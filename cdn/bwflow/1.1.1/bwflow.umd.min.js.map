{"version":3,"sources":["webpack://bwflow/webpack/universalModuleDefinition","webpack://bwflow/webpack/bootstrap","webpack://bwflow/./node_modules/core-js/library/modules/es6.symbol.js","webpack://bwflow/./node_modules/core-js/modules/_iter-define.js","webpack://bwflow/./node_modules/core-js/modules/_string-at.js","webpack://bwflow/./node_modules/core-js/modules/_advance-string-index.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-gopn-ext.js","webpack://bwflow/./node_modules/core-js/library/modules/_has.js","webpack://bwflow/./node_modules/core-js/modules/_array-methods.js","webpack://bwflow/./node_modules/core-js/modules/_flags.js","webpack://bwflow/./node_modules/core-js/modules/_object-keys.js","webpack://bwflow/./node_modules/core-js/library/modules/_to-absolute-index.js","webpack://bwflow/./lib/bWflow/_src/bWflowViewer.vue?6d03","webpack://bwflow/./node_modules/core-js/modules/_is-array.js","webpack://bwflow/./node_modules/core-js/modules/_object-gopd.js","webpack://bwflow/./node_modules/core-js/modules/_object-dps.js","webpack://bwflow/./node_modules/core-js/library/modules/es6.string.iterator.js","webpack://bwflow/./node_modules/core-js/library/modules/_enum-bug-keys.js","webpack://bwflow/./node_modules/core-js/library/modules/_to-primitive.js","webpack://bwflow/./node_modules/core-js/modules/es6.object.define-property.js","webpack://bwflow/./node_modules/core-js/library/modules/_dom-create.js","webpack://bwflow/./node_modules/core-js/modules/_fix-re-wks.js","webpack://bwflow/./node_modules/core-js/modules/_dom-create.js","webpack://bwflow/./node_modules/core-js/modules/_classof.js","webpack://bwflow/./node_modules/core-js/library/modules/_to-object.js","webpack://bwflow/./node_modules/core-js/library/modules/_defined.js","webpack://bwflow/./node_modules/core-js/modules/_object-gops.js","webpack://bwflow/./node_modules/core-js/library/modules/_fails.js","webpack://bwflow/./node_modules/core-js/modules/_redefine.js","webpack://bwflow/./node_modules/core-js/modules/_object-create.js","webpack://bwflow/./node_modules/core-js/modules/_wks.js","webpack://bwflow/./node_modules/core-js/modules/_library.js","webpack://bwflow/./node_modules/core-js/modules/_cof.js","webpack://bwflow/./node_modules/core-js/modules/_strict-method.js","webpack://bwflow/./node_modules/core-js/library/modules/_iter-define.js","webpack://bwflow/./node_modules/core-js/modules/_hide.js","webpack://bwflow/./node_modules/core-js/library/modules/_html.js","webpack://bwflow/./node_modules/core-js/library/modules/_iobject.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-pie.js","webpack://bwflow/./node_modules/core-js/library/modules/_hide.js","webpack://bwflow/./node_modules/core-js/modules/_array-fill.js","webpack://bwflow/./node_modules/core-js/library/modules/_to-iobject.js","webpack://bwflow/./node_modules/core-js/modules/_object-gpo.js","webpack://bwflow/./node_modules/core-js/library/modules/_to-integer.js","webpack://bwflow/./node_modules/inherits/inherits_browser.js","webpack://bwflow/./node_modules/core-js/modules/_iter-create.js","webpack://bwflow/./node_modules/core-js/library/fn/object/define-property.js","webpack://bwflow/./node_modules/core-js/modules/es6.object.keys.js","webpack://bwflow/./node_modules/core-js/modules/_to-integer.js","webpack://bwflow/./node_modules/core-js/library/modules/_set-to-string-tag.js","webpack://bwflow/./node_modules/core-js/modules/_property-desc.js","webpack://bwflow/./node_modules/core-js/library/modules/es6.object.define-property.js","webpack://bwflow/./node_modules/core-js/library/modules/_enum-keys.js","webpack://bwflow/./node_modules/core-js/library/modules/_iterators.js","webpack://bwflow/./node_modules/core-js/modules/_to-object.js","webpack://bwflow/./node_modules/core-js/modules/es6.string.trim.js","webpack://bwflow/./node_modules/core-js/modules/_object-to-array.js","webpack://bwflow/./node_modules/core-js/library/modules/_iter-step.js","webpack://bwflow/./node_modules/core-js/library/modules/_wks.js","webpack://bwflow/./node_modules/core-js/modules/_regexp-exec.js","webpack://bwflow/./node_modules/core-js/modules/_object-pie.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-gpo.js","webpack://bwflow/./node_modules/core-js/modules/_shared.js","webpack://bwflow/./node_modules/core-js/library/modules/_shared-key.js","webpack://bwflow/./node_modules/core-js/modules/es6.array.index-of.js","webpack://bwflow/./node_modules/core-js/library/modules/_core.js","webpack://bwflow/./node_modules/core-js/modules/es6.object.define-properties.js","webpack://bwflow/./node_modules/core-js/library/modules/_array-includes.js","webpack://bwflow/./node_modules/core-js/modules/_export.js","webpack://bwflow/./node_modules/@babel/runtime-corejs2/core-js/symbol/iterator.js","webpack://bwflow/./node_modules/core-js/modules/_object-sap.js","webpack://bwflow/./node_modules/core-js/modules/_regexp-exec-abstract.js","webpack://bwflow/./node_modules/core-js/modules/_shared-key.js","webpack://bwflow/./node_modules/core-js/modules/_iobject.js","webpack://bwflow/./node_modules/core-js/library/modules/_uid.js","webpack://bwflow/./node_modules/core-js/library/modules/_export.js","webpack://bwflow/./node_modules/object-refs/lib/refs.js","webpack://bwflow/./node_modules/core-js/library/modules/_wks-define.js","webpack://bwflow/./node_modules/@babel/runtime-corejs2/core-js/symbol.js","webpack://bwflow/./node_modules/core-js/modules/_to-iobject.js","webpack://bwflow/./node_modules/core-js/modules/_has.js","webpack://bwflow/./node_modules/core-js/library/modules/es7.symbol.async-iterator.js","webpack://bwflow/./node_modules/core-js/modules/_to-primitive.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-gopn.js","webpack://bwflow/./node_modules/core-js/library/modules/_cof.js","webpack://bwflow/./node_modules/core-js/library/modules/web.dom.iterable.js","webpack://bwflow/./node_modules/core-js/modules/es6.array.fill.js","webpack://bwflow/./node_modules/core-js/modules/es6.array.map.js","webpack://bwflow/./node_modules/core-js/library/modules/_string-at.js","webpack://bwflow/./lib/bWflow/_src/bWflow.vue?c301","webpack://bwflow/./node_modules/core-js/modules/es6.array.find.js","webpack://bwflow/./node_modules/core-js/library/modules/es7.symbol.observable.js","webpack://bwflow/./node_modules/core-js/modules/_global.js","webpack://bwflow/./node_modules/core-js/modules/_to-absolute-index.js","webpack://bwflow/./node_modules/core-js/library/modules/_ie8-dom-define.js","webpack://bwflow/./node_modules/core-js/library/modules/_a-function.js","webpack://bwflow/./node_modules/core-js/modules/_fails.js","webpack://bwflow/./node_modules/object-refs/lib/collection.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-dps.js","webpack://bwflow/./node_modules/core-js/modules/_set-to-string-tag.js","webpack://bwflow/./node_modules/core-js/modules/es6.function.name.js","webpack://bwflow/./node_modules/core-js/modules/_core.js","webpack://bwflow/./node_modules/core-js/library/modules/_add-to-unscopables.js","webpack://bwflow/./node_modules/core-js/modules/_iterators.js","webpack://bwflow/./node_modules/@babel/runtime-corejs2/core-js/object/define-property.js","webpack://bwflow/./node_modules/core-js/modules/es7.object.values.js","webpack://bwflow/./node_modules/core-js/modules/_object-dp.js","webpack://bwflow/./node_modules/@soda/get-current-script/index.js","webpack://bwflow/./node_modules/core-js/library/modules/_descriptors.js","webpack://bwflow/./node_modules/core-js/modules/es7.object.get-own-property-descriptors.js","webpack://bwflow/./node_modules/core-js/library/modules/_iter-create.js","webpack://bwflow/./node_modules/object-refs/index.js","webpack://bwflow/./node_modules/core-js/library/modules/_is-array.js","webpack://bwflow/./node_modules/core-js/modules/_object-gopn.js","webpack://bwflow/./node_modules/core-js/library/modules/_redefine.js","webpack://bwflow/./node_modules/core-js/modules/_own-keys.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-gops.js","webpack://bwflow/./node_modules/core-js/modules/_ctx.js","webpack://bwflow/./node_modules/core-js/modules/_add-to-unscopables.js","webpack://bwflow/./node_modules/core-js/modules/_to-length.js","webpack://bwflow/./node_modules/core-js/modules/_descriptors.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-create.js","webpack://bwflow/./node_modules/core-js/modules/es6.regexp.replace.js","webpack://bwflow/./node_modules/core-js/modules/_string-trim.js","webpack://bwflow/./node_modules/core-js/modules/web.dom.iterable.js","webpack://bwflow/./node_modules/core-js/library/modules/_property-desc.js","webpack://bwflow/./node_modules/core-js/modules/es6.regexp.exec.js","webpack://bwflow/./node_modules/core-js/library/modules/_to-length.js","webpack://bwflow/./node_modules/core-js/library/modules/_library.js","webpack://bwflow/./node_modules/core-js/modules/_defined.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-gopd.js","webpack://bwflow/./node_modules/core-js/modules/_array-includes.js","webpack://bwflow/./node_modules/core-js/library/modules/es6.array.iterator.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-keys.js","webpack://bwflow/./node_modules/core-js/modules/_ie8-dom-define.js","webpack://bwflow/(webpack)/buildin/global.js","webpack://bwflow/./node_modules/core-js/modules/_uid.js","webpack://bwflow/./node_modules/core-js/modules/es6.array.iterator.js","webpack://bwflow/./node_modules/core-js/modules/_an-object.js","webpack://bwflow/./node_modules/core-js/library/modules/_wks-ext.js","webpack://bwflow/./node_modules/core-js/modules/_array-species-create.js","webpack://bwflow/./node_modules/core-js/modules/_object-keys-internal.js","webpack://bwflow/./node_modules/core-js/modules/es6.array.filter.js","webpack://bwflow/./node_modules/core-js/modules/_is-object.js","webpack://bwflow/./node_modules/core-js/modules/_iter-step.js","webpack://bwflow/./node_modules/core-js/library/modules/_ctx.js","webpack://bwflow/./node_modules/core-js/library/fn/symbol/iterator.js","webpack://bwflow/./node_modules/core-js/modules/_a-function.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-dp.js","webpack://bwflow/./node_modules/core-js/library/modules/_shared.js","webpack://bwflow/./node_modules/core-js/modules/_enum-bug-keys.js","webpack://bwflow/./node_modules/core-js/library/modules/_an-object.js","webpack://bwflow/./node_modules/core-js/library/modules/_global.js","webpack://bwflow/./node_modules/path-intersection/intersect.js","webpack://bwflow/./node_modules/core-js/library/modules/_object-keys-internal.js","webpack://bwflow/./node_modules/css.escape/css.escape.js","webpack://bwflow/./node_modules/core-js/modules/_array-species-constructor.js","webpack://bwflow/./node_modules/core-js/library/modules/_meta.js","webpack://bwflow/./node_modules/core-js/modules/_create-property.js","webpack://bwflow/./node_modules/core-js/modules/es6.array.for-each.js","webpack://bwflow/./node_modules/core-js/library/modules/_is-object.js","webpack://bwflow/./node_modules/core-js/library/fn/symbol/index.js","webpack://bwflow/./node_modules/core-js/modules/_function-to-string.js","webpack://bwflow/./node_modules/core-js/modules/_html.js","webpack://bwflow/./node_modules/@vue/cli-service/lib/commands/build/setPublicPath.js","webpack://bwflow/./node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty.js","webpack://bwflow/./lib/bWflow/_src/bWflow.vue","webpack://bwflow/./node_modules/didi/dist/index.esm.js","webpack://bwflow/./node_modules/diagram-js/lib/draw/BaseRenderer.js","webpack://bwflow/./node_modules/tiny-svg/dist/index.esm.js","webpack://bwflow/./node_modules/diagram-js/lib/util/RenderUtil.js","webpack://bwflow/./node_modules/min-dash/dist/index.esm.js","webpack://bwflow/./node_modules/diagram-js/lib/util/Elements.js","webpack://bwflow/./node_modules/diagram-js/lib/draw/DefaultRenderer.js","webpack://bwflow/./node_modules/diagram-js/lib/draw/Styles.js","webpack://bwflow/./node_modules/diagram-js/lib/draw/index.js","webpack://bwflow/./node_modules/diagram-js/lib/util/Collections.js","webpack://bwflow/./node_modules/diagram-js/lib/core/Canvas.js","webpack://bwflow/./node_modules/diagram-js/lib/core/ElementRegistry.js","webpack://bwflow/./node_modules/diagram-js/lib/model/index.js","webpack://bwflow/./node_modules/diagram-js/lib/core/ElementFactory.js","webpack://bwflow/./node_modules/diagram-js/lib/core/EventBus.js","webpack://bwflow/./node_modules/diagram-js/lib/util/GraphicsUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/util/SvgTransformUtil.js","webpack://bwflow/./node_modules/min-dom/dist/index.esm.js","webpack://bwflow/./node_modules/diagram-js/lib/core/GraphicsFactory.js","webpack://bwflow/./node_modules/diagram-js/lib/core/index.js","webpack://bwflow/./node_modules/diagram-js/lib/Diagram.js","webpack://bwflow/./node_modules/diagram-js/lib/features/align-elements/AlignElements.js","webpack://bwflow/./node_modules/diagram-js/lib/features/align-elements/index.js","webpack://bwflow/./node_modules/diagram-js/lib/util/Event.js","webpack://bwflow/./node_modules/diagram-js/lib/features/hover-fix/HoverFix.js","webpack://bwflow/./node_modules/diagram-js/lib/features/hover-fix/index.js","webpack://bwflow/./node_modules/diagram-js/lib/util/Platform.js","webpack://bwflow/./node_modules/diagram-js/lib/util/Mouse.js","webpack://bwflow/./node_modules/diagram-js/lib/features/interaction-events/InteractionEvents.js","webpack://bwflow/./node_modules/diagram-js/lib/features/interaction-events/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/outline/Outline.js","webpack://bwflow/./node_modules/diagram-js/lib/features/outline/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/selection/Selection.js","webpack://bwflow/./node_modules/diagram-js/lib/features/selection/SelectionVisuals.js","webpack://bwflow/./node_modules/diagram-js/lib/features/selection/SelectionBehavior.js","webpack://bwflow/./node_modules/diagram-js/lib/features/selection/index.js","webpack://bwflow/./node_modules/diagram-js/lib/util/Cursor.js","webpack://bwflow/./node_modules/diagram-js/lib/util/ClickTrap.js","webpack://bwflow/./node_modules/diagram-js/lib/util/PositionUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/features/dragging/Dragging.js","webpack://bwflow/./node_modules/diagram-js/lib/features/dragging/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/rules/Rules.js","webpack://bwflow/./node_modules/diagram-js/lib/features/rules/index.js","webpack://bwflow/./node_modules/diagram-js/lib/util/Geometry.js","webpack://bwflow/./node_modules/diagram-js/lib/util/LineIntersection.js","webpack://bwflow/./node_modules/diagram-js/lib/features/bendpoints/BendpointUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/features/bendpoints/Bendpoints.js","webpack://bwflow/./node_modules/diagram-js/lib/layout/LayoutUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/features/bendpoints/BendpointMove.js","webpack://bwflow/./node_modules/diagram-js/lib/features/bendpoints/BendpointMovePreview.js","webpack://bwflow/./node_modules/diagram-js/lib/features/bendpoints/ConnectionSegmentMove.js","webpack://bwflow/./node_modules/diagram-js/lib/features/snapping/SnapUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/features/bendpoints/BendpointSnapping.js","webpack://bwflow/./node_modules/diagram-js/lib/features/bendpoints/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/connect/Connect.js","webpack://bwflow/./node_modules/diagram-js/lib/features/connect/ConnectPreview.js","webpack://bwflow/./node_modules/diagram-js/lib/features/connect/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/connection-preview/ConnectionPreview.js","webpack://bwflow/./node_modules/diagram-js/lib/features/connection-preview/index.js","webpack://bwflow/./node_modules/diagram-js/lib/util/IdGenerator.js","webpack://bwflow/./node_modules/diagram-js/lib/features/overlays/Overlays.js","webpack://bwflow/./node_modules/diagram-js/lib/features/overlays/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/context-pad/ContextPad.js","webpack://bwflow/./node_modules/diagram-js/lib/features/context-pad/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/preview-support/PreviewSupport.js","webpack://bwflow/./node_modules/diagram-js/lib/features/preview-support/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/create/Create.js","webpack://bwflow/./node_modules/diagram-js/lib/features/create/CreatePreview.js","webpack://bwflow/./node_modules/diagram-js/lib/features/create/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/tool-manager/ToolManager.js","webpack://bwflow/./node_modules/diagram-js/lib/features/tool-manager/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/keyboard/KeyboardUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/features/hand-tool/HandTool.js","webpack://bwflow/./node_modules/diagram-js/lib/features/hand-tool/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/lasso-tool/LassoTool.js","webpack://bwflow/./node_modules/diagram-js/lib/features/lasso-tool/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/global-connect/GlobalConnect.js","webpack://bwflow/./node_modules/diagram-js/lib/features/global-connect/index.js","webpack://bwflow/./node_modules/diagram-js/lib/navigation/movecanvas/MoveCanvas.js","webpack://bwflow/./node_modules/diagram-js/lib/navigation/movecanvas/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/move/Move.js","webpack://bwflow/./node_modules/diagram-js/lib/features/move/MovePreview.js","webpack://bwflow/./node_modules/diagram-js/lib/features/move/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/palette/Palette.js","webpack://bwflow/./node_modules/diagram-js/lib/features/palette/index.js","webpack://bwflow/./node_modules/diagram-js/lib/util/Math.js","webpack://bwflow/./node_modules/diagram-js/lib/navigation/zoomscroll/ZoomUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/navigation/zoomscroll/ZoomScroll.js","webpack://bwflow/./node_modules/diagram-js/lib/navigation/zoomscroll/index.js","webpack://bwflow/./node_modules/diagram-js/lib/command/CommandStack.js","webpack://bwflow/./node_modules/diagram-js/lib/command/index.js","webpack://bwflow/./node_modules/diagram-js/lib/util/Removal.js","webpack://bwflow/./node_modules/diagram-js/lib/command/CommandInterceptor.js","webpack://bwflow/./node_modules/diagram-js/lib/features/label-support/LabelSupport.js","webpack://bwflow/./node_modules/diagram-js/lib/features/label-support/index.js","webpack://bwflow/./lib/_util/translate.js","webpack://bwflow/./lib/_util/util.js","webpack://bwflow/./lib/bWflow/_src/modules/component/label.js","webpack://bwflow/./lib/bWflow/_src/modules/modeling/elementFactory.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/AlignElementsHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/AppendShapeHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/CreateConnectionHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/CreateElementsHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/CreateShapeHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/CreateLabelHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/DeleteConnectionHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/DeleteElementsHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/DeleteShapeHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/DistributeElementsHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/LayoutConnectionHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/MoveConnectionHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/util/AttachUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/helper/AnchorsHelper.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveClosure.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveHelper.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/MoveElementsHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/MoveShapeHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/ReconnectConnectionHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/ReplaceShapeHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/ResizeShapeHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/space-tool/SpaceUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/SpaceToolHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/ToggleShapeCollapseHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/UpdateAttachmentHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/cmd/UpdateWaypointsHandler.js","webpack://bwflow/./node_modules/diagram-js/lib/features/modeling/Modeling.js","webpack://bwflow/./lib/bWflow/_src/modules/labelEditing/labelUtil.js","webpack://bwflow/./lib/bWflow/_src/modules/labelEditing/updateLabelHandler.js","webpack://bwflow/./lib/bWflow/_src/modules/modeling/modeling.js","webpack://bwflow/./lib/bWflow/_src/modules/modeling/elementUpdater.js","webpack://bwflow/./node_modules/diagram-js/lib/layout/BaseLayouter.js","webpack://bwflow/./node_modules/diagram-js/lib/layout/ManhattanLayout.js","webpack://bwflow/./lib/bWflow/_src/modules/modeling/elementLayouter.js","webpack://bwflow/./node_modules/diagram-js/lib/layout/CroppingConnectionDocking.js","webpack://bwflow/./lib/bWflow/_src/modules/modeling/index.js","webpack://bwflow/./lib/bWflow/_src/modules/draw/renderUtil.js","webpack://bwflow/./lib/bWflow/_src/modules/draw/myRenderer.js","webpack://bwflow/./node_modules/diagram-js/lib/util/Text.js","webpack://bwflow/./lib/bWflow/_src/modules/draw/textRenderer.js","webpack://bwflow/./node_modules/@babel/runtime-corejs2/helpers/esm/typeof.js","webpack://bwflow/./lib/bWflow/_src/modules/draw/pathMap.js","webpack://bwflow/./lib/bWflow/_src/modules/draw/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/change-support/ChangeSupport.js","webpack://bwflow/./node_modules/diagram-js/lib/features/change-support/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/resize/ResizeUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/features/resize/Resize.js","webpack://bwflow/./node_modules/diagram-js/lib/features/resize/ResizePreview.js","webpack://bwflow/./node_modules/diagram-js/lib/features/resize/ResizeHandles.js","webpack://bwflow/./node_modules/diagram-js/lib/features/resize/index.js","webpack://bwflow/./node_modules/diagram-js-direct-editing/lib/TextBox.js","webpack://bwflow/./node_modules/diagram-js-direct-editing/lib/DirectEditing.js","webpack://bwflow/./node_modules/diagram-js-direct-editing/index.js","webpack://bwflow/./lib/bWflow/_src/modules/labelEditing/labelEditingProvider.js","webpack://bwflow/./lib/bWflow/_src/modules/labelEditing/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/snapping/SnapContext.js","webpack://bwflow/./node_modules/diagram-js/lib/features/snapping/CreateMoveSnapping.js","webpack://bwflow/./lib/bWflow/_src/modules/snapping/myCreateMoveSnapping.js","webpack://bwflow/./node_modules/diagram-js/lib/features/snapping/ResizeSnapping.js","webpack://bwflow/./node_modules/diagram-js/lib/features/snapping/Snapping.js","webpack://bwflow/./node_modules/diagram-js/lib/features/snapping/index.js","webpack://bwflow/./lib/bWflow/_src/modules/snapping/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/rules/RuleProvider.js","webpack://bwflow/./lib/bWflow/_src/modules/rules/myRuleProvider.js","webpack://bwflow/./lib/bWflow/_src/modules/rules/index.js","webpack://bwflow/./lib/bWflow/_src/modules/palette/paletteProvider.js","webpack://bwflow/./lib/bWflow/_src/modules/palette/index.js","webpack://bwflow/./node_modules/diagram-js/lib/features/auto-place/AutoPlaceUtil.js","webpack://bwflow/./node_modules/diagram-js/lib/features/auto-place/AutoPlace.js","webpack://bwflow/./node_modules/diagram-js/lib/features/auto-place/AutoPlaceSelectionBehavior.js","webpack://bwflow/./node_modules/diagram-js/lib/features/auto-place/index.js","webpack://bwflow/./lib/bWflow/_src/modules/autoPlace/myAutoPlaceUtil.js","webpack://bwflow/./lib/bWflow/_src/modules/autoPlace/myAutoPlace.js","webpack://bwflow/./lib/bWflow/_src/modules/autoPlace/index.js","webpack://bwflow/./lib/bWflow/_src/modules/contextPad/contextPadProvider.js","webpack://bwflow/./lib/bWflow/_src/modules/contextPad/index.js","webpack://bwflow/./lib/bWflow/_src/modules/import/myImporter.js","webpack://bwflow/./lib/bWflow/_src/modules/import/index.js","webpack://bwflow/./lib/bWflow/_src/myflow.js","webpack://bwflow/lib/bWflow/_src/bWflow.vue","webpack://bwflow/./lib/bWflow/_src/bWflow.vue?af8d","webpack://bwflow/./node_modules/vue-loader/lib/runtime/componentNormalizer.js","webpack://bwflow/./lib/bWflow/_src/bWflow.vue?061b","webpack://bwflow/./lib/bWflow/_src/bWflowViewer.vue","webpack://bwflow/lib/bWflow/_src/bWflowViewer.vue","webpack://bwflow/./lib/bWflow/_src/bWflowViewer.vue?f42e","webpack://bwflow/./lib/bWflow/_src/bWflowViewer.vue?b0f2","webpack://bwflow/./lib/bWflow/index.js","webpack://bwflow/./lib/index.js","webpack://bwflow/./node_modules/@vue/cli-service/lib/commands/build/entry-lib.js","webpack://bwflow/./node_modules/core-js/modules/_string-ws.js"],"names":["root","factory","exports","module","define","amd","self","this","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","global","has","DESCRIPTORS","$export","redefine","META","KEY","$fails","shared","setToStringTag","uid","wks","wksExt","wksDefine","enumKeys","isArray","anObject","isObject","toObject","toIObject","toPrimitive","createDesc","_create","gOPNExt","$GOPD","$GOPS","$DP","$keys","gOPD","f","dP","gOPN","$Symbol","$JSON","JSON","_stringify","stringify","PROTOTYPE","HIDDEN","TO_PRIMITIVE","isEnum","propertyIsEnumerable","SymbolRegistry","AllSymbols","OPSymbols","ObjectProto","USE_NATIVE","QObject","setter","findChild","setSymbolDesc","a","it","D","protoDesc","wrap","tag","sym","_k","isSymbol","iterator","$defineProperty","$defineProperties","P","keys","length","$create","undefined","$propertyIsEnumerable","E","$getOwnPropertyDescriptor","$getOwnPropertyNames","names","result","push","$getOwnPropertySymbols","IS_OP","TypeError","arguments","$set","configurable","set","G","W","F","es6Symbols","split","j","wellKnownSymbols","store","k","S","keyFor","useSetter","useSimple","defineProperties","getOwnPropertyDescriptor","getOwnPropertyNames","getOwnPropertySymbols","FAILS_ON_PRIMITIVES","replacer","$replacer","args","apply","valueOf","Math","LIBRARY","hide","Iterators","$iterCreate","getPrototypeOf","ITERATOR","BUGGY","FF_ITERATOR","KEYS","VALUES","returnThis","Base","NAME","Constructor","next","DEFAULT","IS_SET","FORCED","methods","IteratorPrototype","getMethod","kind","proto","TAG","DEF_VALUES","VALUES_BUG","$native","$default","$entries","$anyNative","entries","values","toInteger","defined","TO_STRING","that","pos","b","String","charCodeAt","charAt","slice","at","index","unicode","toString","windowNames","window","getWindowNames","e","ctx","IObject","toLength","asc","TYPE","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","NO_HOLES","$this","callbackfn","val","res","O","ignoreCase","multiline","sticky","enumBugKeys","max","min","cof","Array","arg","pIE","IE8_DOM_DEFINE","getKeys","Properties","$at","iterated","_t","_i","point","done","fn","document","is","createElement","fails","regexpExec","SPECIES","REPLACE_SUPPORTS_NAMED_GROUPS","re","exec","groups","replace","SPLIT_WORKS_WITH_OVERWRITTEN_EXEC","originalExec","SYMBOL","DELEGATES_TO_SYMBOL","DELEGATES_TO_EXEC","execCalled","constructor","nativeRegExpMethod","fns","nativeMethod","regexp","str","arg2","forceStringMethod","strfn","rxfn","RegExp","string","ARG","tryGet","T","B","callee","SRC","$toString","TPL","inspectSource","safe","isFunction","join","Function","dPs","IE_PROTO","Empty","createDict","iframeDocument","iframe","lt","gt","style","display","appendChild","src","contentWindow","open","write","close","USE_SYMBOL","$exports","method","documentElement","toAbsoluteIndex","aLen","end","endPos","ceil","floor","isNaN","ctor","superCtor","super_","writable","TempCtor","descriptor","$Object","desc","def","stat","bitmap","gOPS","getSymbols","symbols","$trim","isEntries","regexpFlags","nativeExec","nativeReplace","patchedExec","LAST_INDEX","UPDATES_LAST_INDEX_WRONG","re1","re2","NPCG_INCLUDED","PATCH","lastIndex","reCopy","match","source","core","SHARED","version","copyright","$indexOf","indexOf","NEGATIVE_ZERO","searchElement","__e","IS_INCLUDES","el","fromIndex","type","own","out","exp","IS_FORCED","IS_GLOBAL","IS_STATIC","IS_PROTO","IS_BIND","target","expProto","U","R","classof","builtinExec","id","px","random","concat","IS_WRAP","C","virtual","Collection","defineCollectionProperty","ref","collection","extend","forEach","inverse","inverseProperty","_value","old","unset","Refs","props","Error","ensureRefsCollection","isExtended","ensureBound","remove","add","hiddenKeys","TO_STRING_TAG","DOMIterables","fill","$map","map","$find","forced","find","__g","refs","element","idx","splice","currentIdx","__refs_collection","FProto","nameRE","$values","Attributes","getCurrentScript","currentScript","err","pageSource","inlineScriptSourceRegExp","inlineScriptSource","ieStackRegExp","ffStackRegExp","stackDetails","stack","scriptLocation","line","currentLocation","location","href","hash","scripts","getElementsByTagName","outerHTML","trim","readyState","innerHTML","ownKeys","createProperty","getOwnPropertyDescriptors","getDesc","Reflect","aFunction","UNSCOPABLES","ArrayProto","advanceStringIndex","regExpExec","SUBSTITUTION_SYMBOLS","SUBSTITUTION_SYMBOLS_NO_NAMED","maybeToString","REPLACE","$replace","maybeCallNative","searchValue","replaceValue","rx","functionalReplace","fullUnicode","results","matchStr","accumulatedResult","nextSourcePosition","matched","position","captures","namedCaptures","replacerArgs","replacement","getSubstitution","tailPos","ch","capture","spaces","space","non","ltrim","rtrim","exporter","ALIAS","FORCE","$iterators","ArrayValues","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","collections","explicit","addToUnscopables","step","Arguments","g","speciesConstructor","original","arrayIndexOf","$filter","filter","p2s","toFloat","parseFloat","math","PI","mmin","mmax","pow","abs","pathCommand","pathValues","hasProperty","obj","clone","repush","array","item","ii","cacher","newf","cache","count","shift","parsePathString","pathString","pth","paths","arr","paramCounts","h","q","v","z","data","params","toLowerCase","ps","sleep","setTimeout","rectBBox","x","y","width","height","x2","y2","pathToString","pathClone","pathArray","findDotsAtSegment","p1x","p1y","c1x","c1y","c2x","c2y","p2x","p2y","t1","t13","t12","t2","t3","fixError","bezierBBox","points","bbox","curveBBox","x0","y0","x1","y1","isPointInsideBBox","isBBoxIntersect","bbox1","bbox2","base3","p1","p2","p3","p4","bezlen","x3","y3","x4","y4","z2","Tvalues","Cvalues","sum","ct","xbase","ybase","comb","sqrt","intersectLines","nx","ny","denominator","py","px2","toFixed","py2","number","round","findBezierIntersections","bez1","bez2","justCount","l1","l2","n1","isLine","n2","dots1","dots2","xy","di","di1","dj","dj1","ci","cj","findPathIntersections","path1","path2","pathToCurve","x1m","y1m","x2m","y2m","pi","jj","pj","intr","kk","segment1","segment2","pathToAbsolute","pa0","mx","my","start","pa","toUpperCase","bez","lineToCurve","qubicToCurve","ax","ay","_13","_23","arcToCurve","ry","angle","large_arc_flag","sweep_flag","recursive","_120","rad","rotate","X","cos","sin","Y","f1","f2","cx","cy","rx2","ry2","asin","df","f2old","x2old","y2old","c1","s1","c2","s2","tan","hx","hy","m1","m2","m3","m4","newres","b2ac","sqrtb2ac","tvalues","bounds","mt","jlen","path","curve","curvedPath","attrs","bx","by","qx","qy","processPath","Q","fixArc","pp","pathCommands","pfirst","seg","seglen","CSS","escape","cssEscape","codeUnit","firstCodeUnit","setDesc","isExtensible","FREEZE","preventExtensions","setMeta","w","fastKey","getWeak","onFreeze","meta","NEED","$forEach","STRICT","_defineProperty","render","_vm","_c","_self","staticClass","staticRenderFns","CLASS_PATTERN","isClass","test","annotate","pop","$inject","CONSTRUCTOR_ARGS","FN_ARGS","FN_ARG","parse","Module","providers","_toConsumableArray","arr2","from","Injector","parent","strict","currentlyResolving","error","_providers","instances","_instances","injector","msg","parts","pivot","hasProp","fnDef","locals","inject","dependencies","dep","instantiate","Type","_fnDef","invoke","func","context","_fnDef2","createPrivateInjectorFactory","privateChildInjector","createChild","forceNewInstances","provider","cacheIdx","privateChildInjectorFactory","fromParentModule","matchedScopes","privateInjectorsCache","privateChildInjectors","privateChildFactories","$scope","scope","unshift","factoryMap","arrayUnwrap","__exports__","clonedModule","reduce","substring","privateInjector","__modules__","getFromPrivateInjector","prop","DEFAULT_RENDER_PRIORITY","BaseRenderer","eventBus","renderPriority","on","evt","visuals","gfx","canRender","drawShape","drawConnection","getShapePath","getConnectionPath","ensureImported","ownerDocument","importNode","appendTo","node","LENGTH_ATTR","CSS_PROPERTIES","getAttribute","getAttributeNS","setAttribute","hyphenated","setAttributeNS","setAttributes","ClassList","nodeType","list","classList","parentNode","removeChild","clear","child","firstChild","cloneNode","className","baseVal","removeMatching","toggle","force","contains","svg","SVG_START","unwrap","parsed","parseDocument","fragment","createDocumentFragment","parser","DOMParser","async","parseFromString","createElementNS","createMatrix","matrix","createSVGMatrix","createTransform","createSVGTransformFromMatrix","createSVGTransform","wrapMatrix","transformList","transform","SVGMatrix","setTransforms","transforms","appendItem","consolidate","componentsToPath","elements","toSVGPoints","createLine","updateLine","flatten","nativeToString","nativeHasOwnProperty","isUndefined","isDefined","isNil","isNumber","isString","ensureArray","matcher","toMatcher","convertKey","toNum","identity","without","every","matches","some","groupBy","extractor","grouped","toExtractor","discriminator","group","uniqueBy","_len","_key","sortBy","sorted","disc","entry","matchPattern","pattern","Number","debounce","timeout","timer","lastArgs","lastThis","lastNow","fire","now","Date","scheduledDiff","schedule","_extends","assign","others","pick","properties","getParents","getParent","unique","canAdd","eachElement","depth","selfAndChildren","maxDepth","processedChildren","children","selfAndAllChildren","allowDuplicates","getClosure","isTopLevel","closure","allShapes","copyObject","allConnections","enclosedElements","enclosedConnections","topLevel","handleConnection","handleElement","waypoints","incoming","outgoing","getBBox","stopRecursion","minX","minY","maxX","maxY","getEnclosedElements","filteredElements","getType","isFrameElement","isFrame","src1","src2","DefaultRenderer","styles","CONNECTION_STYLE","strokeWidth","stroke","SHAPE_STYLE","FRAME_STYLE","strokeDasharray","Styles","defaultTraits","strokeOpacity","pointerEvents","cls","traits","additionalAttrs","computeStyle","custom","defaultStyles","rect","connection","shape","shapePath","connectionPath","__init__","defaultRenderer","resolution","ensurePx","createContainer","options","container","body","overflow","createGroup","childIndex","childNodes","insertBefore","BASE_LAYER","REQUIRED_MODEL_ATTRS","Canvas","config","graphicsFactory","elementRegistry","_eventBus","_elementRegistry","_graphicsFactory","_init","setCTM","mstr","_container","_svg","viewport","_viewport","_layers","deferUpdate","_viewboxChanged","_cachedViewbox","_destroy","_clear","emit","_rootElement","allElements","getAll","setRootElement","_removeElement","getDefaultLayer","getLayer","layer","_createLayer","getContainer","_updateMarker","marker","_elements","secondaryGfx","addMarker","removeMarker","hasMarker","getGraphics","toggleMarker","getRootElement","override","_ensureValid","currentRoot","requiredAttrs","valid","attr","_setParent","parentIndex","_addElement","update","addShape","addConnection","removeShape","removeConnection","secondary","_changeViewbox","changeFn","viewbox","box","innerBox","scale","outerBox","getSize","translate","inner","outer","scroll","delta","getCTM","dx","dy","multiply","zoom","newScale","center","_fitViewport","_setZoom","newViewbox","vbox","centerPoint","originalPoint","currentMatrix","scaleMatrix","newMatrix","createSVGPoint","currentScale","matrixTransform","clientWidth","clientHeight","getAbsoluteBBox","resized","ELEMENT_ID","ElementRegistry","_validateId","updateId","newId","filtered","parentRefs","labelRefs","attacherRefs","outgoingRefs","incomingRefs","labels","newLabel","label","Shape","Root","Label","Connection","ElementFactory","_uid","createRoot","createLabel","createShape","createConnection","FN_REF","DEFAULT_PRIORITY","EventBus","_listeners","InternalEvent","invokeFunction","getVisual","getChildren","amount","setTranslate","setRotate","setScale","removeAttribute","events","priority","callback","actualCallback","_addListener","once","event","wrappedCallback","off","_removeListener","createEvent","init","firstListener","returnValue","originalType","_invokeListeners","defaultPrevented","handleError","listener","cancelBubble","_invokeListener","stopPropagation","preventDefault","console","newListener","previousListener","_getListeners","_setListeners","nextListener","listenerCallback","indexof","Element","vendor","matchesSelector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","selector","nodes","querySelectorAll","closest","checkYourSelf","currentElem","DOCUMENT_NODE","DOCUMENT_FRAGMENT_NODE","addEventListener","unbind","removeEventListener","bind_1","unbind_1","componentEvent","forceCaptureEvents","bind$1","srcElement","delegateTarget","unbind$1","bugTestDiv","delegate","domify","innerHTMLBug","legend","tr","col","_default","html","doc","createTextNode","lastChild","prefix","suffix","query","querySelector","GraphicsFactory","newNode","siblingNode","td","th","option","optgroup","thead","tbody","colgroup","caption","tfoot","polyline","ellipse","polygon","circle","text","_getChildrenContainer","childrenGfx","visual","_createContainer","outerGfx","updateContainments","parents","reverse","childGfx","hidden","__depends__","canvas","elementFactory","bootstrap","bootstrapModules","components","hasModule","addModule","visit","createInjector","configModule","Diagram","last","sortTopOrMiddle","sortLeftOrCenter","destroy","ALIGNMENT_SORTING","left","right","top","middle","bottom","AlignElements","modeling","_modeling","_getOrientationDetails","vertical","axis","dimension","_isType","types","_alignmentPosition","sortedElements","centeredElements","firstElement","lastElement","orientation","alignment","centers","hasSharedCenters","getMiddleOrTop","first","trigger","host","labelTarget","sortFn","alignElements","__stopPropagation","getOriginal","originalEvent","srcEvent","immediate","toPoint","pointers","touches","clientX","clientY","HIGH_PRIORITY","HoverFix","dragging","ensureHover","hover","_findTargetGfx","move","hoverGfx","MouseEvent","elementFromPoint","getGfx","hoverFix","isMac","navigator","platform","isPrimaryButton","button","hasPrimaryModifier","metaKey","ctrlKey","hasSecondaryModifier","shiftKey","allowAll","LOW_PRIORITY","InteractionEvents","isIgnored","handlers","mouseHandler","localEventName","ignoredFilters","bindings","click","contextmenu","dblclick","mousedown","mousemove","mouseover","mouseout","mouseup","triggerMouseEvent","eventName","targetElement","ELEMENT_SELECTOR","registerEvent","localEvent","ignoredFilter","handler","$delegate","unregisterEvent","registerEvents","unregisterEvents","createDefaultHit","updateDefaultHit","STROKE_HIT_STYLE","createHitStyle","CLICK_STROKE_HIT_STYLE","ALL_HIT_STYLE","HIT_TYPES","classNames","applyStyle","hit","appendHit","removeHits","hits","boxType","createWaypointsHit","createBoxHit","interactionEvents","Outline","offset","OUTLINE_STYLE","createOutline","outline","updateShapeOutline","updateConnectionOutline","Selection","_selectedElements","deselect","select","selectedElements","oldSelection","newSelection","isSelected","MARKER_HOVER","MARKER_SELECTED","SelectionVisuals","selection","_multiSelectionBox","SelectionBehavior","canExecute","hints","autoSelect","isShown","previousSelection","selectedShape","isMultiSelect","selectionVisuals","selectionBehavior","CURSOR_CLS_PATTERN","classes","TRAP_PRIORITY","install","trap","DRAG_ACTIVE_CLS","isTouchEvent","TouchEvent","getLength","Dragging","defaultOptions","threshold","trapClick","toLocalPoint","globalPosition","clientRect","getBoundingClientRect","dragContext","payload","isTouch","restoreSelection","existingSelection","activate","displacement","globalStart","globalCurrent","globalDelta","localStart","localCurrent","localDelta","active","cancel","keepSelection","cursor","previousContext","cleanup","checkCancel","which","trapClickAndEnd","untrap","trapTouch","restore","wasActive","endDrag","relativeTo","manual","autoActivate","setOptions","Rules","_commandStack","allowed","action","commandStack","rules","pointDistance","pointsOnLine","accuracy","dist","ALIGNED_THRESHOLD","pointsAligned","pointsAlignedHorizontally","pointsAlignedVertically","firstPoint","pointInRect","tolerance","getMidPoint","segments","INTERSECTION_THRESHOLD","getBendpointIntersection","reference","bendpoint","getPathIntersection","intersections","getApproxIntersection","BENDPOINT_CLS","SEGMENT_DRAGGER_CLS","toCanvasCoordinates","getConnectionIntersection","localPosition","intersection","addBendpoint","parentGfx","groupGfx","createParallelDragger","segmentStart","segmentEnd","draggerGfx","padding","hitWidth","calculateHitWidth","hitHeight","addSegmentDragger","mid","calculateSegmentMoveRegion","segmentLength","segmentLengthXAxis","segmentLengthYAxis","Bendpoints","bendpointMove","connectionSegmentMove","isIntersectionMiddle","treshold","p0","aligned","xDelta","yDelta","calculateIntersectionThreshold","relevantSegment","activateBendpointMove","bindInteractionEvents","getBendpointsContainer","getSegmentDragger","createBendpoints","createSegmentDraggers","segmentDraggerGfx","clearBendpoints","clearSegmentDraggers","addHandles","updateHandles","updateFloatingBendpointPosition","floating","updateSegmentDraggerPosition","draggerVisual","relativePosition","getDraggerVisual","bendpointsGfx","primary","bendpointContainer","roundBounds","roundPoint","asTRBL","asBounds","trbl","getMid","getOrientation","rectOrientation","referenceOrientation","horizontal","getElementLineIntersection","elementPath","linePath","cropStart","getIntersections","distance","previousPoint","nextPoint","RECONNECT_START","RECONNECT_END","UPDATE_WAYPOINTS","BendpointMove","_injector","bendpointIndex","insert","command","connectionGfx","newWaypoints","docking","cropWaypoints","updateWaypoints","isReverse","reconnect","connectionDocking","getCroppedWaypoints","MARKER_OK","MARKER_NOT_OK","MARKER_CONNECT_HOVER","MARKER_CONNECT_UPDATING","MARKER_ELEMENT_HIDDEN","BendpointMovePreview","connectionPreview","drawPreviewHints","connectionStart","connectionEnd","noCropping","noLayout","drawPreview","cleanUp","axisAdd","axisSet","axisFenced","maxValue","minValue","fencedValue","flipAxis","getDocking","referenceElement","moveAxis","referenceMid","inverseAxis","ConnectionSegmentMove","cropConnection","croppedWaypoints","oldWaypoints","redrawConnection","updateDragger","segmentOffset","segmentStartIndex","segmentEndIndex","draggerPosition","filterRedundantWaypoints","filteredWaypoints","direction","dragPosition","originalWaypoints","sourceToSegmentOrientation","targetToSegmentOrientation","newSegmentStart","newSegmentEnd","waypointCount","newSegmentStartIndex","segmentMove","snapValue","topLeft","bottomRight","defaultValue","isSnapped","snapped","setSnapped","previousValue","TOLERANCE","BendpointSnapping","snapTo","rem","getConnectionSegmentSnaps","snapPoints","referenceWaypoints","getBendpointSnaps","sx","sy","hoverMid","bendpoints","bendpointMovePreview","bendpointSnapping","Connect","canConnect","canConnectReverse","connect","ConnectPreview","startPosition","connectPreview","MARKER_CONNECTION_PREVIEW","ConnectionPreview","_canvas","_elementFactory","_connectionDocking","_layouter","cacheReturnValues","returnValues","firstArgument","ensureConnectionAttrs","connectionPreviewGfx","getConnection","noNoop","createConnectionPreviewGfx","layoutConnection","drawNoopPreview","createNoopConnection","sourcePath","targetPath","IdGenerator","_counter","_prefix","Overlays","_ids","_overlayDefaults","show","defaults","_overlays","_overlayContainers","_overlayRoot","setPosition","setVisible","visible","setTransform","search","_getOverlayContainer","overlays","overlay","_addOverlay","htmlContainer","_updateOverlayContainer","_updateOverlay","_createOverlayContainer","_updateRoot","raw","overlayContainer","jquery","_updateOverlayVisibilty","minZoom","maxZoom","_updateOverlayScale","minScale","maxScale","shouldScale","_updateOverlaysVisibilty","updateViewbox","entrySelector","ContextPad","_overlaysConfig","_current","addClasses","actualClassNames","isOpen","current","registerProvider","getEntries","_getProviders","entriesOrUpdater","getContextPadEntries","_updateAndOpen","pad","getPad","grouping","control","title","imageUrl","overlaysConfig","_overlayId","contextPad","MARKER_TYPES","NODES_CAN_HAVE_MARKER","PreviewSupport","_styles","_clonedMarkers","clonedMarker","getMarker","markerType","referenceToId","idToReference","canHaveMarker","nodeName","addDragger","dragger","_cloneMarkers","addFrame","frame","class","_cloneMarker","markerId","clonedMarkerId","defs","previewSupport","MARKER_ATTACH","MARKER_NEW_PARENT","PREFIX","Create","canCreate","isLabel","isConnection","attach","isSingleShape","connectionTarget","targetParent","targetAttach","setMarker","ensureConstraints","appendShape","createElements","waypoint","createConstraints","CreatePreview","createDragGroup","dragGroup","defaultLayer","createPreview","ToolManager","_dragging","_tools","_active","registerTool","tools","bindEvents","isActive","tool","setActive","eventsToRegister","reactivate","toolManager","isCmd","altKey","isKey","keyCode","HAND_CURSOR","HandTool","keyboard","activateMove","addListener","deactivateMove","isSpace","keyEvent","removeListener","SVGElement","activateHand","handTool","LASSO_TOOL_CURSOR","LassoTool","_selection","activateLasso","toBBox","activateSelection","lassoTool","GlobalConnect","_rules","startTarget","canStartConnect","globalConnect","THRESHOLD","MoveCanvas","handleMove","lastPosition","handleEnd","handleStart","moveCanvas","MEDIUM_PRIORITY","MoveEvents","canMove","shapes","referencePoint","removeNested","validatedShapes","isAttach","moveElements","primaryShape","ids","MARKER_DRAGGING","MovePreview","getVisualDragShapes","getAllDraggedElements","removeEdges","makeDraggable","allDraggedElements","dragShapes","visuallyDraggedShapes","differentParents","haveDifferentParents","movePreview","TOGGLE_SELECTOR","ENTRY_SELECTOR","PALETTE_OPEN_CLS","PALETTE_TWO_COLUMN_CLS","Palette","updateToolHighlight","_update","_diagramInitialized","_rebuild","addPaletteEntries","getPaletteEntries","parentContainer","_getParentContainer","HTML_MARKUP","_layoutChanged","_toggleState","state","twoColumn","_needsCollapse","_entries","entriesContainer","separator","availableHeight","margin","entriesHeight","isActiveTool","_activeTool","toolsContainer","_toolsContainer","actionName","toolClasses","palette","log10","log","getStepSize","range","steps","minLinearRange","maxLinearRange","absoluteLinearRange","cap","sign","RANGE","NUM_STEPS","DELTA_THRESHOLD","DEFAULT_SCALE","ZoomScroll","_enabled","_handleWheel","_totalDelta","_scale","enabled","reset","stepSize","_zoom","isZoom","isHorizontalScroll","factor","deltaMode","elementRect","deltaY","deltaX","stepZoom","currentLinearZoomLevel","newLinearZoomLevel","newLogZoomLevel","newEnabled","handleWheel","oldEnabled","zoomScroll","CommandStack","_handlerMap","_stack","_stackIdx","_currentExecution","actions","dirty","execute","_pushAction","_internalExecute","_popAction","_getHandler","_fire","undo","_getUndoAction","_internalUndo","redo","_getRedoAction","register","_setHandler","registerHandler","handlerCls","canUndo","canRedo","_atomicDo","revert","_markDirty","_revertedAction","qualifier","_createId","execution","atomic","preExecute","_executedAction","postExecute","baseAction","stackIdx","saveClear","removeFn","CommandInterceptor","unwrapEvent","hook","handlerFn","fullEvent","hooks","LabelSupport","removeLabels","preExecuted","enclosedLabels","addAll","nested","labelTargetIndex","labelSupport","uuid","hexDigits","substr","isAny","DEFAULT_LABEL_SIZE","BaseElementFactory","_translate","AppendShapeHandler","existsConnection","CreateConnectionHandler","layouter","inherits","baseCreate","elementType","createFlowElement","businessObject","size","_getDefaultSize","CreateElementsHandler","createShapeHints","autoResize","CreateShapeHandler","CreateLabelHandler","positionOrBounds","originalExecute","ensureValidDimensions","originalRevert","DeleteConnectionHandler","DeleteElementsHandler","DeleteShapeHandler","DistributeElements","oldParent","oldParentIndex","OFF_AXIS","LayoutConnectionHandler","MoveConnectionHandler","getNewAttachPoint","oldBounds","newBounds","oldCenter","newCenter","oldDelta","newDelta","getResizedSourceAnchor","safeGetWaypoints","waypointsInsideNewBounds","getWaypointsInsideBounds","oldAnchor","getResizedTargetAnchor","getMovedSourceAnchor","moveDelta","subtract","getMovedTargetAnchor","isInsideBounds","MoveClosure","MoveHelper","MoveElementsHandler","_helper","MoveShapeHandler","ReconnectConnectionHandler","ReplaceShapeHandler","ResizeShapeHandler","getWaypointsUpdatingConnections","movingShapes","resizingShapes","waypointsUpdatingConnections","includes","resizeBounds","SpaceToolHandler","copyWaypoint","copyWaypoints","getAxisFromDirection","shouldMoveWaypoint","relevantAxis","getBounds","ToggleShapeCollapseHandler","getElementsVisibilityRecursive","setHiddenRecursive","newHidden","collapsed","restoreVisibilityRecursive","lastState","UpdateAttachmentHandler","removeAttacher","attacher","attachers","addAttacher","UpdateWaypointsHandler","Modeling","registerHandlers","updateRange","lastIdx","rangeDiff","centerElement","refCenter","spaceInBetween","firstGroup","lastGroupIdx","lastGroup","groupsSize","refElem","groupIdx","prevGroup","newParent","newParentIndex","newClosure","moveRecursive","moveClosure","newHost","keepParent","moveShape","recurse","layout","sourceMoved","targetMoved","moveConnection","moveChildren","getNewParent","newSource","newTarget","dockingOrPoints","oldSource","oldTarget","layoutConnectionHints","newShape","oldShape","newData","canReconnect","updateAttachment","reconnectEnd","reconnectStart","dockingPoint","minBounds","moveShapes","resizeShapes","updateConnectionWaypoints","resizeShape","attachSupport","connections","affectedShapes","layoutHints","labelBehavior","oldChildrenVisibility","oldHost","attacherIdx","getHandlers","connectionParent","removeElements","distributeElements","replaceShape","createSpace","toggleCollapse","getLabel","semantic","setLabel","FLOW_LABEL_INDENT","isLabelExternal","hasExternalLabel","getFlowLabelPosition","second","getWaypointsMid","atan","getExternalLabelMid","NULL_DIMENSIONS","UpdateLabelHandler","textRenderer","setText","isEmptyText","paddingTop","labelCenter","oldLabel","unsetLabel","getExternalLabelBounds","BaseModeling","BpmnUpdater","cropped","createElementsBehavior","executed","BaseLayouter","updateLabel","MIN_SEGMENT_LENGTH","POINT_ORIENTATION_PADDING","ORIENTATION_THRESHOLD","needsTurn","startDirection","canLayoutStraight","targetOrientation","getSegmentBendpoints","directions","segmentDirections","xmid","ymid","layoutStraight","layoutHorizontal","layoutTurn","turnNextDirections","getBendpoints","getStartSegment","getEndSegment","invertedSegment","invertDirections","getMidSegment","startSegment","endSegment","endDirection","getSimpleBendpoints","isValidDirections","isExplicitDirections","midSegment","connectPoints","withoutRedundantPoints","connectRectangles","preferredLayouts","preferredLayout","getDirections","directionSplit","startDocking","getDockingPoint","invertOrientation","endDocking","repairConnection","repairedWaypoints","preferStraight","tryLayoutStraight","tryRepairConnectionEnd","tryRepairConnectionStart","inRange","isInRange","primaryAxis","preserveDocking","moved","other","newDocking","_tryRepairConnectionSide","needsRelayout","repairBendpoint","candidate","oldPeer","newPeer","removeOverlapping","slicedPoints","oldDocking","newPoints","defaultLayout","rectangle","dockingDirection","previous","elementLayouter","getConnectionDocking","getLoopPreferredLayout","dockingToPoint","actual","CroppingConnectionDocking","manhattanOptions","updatedWaypoints","sourceDocking","targetDocking","dockStart","dockingIdx","croppedPoint","_getIntersection","takeFirst","_getShapePath","_getConnectionPath","_getGfx","CommandModule","LabelSupportModule","SelectionModule","ElementLayouter","elementUpdater","ElementUpdater","getSemantic","getStrokeWidth","defaultWidth","getFillColor","defaultColor","fillColor","getStrokeColor","strokeColor","getCirclePath","radius","circlePath","getRoundRectPath","borderRadius","roundRectPath","getDiamondPath","halfWidth","halfHeight","diamondPath","getRectPath","rectPath","TASK_BORDER_RADIUS","DEFAULT_FILL_OPACITY","myRenderer","pathMap","myOptions","defaultFillColor","defaultStrokeColor","markers","renderer","drawCircle","fillOpacity","svgCreate","svgAttr","svgAppend","drawRect","drawPath","drawDiamond","x_2","y_2","pointsString","drawMarker","renderLabel","createText","svgClasses","renderEmbeddedLabel","align","renderExternalLabel","fitBox","getExternalStyle","attachTaskMarkers","taskMarkers","subprocess","seq","parallel","compensation","loop","adhoc","createPathFromConnection","pathData","colorEscape","strokeLinecap","viewBox","refX","refY","markerWidth","markerHeight","orient","domQuery","createMarker","sequenceflowEnd","messageflowStart","messageflowEnd","associationStart","associationEnd","conditionalflowMarker","conditionaldefaultflowMarker","drawIcon","icon","getScaledPath","abspos","iconFill","diamond","xScaleFactor","yScaleFactor","containerWidth","containerHeight","task","pathData2","pathData3","markerRect","markerPath","lineStroke","strokeLinejoin","markerEnd","iconX","iconY","_drawPath","default","DEFAULT_BOX_PADDING","parseAlign","parsePadding","getTextBBox","fakeText","textBBox","textContent","emptyLine","layoutNext","lines","maxWidth","originalLine","fitLine","fit","shortenLine","remainder","semanticShorten","maxLength","part","shortenedParts","shortenedLine","getHelperSvg","helperSvg","getElementById","Text","_config","getLineHeight","lineHeight","parseInt","fontSize","layoutText","getDimensions","dimensions","layouted","helperText","totalHeight","maxLineWidth","textElement","tspan","DEFAULT_FONT_SIZE","LINE_HEIGHT_RATIO","MIN_TEXT_ANNOTATION_HEIGHT","defaultStyle","fontFamily","fontWeight","externalStyle","textUtil","TextUtil","layoutedDimensions","getTextAnnotationBounds","getDefaultStyle","PathMap","heightElements","widthElements","getRawPath","pathId","param","rawPath","coordinates","heightRatio","widthRatio","heightIndex","widthIndex","format","tokenRegex","objNotationRegex","all","quote","quotedName","isFunc","ChangeSupport","changeSupport","DEFAULT_CHILD_BOX_PADDING","applyConstraints","resizeConstraints","currentBounds","currentTrbl","getMinResizeBounds","minDimensions","childrenBounds","currentBox","minBox","childrenBox","combinedBox","asPadding","mayBePadding","addPadding","isBBoxChild","computeChildrenBBox","shapeOrChildren","DEFAULT_MIN_WIDTH","Resize","canResize","computeMinResizeBox","boundsChanged","getReferencePoint","getCursor","contextOrDirection","childrenBoxPadding","MARKER_RESIZING","MARKER_RESIZE_NOT_OK","ResizePreview","updateFrame","removeFrame","HANDLE_OFFSET","HANDLE_SIZE","HANDLE_HIT_SIZE","CLS_RESIZER","ResizeHandles","resize","_resize","removeResizers","addResizer","getHandleOffset","startResize","_createResizer","resizersParent","_getResizersParent","createResizer","resizer","resizePreview","resizeHandles","isTextNode","Node","TEXT_NODE","toArray","nodeList","TextBox","content","keyHandler","resizeHandler","handlePaste","DirectEditing","_textbox","_handleKey","_handleResize","parentStyle","maxHeight","minWidth","minHeight","backgroundColor","border","boxSizing","wordWrap","textAlign","contentStyle","centerVertically","innerText","resizable","setSelection","clipboardData","getData","insertText","hasResized","success","execCommand","_insertTextIE","getSelection","startContainer","endContainer","startOffset","endOffset","commonAncestorContainer","childNodesArray","containerTextContent","textNode","startContainerChildIndex","endContainerChildIndex","childNode","scrollHeight","offsetHeight","resizeHandle","Infinity","startX","startY","startWidth","startHeight","onMouseDown","onMouseMove","onMouseUp","newWidth","newHeight","borderTop","borderRight","borderBottom","borderLeft","getValue","getRangeAt","createRange","selectNodeContents","setStart","setEnd","removeAllRanges","addRange","complete","containerBounds","previousBounds","$textbox","newText","previousText","charCode","directEditing","LabelEditingProvider","activateDirectEdit","isDirectEdit","_textRenderer","getEditingBBox","externalFontSize","externalLineHeight","defaultFontSize","defaultLineHeight","paddingBottom","paddingLeft","paddingRight","externalLabelMid","absoluteBBox","ChangeSupportModule","ResizeModule","DirectEditingModule","labelEditingProvider","SnapContext","_targets","_snapOrigins","_snapLocations","_defaultSnaps","SnapPoints","defaultSnaps","_snapValues","getSnapOrigin","snapLocation","setSnapOrigin","initialValue","addDefaultSnap","snapValues","getSnapLocations","setSnapLocations","snapLocations","pointsForTarget","targetId","initDefaults","snap","snappingValues","HIGHER_PRIORITY","CreateMoveSnapping","snapping","initSnap","snapContext","initialized","addSnapTargetPoints","isHidden","MyCreateMoveSnapping","shapeMid","shapeTopLeft","shapeBottomRight","snapTargets","getSnapTargets","snapTarget","ResizeSnapping","isHorizontal","isVertical","snapOrigin","isAttached","SNAP_TOLERANCE","SNAP_LINE_HIDE_DELAY","Snapping","_asyncHide","snapCurrent","locationSnapping","originValue","showSnapLine","axisSnapping","_createLine","_createSnapLines","_snapLines","getSnapLine","snapLine","createMoveSnapping","resizeSnapping","SnappingModule","myCreateMoveSnapping","RuleProvider","myRuleProvider","addRule","ExamplePaletteProvider","_handTool","_lassoTool","_globalConnect","_palette","_myOptions","createAction","createListener","dragstart","paletteProvider","PaletteProvider","PLACEMENT_DETECTION_PAD","DEFAULT_DISTANCE","DEFAULT_MAX_DISTANCE","findFreePosition","getNextPosition","connectedAtPosition","getConnectedAtPosition","generateGetNextPosition","nextPositionDirection","previousPosition","nextPosition","nextPositionDirectionForAxis","minDistance","getAutoPlaceClosure","getConnectedDistance","getDefaultWeight","defaultDistance","getWeight","maxDistance","getDistance","noneFilter","sourcesDistances","weight","targetsDistances","distances","accumulator","currentValue","distancesGrouped","allConnected","getConnected","getTargets","getSources","AutoPlace","getNewShapePosition","append","sourceMid","sourceTrbl","AutoPlaceSelectionBehavior","autoPlace","autoPlaceSelectionBehavior","getFlowNodePosition","horizontalDistance","getVerticalDistance","MyAutoPlace","AutoPlaceModule","myAutoPlace","contextPadProvider","_connect","_autoPlace","removeElement","startConnect","appendAction","appendStart","ContextPadProvider","elementData","getWaypoints","MyImporter","_getSource","_getTarget","wh","addLabel","_getElement","to","myImporter","nodeToJson","mynode","importData","diagram","paletteOptions","mounted","$nextTick","computed","$refs","initEvent","handlerZoom","handlerRedo","handlerUndo","setData","updateElemet","normalizeComponent","scriptExports","functionalTemplate","injectStyles","scopeId","moduleIdentifier","shadowMode","_compiled","functional","_scopeId","$vnode","ssrContext","__VUE_SSR_CONTEXT__","_registeredComponents","_ssrRegister","$root","$options","shadowRoot","_injectStyles","originalRender","existing","beforeCreate","component","isSimple","Boolean","isAutoHeight","viewHeight","nodeMap","$emit","makeSimple","radio","setVeiwHeight","dX","dY","wfData","bWflow","Vue","bWflowViewer","prototypes","installed","use"],"mappings":"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","file":"bwflow.umd.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"bwflow\"] = factory();\n\telse\n\t\troot[\"bwflow\"] = factory();\n})((typeof self !== 'undefined' ? self : this), function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"fb15\");\n","'use strict';\n// ECMAScript 6 symbols shim\nvar global = require('./_global');\nvar has = require('./_has');\nvar DESCRIPTORS = require('./_descriptors');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar META = require('./_meta').KEY;\nvar $fails = require('./_fails');\nvar shared = require('./_shared');\nvar setToStringTag = require('./_set-to-string-tag');\nvar uid = require('./_uid');\nvar wks = require('./_wks');\nvar wksExt = require('./_wks-ext');\nvar wksDefine = require('./_wks-define');\nvar enumKeys = require('./_enum-keys');\nvar isArray = require('./_is-array');\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar toObject = require('./_to-object');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar createDesc = require('./_property-desc');\nvar _create = require('./_object-create');\nvar gOPNExt = require('./_object-gopn-ext');\nvar $GOPD = require('./_object-gopd');\nvar $GOPS = require('./_object-gops');\nvar $DP = require('./_object-dp');\nvar $keys = require('./_object-keys');\nvar gOPD = $GOPD.f;\nvar dP = $DP.f;\nvar gOPN = gOPNExt.f;\nvar $Symbol = global.Symbol;\nvar $JSON = global.JSON;\nvar _stringify = $JSON && $JSON.stringify;\nvar PROTOTYPE = 'prototype';\nvar HIDDEN = wks('_hidden');\nvar TO_PRIMITIVE = wks('toPrimitive');\nvar isEnum = {}.propertyIsEnumerable;\nvar SymbolRegistry = shared('symbol-registry');\nvar AllSymbols = shared('symbols');\nvar OPSymbols = shared('op-symbols');\nvar ObjectProto = Object[PROTOTYPE];\nvar USE_NATIVE = typeof $Symbol == 'function' && !!$GOPS.f;\nvar QObject = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function () {\n  return _create(dP({}, 'a', {\n    get: function () { return dP(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (it, key, D) {\n  var protoDesc = gOPD(ObjectProto, key);\n  if (protoDesc) delete ObjectProto[key];\n  dP(it, key, D);\n  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function (tag) {\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D) {\n  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if (has(AllSymbols, key)) {\n    if (!D.enumerable) {\n      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;\n      D = _create(D, { enumerable: createDesc(0, false) });\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P) {\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P));\n  var i = 0;\n  var l = keys.length;\n  var key;\n  while (l > i) $defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P) {\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key) {\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {\n  it = toIObject(it);\n  key = toPrimitive(key, true);\n  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;\n  var D = gOPD(it, key);\n  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it) {\n  var names = gOPN(toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it) {\n  var IS_OP = it === ObjectProto;\n  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif (!USE_NATIVE) {\n  $Symbol = function Symbol() {\n    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function (value) {\n      if (this === ObjectProto) $set.call(OPSymbols, value);\n      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString() {\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f = $defineProperty;\n  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;\n  require('./_object-pie').f = $propertyIsEnumerable;\n  $GOPS.f = $getOwnPropertySymbols;\n\n  if (DESCRIPTORS && !require('./_library')) {\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function (name) {\n    return wrap(wks(name));\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });\n\nfor (var es6Symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);\n\nfor (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function (key) {\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');\n    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;\n  },\n  useSetter: function () { setter = true; },\n  useSimple: function () { setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// Chrome 38 and 39 `Object.getOwnPropertySymbols` fails on primitives\n// https://bugs.chromium.org/p/v8/issues/detail?id=3443\nvar FAILS_ON_PRIMITIVES = $fails(function () { $GOPS.f(1); });\n\n$export($export.S + $export.F * FAILS_ON_PRIMITIVES, 'Object', {\n  getOwnPropertySymbols: function getOwnPropertySymbols(it) {\n    return $GOPS.f(toObject(it));\n  }\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it) {\n    var args = [it];\n    var i = 1;\n    var replacer, $replacer;\n    while (arguments.length > i) args.push(arguments[i++]);\n    $replacer = replacer = args[1];\n    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n    if (!isArray(replacer)) replacer = function (key, value) {\n      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);\n      if (!isSymbol(value)) return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n","'use strict';\nvar LIBRARY = require('./_library');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar $iterCreate = require('./_iter-create');\nvar setToStringTag = require('./_set-to-string-tag');\nvar getPrototypeOf = require('./_object-gpo');\nvar ITERATOR = require('./_wks')('iterator');\nvar BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`\nvar FF_ITERATOR = '@@iterator';\nvar KEYS = 'keys';\nvar VALUES = 'values';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function (kind) {\n    if (!BUGGY && kind in proto) return proto[kind];\n    switch (kind) {\n      case KEYS: return function keys() { return new Constructor(this, kind); };\n      case VALUES: return function values() { return new Constructor(this, kind); };\n    } return function entries() { return new Constructor(this, kind); };\n  };\n  var TAG = NAME + ' Iterator';\n  var DEF_VALUES = DEFAULT == VALUES;\n  var VALUES_BUG = false;\n  var proto = Base.prototype;\n  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];\n  var $default = $native || getMethod(DEFAULT);\n  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;\n  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;\n  var methods, key, IteratorPrototype;\n  // Fix native\n  if ($anyNative) {\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));\n    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEF_VALUES && $native && $native.name !== VALUES) {\n    VALUES_BUG = true;\n    $default = function values() { return $native.call(this); };\n  }\n  // Define iterator\n  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG] = returnThis;\n  if (DEFAULT) {\n    methods = {\n      values: DEF_VALUES ? $default : getMethod(VALUES),\n      keys: IS_SET ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if (FORCED) for (key in methods) {\n      if (!(key in proto)) redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n","var toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function (TO_STRING) {\n  return function (that, pos) {\n    var s = String(defined(that));\n    var i = toInteger(pos);\n    var l = s.length;\n    var a, b;\n    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n","'use strict';\nvar at = require('./_string-at')(true);\n\n // `AdvanceStringIndex` abstract operation\n// https://tc39.github.io/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? at(S, index).length : 1);\n};\n","// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = require('./_to-iobject');\nvar gOPN = require('./_object-gopn').f;\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return gOPN(it);\n  } catch (e) {\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","// 0 -> Array#forEach\n// 1 -> Array#map\n// 2 -> Array#filter\n// 3 -> Array#some\n// 4 -> Array#every\n// 5 -> Array#find\n// 6 -> Array#findIndex\nvar ctx = require('./_ctx');\nvar IObject = require('./_iobject');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar asc = require('./_array-species-create');\nmodule.exports = function (TYPE, $create) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  var create = $create || asc;\n  return function ($this, callbackfn, that) {\n    var O = toObject($this);\n    var self = IObject(O);\n    var f = ctx(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var val, res;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      val = self[index];\n      res = f(val, index, O);\n      if (TYPE) {\n        if (IS_MAP) result[index] = res;   // map\n        else if (res) switch (TYPE) {\n          case 3: return true;             // some\n          case 5: return val;              // find\n          case 6: return index;            // findIndex\n          case 2: result.push(val);        // filter\n        } else if (IS_EVERY) return false; // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;\n  };\n};\n","'use strict';\n// 21.2.5.3 get RegExp.prototype.flags\nvar anObject = require('./_an-object');\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./bWflowViewer.vue?vue&type=style&index=0&id=7cdb0dd0&prod&lang=less&\"","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n","var pIE = require('./_object-pie');\nvar createDesc = require('./_property-desc');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar has = require('./_has');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n","var dP = require('./_object-dp');\nvar anObject = require('./_an-object');\nvar getKeys = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n","'use strict';\nvar $at = require('./_string-at')(true);\n\n// 21.1.3.27 String.prototype[@@iterator]()\nrequire('./_iter-define')(String, 'String', function (iterated) {\n  this._t = String(iterated); // target\n  this._i = 0;                // next index\n// 21.1.5.2.1 %StringIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var index = this._i;\n  var point;\n  if (index >= O.length) return { value: undefined, done: true };\n  point = $at(O, index);\n  this._i += point.length;\n  return { value: point, done: false };\n});\n","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var $export = require('./_export');\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperty: require('./_object-dp').f });\n","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n","'use strict';\nrequire('./es6.regexp.exec');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar fails = require('./_fails');\nvar defined = require('./_defined');\nvar wks = require('./_wks');\nvar regexpExec = require('./_regexp-exec');\n\nvar SPECIES = wks('species');\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  // #replace needs built-in support for named groups.\n  // #match works fine because it just return the exec results, even if it has\n  // a \"grops\" property.\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  return ''.replace(re, '$<a>') !== '7';\n});\n\nvar SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = (function () {\n  // Chrome 51 has a buggy \"split\" implementation when RegExp#exec !== nativeExec\n  var re = /(?:)/;\n  var originalExec = re.exec;\n  re.exec = function () { return originalExec.apply(this, arguments); };\n  var result = 'ab'.split(re);\n  return result.length === 2 && result[0] === 'a' && result[1] === 'b';\n})();\n\nmodule.exports = function (KEY, length, exec) {\n  var SYMBOL = wks(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL ? !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n    re.exec = function () { execCalled = true; return null; };\n    if (KEY === 'split') {\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n    }\n    re[SYMBOL]('');\n    return !execCalled;\n  }) : undefined;\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    (KEY === 'replace' && !REPLACE_SUPPORTS_NAMED_GROUPS) ||\n    (KEY === 'split' && !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC)\n  ) {\n    var nativeRegExpMethod = /./[SYMBOL];\n    var fns = exec(\n      defined,\n      SYMBOL,\n      ''[KEY],\n      function maybeCallNative(nativeMethod, regexp, str, arg2, forceStringMethod) {\n        if (regexp.exec === regexpExec) {\n          if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n            // The native String method already delegates to @@method (this\n            // polyfilled function), leasing to infinite recursion.\n            // We avoid it by directly calling the native @@method method.\n            return { done: true, value: nativeRegExpMethod.call(regexp, str, arg2) };\n          }\n          return { done: true, value: nativeMethod.call(str, regexp, arg2) };\n        }\n        return { done: false };\n      }\n    );\n    var strfn = fns[0];\n    var rxfn = fns[1];\n\n    redefine(String.prototype, KEY, strfn);\n    hide(RegExp.prototype, SYMBOL, length == 2\n      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)\n      // 21.2.5.11 RegExp.prototype[@@split](string, limit)\n      ? function (string, arg) { return rxfn.call(string, this, arg); }\n      // 21.2.5.6 RegExp.prototype[@@match](string)\n      // 21.2.5.9 RegExp.prototype[@@search](string)\n      : function (string) { return rxfn.call(string, this); }\n    );\n  }\n};\n","var isObject = require('./_is-object');\nvar document = require('./_global').document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n","// getting tag from 19.1.3.6 Object.prototype.toString()\nvar cof = require('./_cof');\nvar TAG = require('./_wks')('toStringTag');\n// ES3 wrong here\nvar ARG = cof(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (e) { /* empty */ }\n};\n\nmodule.exports = function (it) {\n  var O, T, B;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (T = tryGet(O = Object(it), TAG)) == 'string' ? T\n    // builtinTag case\n    : ARG ? cof(O)\n    // ES3 arguments fallback\n    : (B = cof(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : B;\n};\n","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n","exports.f = Object.getOwnPropertySymbols;\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n","var global = require('./_global');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar SRC = require('./_uid')('src');\nvar $toString = require('./_function-to-string');\nvar TO_STRING = 'toString';\nvar TPL = ('' + $toString).split(TO_STRING);\n\nrequire('./_core').inspectSource = function (it) {\n  return $toString.call(it);\n};\n\n(module.exports = function (O, key, val, safe) {\n  var isFunction = typeof val == 'function';\n  if (isFunction) has(val, 'name') || hide(val, 'name', key);\n  if (O[key] === val) return;\n  if (isFunction) has(val, SRC) || hide(val, SRC, O[key] ? '' + O[key] : TPL.join(String(key)));\n  if (O === global) {\n    O[key] = val;\n  } else if (!safe) {\n    delete O[key];\n    hide(O, key, val);\n  } else if (O[key]) {\n    O[key] = val;\n  } else {\n    hide(O, key, val);\n  }\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, TO_STRING, function toString() {\n  return typeof this == 'function' && this[SRC] || $toString.call(this);\n});\n","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = require('./_an-object');\nvar dPs = require('./_object-dps');\nvar enumBugKeys = require('./_enum-bug-keys');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n","var store = require('./_shared')('wks');\nvar uid = require('./_uid');\nvar Symbol = require('./_global').Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n","module.exports = false;\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","'use strict';\nvar fails = require('./_fails');\n\nmodule.exports = function (method, arg) {\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call\n    arg ? method.call(null, function () { /* empty */ }, 1) : method.call(null);\n  });\n};\n","'use strict';\nvar LIBRARY = require('./_library');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar $iterCreate = require('./_iter-create');\nvar setToStringTag = require('./_set-to-string-tag');\nvar getPrototypeOf = require('./_object-gpo');\nvar ITERATOR = require('./_wks')('iterator');\nvar BUGGY = !([].keys && 'next' in [].keys()); // Safari has buggy iterators w/o `next`\nvar FF_ITERATOR = '@@iterator';\nvar KEYS = 'keys';\nvar VALUES = 'values';\n\nvar returnThis = function () { return this; };\n\nmodule.exports = function (Base, NAME, Constructor, next, DEFAULT, IS_SET, FORCED) {\n  $iterCreate(Constructor, NAME, next);\n  var getMethod = function (kind) {\n    if (!BUGGY && kind in proto) return proto[kind];\n    switch (kind) {\n      case KEYS: return function keys() { return new Constructor(this, kind); };\n      case VALUES: return function values() { return new Constructor(this, kind); };\n    } return function entries() { return new Constructor(this, kind); };\n  };\n  var TAG = NAME + ' Iterator';\n  var DEF_VALUES = DEFAULT == VALUES;\n  var VALUES_BUG = false;\n  var proto = Base.prototype;\n  var $native = proto[ITERATOR] || proto[FF_ITERATOR] || DEFAULT && proto[DEFAULT];\n  var $default = $native || getMethod(DEFAULT);\n  var $entries = DEFAULT ? !DEF_VALUES ? $default : getMethod('entries') : undefined;\n  var $anyNative = NAME == 'Array' ? proto.entries || $native : $native;\n  var methods, key, IteratorPrototype;\n  // Fix native\n  if ($anyNative) {\n    IteratorPrototype = getPrototypeOf($anyNative.call(new Base()));\n    if (IteratorPrototype !== Object.prototype && IteratorPrototype.next) {\n      // Set @@toStringTag to native iterators\n      setToStringTag(IteratorPrototype, TAG, true);\n      // fix for some old engines\n      if (!LIBRARY && typeof IteratorPrototype[ITERATOR] != 'function') hide(IteratorPrototype, ITERATOR, returnThis);\n    }\n  }\n  // fix Array#{values, @@iterator}.name in V8 / FF\n  if (DEF_VALUES && $native && $native.name !== VALUES) {\n    VALUES_BUG = true;\n    $default = function values() { return $native.call(this); };\n  }\n  // Define iterator\n  if ((!LIBRARY || FORCED) && (BUGGY || VALUES_BUG || !proto[ITERATOR])) {\n    hide(proto, ITERATOR, $default);\n  }\n  // Plug for library\n  Iterators[NAME] = $default;\n  Iterators[TAG] = returnThis;\n  if (DEFAULT) {\n    methods = {\n      values: DEF_VALUES ? $default : getMethod(VALUES),\n      keys: IS_SET ? $default : getMethod(KEYS),\n      entries: $entries\n    };\n    if (FORCED) for (key in methods) {\n      if (!(key in proto)) redefine(proto, key, methods[key]);\n    } else $export($export.P + $export.F * (BUGGY || VALUES_BUG), NAME, methods);\n  }\n  return methods;\n};\n","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","var document = require('./_global').document;\nmodule.exports = document && document.documentElement;\n","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n","exports.f = {}.propertyIsEnumerable;\n","var dP = require('./_object-dp');\nvar createDesc = require('./_property-desc');\nmodule.exports = require('./_descriptors') ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\n'use strict';\nvar toObject = require('./_to-object');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nvar toLength = require('./_to-length');\nmodule.exports = function fill(value /* , start = 0, end = @length */) {\n  var O = toObject(this);\n  var length = toLength(O.length);\n  var aLen = arguments.length;\n  var index = toAbsoluteIndex(aLen > 1 ? arguments[1] : undefined, length);\n  var end = aLen > 2 ? arguments[2] : undefined;\n  var endPos = end === undefined ? length : toAbsoluteIndex(end, length);\n  while (endPos > index) O[index++] = value;\n  return O;\n};\n","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has = require('./_has');\nvar toObject = require('./_to-object');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n","if (typeof Object.create === 'function') {\n  // implementation from standard node.js 'util' module\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      ctor.prototype = Object.create(superCtor.prototype, {\n        constructor: {\n          value: ctor,\n          enumerable: false,\n          writable: true,\n          configurable: true\n        }\n      })\n    }\n  };\n} else {\n  // old school shim for old browsers\n  module.exports = function inherits(ctor, superCtor) {\n    if (superCtor) {\n      ctor.super_ = superCtor\n      var TempCtor = function () {}\n      TempCtor.prototype = superCtor.prototype\n      ctor.prototype = new TempCtor()\n      ctor.prototype.constructor = ctor\n    }\n  }\n}\n","'use strict';\nvar create = require('./_object-create');\nvar descriptor = require('./_property-desc');\nvar setToStringTag = require('./_set-to-string-tag');\nvar IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });\n\nmodule.exports = function (Constructor, NAME, next) {\n  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n","require('../../modules/es6.object.define-property');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function defineProperty(it, key, desc) {\n  return $Object.defineProperty(it, key, desc);\n};\n","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./_to-object');\nvar $keys = require('./_object-keys');\n\nrequire('./_object-sap')('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n","// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n","var def = require('./_object-dp').f;\nvar has = require('./_has');\nvar TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function (it, tag, stat) {\n  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","var $export = require('./_export');\n// 19.1.2.4 / 15.2.3.6 Object.defineProperty(O, P, Attributes)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperty: require('./_object-dp').f });\n","// all enumerable object keys, includes symbols\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nmodule.exports = function (it) {\n  var result = getKeys(it);\n  var getSymbols = gOPS.f;\n  if (getSymbols) {\n    var symbols = getSymbols(it);\n    var isEnum = pIE.f;\n    var i = 0;\n    var key;\n    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);\n  } return result;\n};\n","module.exports = {};\n","// 7.1.13 ToObject(argument)\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n","'use strict';\n// 21.1.3.25 String.prototype.trim()\nrequire('./_string-trim')('trim', function ($trim) {\n  return function trim() {\n    return $trim(this, 3);\n  };\n});\n","var DESCRIPTORS = require('./_descriptors');\nvar getKeys = require('./_object-keys');\nvar toIObject = require('./_to-iobject');\nvar isEnum = require('./_object-pie').f;\nmodule.exports = function (isEntries) {\n  return function (it) {\n    var O = toIObject(it);\n    var keys = getKeys(O);\n    var length = keys.length;\n    var i = 0;\n    var result = [];\n    var key;\n    while (length > i) {\n      key = keys[i++];\n      if (!DESCRIPTORS || isEnum.call(O, key)) {\n        result.push(isEntries ? [key, O[key]] : O[key]);\n      }\n    }\n    return result;\n  };\n};\n","module.exports = function (done, value) {\n  return { value: value, done: !!done };\n};\n","var store = require('./_shared')('wks');\nvar uid = require('./_uid');\nvar Symbol = require('./_global').Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n","'use strict';\n\nvar regexpFlags = require('./_flags');\n\nvar nativeExec = RegExp.prototype.exec;\n// This always refers to the native implementation, because the\n// String#replace polyfill uses ./fix-regexp-well-known-symbol-logic.js,\n// which loads this file before patching the method.\nvar nativeReplace = String.prototype.replace;\n\nvar patchedExec = nativeExec;\n\nvar LAST_INDEX = 'lastIndex';\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/,\n      re2 = /b*/g;\n  nativeExec.call(re1, 'a');\n  nativeExec.call(re2, 'a');\n  return re1[LAST_INDEX] !== 0 || re2[LAST_INDEX] !== 0;\n})();\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED;\n\nif (PATCH) {\n  patchedExec = function exec(str) {\n    var re = this;\n    var lastIndex, reCopy, match, i;\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + re.source + '$(?!\\\\s)', regexpFlags.call(re));\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re[LAST_INDEX];\n\n    match = nativeExec.call(re, str);\n\n    if (UPDATES_LAST_INDEX_WRONG && match) {\n      re[LAST_INDEX] = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/\n      // eslint-disable-next-line no-loop-func\n      nativeReplace.call(match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n","exports.f = {}.propertyIsEnumerable;\n","// 19.1.2.9 / 15.2.3.2 Object.getPrototypeOf(O)\nvar has = require('./_has');\nvar toObject = require('./_to-object');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar ObjectProto = Object.prototype;\n\nmodule.exports = Object.getPrototypeOf || function (O) {\n  O = toObject(O);\n  if (has(O, IE_PROTO)) return O[IE_PROTO];\n  if (typeof O.constructor == 'function' && O instanceof O.constructor) {\n    return O.constructor.prototype;\n  } return O instanceof Object ? ObjectProto : null;\n};\n","var core = require('./_core');\nvar global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: core.version,\n  mode: require('./_library') ? 'pure' : 'global',\n  copyright: ' 2020 Denis Pushkarev (zloirock.ru)'\n});\n","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n","'use strict';\nvar $export = require('./_export');\nvar $indexOf = require('./_array-includes')(false);\nvar $native = [].indexOf;\nvar NEGATIVE_ZERO = !!$native && 1 / [1].indexOf(1, -0) < 0;\n\n$export($export.P + $export.F * (NEGATIVE_ZERO || !require('./_strict-method')($native)), 'Array', {\n  // 22.1.3.11 / 15.4.4.14 Array.prototype.indexOf(searchElement [, fromIndex])\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? $native.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments[1]);\n  }\n});\n","var core = module.exports = { version: '2.6.12' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","var $export = require('./_export');\n// 19.1.2.3 / 15.2.3.7 Object.defineProperties(O, Properties)\n$export($export.S + $export.F * !require('./_descriptors'), 'Object', { defineProperties: require('./_object-dps') });\n","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n","var global = require('./_global');\nvar core = require('./_core');\nvar hide = require('./_hide');\nvar redefine = require('./_redefine');\nvar ctx = require('./_ctx');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] || (global[name] = {}) : (global[name] || {})[PROTOTYPE];\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE] || (exports[PROTOTYPE] = {});\n  var key, own, out, exp;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    // export native or passed\n    out = (own ? target : source)[key];\n    // bind timers to global for call from export context\n    exp = IS_BIND && own ? ctx(out, global) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // extend global\n    if (target) redefine(target, key, out, type & $export.U);\n    // export\n    if (exports[key] != out) hide(exports, key, exp);\n    if (IS_PROTO && expProto[key] != out) expProto[key] = out;\n  }\n};\nglobal.core = core;\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n","module.exports = require(\"core-js/library/fn/symbol/iterator\");","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n","'use strict';\n\nvar classof = require('./_classof');\nvar builtinExec = RegExp.prototype.exec;\n\n // `RegExpExec` abstract operation\n// https://tc39.github.io/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (typeof exec === 'function') {\n    var result = exec.call(R, S);\n    if (typeof result !== 'object') {\n      throw new TypeError('RegExp exec method returned something other than an Object or null');\n    }\n    return result;\n  }\n  if (classof(R) !== 'RegExp') {\n    throw new TypeError('RegExp#exec called on incompatible receiver');\n  }\n  return builtinExec.call(R, S);\n};\n","var shared = require('./_shared')('keys');\nvar uid = require('./_uid');\nmodule.exports = function (key) {\n  return shared[key] || (shared[key] = uid(key));\n};\n","// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = require('./_cof');\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n","var global = require('./_global');\nvar core = require('./_core');\nvar ctx = require('./_ctx');\nvar hide = require('./_hide');\nvar has = require('./_has');\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var IS_WRAP = type & $export.W;\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE];\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];\n  var key, own, out;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if (own && has(exports, key)) continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function (C) {\n      var F = function (a, b, c) {\n        if (this instanceof C) {\n          switch (arguments.length) {\n            case 0: return new C();\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if (IS_PROTO) {\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n","'use strict';\n\nvar Collection = require('./collection');\n\nfunction hasOwnProperty(e, property) {\n  return Object.prototype.hasOwnProperty.call(e, property.name || property);\n}\n\nfunction defineCollectionProperty(ref, property, target) {\n\n  var collection = Collection.extend(target[property.name] || [], ref, property, target);\n\n  Object.defineProperty(target, property.name, {\n    enumerable: property.enumerable,\n    value: collection\n  });\n\n  if (collection.length) {\n\n    collection.forEach(function(o) {\n      ref.set(o, property.inverse, target);\n    });\n  }\n}\n\n\nfunction defineProperty(ref, property, target) {\n\n  var inverseProperty = property.inverse;\n\n  var _value = target[property.name];\n\n  Object.defineProperty(target, property.name, {\n    configurable: property.configurable,\n    enumerable: property.enumerable,\n\n    get: function() {\n      return _value;\n    },\n\n    set: function(value) {\n\n      // return if we already performed all changes\n      if (value === _value) {\n        return;\n      }\n\n      var old = _value;\n\n      // temporary set null\n      _value = null;\n\n      if (old) {\n        ref.unset(old, inverseProperty, target);\n      }\n\n      // set new value\n      _value = value;\n\n      // set inverse value\n      ref.set(_value, inverseProperty, target);\n    }\n  });\n\n}\n\n/**\n * Creates a new references object defining two inversly related\n * attribute descriptors a and b.\n *\n * <p>\n *   When bound to an object using {@link Refs#bind} the references\n *   get activated and ensure that add and remove operations are applied\n *   reversely, too.\n * </p>\n *\n * <p>\n *   For attributes represented as collections {@link Refs} provides the\n *   {@link RefsCollection#add}, {@link RefsCollection#remove} and {@link RefsCollection#contains} extensions\n *   that must be used to properly hook into the inverse change mechanism.\n * </p>\n *\n * @class Refs\n *\n * @classdesc A bi-directional reference between two attributes.\n *\n * @param {Refs.AttributeDescriptor} a property descriptor\n * @param {Refs.AttributeDescriptor} b property descriptor\n *\n * @example\n *\n * var refs = Refs({ name: 'wheels', collection: true, enumerable: true }, { name: 'car' });\n *\n * var car = { name: 'toyota' };\n * var wheels = [{ pos: 'front-left' }, { pos: 'front-right' }];\n *\n * refs.bind(car, 'wheels');\n *\n * car.wheels // []\n * car.wheels.add(wheels[0]);\n * car.wheels.add(wheels[1]);\n *\n * car.wheels // [{ pos: 'front-left' }, { pos: 'front-right' }]\n *\n * wheels[0].car // { name: 'toyota' };\n * car.wheels.remove(wheels[0]);\n *\n * wheels[0].car // undefined\n */\nfunction Refs(a, b) {\n\n  if (!(this instanceof Refs)) {\n    return new Refs(a, b);\n  }\n\n  // link\n  a.inverse = b;\n  b.inverse = a;\n\n  this.props = {};\n  this.props[a.name] = a;\n  this.props[b.name] = b;\n}\n\n/**\n * Binds one side of a bi-directional reference to a\n * target object.\n *\n * @memberOf Refs\n *\n * @param  {Object} target\n * @param  {String} property\n */\nRefs.prototype.bind = function(target, property) {\n  if (typeof property === 'string') {\n    if (!this.props[property]) {\n      throw new Error('no property <' + property + '> in ref');\n    }\n    property = this.props[property];\n  }\n\n  if (property.collection) {\n    defineCollectionProperty(this, property, target);\n  } else {\n    defineProperty(this, property, target);\n  }\n};\n\nRefs.prototype.ensureRefsCollection = function(target, property) {\n\n  var collection = target[property.name];\n\n  if (!Collection.isExtended(collection)) {\n    defineCollectionProperty(this, property, target);\n  }\n\n  return collection;\n};\n\nRefs.prototype.ensureBound = function(target, property) {\n  if (!hasOwnProperty(target, property)) {\n    this.bind(target, property);\n  }\n};\n\nRefs.prototype.unset = function(target, property, value) {\n\n  if (target) {\n    this.ensureBound(target, property);\n\n    if (property.collection) {\n      this.ensureRefsCollection(target, property).remove(value);\n    } else {\n      target[property.name] = undefined;\n    }\n  }\n};\n\nRefs.prototype.set = function(target, property, value) {\n\n  if (target) {\n    this.ensureBound(target, property);\n\n    if (property.collection) {\n      this.ensureRefsCollection(target, property).add(value);\n    } else {\n      target[property.name] = value;\n    }\n  }\n};\n\nmodule.exports = Refs;\n\n\n/**\n * An attribute descriptor to be used specify an attribute in a {@link Refs} instance\n *\n * @typedef {Object} Refs.AttributeDescriptor\n * @property {String} name\n * @property {boolean} [collection=false]\n * @property {boolean} [enumerable=false]\n */","var global = require('./_global');\nvar core = require('./_core');\nvar LIBRARY = require('./_library');\nvar wksExt = require('./_wks-ext');\nvar defineProperty = require('./_object-dp').f;\nmodule.exports = function (name) {\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });\n};\n","module.exports = require(\"core-js/library/fn/symbol\");","// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = require('./_iobject');\nvar defined = require('./_defined');\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n","var hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","require('./_wks-define')('asyncIterator');\n","// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = require('./_is-object');\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = require('./_object-keys-internal');\nvar hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","require('./es6.array.iterator');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar TO_STRING_TAG = require('./_wks')('toStringTag');\n\nvar DOMIterables = ('CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,' +\n  'DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,' +\n  'MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,' +\n  'SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,' +\n  'TextTrackList,TouchList').split(',');\n\nfor (var i = 0; i < DOMIterables.length; i++) {\n  var NAME = DOMIterables[i];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  if (proto && !proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n  Iterators[NAME] = Iterators.Array;\n}\n","// 22.1.3.6 Array.prototype.fill(value, start = 0, end = this.length)\nvar $export = require('./_export');\n\n$export($export.P, 'Array', { fill: require('./_array-fill') });\n\nrequire('./_add-to-unscopables')('fill');\n","'use strict';\nvar $export = require('./_export');\nvar $map = require('./_array-methods')(1);\n\n$export($export.P + $export.F * !require('./_strict-method')([].map, true), 'Array', {\n  // 22.1.3.15 / 15.4.4.19 Array.prototype.map(callbackfn [, thisArg])\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments[1]);\n  }\n});\n","var toInteger = require('./_to-integer');\nvar defined = require('./_defined');\n// true  -> String#at\n// false -> String#codePointAt\nmodule.exports = function (TO_STRING) {\n  return function (that, pos) {\n    var s = String(defined(that));\n    var i = toInteger(pos);\n    var l = s.length;\n    var a, b;\n    if (i < 0 || i >= l) return TO_STRING ? '' : undefined;\n    a = s.charCodeAt(i);\n    return a < 0xd800 || a > 0xdbff || i + 1 === l || (b = s.charCodeAt(i + 1)) < 0xdc00 || b > 0xdfff\n      ? TO_STRING ? s.charAt(i) : a\n      : TO_STRING ? s.slice(i, i + 2) : (a - 0xd800 << 10) + (b - 0xdc00) + 0x10000;\n  };\n};\n","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-2!../../../node_modules/less-loader/dist/cjs.js??ref--11-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./bWflow.vue?vue&type=style&index=0&id=6ce1dcb1&prod&lang=less&\"","'use strict';\n// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)\nvar $export = require('./_export');\nvar $find = require('./_array-methods')(5);\nvar KEY = 'find';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\nrequire('./_add-to-unscopables')(KEY);\n","require('./_wks-define')('observable');\n","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n","var toInteger = require('./_to-integer');\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n","'use strict';\n\n/**\n * An empty collection stub. Use {@link RefsCollection.extend} to extend a\n * collection with ref semantics.\n *\n * @class RefsCollection\n */\n\n/**\n * Extends a collection with {@link Refs} aware methods\n *\n * @memberof RefsCollection\n * @static\n *\n * @param  {Array<Object>} collection\n * @param  {Refs} refs instance\n * @param  {Object} property represented by the collection\n * @param  {Object} target object the collection is attached to\n *\n * @return {RefsCollection<Object>} the extended array\n */\nfunction extend(collection, refs, property, target) {\n\n  var inverseProperty = property.inverse;\n\n  /**\n   * Removes the given element from the array and returns it.\n   *\n   * @method RefsCollection#remove\n   *\n   * @param {Object} element the element to remove\n   */\n  Object.defineProperty(collection, 'remove', {\n    value: function(element) {\n      var idx = this.indexOf(element);\n      if (idx !== -1) {\n        this.splice(idx, 1);\n\n        // unset inverse\n        refs.unset(element, inverseProperty, target);\n      }\n\n      return element;\n    }\n  });\n\n  /**\n   * Returns true if the collection contains the given element\n   *\n   * @method RefsCollection#contains\n   *\n   * @param {Object} element the element to check for\n   */\n  Object.defineProperty(collection, 'contains', {\n    value: function(element) {\n      return this.indexOf(element) !== -1;\n    }\n  });\n\n  /**\n   * Adds an element to the array, unless it exists already (set semantics).\n   *\n   * @method RefsCollection#add\n   *\n   * @param {Object} element the element to add\n   * @param {Number} optional index to add element to\n   *                 (possibly moving other elements around)\n   */\n  Object.defineProperty(collection, 'add', {\n    value: function(element, idx) {\n\n      var currentIdx = this.indexOf(element);\n\n      if (typeof idx === 'undefined') {\n\n        if (currentIdx !== -1) {\n          // element already in collection (!)\n          return;\n        }\n\n        // add to end of array, as no idx is specified\n        idx = this.length;\n      }\n\n      // handle already in collection\n      if (currentIdx !== -1) {\n\n        // remove element from currentIdx\n        this.splice(currentIdx, 1);\n      }\n\n      // add element at idx\n      this.splice(idx, 0, element);\n\n      if (currentIdx === -1) {\n        // set inverse, unless element was\n        // in collection already\n        refs.set(element, inverseProperty, target);\n      }\n    }\n  });\n\n  // a simple marker, identifying this element\n  // as being a refs collection\n  Object.defineProperty(collection, '__refs_collection', {\n    value: true\n  });\n\n  return collection;\n}\n\n\nfunction isExtended(collection) {\n  return collection.__refs_collection === true;\n}\n\nmodule.exports.extend = extend;\n\nmodule.exports.isExtended = isExtended;","var dP = require('./_object-dp');\nvar anObject = require('./_an-object');\nvar getKeys = require('./_object-keys');\n\nmodule.exports = require('./_descriptors') ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = getKeys(Properties);\n  var length = keys.length;\n  var i = 0;\n  var P;\n  while (length > i) dP.f(O, P = keys[i++], Properties[P]);\n  return O;\n};\n","var def = require('./_object-dp').f;\nvar has = require('./_has');\nvar TAG = require('./_wks')('toStringTag');\n\nmodule.exports = function (it, tag, stat) {\n  if (it && !has(it = stat ? it : it.prototype, TAG)) def(it, TAG, { configurable: true, value: tag });\n};\n","var dP = require('./_object-dp').f;\nvar FProto = Function.prototype;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// 19.2.4.2 name\nNAME in FProto || require('./_descriptors') && dP(FProto, NAME, {\n  configurable: true,\n  get: function () {\n    try {\n      return ('' + this).match(nameRE)[1];\n    } catch (e) {\n      return '';\n    }\n  }\n});\n","var core = module.exports = { version: '2.6.12' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n","module.exports = function () { /* empty */ };\n","module.exports = {};\n","module.exports = require(\"core-js/library/fn/object/define-property\");","// https://github.com/tc39/proposal-object-values-entries\nvar $export = require('./_export');\nvar $values = require('./_object-to-array')(false);\n\n$export($export.S, 'Object', {\n  values: function values(it) {\n    return $values(it);\n  }\n});\n","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","// addapted from the document.currentScript polyfill by Adam Miller\n// MIT license\n// source: https://github.com/amiller-gh/currentScript-polyfill\n\n// added support for Firefox https://bugzilla.mozilla.org/show_bug.cgi?id=1620505\n\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    define([], factory);\n  } else if (typeof module === 'object' && module.exports) {\n    module.exports = factory();\n  } else {\n    root.getCurrentScript = factory();\n  }\n}(typeof self !== 'undefined' ? self : this, function () {\n  function getCurrentScript () {\n    var descriptor = Object.getOwnPropertyDescriptor(document, 'currentScript')\n    // for chrome\n    if (!descriptor && 'currentScript' in document && document.currentScript) {\n      return document.currentScript\n    }\n\n    // for other browsers with native support for currentScript\n    if (descriptor && descriptor.get !== getCurrentScript && document.currentScript) {\n      return document.currentScript\n    }\n  \n    // IE 8-10 support script readyState\n    // IE 11+ & Firefox support stack trace\n    try {\n      throw new Error();\n    }\n    catch (err) {\n      // Find the second match for the \"at\" string to get file src url from stack.\n      var ieStackRegExp = /.*at [^(]*\\((.*):(.+):(.+)\\)$/ig,\n        ffStackRegExp = /@([^@]*):(\\d+):(\\d+)\\s*$/ig,\n        stackDetails = ieStackRegExp.exec(err.stack) || ffStackRegExp.exec(err.stack),\n        scriptLocation = (stackDetails && stackDetails[1]) || false,\n        line = (stackDetails && stackDetails[2]) || false,\n        currentLocation = document.location.href.replace(document.location.hash, ''),\n        pageSource,\n        inlineScriptSourceRegExp,\n        inlineScriptSource,\n        scripts = document.getElementsByTagName('script'); // Live NodeList collection\n  \n      if (scriptLocation === currentLocation) {\n        pageSource = document.documentElement.outerHTML;\n        inlineScriptSourceRegExp = new RegExp('(?:[^\\\\n]+?\\\\n){0,' + (line - 2) + '}[^<]*<script>([\\\\d\\\\D]*?)<\\\\/script>[\\\\d\\\\D]*', 'i');\n        inlineScriptSource = pageSource.replace(inlineScriptSourceRegExp, '$1').trim();\n      }\n  \n      for (var i = 0; i < scripts.length; i++) {\n        // If ready state is interactive, return the script tag\n        if (scripts[i].readyState === 'interactive') {\n          return scripts[i];\n        }\n  \n        // If src matches, return the script tag\n        if (scripts[i].src === scriptLocation) {\n          return scripts[i];\n        }\n  \n        // If inline source matches, return the script tag\n        if (\n          scriptLocation === currentLocation &&\n          scripts[i].innerHTML &&\n          scripts[i].innerHTML.trim() === inlineScriptSource\n        ) {\n          return scripts[i];\n        }\n      }\n  \n      // If no match, return null\n      return null;\n    }\n  };\n\n  return getCurrentScript\n}));\n","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","// https://github.com/tc39/proposal-object-getownpropertydescriptors\nvar $export = require('./_export');\nvar ownKeys = require('./_own-keys');\nvar toIObject = require('./_to-iobject');\nvar gOPD = require('./_object-gopd');\nvar createProperty = require('./_create-property');\n\n$export($export.S, 'Object', {\n  getOwnPropertyDescriptors: function getOwnPropertyDescriptors(object) {\n    var O = toIObject(object);\n    var getDesc = gOPD.f;\n    var keys = ownKeys(O);\n    var result = {};\n    var i = 0;\n    var key, desc;\n    while (keys.length > i) {\n      desc = getDesc(O, key = keys[i++]);\n      if (desc !== undefined) createProperty(result, key, desc);\n    }\n    return result;\n  }\n});\n","'use strict';\nvar create = require('./_object-create');\nvar descriptor = require('./_property-desc');\nvar setToStringTag = require('./_set-to-string-tag');\nvar IteratorPrototype = {};\n\n// 25.1.2.1.1 %IteratorPrototype%[@@iterator]()\nrequire('./_hide')(IteratorPrototype, require('./_wks')('iterator'), function () { return this; });\n\nmodule.exports = function (Constructor, NAME, next) {\n  Constructor.prototype = create(IteratorPrototype, { next: descriptor(1, next) });\n  setToStringTag(Constructor, NAME + ' Iterator');\n};\n","module.exports = require('./lib/refs');\n\nmodule.exports.Collection = require('./lib/collection');","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = require('./_object-keys-internal');\nvar hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n","module.exports = require('./_hide');\n","// all object keys, includes non-enumerable and symbols\nvar gOPN = require('./_object-gopn');\nvar gOPS = require('./_object-gops');\nvar anObject = require('./_an-object');\nvar Reflect = require('./_global').Reflect;\nmodule.exports = Reflect && Reflect.ownKeys || function ownKeys(it) {\n  var keys = gOPN.f(anObject(it));\n  var getSymbols = gOPS.f;\n  return getSymbols ? keys.concat(getSymbols(it)) : keys;\n};\n","exports.f = Object.getOwnPropertySymbols;\n","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","// 22.1.3.31 Array.prototype[@@unscopables]\nvar UNSCOPABLES = require('./_wks')('unscopables');\nvar ArrayProto = Array.prototype;\nif (ArrayProto[UNSCOPABLES] == undefined) require('./_hide')(ArrayProto, UNSCOPABLES, {});\nmodule.exports = function (key) {\n  ArrayProto[UNSCOPABLES][key] = true;\n};\n","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n","// Thank's IE8 for his funny defineProperty\nmodule.exports = !require('./_fails')(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n","// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\nvar anObject = require('./_an-object');\nvar dPs = require('./_object-dps');\nvar enumBugKeys = require('./_enum-bug-keys');\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\nvar Empty = function () { /* empty */ };\nvar PROTOTYPE = 'prototype';\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar createDict = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = require('./_dom-create')('iframe');\n  var i = enumBugKeys.length;\n  var lt = '<';\n  var gt = '>';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  require('./_html').appendChild(iframe);\n  iframe.src = 'javascript:'; // eslint-disable-line no-script-url\n  // createDict = iframe.contentWindow.Object;\n  // html.removeChild(iframe);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(lt + 'script' + gt + 'document.F=Object' + lt + '/script' + gt);\n  iframeDocument.close();\n  createDict = iframeDocument.F;\n  while (i--) delete createDict[PROTOTYPE][enumBugKeys[i]];\n  return createDict();\n};\n\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    Empty[PROTOTYPE] = anObject(O);\n    result = new Empty();\n    Empty[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = createDict();\n  return Properties === undefined ? result : dPs(result, Properties);\n};\n","'use strict';\n\nvar anObject = require('./_an-object');\nvar toObject = require('./_to-object');\nvar toLength = require('./_to-length');\nvar toInteger = require('./_to-integer');\nvar advanceStringIndex = require('./_advance-string-index');\nvar regExpExec = require('./_regexp-exec-abstract');\nvar max = Math.max;\nvar min = Math.min;\nvar floor = Math.floor;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&`']|\\d\\d?|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&`']|\\d\\d?)/g;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// @@replace logic\nrequire('./_fix-re-wks')('replace', 2, function (defined, REPLACE, $replace, maybeCallNative) {\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = defined(this);\n      var fn = searchValue == undefined ? undefined : searchValue[REPLACE];\n      return fn !== undefined\n        ? fn.call(searchValue, O, replaceValue)\n        : $replace.call(String(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace\n    function (regexp, replaceValue) {\n      var res = maybeCallNative($replace, regexp, this, replaceValue);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var functionalReplace = typeof replaceValue === 'function';\n      if (!functionalReplace) replaceValue = String(replaceValue);\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n        results.push(result);\n        if (!global) break;\n        var matchStr = String(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n        var matched = String(result[0]);\n        var position = max(min(toInteger(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = [matched].concat(captures, position, S);\n          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n          var replacement = String(replaceValue.apply(undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + S.slice(nextSourcePosition);\n    }\n  ];\n\n    // https://tc39.github.io/ecma262/#sec-getsubstitution\n  function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {\n    var tailPos = position + matched.length;\n    var m = captures.length;\n    var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n    if (namedCaptures !== undefined) {\n      namedCaptures = toObject(namedCaptures);\n      symbols = SUBSTITUTION_SYMBOLS;\n    }\n    return $replace.call(replacement, symbols, function (match, ch) {\n      var capture;\n      switch (ch.charAt(0)) {\n        case '$': return '$';\n        case '&': return matched;\n        case '`': return str.slice(0, position);\n        case \"'\": return str.slice(tailPos);\n        case '<':\n          capture = namedCaptures[ch.slice(1, -1)];\n          break;\n        default: // \\d\\d?\n          var n = +ch;\n          if (n === 0) return match;\n          if (n > m) {\n            var f = floor(n / 10);\n            if (f === 0) return match;\n            if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n            return match;\n          }\n          capture = captures[n - 1];\n      }\n      return capture === undefined ? '' : capture;\n    });\n  }\n});\n","var $export = require('./_export');\nvar defined = require('./_defined');\nvar fails = require('./_fails');\nvar spaces = require('./_string-ws');\nvar space = '[' + spaces + ']';\nvar non = '\\u200b\\u0085';\nvar ltrim = RegExp('^' + space + space + '*');\nvar rtrim = RegExp(space + space + '*$');\n\nvar exporter = function (KEY, exec, ALIAS) {\n  var exp = {};\n  var FORCE = fails(function () {\n    return !!spaces[KEY]() || non[KEY]() != non;\n  });\n  var fn = exp[KEY] = FORCE ? exec(trim) : spaces[KEY];\n  if (ALIAS) exp[ALIAS] = fn;\n  $export($export.P + $export.F * FORCE, 'String', exp);\n};\n\n// 1 -> String#trimLeft\n// 2 -> String#trimRight\n// 3 -> String#trim\nvar trim = exporter.trim = function (string, TYPE) {\n  string = String(defined(string));\n  if (TYPE & 1) string = string.replace(ltrim, '');\n  if (TYPE & 2) string = string.replace(rtrim, '');\n  return string;\n};\n\nmodule.exports = exporter;\n","var $iterators = require('./es6.array.iterator');\nvar getKeys = require('./_object-keys');\nvar redefine = require('./_redefine');\nvar global = require('./_global');\nvar hide = require('./_hide');\nvar Iterators = require('./_iterators');\nvar wks = require('./_wks');\nvar ITERATOR = wks('iterator');\nvar TO_STRING_TAG = wks('toStringTag');\nvar ArrayValues = Iterators.Array;\n\nvar DOMIterables = {\n  CSSRuleList: true, // TODO: Not spec compliant, should be false.\n  CSSStyleDeclaration: false,\n  CSSValueList: false,\n  ClientRectList: false,\n  DOMRectList: false,\n  DOMStringList: false,\n  DOMTokenList: true,\n  DataTransferItemList: false,\n  FileList: false,\n  HTMLAllCollection: false,\n  HTMLCollection: false,\n  HTMLFormElement: false,\n  HTMLSelectElement: false,\n  MediaList: true, // TODO: Not spec compliant, should be false.\n  MimeTypeArray: false,\n  NamedNodeMap: false,\n  NodeList: true,\n  PaintRequestList: false,\n  Plugin: false,\n  PluginArray: false,\n  SVGLengthList: false,\n  SVGNumberList: false,\n  SVGPathSegList: false,\n  SVGPointList: false,\n  SVGStringList: false,\n  SVGTransformList: false,\n  SourceBufferList: false,\n  StyleSheetList: true, // TODO: Not spec compliant, should be false.\n  TextTrackCueList: false,\n  TextTrackList: false,\n  TouchList: false\n};\n\nfor (var collections = getKeys(DOMIterables), i = 0; i < collections.length; i++) {\n  var NAME = collections[i];\n  var explicit = DOMIterables[NAME];\n  var Collection = global[NAME];\n  var proto = Collection && Collection.prototype;\n  var key;\n  if (proto) {\n    if (!proto[ITERATOR]) hide(proto, ITERATOR, ArrayValues);\n    if (!proto[TO_STRING_TAG]) hide(proto, TO_STRING_TAG, NAME);\n    Iterators[NAME] = ArrayValues;\n    if (explicit) for (key in $iterators) if (!proto[key]) redefine(proto, key, $iterators[key], true);\n  }\n}\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","'use strict';\nvar regexpExec = require('./_regexp-exec');\nrequire('./_export')({\n  target: 'RegExp',\n  proto: true,\n  forced: regexpExec !== /./.exec\n}, {\n  exec: regexpExec\n});\n","// 7.1.15 ToLength\nvar toInteger = require('./_to-integer');\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n","module.exports = true;\n","// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n","var pIE = require('./_object-pie');\nvar createDesc = require('./_property-desc');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar has = require('./_has');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n","// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = require('./_to-iobject');\nvar toLength = require('./_to-length');\nvar toAbsoluteIndex = require('./_to-absolute-index');\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables');\nvar step = require('./_iter-step');\nvar Iterators = require('./_iterators');\nvar toIObject = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var kind = this._k;\n  var index = this._i++;\n  if (!O || index >= O.length) {\n    this._t = undefined;\n    return step(1);\n  }\n  if (kind == 'keys') return step(0, index);\n  if (kind == 'values') return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n","// 19.1.2.14 / 15.2.3.14 Object.keys(O)\nvar $keys = require('./_object-keys-internal');\nvar enumBugKeys = require('./_enum-bug-keys');\n\nmodule.exports = Object.keys || function keys(O) {\n  return $keys(O, enumBugKeys);\n};\n","module.exports = !require('./_descriptors') && !require('./_fails')(function () {\n  return Object.defineProperty(require('./_dom-create')('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","var id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n","'use strict';\nvar addToUnscopables = require('./_add-to-unscopables');\nvar step = require('./_iter-step');\nvar Iterators = require('./_iterators');\nvar toIObject = require('./_to-iobject');\n\n// 22.1.3.4 Array.prototype.entries()\n// 22.1.3.13 Array.prototype.keys()\n// 22.1.3.29 Array.prototype.values()\n// 22.1.3.30 Array.prototype[@@iterator]()\nmodule.exports = require('./_iter-define')(Array, 'Array', function (iterated, kind) {\n  this._t = toIObject(iterated); // target\n  this._i = 0;                   // next index\n  this._k = kind;                // kind\n// 22.1.5.2.1 %ArrayIteratorPrototype%.next()\n}, function () {\n  var O = this._t;\n  var kind = this._k;\n  var index = this._i++;\n  if (!O || index >= O.length) {\n    this._t = undefined;\n    return step(1);\n  }\n  if (kind == 'keys') return step(0, index);\n  if (kind == 'values') return step(0, O[index]);\n  return step(0, [index, O[index]]);\n}, 'values');\n\n// argumentsList[@@iterator] is %ArrayProto_values% (9.4.4.6, 9.4.4.7)\nIterators.Arguments = Iterators.Array;\n\naddToUnscopables('keys');\naddToUnscopables('values');\naddToUnscopables('entries');\n","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n","exports.f = require('./_wks');\n","// 9.4.2.3 ArraySpeciesCreate(originalArray, length)\nvar speciesConstructor = require('./_array-species-constructor');\n\nmodule.exports = function (original, length) {\n  return new (speciesConstructor(original))(length);\n};\n","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","'use strict';\nvar $export = require('./_export');\nvar $filter = require('./_array-methods')(2);\n\n$export($export.P + $export.F * !require('./_strict-method')([].filter, true), 'Array', {\n  // 22.1.3.7 / 15.4.4.20 Array.prototype.filter(callbackfn [, thisArg])\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments[1]);\n  }\n});\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","module.exports = function (done, value) {\n  return { value: value, done: !!done };\n};\n","// optional / simple context binding\nvar aFunction = require('./_a-function');\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","require('../../modules/es6.string.iterator');\nrequire('../../modules/web.dom.iterable');\nmodule.exports = require('../../modules/_wks-ext').f('iterator');\n","module.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n","var anObject = require('./_an-object');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar toPrimitive = require('./_to-primitive');\nvar dP = Object.defineProperty;\n\nexports.f = require('./_descriptors') ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var core = require('./_core');\nvar global = require('./_global');\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: core.version,\n  mode: require('./_library') ? 'pure' : 'global',\n  copyright: ' 2020 Denis Pushkarev (zloirock.ru)'\n});\n","// IE 8- don't enum bug keys\nmodule.exports = (\n  'constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf'\n).split(',');\n","var isObject = require('./_is-object');\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n","// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n","'use strict';\n\n/**\n * This file contains source code adapted from Snap.svg (licensed Apache-2.0).\n *\n * @see https://github.com/adobe-webplatform/Snap.svg/blob/master/src/path.js\n */\n\n/* eslint no-fallthrough: \"off\" */\n\nvar p2s = /,?([a-z]),?/gi,\n    toFloat = parseFloat,\n    math = Math,\n    PI = math.PI,\n    mmin = math.min,\n    mmax = math.max,\n    pow = math.pow,\n    abs = math.abs,\n    pathCommand = /([a-z])[\\s,]*((-?\\d*\\.?\\d*(?:e[-+]?\\d+)?[\\s]*,?[\\s]*)+)/ig,\n    pathValues = /(-?\\d*\\.?\\d*(?:e[-+]?\\\\d+)?)[\\s]*,?[\\s]*/ig;\n\nvar isArray = Array.isArray || function(o) { return o instanceof Array; };\n\nfunction hasProperty(obj, property) {\n  return Object.prototype.hasOwnProperty.call(obj, property);\n}\n\nfunction clone(obj) {\n\n  if (typeof obj == 'function' || Object(obj) !== obj) {\n    return obj;\n  }\n\n  var res = new obj.constructor;\n\n  for (var key in obj) {\n    if (hasProperty(obj, key)) {\n      res[key] = clone(obj[key]);\n    }\n  }\n\n  return res;\n}\n\nfunction repush(array, item) {\n  for (var i = 0, ii = array.length; i < ii; i++) if (array[i] === item) {\n    return array.push(array.splice(i, 1)[0]);\n  }\n}\n\nfunction cacher(f) {\n\n  function newf() {\n\n    var arg = Array.prototype.slice.call(arguments, 0),\n        args = arg.join('\\u2400'),\n        cache = newf.cache = newf.cache || {},\n        count = newf.count = newf.count || [];\n\n    if (hasProperty(cache, args)) {\n      repush(count, args);\n      return cache[args];\n    }\n\n    count.length >= 1e3 && delete cache[count.shift()];\n    count.push(args);\n    cache[args] = f.apply(0, arg);\n\n    return cache[args];\n  }\n  return newf;\n}\n\nfunction parsePathString(pathString) {\n\n  if (!pathString) {\n    return null;\n  }\n\n  var pth = paths(pathString);\n\n  if (pth.arr) {\n    return clone(pth.arr);\n  }\n\n  var paramCounts = { a: 7, c: 6, h: 1, l: 2, m: 2, q: 4, s: 4, t: 2, v: 1, z: 0 },\n      data = [];\n\n  if (isArray(pathString) && isArray(pathString[0])) { // rough assumption\n    data = clone(pathString);\n  }\n\n  if (!data.length) {\n\n    String(pathString).replace(pathCommand, function(a, b, c) {\n      var params = [],\n          name = b.toLowerCase();\n\n      c.replace(pathValues, function(a, b) {\n        b && params.push(+b);\n      });\n\n      if (name == 'm' && params.length > 2) {\n        data.push([b].concat(params.splice(0, 2)));\n        name = 'l';\n        b = b == 'm' ? 'l' : 'L';\n      }\n\n      while (params.length >= paramCounts[name]) {\n        data.push([b].concat(params.splice(0, paramCounts[name])));\n        if (!paramCounts[name]) {\n          break;\n        }\n      }\n    });\n  }\n\n  data.toString = paths.toString;\n  pth.arr = clone(data);\n\n  return data;\n}\n\nfunction paths(ps) {\n  var p = paths.ps = paths.ps || {};\n\n  if (p[ps]) {\n    p[ps].sleep = 100;\n  } else {\n    p[ps] = {\n      sleep: 100\n    };\n  }\n\n  setTimeout(function() {\n    for (var key in p) {\n      if (hasProperty(p, key) && key != ps) {\n        p[key].sleep--;\n        !p[key].sleep && delete p[key];\n      }\n    }\n  });\n\n  return p[ps];\n}\n\nfunction rectBBox(x, y, width, height) {\n\n  if (arguments.length === 1) {\n    y = x.y;\n    width = x.width;\n    height = x.height;\n    x = x.x;\n  }\n\n  return {\n    x: x,\n    y: y,\n    width: width,\n    height: height,\n    x2: x + width,\n    y2: y + height\n  };\n}\n\nfunction pathToString() {\n  return this.join(',').replace(p2s, '$1');\n}\n\nfunction pathClone(pathArray) {\n  var res = clone(pathArray);\n  res.toString = pathToString;\n  return res;\n}\n\nfunction findDotsAtSegment(p1x, p1y, c1x, c1y, c2x, c2y, p2x, p2y, t) {\n  var t1 = 1 - t,\n      t13 = pow(t1, 3),\n      t12 = pow(t1, 2),\n      t2 = t * t,\n      t3 = t2 * t,\n      x = t13 * p1x + t12 * 3 * t * c1x + t1 * 3 * t * t * c2x + t3 * p2x,\n      y = t13 * p1y + t12 * 3 * t * c1y + t1 * 3 * t * t * c2y + t3 * p2y;\n\n  return {\n    x: fixError(x),\n    y: fixError(y)\n  };\n}\n\nfunction bezierBBox(points) {\n\n  var bbox = curveBBox.apply(null, points);\n\n  return rectBBox(\n    bbox.x0,\n    bbox.y0,\n    bbox.x1 - bbox.x0,\n    bbox.y1 - bbox.y0\n  );\n}\n\nfunction isPointInsideBBox(bbox, x, y) {\n  return x >= bbox.x &&\n    x <= bbox.x + bbox.width &&\n    y >= bbox.y &&\n    y <= bbox.y + bbox.height;\n}\n\nfunction isBBoxIntersect(bbox1, bbox2) {\n  bbox1 = rectBBox(bbox1);\n  bbox2 = rectBBox(bbox2);\n  return isPointInsideBBox(bbox2, bbox1.x, bbox1.y)\n    || isPointInsideBBox(bbox2, bbox1.x2, bbox1.y)\n    || isPointInsideBBox(bbox2, bbox1.x, bbox1.y2)\n    || isPointInsideBBox(bbox2, bbox1.x2, bbox1.y2)\n    || isPointInsideBBox(bbox1, bbox2.x, bbox2.y)\n    || isPointInsideBBox(bbox1, bbox2.x2, bbox2.y)\n    || isPointInsideBBox(bbox1, bbox2.x, bbox2.y2)\n    || isPointInsideBBox(bbox1, bbox2.x2, bbox2.y2)\n    || (bbox1.x < bbox2.x2 && bbox1.x > bbox2.x\n        || bbox2.x < bbox1.x2 && bbox2.x > bbox1.x)\n    && (bbox1.y < bbox2.y2 && bbox1.y > bbox2.y\n        || bbox2.y < bbox1.y2 && bbox2.y > bbox1.y);\n}\n\nfunction base3(t, p1, p2, p3, p4) {\n  var t1 = -3 * p1 + 9 * p2 - 9 * p3 + 3 * p4,\n      t2 = t * t1 + 6 * p1 - 12 * p2 + 6 * p3;\n  return t * t2 - 3 * p1 + 3 * p2;\n}\n\nfunction bezlen(x1, y1, x2, y2, x3, y3, x4, y4, z) {\n\n  if (z == null) {\n    z = 1;\n  }\n\n  z = z > 1 ? 1 : z < 0 ? 0 : z;\n\n  var z2 = z / 2,\n      n = 12,\n      Tvalues = [-.1252,.1252,-.3678,.3678,-.5873,.5873,-.7699,.7699,-.9041,.9041,-.9816,.9816],\n      Cvalues = [0.2491,0.2491,0.2335,0.2335,0.2032,0.2032,0.1601,0.1601,0.1069,0.1069,0.0472,0.0472],\n      sum = 0;\n\n  for (var i = 0; i < n; i++) {\n    var ct = z2 * Tvalues[i] + z2,\n        xbase = base3(ct, x1, x2, x3, x4),\n        ybase = base3(ct, y1, y2, y3, y4),\n        comb = xbase * xbase + ybase * ybase;\n\n    sum += Cvalues[i] * math.sqrt(comb);\n  }\n\n  return z2 * sum;\n}\n\n\nfunction intersectLines(x1, y1, x2, y2, x3, y3, x4, y4) {\n\n  if (\n    mmax(x1, x2) < mmin(x3, x4) ||\n      mmin(x1, x2) > mmax(x3, x4) ||\n      mmax(y1, y2) < mmin(y3, y4) ||\n      mmin(y1, y2) > mmax(y3, y4)\n  ) {\n    return;\n  }\n\n  var nx = (x1 * y2 - y1 * x2) * (x3 - x4) - (x1 - x2) * (x3 * y4 - y3 * x4),\n      ny = (x1 * y2 - y1 * x2) * (y3 - y4) - (y1 - y2) * (x3 * y4 - y3 * x4),\n      denominator = (x1 - x2) * (y3 - y4) - (y1 - y2) * (x3 - x4);\n\n  if (!denominator) {\n    return;\n  }\n\n  var px = fixError(nx / denominator),\n      py = fixError(ny / denominator),\n      px2 = +px.toFixed(2),\n      py2 = +py.toFixed(2);\n\n  if (\n    px2 < +mmin(x1, x2).toFixed(2) ||\n      px2 > +mmax(x1, x2).toFixed(2) ||\n      px2 < +mmin(x3, x4).toFixed(2) ||\n      px2 > +mmax(x3, x4).toFixed(2) ||\n      py2 < +mmin(y1, y2).toFixed(2) ||\n      py2 > +mmax(y1, y2).toFixed(2) ||\n      py2 < +mmin(y3, y4).toFixed(2) ||\n      py2 > +mmax(y3, y4).toFixed(2)\n  ) {\n    return;\n  }\n\n  return { x: px, y: py };\n}\n\nfunction fixError(number) {\n  return Math.round(number * 100000000000) / 100000000000;\n}\n\nfunction findBezierIntersections(bez1, bez2, justCount) {\n  var bbox1 = bezierBBox(bez1),\n      bbox2 = bezierBBox(bez2);\n\n  if (!isBBoxIntersect(bbox1, bbox2)) {\n    return justCount ? 0 : [];\n  }\n\n  // As an optimization, lines will have only 1 segment\n\n  var l1 = bezlen.apply(0, bez1),\n      l2 = bezlen.apply(0, bez2),\n      n1 = isLine(bez1) ? 1 : ~~(l1 / 5) || 1,\n      n2 = isLine(bez2) ? 1 : ~~(l2 / 5) || 1,\n      dots1 = [],\n      dots2 = [],\n      xy = {},\n      res = justCount ? 0 : [];\n\n  for (var i = 0; i < n1 + 1; i++) {\n    var p = findDotsAtSegment.apply(0, bez1.concat(i / n1));\n    dots1.push({ x: p.x, y: p.y, t: i / n1 });\n  }\n\n  for (i = 0; i < n2 + 1; i++) {\n    p = findDotsAtSegment.apply(0, bez2.concat(i / n2));\n    dots2.push({ x: p.x, y: p.y, t: i / n2 });\n  }\n\n  for (i = 0; i < n1; i++) {\n\n    for (var j = 0; j < n2; j++) {\n      var di = dots1[i],\n          di1 = dots1[i + 1],\n          dj = dots2[j],\n          dj1 = dots2[j + 1],\n          ci = abs(di1.x - di.x) < .01 ? 'y' : 'x',\n          cj = abs(dj1.x - dj.x) < .01 ? 'y' : 'x',\n          is = intersectLines(di.x, di.y, di1.x, di1.y, dj.x, dj.y, dj1.x, dj1.y),\n          key;\n\n      if (is) {\n        key = is.x.toFixed(9) + '#' + is.y.toFixed(9);\n\n        if (xy[key]) {\n          continue;\n        }\n\n        xy[key] = true;\n\n        var t1 = di.t + abs((is[ci] - di[ci]) / (di1[ci] - di[ci])) * (di1.t - di.t),\n            t2 = dj.t + abs((is[cj] - dj[cj]) / (dj1[cj] - dj[cj])) * (dj1.t - dj.t);\n\n        if (t1 >= 0 && t1 <= 1 && t2 >= 0 && t2 <= 1) {\n\n          if (justCount) {\n            res++;\n          } else {\n            res.push({\n              x: is.x,\n              y: is.y,\n              t1: t1,\n              t2: t2\n            });\n          }\n        }\n      }\n    }\n  }\n\n  return res;\n}\n\n\n/**\n * Find or counts the intersections between two SVG paths.\n *\n * Returns a number in counting mode and a list of intersections otherwise.\n *\n * A single intersection entry contains the intersection coordinates (x, y)\n * as well as additional information regarding the intersecting segments\n * on each path (segment1, segment2) and the relative location of the\n * intersection on these segments (t1, t2).\n *\n * The path may be an SVG path string or a list of path components\n * such as `[ [ 'M', 0, 10 ], [ 'L', 20, 0 ] ]`.\n *\n * @example\n *\n * var intersections = findPathIntersections(\n *   'M0,0L100,100',\n *   [ [ 'M', 0, 100 ], [ 'L', 100, 0 ] ]\n * );\n *\n * // intersections = [\n * //   { x: 50, y: 50, segment1: 1, segment2: 1, t1: 0.5, t2: 0.5 }\n * // ]\n *\n * @param {String|Array<PathDef>} path1\n * @param {String|Array<PathDef>} path2\n * @param {Boolean} [justCount=false]\n *\n * @return {Array<Intersection>|Number}\n */\nfunction findPathIntersections(path1, path2, justCount) {\n  path1 = pathToCurve(path1);\n  path2 = pathToCurve(path2);\n\n  var x1, y1, x2, y2, x1m, y1m, x2m, y2m, bez1, bez2,\n      res = justCount ? 0 : [];\n\n  for (var i = 0, ii = path1.length; i < ii; i++) {\n    var pi = path1[i];\n\n    if (pi[0] == 'M') {\n      x1 = x1m = pi[1];\n      y1 = y1m = pi[2];\n    } else {\n\n      if (pi[0] == 'C') {\n        bez1 = [x1, y1].concat(pi.slice(1));\n        x1 = bez1[6];\n        y1 = bez1[7];\n      } else {\n        bez1 = [x1, y1, x1, y1, x1m, y1m, x1m, y1m];\n        x1 = x1m;\n        y1 = y1m;\n      }\n\n      for (var j = 0, jj = path2.length; j < jj; j++) {\n        var pj = path2[j];\n\n        if (pj[0] == 'M') {\n          x2 = x2m = pj[1];\n          y2 = y2m = pj[2];\n        } else {\n\n          if (pj[0] == 'C') {\n            bez2 = [x2, y2].concat(pj.slice(1));\n            x2 = bez2[6];\n            y2 = bez2[7];\n          } else {\n            bez2 = [x2, y2, x2, y2, x2m, y2m, x2m, y2m];\n            x2 = x2m;\n            y2 = y2m;\n          }\n\n          var intr = findBezierIntersections(bez1, bez2, justCount);\n\n          if (justCount) {\n            res += intr;\n          } else {\n\n            for (var k = 0, kk = intr.length; k < kk; k++) {\n              intr[k].segment1 = i;\n              intr[k].segment2 = j;\n              intr[k].bez1 = bez1;\n              intr[k].bez2 = bez2;\n            }\n\n            res = res.concat(intr);\n          }\n        }\n      }\n    }\n  }\n\n  return res;\n}\n\n\nfunction pathToAbsolute(pathArray) {\n  var pth = paths(pathArray);\n\n  if (pth.abs) {\n    return pathClone(pth.abs);\n  }\n\n  if (!isArray(pathArray) || !isArray(pathArray && pathArray[0])) { // rough assumption\n    pathArray = parsePathString(pathArray);\n  }\n\n  if (!pathArray || !pathArray.length) {\n    return [['M', 0, 0]];\n  }\n\n  var res = [],\n      x = 0,\n      y = 0,\n      mx = 0,\n      my = 0,\n      start = 0,\n      pa0;\n\n  if (pathArray[0][0] == 'M') {\n    x = +pathArray[0][1];\n    y = +pathArray[0][2];\n    mx = x;\n    my = y;\n    start++;\n    res[0] = ['M', x, y];\n  }\n\n  for (var r, pa, i = start, ii = pathArray.length; i < ii; i++) {\n    res.push(r = []);\n    pa = pathArray[i];\n    pa0 = pa[0];\n\n    if (pa0 != pa0.toUpperCase()) {\n      r[0] = pa0.toUpperCase();\n\n      switch (r[0]) {\n      case 'A':\n        r[1] = pa[1];\n        r[2] = pa[2];\n        r[3] = pa[3];\n        r[4] = pa[4];\n        r[5] = pa[5];\n        r[6] = +pa[6] + x;\n        r[7] = +pa[7] + y;\n        break;\n      case 'V':\n        r[1] = +pa[1] + y;\n        break;\n      case 'H':\n        r[1] = +pa[1] + x;\n        break;\n      case 'M':\n        mx = +pa[1] + x;\n        my = +pa[2] + y;\n      default:\n        for (var j = 1, jj = pa.length; j < jj; j++) {\n          r[j] = +pa[j] + ((j % 2) ? x : y);\n        }\n      }\n    } else {\n      for (var k = 0, kk = pa.length; k < kk; k++) {\n        r[k] = pa[k];\n      }\n    }\n    pa0 = pa0.toUpperCase();\n\n    switch (r[0]) {\n    case 'Z':\n      x = +mx;\n      y = +my;\n      break;\n    case 'H':\n      x = r[1];\n      break;\n    case 'V':\n      y = r[1];\n      break;\n    case 'M':\n      mx = r[r.length - 2];\n      my = r[r.length - 1];\n    default:\n      x = r[r.length - 2];\n      y = r[r.length - 1];\n    }\n  }\n\n  res.toString = pathToString;\n  pth.abs = pathClone(res);\n\n  return res;\n}\n\nfunction isLine(bez) {\n  return (\n    bez[0] === bez[2] &&\n    bez[1] === bez[3] &&\n    bez[4] === bez[6] &&\n    bez[5] === bez[7]\n  );\n}\n\nfunction lineToCurve(x1, y1, x2, y2) {\n  return [\n    x1, y1, x2,\n    y2, x2, y2\n  ];\n}\n\nfunction qubicToCurve(x1, y1, ax, ay, x2, y2) {\n  var _13 = 1 / 3,\n      _23 = 2 / 3;\n\n  return [\n    _13 * x1 + _23 * ax,\n    _13 * y1 + _23 * ay,\n    _13 * x2 + _23 * ax,\n    _13 * y2 + _23 * ay,\n    x2,\n    y2\n  ];\n}\n\nfunction arcToCurve(x1, y1, rx, ry, angle, large_arc_flag, sweep_flag, x2, y2, recursive) {\n\n  // for more information of where this math came from visit:\n  // http://www.w3.org/TR/SVG11/implnote.html#ArcImplementationNotes\n  var _120 = PI * 120 / 180,\n      rad = PI / 180 * (+angle || 0),\n      res = [],\n      xy,\n      rotate = cacher(function(x, y, rad) {\n        var X = x * math.cos(rad) - y * math.sin(rad),\n            Y = x * math.sin(rad) + y * math.cos(rad);\n\n        return { x: X, y: Y };\n      });\n\n  if (!recursive) {\n    xy = rotate(x1, y1, -rad);\n    x1 = xy.x;\n    y1 = xy.y;\n    xy = rotate(x2, y2, -rad);\n    x2 = xy.x;\n    y2 = xy.y;\n\n    var x = (x1 - x2) / 2,\n        y = (y1 - y2) / 2;\n\n    var h = (x * x) / (rx * rx) + (y * y) / (ry * ry);\n\n    if (h > 1) {\n      h = math.sqrt(h);\n      rx = h * rx;\n      ry = h * ry;\n    }\n\n    var rx2 = rx * rx,\n        ry2 = ry * ry,\n        k = (large_arc_flag == sweep_flag ? -1 : 1) *\n            math.sqrt(abs((rx2 * ry2 - rx2 * y * y - ry2 * x * x) / (rx2 * y * y + ry2 * x * x))),\n        cx = k * rx * y / ry + (x1 + x2) / 2,\n        cy = k * -ry * x / rx + (y1 + y2) / 2,\n        f1 = math.asin(((y1 - cy) / ry).toFixed(9)),\n        f2 = math.asin(((y2 - cy) / ry).toFixed(9));\n\n    f1 = x1 < cx ? PI - f1 : f1;\n    f2 = x2 < cx ? PI - f2 : f2;\n    f1 < 0 && (f1 = PI * 2 + f1);\n    f2 < 0 && (f2 = PI * 2 + f2);\n\n    if (sweep_flag && f1 > f2) {\n      f1 = f1 - PI * 2;\n    }\n    if (!sweep_flag && f2 > f1) {\n      f2 = f2 - PI * 2;\n    }\n  } else {\n    f1 = recursive[0];\n    f2 = recursive[1];\n    cx = recursive[2];\n    cy = recursive[3];\n  }\n\n  var df = f2 - f1;\n\n  if (abs(df) > _120) {\n    var f2old = f2,\n        x2old = x2,\n        y2old = y2;\n\n    f2 = f1 + _120 * (sweep_flag && f2 > f1 ? 1 : -1);\n    x2 = cx + rx * math.cos(f2);\n    y2 = cy + ry * math.sin(f2);\n    res = arcToCurve(x2, y2, rx, ry, angle, 0, sweep_flag, x2old, y2old, [f2, f2old, cx, cy]);\n  }\n\n  df = f2 - f1;\n\n  var c1 = math.cos(f1),\n      s1 = math.sin(f1),\n      c2 = math.cos(f2),\n      s2 = math.sin(f2),\n      t = math.tan(df / 4),\n      hx = 4 / 3 * rx * t,\n      hy = 4 / 3 * ry * t,\n      m1 = [x1, y1],\n      m2 = [x1 + hx * s1, y1 - hy * c1],\n      m3 = [x2 + hx * s2, y2 - hy * c2],\n      m4 = [x2, y2];\n\n  m2[0] = 2 * m1[0] - m2[0];\n  m2[1] = 2 * m1[1] - m2[1];\n\n  if (recursive) {\n    return [m2, m3, m4].concat(res);\n  } else {\n    res = [m2, m3, m4].concat(res).join().split(',');\n    var newres = [];\n\n    for (var i = 0, ii = res.length; i < ii; i++) {\n      newres[i] = i % 2 ? rotate(res[i - 1], res[i], rad).y : rotate(res[i], res[i + 1], rad).x;\n    }\n\n    return newres;\n  }\n}\n\n// Returns bounding box of cubic bezier curve.\n// Source: http://blog.hackers-cafe.net/2009/06/how-to-calculate-bezier-curves-bounding.html\n// Original version: NISHIO Hirokazu\n// Modifications: https://github.com/timo22345\nfunction curveBBox(x0, y0, x1, y1, x2, y2, x3, y3) {\n  var tvalues = [],\n      bounds = [[], []],\n      a, b, c, t, t1, t2, b2ac, sqrtb2ac;\n\n  for (var i = 0; i < 2; ++i) {\n\n    if (i == 0) {\n      b = 6 * x0 - 12 * x1 + 6 * x2;\n      a = -3 * x0 + 9 * x1 - 9 * x2 + 3 * x3;\n      c = 3 * x1 - 3 * x0;\n    } else {\n      b = 6 * y0 - 12 * y1 + 6 * y2;\n      a = -3 * y0 + 9 * y1 - 9 * y2 + 3 * y3;\n      c = 3 * y1 - 3 * y0;\n    }\n\n    if (abs(a) < 1e-12) {\n\n      if (abs(b) < 1e-12) {\n        continue;\n      }\n\n      t = -c / b;\n\n      if (0 < t && t < 1) {\n        tvalues.push(t);\n      }\n\n      continue;\n    }\n\n    b2ac = b * b - 4 * c * a;\n    sqrtb2ac = math.sqrt(b2ac);\n\n    if (b2ac < 0) {\n      continue;\n    }\n\n    t1 = (-b + sqrtb2ac) / (2 * a);\n\n    if (0 < t1 && t1 < 1) {\n      tvalues.push(t1);\n    }\n\n    t2 = (-b - sqrtb2ac) / (2 * a);\n\n    if (0 < t2 && t2 < 1) {\n      tvalues.push(t2);\n    }\n  }\n\n  var j = tvalues.length,\n      jlen = j,\n      mt;\n\n  while (j--) {\n    t = tvalues[j];\n    mt = 1 - t;\n    bounds[0][j] = (mt * mt * mt * x0) + (3 * mt * mt * t * x1) + (3 * mt * t * t * x2) + (t * t * t * x3);\n    bounds[1][j] = (mt * mt * mt * y0) + (3 * mt * mt * t * y1) + (3 * mt * t * t * y2) + (t * t * t * y3);\n  }\n\n  bounds[0][jlen] = x0;\n  bounds[1][jlen] = y0;\n  bounds[0][jlen + 1] = x3;\n  bounds[1][jlen + 1] = y3;\n  bounds[0].length = bounds[1].length = jlen + 2;\n\n  return {\n    x0: mmin.apply(0, bounds[0]),\n    y0: mmin.apply(0, bounds[1]),\n    x1: mmax.apply(0, bounds[0]),\n    y1: mmax.apply(0, bounds[1])\n  };\n}\n\nfunction pathToCurve(path) {\n\n  var pth = paths(path);\n\n  // return cached curve, if existing\n  if (pth.curve) {\n    return pathClone(pth.curve);\n  }\n\n  var curvedPath = pathToAbsolute(path),\n      attrs = { x: 0, y: 0, bx: 0, by: 0, X: 0, Y: 0, qx: null, qy: null },\n      processPath = function(path, d, pathCommand) {\n        var nx, ny;\n\n        if (!path) {\n          return ['C', d.x, d.y, d.x, d.y, d.x, d.y];\n        }\n\n        !(path[0] in { T: 1, Q: 1 }) && (d.qx = d.qy = null);\n\n        switch (path[0]) {\n        case 'M':\n          d.X = path[1];\n          d.Y = path[2];\n          break;\n        case 'A':\n          path = ['C'].concat(arcToCurve.apply(0, [d.x, d.y].concat(path.slice(1))));\n          break;\n        case 'S':\n          if (pathCommand == 'C' || pathCommand == 'S') {\n            // In 'S' case we have to take into account, if the previous command is C/S.\n            nx = d.x * 2 - d.bx;\n            // And reflect the previous\n            ny = d.y * 2 - d.by;\n            // command's control point relative to the current point.\n          }\n          else {\n            // or some else or nothing\n            nx = d.x;\n            ny = d.y;\n          }\n          path = ['C', nx, ny].concat(path.slice(1));\n          break;\n        case 'T':\n          if (pathCommand == 'Q' || pathCommand == 'T') {\n            // In 'T' case we have to take into account, if the previous command is Q/T.\n            d.qx = d.x * 2 - d.qx;\n            // And make a reflection similar\n            d.qy = d.y * 2 - d.qy;\n            // to case 'S'.\n          }\n          else {\n            // or something else or nothing\n            d.qx = d.x;\n            d.qy = d.y;\n          }\n          path = ['C'].concat(qubicToCurve(d.x, d.y, d.qx, d.qy, path[1], path[2]));\n          break;\n        case 'Q':\n          d.qx = path[1];\n          d.qy = path[2];\n          path = ['C'].concat(qubicToCurve(d.x, d.y, path[1], path[2], path[3], path[4]));\n          break;\n        case 'L':\n          path = ['C'].concat(lineToCurve(d.x, d.y, path[1], path[2]));\n          break;\n        case 'H':\n          path = ['C'].concat(lineToCurve(d.x, d.y, path[1], d.y));\n          break;\n        case 'V':\n          path = ['C'].concat(lineToCurve(d.x, d.y, d.x, path[1]));\n          break;\n        case 'Z':\n          path = ['C'].concat(lineToCurve(d.x, d.y, d.X, d.Y));\n          break;\n        }\n\n        return path;\n      },\n\n      fixArc = function(pp, i) {\n\n        if (pp[i].length > 7) {\n          pp[i].shift();\n          var pi = pp[i];\n\n          while (pi.length) {\n            pathCommands[i] = 'A'; // if created multiple C:s, their original seg is saved\n            pp.splice(i++, 0, ['C'].concat(pi.splice(0, 6)));\n          }\n\n          pp.splice(i, 1);\n          ii = curvedPath.length;\n        }\n      },\n\n      pathCommands = [], // path commands of original path p\n      pfirst = '', // temporary holder for original path command\n      pathCommand = ''; // holder for previous path command of original path\n\n  for (var i = 0, ii = curvedPath.length; i < ii; i++) {\n    curvedPath[i] && (pfirst = curvedPath[i][0]); // save current path command\n\n    if (pfirst != 'C') // C is not saved yet, because it may be result of conversion\n    {\n      pathCommands[i] = pfirst; // Save current path command\n      i && (pathCommand = pathCommands[i - 1]); // Get previous path command pathCommand\n    }\n    curvedPath[i] = processPath(curvedPath[i], attrs, pathCommand); // Previous path command is inputted to processPath\n\n    if (pathCommands[i] != 'A' && pfirst == 'C') pathCommands[i] = 'C'; // A is the only command\n    // which may produce multiple C:s\n    // so we have to make sure that C is also C in original path\n\n    fixArc(curvedPath, i); // fixArc adds also the right amount of A:s to pathCommands\n\n    var seg = curvedPath[i],\n        seglen = seg.length;\n\n    attrs.x = seg[seglen - 2];\n    attrs.y = seg[seglen - 1];\n    attrs.bx = toFloat(seg[seglen - 4]) || attrs.x;\n    attrs.by = toFloat(seg[seglen - 3]) || attrs.y;\n  }\n\n  // cache curve\n  pth.curve = pathClone(curvedPath);\n\n  return curvedPath;\n}\n\nmodule.exports = findPathIntersections;\n","var has = require('./_has');\nvar toIObject = require('./_to-iobject');\nvar arrayIndexOf = require('./_array-includes')(false);\nvar IE_PROTO = require('./_shared-key')('IE_PROTO');\n\nmodule.exports = function (object, names) {\n  var O = toIObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) if (key != IE_PROTO) has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~arrayIndexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n;(function(root, factory) {\n\t// https://github.com/umdjs/umd/blob/master/returnExports.js\n\tif (typeof exports == 'object') {\n\t\t// For Node.js.\n\t\tmodule.exports = factory(root);\n\t} else if (typeof define == 'function' && define.amd) {\n\t\t// For AMD. Register as an anonymous module.\n\t\tdefine([], factory.bind(root, root));\n\t} else {\n\t\t// For browser globals (not exposing the function separately).\n\t\tfactory(root);\n\t}\n}(typeof global != 'undefined' ? global : this, function(root) {\n\n\tif (root.CSS && root.CSS.escape) {\n\t\treturn root.CSS.escape;\n\t}\n\n\t// https://drafts.csswg.org/cssom/#serialize-an-identifier\n\tvar cssEscape = function(value) {\n\t\tif (arguments.length == 0) {\n\t\t\tthrow new TypeError('`CSS.escape` requires an argument.');\n\t\t}\n\t\tvar string = String(value);\n\t\tvar length = string.length;\n\t\tvar index = -1;\n\t\tvar codeUnit;\n\t\tvar result = '';\n\t\tvar firstCodeUnit = string.charCodeAt(0);\n\t\twhile (++index < length) {\n\t\t\tcodeUnit = string.charCodeAt(index);\n\t\t\t// Note: theres no need to special-case astral symbols, surrogate\n\t\t\t// pairs, or lone surrogates.\n\n\t\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t\t// (U+FFFD).\n\t\t\tif (codeUnit == 0x0000) {\n\t\t\t\tresult += '\\uFFFD';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t\t// U+007F, []\n\t\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039), []\n\t\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), []\n\t\t\t\t(\n\t\t\t\t\tindex == 1 &&\n\t\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\t\tresult += '\\\\' + codeUnit.toString(16) + ' ';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t\t// there is no second character, []\n\t\t\t\tindex == 0 &&\n\t\t\t\tlength == 1 &&\n\t\t\t\tcodeUnit == 0x002D\n\t\t\t) {\n\t\t\t\tresult += '\\\\' + string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the character is not handled by one of the above rules and is\n\t\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t\t// U+005A), or [a-z] (U+0061 to U+007A), []\n\t\t\tif (\n\t\t\t\tcodeUnit >= 0x0080 ||\n\t\t\t\tcodeUnit == 0x002D ||\n\t\t\t\tcodeUnit == 0x005F ||\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t\t) {\n\t\t\t\t// the character itself\n\t\t\t\tresult += string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Otherwise, the escaped character.\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\t\tresult += '\\\\' + string.charAt(index);\n\n\t\t}\n\t\treturn result;\n\t};\n\n\tif (!root.CSS) {\n\t\troot.CSS = {};\n\t}\n\n\troot.CSS.escape = cssEscape;\n\treturn cssEscape;\n\n}));\n","var isObject = require('./_is-object');\nvar isArray = require('./_is-array');\nvar SPECIES = require('./_wks')('species');\n\nmodule.exports = function (original) {\n  var C;\n  if (isArray(original)) {\n    C = original.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n","var META = require('./_uid')('meta');\nvar isObject = require('./_is-object');\nvar has = require('./_has');\nvar setDesc = require('./_object-dp').f;\nvar id = 0;\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\nvar FREEZE = !require('./_fails')(function () {\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function (it) {\n  setDesc(it, META, { value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  } });\n};\nvar fastKey = function (it, create) {\n  // return primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function (it, create) {\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY: META,\n  NEED: false,\n  fastKey: fastKey,\n  getWeak: getWeak,\n  onFreeze: onFreeze\n};\n","'use strict';\nvar $defineProperty = require('./_object-dp');\nvar createDesc = require('./_property-desc');\n\nmodule.exports = function (object, index, value) {\n  if (index in object) $defineProperty.f(object, index, createDesc(0, value));\n  else object[index] = value;\n};\n","'use strict';\nvar $export = require('./_export');\nvar $forEach = require('./_array-methods')(0);\nvar STRICT = require('./_strict-method')([].forEach, true);\n\n$export($export.P + $export.F * !STRICT, 'Array', {\n  // 22.1.3.10 / 15.4.4.18 Array.prototype.forEach(callbackfn [, thisArg])\n  forEach: function forEach(callbackfn /* , thisArg */) {\n    return $forEach(this, callbackfn, arguments[1]);\n  }\n});\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","require('../../modules/es6.symbol');\nrequire('../../modules/es6.object.to-string');\nrequire('../../modules/es7.symbol.async-iterator');\nrequire('../../modules/es7.symbol.observable');\nmodule.exports = require('../../modules/_core').Symbol;\n","module.exports = require('./_shared')('native-function-to-string', Function.toString);\n","var document = require('./_global').document;\nmodule.exports = document && document.documentElement;\n","// This file is imported into lib/wc client bundles.\n\nif (typeof window !== 'undefined') {\n  var currentScript = window.document.currentScript\n  if (process.env.NEED_CURRENTSCRIPT_POLYFILL) {\n    var getCurrentScript = require('@soda/get-current-script')\n    currentScript = getCurrentScript()\n\n    // for backward compatibility, because previously we directly included the polyfill\n    if (!('currentScript' in document)) {\n      Object.defineProperty(document, 'currentScript', { get: getCurrentScript })\n    }\n  }\n\n  var src = currentScript && currentScript.src.match(/(.+\\/)[^/]+\\.js(\\?.*)?$/)\n  if (src) {\n    __webpack_public_path__ = src[1] // eslint-disable-line\n  }\n}\n\n// Indicate to webpack that this file can be concatenated\nexport default null\n","import _Object$defineProperty from \"@babel/runtime-corejs2/core-js/object/define-property\";\nexport default function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    _Object$defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"container\",staticClass:\"b-flow\"})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var CLASS_PATTERN = /^class /;\n\nfunction isClass(fn) {\n  return CLASS_PATTERN.test(fn.toString());\n}\n\nfunction isArray(obj) {\n  return Object.prototype.toString.call(obj) === '[object Array]';\n}\n\nfunction annotate() {\n  var args = Array.prototype.slice.call(arguments);\n\n  if (args.length === 1 && isArray(args[0])) {\n    args = args[0];\n  }\n\n  var fn = args.pop();\n\n  fn.$inject = args;\n\n  return fn;\n}\n\n// Current limitations:\n// - can't put into \"function arg\" comments\n// function /* (no parenthesis like this) */ (){}\n// function abc( /* xx (no parenthesis like this) */ a, b) {}\n//\n// Just put the comment before function or inside:\n// /* (((this is fine))) */ function(a, b) {}\n// function abc(a) { /* (((this is fine))) */}\n//\n// - can't reliably auto-annotate constructor; we'll match the\n// first constructor(...) pattern found which may be the one\n// of a nested class, too.\n\nvar CONSTRUCTOR_ARGS = /constructor\\s*[^(]*\\(\\s*([^)]*)\\)/m;\nvar FN_ARGS = /^function\\s*[^(]*\\(\\s*([^)]*)\\)/m;\nvar FN_ARG = /\\/\\*([^*]*)\\*\\//m;\n\nfunction parse(fn) {\n\n  if (typeof fn !== 'function') {\n    throw new Error('Cannot annotate \"' + fn + '\". Expected a function!');\n  }\n\n  var match = fn.toString().match(isClass(fn) ? CONSTRUCTOR_ARGS : FN_ARGS);\n\n  // may parse class without constructor\n  if (!match) {\n    return [];\n  }\n\n  return match[1] && match[1].split(',').map(function (arg) {\n    match = arg.match(FN_ARG);\n    return match ? match[1].trim() : arg.trim();\n  }) || [];\n}\n\nfunction Module() {\n  var providers = [];\n\n  this.factory = function (name, factory) {\n    providers.push([name, 'factory', factory]);\n    return this;\n  };\n\n  this.value = function (name, value) {\n    providers.push([name, 'value', value]);\n    return this;\n  };\n\n  this.type = function (name, type) {\n    providers.push([name, 'type', type]);\n    return this;\n  };\n\n  this.forEach = function (iterator) {\n    providers.forEach(iterator);\n  };\n}\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction Injector(modules, parent) {\n  parent = parent || {\n    get: function get(name, strict) {\n      currentlyResolving.push(name);\n\n      if (strict === false) {\n        return null;\n      } else {\n        throw error('No provider for \"' + name + '\"!');\n      }\n    }\n  };\n\n  var currentlyResolving = [];\n  var providers = this._providers = Object.create(parent._providers || null);\n  var instances = this._instances = Object.create(null);\n\n  var self = instances.injector = this;\n\n  var error = function error(msg) {\n    var stack = currentlyResolving.join(' -> ');\n    currentlyResolving.length = 0;\n    return new Error(stack ? msg + ' (Resolving: ' + stack + ')' : msg);\n  };\n\n  /**\n   * Return a named service.\n   *\n   * @param {String} name\n   * @param {Boolean} [strict=true] if false, resolve missing services to null\n   *\n   * @return {Object}\n   */\n  var get = function get(name, strict) {\n    if (!providers[name] && name.indexOf('.') !== -1) {\n      var parts = name.split('.');\n      var pivot = get(parts.shift());\n\n      while (parts.length) {\n        pivot = pivot[parts.shift()];\n      }\n\n      return pivot;\n    }\n\n    if (hasProp(instances, name)) {\n      return instances[name];\n    }\n\n    if (hasProp(providers, name)) {\n      if (currentlyResolving.indexOf(name) !== -1) {\n        currentlyResolving.push(name);\n        throw error('Cannot resolve circular dependency!');\n      }\n\n      currentlyResolving.push(name);\n      instances[name] = providers[name][0](providers[name][1]);\n      currentlyResolving.pop();\n\n      return instances[name];\n    }\n\n    return parent.get(name, strict);\n  };\n\n  var fnDef = function fnDef(fn) {\n    var locals = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n    if (typeof fn !== 'function') {\n      if (isArray(fn)) {\n        fn = annotate(fn.slice());\n      } else {\n        throw new Error('Cannot invoke \"' + fn + '\". Expected a function!');\n      }\n    }\n\n    var inject = fn.$inject || parse(fn);\n    var dependencies = inject.map(function (dep) {\n      if (hasProp(locals, dep)) {\n        return locals[dep];\n      } else {\n        return get(dep);\n      }\n    });\n\n    return {\n      fn: fn,\n      dependencies: dependencies\n    };\n  };\n\n  var instantiate = function instantiate(Type) {\n    var _fnDef = fnDef(Type),\n        dependencies = _fnDef.dependencies,\n        fn = _fnDef.fn;\n\n    return new (Function.prototype.bind.apply(fn, [null].concat(_toConsumableArray(dependencies))))();\n  };\n\n  var invoke = function invoke(func, context, locals) {\n    var _fnDef2 = fnDef(func, locals),\n        dependencies = _fnDef2.dependencies,\n        fn = _fnDef2.fn;\n\n    return fn.call.apply(fn, [context].concat(_toConsumableArray(dependencies)));\n  };\n\n  var createPrivateInjectorFactory = function createPrivateInjectorFactory(privateChildInjector) {\n    return annotate(function (key) {\n      return privateChildInjector.get(key);\n    });\n  };\n\n  var createChild = function createChild(modules, forceNewInstances) {\n    if (forceNewInstances && forceNewInstances.length) {\n      var fromParentModule = Object.create(null);\n      var matchedScopes = Object.create(null);\n\n      var privateInjectorsCache = [];\n      var privateChildInjectors = [];\n      var privateChildFactories = [];\n\n      var provider;\n      var cacheIdx;\n      var privateChildInjector;\n      var privateChildInjectorFactory;\n      for (var name in providers) {\n        provider = providers[name];\n\n        if (forceNewInstances.indexOf(name) !== -1) {\n          if (provider[2] === 'private') {\n            cacheIdx = privateInjectorsCache.indexOf(provider[3]);\n            if (cacheIdx === -1) {\n              privateChildInjector = provider[3].createChild([], forceNewInstances);\n              privateChildInjectorFactory = createPrivateInjectorFactory(privateChildInjector);\n              privateInjectorsCache.push(provider[3]);\n              privateChildInjectors.push(privateChildInjector);\n              privateChildFactories.push(privateChildInjectorFactory);\n              fromParentModule[name] = [privateChildInjectorFactory, name, 'private', privateChildInjector];\n            } else {\n              fromParentModule[name] = [privateChildFactories[cacheIdx], name, 'private', privateChildInjectors[cacheIdx]];\n            }\n          } else {\n            fromParentModule[name] = [provider[2], provider[1]];\n          }\n          matchedScopes[name] = true;\n        }\n\n        if ((provider[2] === 'factory' || provider[2] === 'type') && provider[1].$scope) {\n          /* jshint -W083 */\n          forceNewInstances.forEach(function (scope) {\n            if (provider[1].$scope.indexOf(scope) !== -1) {\n              fromParentModule[name] = [provider[2], provider[1]];\n              matchedScopes[scope] = true;\n            }\n          });\n        }\n      }\n\n      forceNewInstances.forEach(function (scope) {\n        if (!matchedScopes[scope]) {\n          throw new Error('No provider for \"' + scope + '\". Cannot use provider from the parent!');\n        }\n      });\n\n      modules.unshift(fromParentModule);\n    }\n\n    return new Injector(modules, self);\n  };\n\n  var factoryMap = {\n    factory: invoke,\n    type: instantiate,\n    value: function value(_value) {\n      return _value;\n    }\n  };\n\n  modules.forEach(function (module) {\n\n    function arrayUnwrap(type, value) {\n      if (type !== 'value' && isArray(value)) {\n        value = annotate(value.slice());\n      }\n\n      return value;\n    }\n\n    // TODO(vojta): handle wrong inputs (modules)\n    if (module instanceof Module) {\n      module.forEach(function (provider) {\n        var name = provider[0];\n        var type = provider[1];\n        var value = provider[2];\n\n        providers[name] = [factoryMap[type], arrayUnwrap(type, value), type];\n      });\n    } else if ((typeof module === 'undefined' ? 'undefined' : _typeof(module)) === 'object') {\n      if (module.__exports__) {\n        var clonedModule = Object.keys(module).reduce(function (m, key) {\n          if (key.substring(0, 2) !== '__') {\n            m[key] = module[key];\n          }\n          return m;\n        }, Object.create(null));\n\n        var privateInjector = new Injector((module.__modules__ || []).concat([clonedModule]), self);\n        var getFromPrivateInjector = annotate(function (key) {\n          return privateInjector.get(key);\n        });\n        module.__exports__.forEach(function (key) {\n          providers[key] = [getFromPrivateInjector, key, 'private', privateInjector];\n        });\n      } else {\n        Object.keys(module).forEach(function (name) {\n          if (module[name][2] === 'private') {\n            providers[name] = module[name];\n            return;\n          }\n\n          var type = module[name][0];\n          var value = module[name][1];\n\n          providers[name] = [factoryMap[type], arrayUnwrap(type, value), type];\n        });\n      }\n    }\n  });\n\n  // public API\n  this.get = get;\n  this.invoke = invoke;\n  this.instantiate = instantiate;\n  this.createChild = createChild;\n}\n\n// helpers /////////////////\n\nfunction hasProp(obj, prop) {\n  return Object.hasOwnProperty.call(obj, prop);\n}\n\nexport { annotate, Module, Injector };\n","var DEFAULT_RENDER_PRIORITY = 1000;\n\n/**\n * The base implementation of shape and connection renderers.\n *\n * @param {EventBus} eventBus\n * @param {number} [renderPriority=1000]\n */\nexport default function BaseRenderer(eventBus, renderPriority) {\n  var self = this;\n\n  renderPriority = renderPriority || DEFAULT_RENDER_PRIORITY;\n\n  eventBus.on([ 'render.shape', 'render.connection' ], renderPriority, function(evt, context) {\n    var type = evt.type,\n        element = context.element,\n        visuals = context.gfx;\n\n    if (self.canRender(element)) {\n      if (type === 'render.shape') {\n        return self.drawShape(visuals, element);\n      } else {\n        return self.drawConnection(visuals, element);\n      }\n    }\n  });\n\n  eventBus.on([ 'render.getShapePath', 'render.getConnectionPath'], renderPriority, function(evt, element) {\n    if (self.canRender(element)) {\n      if (evt.type === 'render.getShapePath') {\n        return self.getShapePath(element);\n      } else {\n        return self.getConnectionPath(element);\n      }\n    }\n  });\n}\n\n/**\n * Should check whether *this* renderer can render\n * the element/connection.\n *\n * @param {element} element\n *\n * @returns {boolean}\n */\nBaseRenderer.prototype.canRender = function() {};\n\n/**\n * Provides the shape's snap svg element to be drawn on the `canvas`.\n *\n * @param {djs.Graphics} visuals\n * @param {Shape} shape\n *\n * @returns {Snap.svg} [returns a Snap.svg paper element ]\n */\nBaseRenderer.prototype.drawShape = function() {};\n\n/**\n * Provides the shape's snap svg element to be drawn on the `canvas`.\n *\n * @param {djs.Graphics} visuals\n * @param {Connection} connection\n *\n * @returns {Snap.svg} [returns a Snap.svg paper element ]\n */\nBaseRenderer.prototype.drawConnection = function() {};\n\n/**\n * Gets the SVG path of a shape that represents it's visual bounds.\n *\n * @param {Shape} shape\n *\n * @return {string} svg path\n */\nBaseRenderer.prototype.getShapePath = function() {};\n\n/**\n * Gets the SVG path of a connection that represents it's visual bounds.\n *\n * @param {Connection} connection\n *\n * @return {string} svg path\n */\nBaseRenderer.prototype.getConnectionPath = function() {};\n","function ensureImported(element, target) {\n\n  if (element.ownerDocument !== target.ownerDocument) {\n    try {\n      // may fail on webkit\n      return target.ownerDocument.importNode(element, true);\n    } catch (e) {\n      // ignore\n    }\n  }\n\n  return element;\n}\n\n/**\n * appendTo utility\n */\n\n/**\n * Append a node to a target element and return the appended node.\n *\n * @param  {SVGElement} element\n * @param  {SVGElement} target\n *\n * @return {SVGElement} the appended node\n */\nfunction appendTo(element, target) {\n  return target.appendChild(ensureImported(element, target));\n}\n\n/**\n * append utility\n */\n\n/**\n * Append a node to an element\n *\n * @param  {SVGElement} element\n * @param  {SVGElement} node\n *\n * @return {SVGElement} the element\n */\nfunction append(target, node) {\n  appendTo(node, target);\n  return target;\n}\n\n/**\n * attribute accessor utility\n */\n\nvar LENGTH_ATTR = 2;\n\nvar CSS_PROPERTIES = {\n  'alignment-baseline': 1,\n  'baseline-shift': 1,\n  'clip': 1,\n  'clip-path': 1,\n  'clip-rule': 1,\n  'color': 1,\n  'color-interpolation': 1,\n  'color-interpolation-filters': 1,\n  'color-profile': 1,\n  'color-rendering': 1,\n  'cursor': 1,\n  'direction': 1,\n  'display': 1,\n  'dominant-baseline': 1,\n  'enable-background': 1,\n  'fill': 1,\n  'fill-opacity': 1,\n  'fill-rule': 1,\n  'filter': 1,\n  'flood-color': 1,\n  'flood-opacity': 1,\n  'font': 1,\n  'font-family': 1,\n  'font-size': LENGTH_ATTR,\n  'font-size-adjust': 1,\n  'font-stretch': 1,\n  'font-style': 1,\n  'font-variant': 1,\n  'font-weight': 1,\n  'glyph-orientation-horizontal': 1,\n  'glyph-orientation-vertical': 1,\n  'image-rendering': 1,\n  'kerning': 1,\n  'letter-spacing': 1,\n  'lighting-color': 1,\n  'marker': 1,\n  'marker-end': 1,\n  'marker-mid': 1,\n  'marker-start': 1,\n  'mask': 1,\n  'opacity': 1,\n  'overflow': 1,\n  'pointer-events': 1,\n  'shape-rendering': 1,\n  'stop-color': 1,\n  'stop-opacity': 1,\n  'stroke': 1,\n  'stroke-dasharray': 1,\n  'stroke-dashoffset': 1,\n  'stroke-linecap': 1,\n  'stroke-linejoin': 1,\n  'stroke-miterlimit': 1,\n  'stroke-opacity': 1,\n  'stroke-width': LENGTH_ATTR,\n  'text-anchor': 1,\n  'text-decoration': 1,\n  'text-rendering': 1,\n  'unicode-bidi': 1,\n  'visibility': 1,\n  'word-spacing': 1,\n  'writing-mode': 1\n};\n\n\nfunction getAttribute(node, name) {\n  if (CSS_PROPERTIES[name]) {\n    return node.style[name];\n  } else {\n    return node.getAttributeNS(null, name);\n  }\n}\n\nfunction setAttribute(node, name, value) {\n  var hyphenated = name.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase();\n\n  var type = CSS_PROPERTIES[hyphenated];\n\n  if (type) {\n    // append pixel unit, unless present\n    if (type === LENGTH_ATTR && typeof value === 'number') {\n      value = String(value) + 'px';\n    }\n\n    node.style[hyphenated] = value;\n  } else {\n    node.setAttributeNS(null, name, value);\n  }\n}\n\nfunction setAttributes(node, attrs) {\n\n  var names = Object.keys(attrs), i, name;\n\n  for (i = 0, name; (name = names[i]); i++) {\n    setAttribute(node, name, attrs[name]);\n  }\n}\n\n/**\n * Gets or sets raw attributes on a node.\n *\n * @param  {SVGElement} node\n * @param  {Object} [attrs]\n * @param  {String} [name]\n * @param  {String} [value]\n *\n * @return {String}\n */\nfunction attr(node, name, value) {\n  if (typeof name === 'string') {\n    if (value !== undefined) {\n      setAttribute(node, name, value);\n    } else {\n      return getAttribute(node, name);\n    }\n  } else {\n    setAttributes(node, name);\n  }\n\n  return node;\n}\n\n/**\r\n * Clear utility\r\n */\r\nfunction index(arr, obj) {\r\n  if (arr.indexOf) {\r\n    return arr.indexOf(obj);\r\n  }\r\n\r\n\r\n  for (var i = 0; i < arr.length; ++i) {\r\n    if (arr[i] === obj) {\r\n      return i;\r\n    }\r\n  }\r\n\r\n  return -1;\r\n}\r\n\r\nvar re = /\\s+/;\r\n\r\nvar toString = Object.prototype.toString;\r\n\r\nfunction defined(o) {\r\n  return typeof o !== 'undefined';\r\n}\r\n\r\n/**\r\n * Wrap `el` in a `ClassList`.\r\n *\r\n * @param {Element} el\r\n * @return {ClassList}\r\n * @api public\r\n */\r\n\r\nfunction classes(el) {\r\n  return new ClassList(el);\r\n}\r\n\r\nfunction ClassList(el) {\r\n  if (!el || !el.nodeType) {\r\n    throw new Error('A DOM element reference is required');\r\n  }\r\n  this.el = el;\r\n  this.list = el.classList;\r\n}\r\n\r\n/**\r\n * Add class `name` if not already present.\r\n *\r\n * @param {String} name\r\n * @return {ClassList}\r\n * @api public\r\n */\r\n\r\nClassList.prototype.add = function(name) {\r\n\r\n  // classList\r\n  if (this.list) {\r\n    this.list.add(name);\r\n    return this;\r\n  }\r\n\r\n  // fallback\r\n  var arr = this.array();\r\n  var i = index(arr, name);\r\n  if (!~i) {\r\n    arr.push(name);\r\n  }\r\n\r\n  if (defined(this.el.className.baseVal)) {\r\n    this.el.className.baseVal = arr.join(' ');\r\n  } else {\r\n    this.el.className = arr.join(' ');\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove class `name` when present, or\r\n * pass a regular expression to remove\r\n * any which match.\r\n *\r\n * @param {String|RegExp} name\r\n * @return {ClassList}\r\n * @api public\r\n */\r\n\r\nClassList.prototype.remove = function(name) {\r\n  if ('[object RegExp]' === toString.call(name)) {\r\n    return this.removeMatching(name);\r\n  }\r\n\r\n  // classList\r\n  if (this.list) {\r\n    this.list.remove(name);\r\n    return this;\r\n  }\r\n\r\n  // fallback\r\n  var arr = this.array();\r\n  var i = index(arr, name);\r\n  if (~i) {\r\n    arr.splice(i, 1);\r\n  }\r\n  this.el.className.baseVal = arr.join(' ');\r\n  return this;\r\n};\r\n\r\n/**\r\n * Remove all classes matching `re`.\r\n *\r\n * @param {RegExp} re\r\n * @return {ClassList}\r\n * @api private\r\n */\r\n\r\nClassList.prototype.removeMatching = function(re) {\r\n  var arr = this.array();\r\n  for (var i = 0; i < arr.length; i++) {\r\n    if (re.test(arr[i])) {\r\n      this.remove(arr[i]);\r\n    }\r\n  }\r\n  return this;\r\n};\r\n\r\n/**\r\n * Toggle class `name`, can force state via `force`.\r\n *\r\n * For browsers that support classList, but do not support `force` yet,\r\n * the mistake will be detected and corrected.\r\n *\r\n * @param {String} name\r\n * @param {Boolean} force\r\n * @return {ClassList}\r\n * @api public\r\n */\r\n\r\nClassList.prototype.toggle = function(name, force) {\r\n  // classList\r\n  if (this.list) {\r\n    if (defined(force)) {\r\n      if (force !== this.list.toggle(name, force)) {\r\n        this.list.toggle(name); // toggle again to correct\r\n      }\r\n    } else {\r\n      this.list.toggle(name);\r\n    }\r\n    return this;\r\n  }\r\n\r\n  // fallback\r\n  if (defined(force)) {\r\n    if (!force) {\r\n      this.remove(name);\r\n    } else {\r\n      this.add(name);\r\n    }\r\n  } else {\r\n    if (this.has(name)) {\r\n      this.remove(name);\r\n    } else {\r\n      this.add(name);\r\n    }\r\n  }\r\n\r\n  return this;\r\n};\r\n\r\n/**\r\n * Return an array of classes.\r\n *\r\n * @return {Array}\r\n * @api public\r\n */\r\n\r\nClassList.prototype.array = function() {\r\n  var className = this.el.getAttribute('class') || '';\r\n  var str = className.replace(/^\\s+|\\s+$/g, '');\r\n  var arr = str.split(re);\r\n  if ('' === arr[0]) {\r\n    arr.shift();\r\n  }\r\n  return arr;\r\n};\r\n\r\n/**\r\n * Check if class `name` is present.\r\n *\r\n * @param {String} name\r\n * @return {ClassList}\r\n * @api public\r\n */\r\n\r\nClassList.prototype.has =\r\nClassList.prototype.contains = function(name) {\r\n  return (\r\n    this.list ?\r\n      this.list.contains(name) :\r\n      !! ~index(this.array(), name)\r\n  );\r\n};\n\nfunction remove(element) {\n  var parent = element.parentNode;\n\n  if (parent) {\n    parent.removeChild(element);\n  }\n\n  return element;\n}\n\n/**\n * Clear utility\n */\n\n/**\n * Removes all children from the given element\n *\n * @param  {DOMElement} element\n * @return {DOMElement} the element (for chaining)\n */\nfunction clear(element) {\n  var child;\n\n  while ((child = element.firstChild)) {\n    remove(child);\n  }\n\n  return element;\n}\n\nfunction clone(element) {\n  return element.cloneNode(true);\n}\n\nvar ns = {\n  svg: 'http://www.w3.org/2000/svg'\n};\n\n/**\n * DOM parsing utility\n */\n\nvar SVG_START = '<svg xmlns=\"' + ns.svg + '\"';\n\nfunction parse(svg) {\n\n  var unwrap = false;\n\n  // ensure we import a valid svg document\n  if (svg.substring(0, 4) === '<svg') {\n    if (svg.indexOf(ns.svg) === -1) {\n      svg = SVG_START + svg.substring(4);\n    }\n  } else {\n    // namespace svg\n    svg = SVG_START + '>' + svg + '</svg>';\n    unwrap = true;\n  }\n\n  var parsed = parseDocument(svg);\n\n  if (!unwrap) {\n    return parsed;\n  }\n\n  var fragment = document.createDocumentFragment();\n\n  var parent = parsed.firstChild;\n\n  while (parent.firstChild) {\n    fragment.appendChild(parent.firstChild);\n  }\n\n  return fragment;\n}\n\nfunction parseDocument(svg) {\n\n  var parser;\n\n  // parse\n  parser = new DOMParser();\n  parser.async = false;\n\n  return parser.parseFromString(svg, 'text/xml');\n}\n\n/**\n * Create utility for SVG elements\n */\n\n\n/**\n * Create a specific type from name or SVG markup.\n *\n * @param {String} name the name or markup of the element\n * @param {Object} [attrs] attributes to set on the element\n *\n * @returns {SVGElement}\n */\nfunction create(name, attrs) {\n  var element;\n\n  if (name.charAt(0) === '<') {\n    element = parse(name).firstChild;\n    element = document.importNode(element, true);\n  } else {\n    element = document.createElementNS(ns.svg, name);\n  }\n\n  if (attrs) {\n    attr(element, attrs);\n  }\n\n  return element;\n}\n\n/**\n * Events handling utility\n */\n\nfunction on(node, event, listener, useCapture) {\n  node.addEventListener(event, listener, useCapture);\n}\n\nfunction off(node, event, listener, useCapture) {\n  node.removeEventListener(event, listener, useCapture);\n}\n\n/**\n * Geometry helpers\n */\n\n// fake node used to instantiate svg geometry elements\nvar node = create('svg');\n\nfunction extend(object, props) {\n  var i, k, keys = Object.keys(props);\n\n  for (i = 0; (k = keys[i]); i++) {\n    object[k] = props[k];\n  }\n\n  return object;\n}\n\n\nfunction createPoint(x, y) {\n  var point = node.createSVGPoint();\n\n  switch (arguments.length) {\n  case 0:\n    return point;\n  case 2:\n    x = {\n      x: x,\n      y: y\n    };\n    break;\n  }\n\n  return extend(point, x);\n}\n\n/**\n * Create matrix via args.\n *\n * @example\n *\n * createMatrix({ a: 1, b: 1 });\n * createMatrix();\n * createMatrix(1, 2, 0, 0, 30, 20);\n *\n * @return {SVGMatrix}\n */\nfunction createMatrix(a, b, c, d, e, f) {\n  var matrix = node.createSVGMatrix();\n\n  switch (arguments.length) {\n  case 0:\n    return matrix;\n  case 1:\n    return extend(matrix, a);\n  case 6:\n    return extend(matrix, {\n      a: a,\n      b: b,\n      c: c,\n      d: d,\n      e: e,\n      f: f\n    });\n  }\n}\n\nfunction createTransform(matrix) {\n  if (matrix) {\n    return node.createSVGTransformFromMatrix(matrix);\n  } else {\n    return node.createSVGTransform();\n  }\n}\n\n/**\n * Serialization util\n */\n\nvar TEXT_ENTITIES = /([&<>]{1})/g;\nvar ATTR_ENTITIES = /([\\n\\r\"]{1})/g;\n\nvar ENTITY_REPLACEMENT = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '\\''\n};\n\nfunction escape(str, pattern) {\n\n  function replaceFn(match, entity) {\n    return ENTITY_REPLACEMENT[entity] || entity;\n  }\n\n  return str.replace(pattern, replaceFn);\n}\n\nfunction serialize(node, output) {\n\n  var i, len, attrMap, attrNode, childNodes;\n\n  switch (node.nodeType) {\n  // TEXT\n  case 3:\n    // replace special XML characters\n    output.push(escape(node.textContent, TEXT_ENTITIES));\n    break;\n\n  // ELEMENT\n  case 1:\n    output.push('<', node.tagName);\n\n    if (node.hasAttributes()) {\n      attrMap = node.attributes;\n      for (i = 0, len = attrMap.length; i < len; ++i) {\n        attrNode = attrMap.item(i);\n        output.push(' ', attrNode.name, '=\"', escape(attrNode.value, ATTR_ENTITIES), '\"');\n      }\n    }\n\n    if (node.hasChildNodes()) {\n      output.push('>');\n      childNodes = node.childNodes;\n      for (i = 0, len = childNodes.length; i < len; ++i) {\n        serialize(childNodes.item(i), output);\n      }\n      output.push('</', node.tagName, '>');\n    } else {\n      output.push('/>');\n    }\n    break;\n\n  // COMMENT\n  case 8:\n    output.push('<!--', escape(node.nodeValue, TEXT_ENTITIES), '-->');\n    break;\n\n  // CDATA\n  case 4:\n    output.push('<![CDATA[', node.nodeValue, ']]>');\n    break;\n\n  default:\n    throw new Error('unable to handle node ' + node.nodeType);\n  }\n\n  return output;\n}\n\n/**\n * innerHTML like functionality for SVG elements.\n * based on innerSVG (https://code.google.com/p/innersvg)\n */\n\n\nfunction set(element, svg) {\n\n  var parsed = parse(svg);\n\n  // clear element contents\n  clear(element);\n\n  if (!svg) {\n    return;\n  }\n\n  if (!isFragment(parsed)) {\n    // extract <svg> from parsed document\n    parsed = parsed.documentElement;\n  }\n\n  var nodes = slice(parsed.childNodes);\n\n  // import + append each node\n  for (var i = 0; i < nodes.length; i++) {\n    appendTo(nodes[i], element);\n  }\n\n}\n\nfunction get(element) {\n  var child = element.firstChild,\n      output = [];\n\n  while (child) {\n    serialize(child, output);\n    child = child.nextSibling;\n  }\n\n  return output.join('');\n}\n\nfunction isFragment(node) {\n  return node.nodeName === '#document-fragment';\n}\n\nfunction innerSVG(element, svg) {\n\n  if (svg !== undefined) {\n\n    try {\n      set(element, svg);\n    } catch (e) {\n      throw new Error('error parsing SVG: ' + e.message);\n    }\n\n    return element;\n  } else {\n    return get(element);\n  }\n}\n\n\nfunction slice(arr) {\n  return Array.prototype.slice.call(arr);\n}\n\n/**\n * Selection utilities\n */\n\nfunction select(node, selector) {\n  return node.querySelector(selector);\n}\n\nfunction selectAll(node, selector) {\n  var nodes = node.querySelectorAll(selector);\n\n  return [].map.call(nodes, function(element) {\n    return element;\n  });\n}\n\n/**\n * prependTo utility\n */\n\n/**\n * Prepend a node to a target element and return the prepended node.\n *\n * @param  {SVGElement} node\n * @param  {SVGElement} target\n *\n * @return {SVGElement} the prepended node\n */\nfunction prependTo(node, target) {\n  return target.insertBefore(ensureImported(node, target), target.firstChild || null);\n}\n\n/**\n * prepend utility\n */\n\n/**\n * Prepend a node to a target element\n *\n * @param  {SVGElement} target\n * @param  {SVGElement} node\n *\n * @return {SVGElement} the target element\n */\nfunction prepend(target, node) {\n  prependTo(node, target);\n  return target;\n}\n\n/**\n * Replace utility\n */\n\nfunction replace(element, replacement) {\n  element.parentNode.replaceChild(ensureImported(replacement, element), element);\n  return replacement;\n}\n\n/**\n * transform accessor utility\n */\n\nfunction wrapMatrix(transformList, transform) {\n  if (transform instanceof SVGMatrix) {\n    return transformList.createSVGTransformFromMatrix(transform);\n  }\n\n  return transform;\n}\n\n\nfunction setTransforms(transformList, transforms) {\n  var i, t;\n\n  transformList.clear();\n\n  for (i = 0; (t = transforms[i]); i++) {\n    transformList.appendItem(wrapMatrix(transformList, t));\n  }\n}\n\n/**\n * Get or set the transforms on the given node.\n *\n * @param {SVGElement} node\n * @param  {SVGTransform|SVGMatrix|Array<SVGTransform|SVGMatrix>} [transforms]\n *\n * @return {SVGTransform} the consolidated transform\n */\nfunction transform(node, transforms) {\n  var transformList = node.transform.baseVal;\n\n  if (transforms) {\n\n    if (!Array.isArray(transforms)) {\n      transforms = [ transforms ];\n    }\n\n    setTransforms(transformList, transforms);\n  }\n\n  return transformList.consolidate();\n}\n\nexport { append, appendTo, attr, classes, clear, clone, create, innerSVG, prepend, prependTo, remove, replace, transform, on, off, createPoint, createMatrix, createTransform, select, selectAll };\n","import {\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\n\nexport function componentsToPath(elements) {\n  return elements.join(',').replace(/,?([A-z]),?/g, '$1');\n}\n\nexport function toSVGPoints(points) {\n  var result = '';\n\n  for (var i = 0, p; (p = points[i]); i++) {\n    result += p.x + ',' + p.y + ' ';\n  }\n\n  return result;\n}\n\nexport function createLine(points, attrs) {\n\n  var line = svgCreate('polyline');\n  svgAttr(line, { points: toSVGPoints(points) });\n\n  if (attrs) {\n    svgAttr(line, attrs);\n  }\n\n  return line;\n}\n\nexport function updateLine(gfx, points) {\n  svgAttr(gfx, { points: toSVGPoints(points) });\n\n  return gfx;\n}\n","/**\n * Flatten array, one level deep.\n *\n * @param {Array<?>} arr\n *\n * @return {Array<?>}\n */\nfunction flatten(arr) {\n  return Array.prototype.concat.apply([], arr);\n}\n\nvar nativeToString = Object.prototype.toString;\nvar nativeHasOwnProperty = Object.prototype.hasOwnProperty;\nfunction isUndefined(obj) {\n  return obj === undefined;\n}\nfunction isDefined(obj) {\n  return obj !== undefined;\n}\nfunction isNil(obj) {\n  return obj == null;\n}\nfunction isArray(obj) {\n  return nativeToString.call(obj) === '[object Array]';\n}\nfunction isObject(obj) {\n  return nativeToString.call(obj) === '[object Object]';\n}\nfunction isNumber(obj) {\n  return nativeToString.call(obj) === '[object Number]';\n}\nfunction isFunction(obj) {\n  var tag = nativeToString.call(obj);\n  return tag === '[object Function]' || tag === '[object AsyncFunction]' || tag === '[object GeneratorFunction]' || tag === '[object AsyncGeneratorFunction]' || tag === '[object Proxy]';\n}\nfunction isString(obj) {\n  return nativeToString.call(obj) === '[object String]';\n}\n/**\n * Ensure collection is an array.\n *\n * @param {Object} obj\n */\n\nfunction ensureArray(obj) {\n  if (isArray(obj)) {\n    return;\n  }\n\n  throw new Error('must supply array');\n}\n/**\n * Return true, if target owns a property with the given key.\n *\n * @param {Object} target\n * @param {String} key\n *\n * @return {Boolean}\n */\n\nfunction has(target, key) {\n  return nativeHasOwnProperty.call(target, key);\n}\n\n/**\n * Find element in collection.\n *\n * @param  {Array|Object} collection\n * @param  {Function|Object} matcher\n *\n * @return {Object}\n */\n\nfunction find(collection, matcher) {\n  matcher = toMatcher(matcher);\n  var match;\n  forEach(collection, function (val, key) {\n    if (matcher(val, key)) {\n      match = val;\n      return false;\n    }\n  });\n  return match;\n}\n/**\n * Find element index in collection.\n *\n * @param  {Array|Object} collection\n * @param  {Function} matcher\n *\n * @return {Object}\n */\n\nfunction findIndex(collection, matcher) {\n  matcher = toMatcher(matcher);\n  var idx = isArray(collection) ? -1 : undefined;\n  forEach(collection, function (val, key) {\n    if (matcher(val, key)) {\n      idx = key;\n      return false;\n    }\n  });\n  return idx;\n}\n/**\n * Find element in collection.\n *\n * @param  {Array|Object} collection\n * @param  {Function} matcher\n *\n * @return {Array} result\n */\n\nfunction filter(collection, matcher) {\n  var result = [];\n  forEach(collection, function (val, key) {\n    if (matcher(val, key)) {\n      result.push(val);\n    }\n  });\n  return result;\n}\n/**\n * Iterate over collection; returning something\n * (non-undefined) will stop iteration.\n *\n * @param  {Array|Object} collection\n * @param  {Function} iterator\n *\n * @return {Object} return result that stopped the iteration\n */\n\nfunction forEach(collection, iterator) {\n  var val, result;\n\n  if (isUndefined(collection)) {\n    return;\n  }\n\n  var convertKey = isArray(collection) ? toNum : identity;\n\n  for (var key in collection) {\n    if (has(collection, key)) {\n      val = collection[key];\n      result = iterator(val, convertKey(key));\n\n      if (result === false) {\n        return val;\n      }\n    }\n  }\n}\n/**\n * Return collection without element.\n *\n * @param  {Array} arr\n * @param  {Function} matcher\n *\n * @return {Array}\n */\n\nfunction without(arr, matcher) {\n  if (isUndefined(arr)) {\n    return [];\n  }\n\n  ensureArray(arr);\n  matcher = toMatcher(matcher);\n  return arr.filter(function (el, idx) {\n    return !matcher(el, idx);\n  });\n}\n/**\n * Reduce collection, returning a single result.\n *\n * @param  {Object|Array} collection\n * @param  {Function} iterator\n * @param  {Any} result\n *\n * @return {Any} result returned from last iterator\n */\n\nfunction reduce(collection, iterator, result) {\n  forEach(collection, function (value, idx) {\n    result = iterator(result, value, idx);\n  });\n  return result;\n}\n/**\n * Return true if every element in the collection\n * matches the criteria.\n *\n * @param  {Object|Array} collection\n * @param  {Function} matcher\n *\n * @return {Boolean}\n */\n\nfunction every(collection, matcher) {\n  return !!reduce(collection, function (matches, val, key) {\n    return matches && matcher(val, key);\n  }, true);\n}\n/**\n * Return true if some elements in the collection\n * match the criteria.\n *\n * @param  {Object|Array} collection\n * @param  {Function} matcher\n *\n * @return {Boolean}\n */\n\nfunction some(collection, matcher) {\n  return !!find(collection, matcher);\n}\n/**\n * Transform a collection into another collection\n * by piping each member through the given fn.\n *\n * @param  {Object|Array}   collection\n * @param  {Function} fn\n *\n * @return {Array} transformed collection\n */\n\nfunction map(collection, fn) {\n  var result = [];\n  forEach(collection, function (val, key) {\n    result.push(fn(val, key));\n  });\n  return result;\n}\n/**\n * Get the collections keys.\n *\n * @param  {Object|Array} collection\n *\n * @return {Array}\n */\n\nfunction keys(collection) {\n  return collection && Object.keys(collection) || [];\n}\n/**\n * Shorthand for `keys(o).length`.\n *\n * @param  {Object|Array} collection\n *\n * @return {Number}\n */\n\nfunction size(collection) {\n  return keys(collection).length;\n}\n/**\n * Get the values in the collection.\n *\n * @param  {Object|Array} collection\n *\n * @return {Array}\n */\n\nfunction values(collection) {\n  return map(collection, function (val) {\n    return val;\n  });\n}\n/**\n * Group collection members by attribute.\n *\n * @param  {Object|Array} collection\n * @param  {Function} extractor\n *\n * @return {Object} map with { attrValue => [ a, b, c ] }\n */\n\nfunction groupBy(collection, extractor) {\n  var grouped = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  extractor = toExtractor(extractor);\n  forEach(collection, function (val) {\n    var discriminator = extractor(val) || '_';\n    var group = grouped[discriminator];\n\n    if (!group) {\n      group = grouped[discriminator] = [];\n    }\n\n    group.push(val);\n  });\n  return grouped;\n}\nfunction uniqueBy(extractor) {\n  extractor = toExtractor(extractor);\n  var grouped = {};\n\n  for (var _len = arguments.length, collections = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    collections[_key - 1] = arguments[_key];\n  }\n\n  forEach(collections, function (c) {\n    return groupBy(c, extractor, grouped);\n  });\n  var result = map(grouped, function (val, key) {\n    return val[0];\n  });\n  return result;\n}\nvar unionBy = uniqueBy;\n/**\n * Sort collection by criteria.\n *\n * @param  {Object|Array} collection\n * @param  {String|Function} extractor\n *\n * @return {Array}\n */\n\nfunction sortBy(collection, extractor) {\n  extractor = toExtractor(extractor);\n  var sorted = [];\n  forEach(collection, function (value, key) {\n    var disc = extractor(value, key);\n    var entry = {\n      d: disc,\n      v: value\n    };\n\n    for (var idx = 0; idx < sorted.length; idx++) {\n      var d = sorted[idx].d;\n\n      if (disc < d) {\n        sorted.splice(idx, 0, entry);\n        return;\n      }\n    } // not inserted, append (!)\n\n\n    sorted.push(entry);\n  });\n  return map(sorted, function (e) {\n    return e.v;\n  });\n}\n/**\n * Create an object pattern matcher.\n *\n * @example\n *\n * const matcher = matchPattern({ id: 1 });\n *\n * var element = find(elements, matcher);\n *\n * @param  {Object} pattern\n *\n * @return {Function} matcherFn\n */\n\nfunction matchPattern(pattern) {\n  return function (el) {\n    return every(pattern, function (val, key) {\n      return el[key] === val;\n    });\n  };\n}\n\nfunction toExtractor(extractor) {\n  return isFunction(extractor) ? extractor : function (e) {\n    return e[extractor];\n  };\n}\n\nfunction toMatcher(matcher) {\n  return isFunction(matcher) ? matcher : function (e) {\n    return e === matcher;\n  };\n}\n\nfunction identity(arg) {\n  return arg;\n}\n\nfunction toNum(arg) {\n  return Number(arg);\n}\n\n/**\n * Debounce fn, calling it only once if\n * the given time elapsed between calls.\n *\n * @param  {Function} fn\n * @param  {Number} timeout\n *\n * @return {Function} debounced function\n */\nfunction debounce(fn, timeout) {\n  var timer;\n  var lastArgs;\n  var lastThis;\n  var lastNow;\n\n  function fire() {\n    var now = Date.now();\n    var scheduledDiff = lastNow + timeout - now;\n\n    if (scheduledDiff > 0) {\n      return schedule(scheduledDiff);\n    }\n\n    fn.apply(lastThis, lastArgs);\n    timer = lastNow = lastArgs = lastThis = undefined;\n  }\n\n  function schedule(timeout) {\n    timer = setTimeout(fire, timeout);\n  }\n\n  return function () {\n    lastNow = Date.now();\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    lastArgs = args;\n    lastThis = this; // ensure an execution is scheduled\n\n    if (!timer) {\n      schedule(timeout);\n    }\n  };\n}\n/**\n * Throttle fn, calling at most once\n * in the given interval.\n *\n * @param  {Function} fn\n * @param  {Number} interval\n *\n * @return {Function} throttled function\n */\n\nfunction throttle(fn, interval) {\n  var throttling = false;\n  return function () {\n    if (throttling) {\n      return;\n    }\n\n    fn.apply(void 0, arguments);\n    throttling = true;\n    setTimeout(function () {\n      throttling = false;\n    }, interval);\n  };\n}\n/**\n * Bind function against target <this>.\n *\n * @param  {Function} fn\n * @param  {Object}   target\n *\n * @return {Function} bound function\n */\n\nfunction bind(fn, target) {\n  return fn.bind(target);\n}\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\n/**\n * Convenience wrapper for `Object.assign`.\n *\n * @param {Object} target\n * @param {...Object} others\n *\n * @return {Object} the target\n */\n\nfunction assign(target) {\n  for (var _len = arguments.length, others = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    others[_key - 1] = arguments[_key];\n  }\n\n  return _extends.apply(void 0, [target].concat(others));\n}\n/**\n * Pick given properties from the target object.\n *\n * @param {Object} target\n * @param {Array} properties\n *\n * @return {Object} target\n */\n\nfunction pick(target, properties) {\n  var result = {};\n  var obj = Object(target);\n  forEach(properties, function (prop) {\n    if (prop in obj) {\n      result[prop] = target[prop];\n    }\n  });\n  return result;\n}\n/**\n * Pick all target properties, excluding the given ones.\n *\n * @param {Object} target\n * @param {Array} properties\n *\n * @return {Object} target\n */\n\nfunction omit(target, properties) {\n  var result = {};\n  var obj = Object(target);\n  forEach(obj, function (prop, key) {\n    if (properties.indexOf(key) === -1) {\n      result[key] = prop;\n    }\n  });\n  return result;\n}\n/**\n * Recursively merge `...sources` into given target.\n *\n * Does support merging objects; does not support merging arrays.\n *\n * @param {Object} target\n * @param {...Object} sources\n *\n * @return {Object} the target\n */\n\nfunction merge(target) {\n  for (var _len2 = arguments.length, sources = new Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n    sources[_key2 - 1] = arguments[_key2];\n  }\n\n  if (!sources.length) {\n    return target;\n  }\n\n  forEach(sources, function (source) {\n    // skip non-obj sources, i.e. null\n    if (!source || !isObject(source)) {\n      return;\n    }\n\n    forEach(source, function (sourceVal, key) {\n      if (key === '__proto__') {\n        return;\n      }\n\n      var targetVal = target[key];\n\n      if (isObject(sourceVal)) {\n        if (!isObject(targetVal)) {\n          // override target[key] with object\n          targetVal = {};\n        }\n\n        target[key] = merge(targetVal, sourceVal);\n      } else {\n        target[key] = sourceVal;\n      }\n    });\n  });\n  return target;\n}\n\nexport { flatten, find, findIndex, filter, forEach, without, reduce, every, some, map, keys, size, values, groupBy, uniqueBy, unionBy, sortBy, matchPattern, debounce, throttle, bind, isUndefined, isDefined, isNil, isArray, isObject, isNumber, isFunction, isString, ensureArray, has, assign, pick, omit, merge };\n","import {\n  assign,\n  filter,\n  find,\n  isArray,\n  isNumber,\n  isObject,\n  isUndefined,\n  groupBy,\n  forEach\n} from 'min-dash';\n\n\n/**\n * Get parent elements.\n *\n * @param {Array<djs.model.base>} elements\n *\n * @returns {Array<djs.model.Base>}\n */\nexport function getParents(elements) {\n\n  // find elements that are not children of any other elements\n  return filter(elements, function(element) {\n    return !find(elements, function(e) {\n      return e !== element && getParent(element, e);\n    });\n  });\n}\n\n\nfunction getParent(element, parent) {\n  if (!parent) {\n    return;\n  }\n\n  if (element === parent) {\n    return parent;\n  }\n\n  if (!element.parent) {\n    return;\n  }\n\n  return getParent(element.parent, parent);\n}\n\n\n/**\n * Adds an element to a collection and returns true if the\n * element was added.\n *\n * @param {Array<Object>} elements\n * @param {Object} e\n * @param {boolean} unique\n */\nexport function add(elements, e, unique) {\n  var canAdd = !unique || elements.indexOf(e) === -1;\n\n  if (canAdd) {\n    elements.push(e);\n  }\n\n  return canAdd;\n}\n\n\n/**\n * Iterate over each element in a collection, calling the iterator function `fn`\n * with (element, index, recursionDepth).\n *\n * Recurse into all elements that are returned by `fn`.\n *\n * @param  {Object|Array<Object>} elements\n * @param  {Function} fn iterator function called with (element, index, recursionDepth)\n * @param  {number} [depth] maximum recursion depth\n */\nexport function eachElement(elements, fn, depth) {\n\n  depth = depth || 0;\n\n  if (!isArray(elements)) {\n    elements = [ elements ];\n  }\n\n  forEach(elements, function(s, i) {\n    var filter = fn(s, i, depth);\n\n    if (isArray(filter) && filter.length) {\n      eachElement(filter, fn, depth + 1);\n    }\n  });\n}\n\n\n/**\n * Collects self + child elements up to a given depth from a list of elements.\n *\n * @param  {djs.model.Base|Array<djs.model.Base>} elements the elements to select the children from\n * @param  {boolean} unique whether to return a unique result set (no duplicates)\n * @param  {number} maxDepth the depth to search through or -1 for infinite\n *\n * @return {Array<djs.model.Base>} found elements\n */\nexport function selfAndChildren(elements, unique, maxDepth) {\n  var result = [],\n      processedChildren = [];\n\n  eachElement(elements, function(element, i, depth) {\n    add(result, element, unique);\n\n    var children = element.children;\n\n    // max traversal depth not reached yet\n    if (maxDepth === -1 || depth < maxDepth) {\n\n      // children exist && children not yet processed\n      if (children && add(processedChildren, children, unique)) {\n        return children;\n      }\n    }\n  });\n\n  return result;\n}\n\n/**\n * Return self + direct children for a number of elements\n *\n * @param  {Array<djs.model.Base>} elements to query\n * @param  {boolean} allowDuplicates to allow duplicates in the result set\n *\n * @return {Array<djs.model.Base>} the collected elements\n */\nexport function selfAndDirectChildren(elements, allowDuplicates) {\n  return selfAndChildren(elements, !allowDuplicates, 1);\n}\n\n\n/**\n * Return self + ALL children for a number of elements\n *\n * @param  {Array<djs.model.Base>} elements to query\n * @param  {boolean} allowDuplicates to allow duplicates in the result set\n *\n * @return {Array<djs.model.Base>} the collected elements\n */\nexport function selfAndAllChildren(elements, allowDuplicates) {\n  return selfAndChildren(elements, !allowDuplicates, -1);\n}\n\n\n/**\n * Gets the the closure for all selected elements,\n * their enclosed children and connections.\n *\n * @param {Array<djs.model.Base>} elements\n * @param {boolean} [isTopLevel=true]\n * @param {Object} [existingClosure]\n *\n * @return {Object} newClosure\n */\nexport function getClosure(elements, isTopLevel, closure) {\n\n  if (isUndefined(isTopLevel)) {\n    isTopLevel = true;\n  }\n\n  if (isObject(isTopLevel)) {\n    closure = isTopLevel;\n    isTopLevel = true;\n  }\n\n\n  closure = closure || {};\n\n  var allShapes = copyObject(closure.allShapes),\n      allConnections = copyObject(closure.allConnections),\n      enclosedElements = copyObject(closure.enclosedElements),\n      enclosedConnections = copyObject(closure.enclosedConnections);\n\n  var topLevel = copyObject(\n    closure.topLevel,\n    isTopLevel && groupBy(elements, function(e) { return e.id; })\n  );\n\n\n  function handleConnection(c) {\n    if (topLevel[c.source.id] && topLevel[c.target.id]) {\n      topLevel[c.id] = [ c ];\n    }\n\n    // not enclosed as a child, but maybe logically\n    // (connecting two moved elements?)\n    if (allShapes[c.source.id] && allShapes[c.target.id]) {\n      enclosedConnections[c.id] = enclosedElements[c.id] = c;\n    }\n\n    allConnections[c.id] = c;\n  }\n\n  function handleElement(element) {\n\n    enclosedElements[element.id] = element;\n\n    if (element.waypoints) {\n\n      // remember connection\n      enclosedConnections[element.id] = allConnections[element.id] = element;\n    } else {\n\n      // remember shape\n      allShapes[element.id] = element;\n\n      // remember all connections\n      forEach(element.incoming, handleConnection);\n\n      forEach(element.outgoing, handleConnection);\n\n      // recurse into children\n      return element.children;\n    }\n  }\n\n  eachElement(elements, handleElement);\n\n  return {\n    allShapes: allShapes,\n    allConnections: allConnections,\n    topLevel: topLevel,\n    enclosedConnections: enclosedConnections,\n    enclosedElements: enclosedElements\n  };\n}\n\n/**\n * Returns the surrounding bbox for all elements in\n * the array or the element primitive.\n *\n * @param {Array<djs.model.Shape>|djs.model.Shape} elements\n * @param {boolean} stopRecursion\n */\nexport function getBBox(elements, stopRecursion) {\n\n  stopRecursion = !!stopRecursion;\n  if (!isArray(elements)) {\n    elements = [elements];\n  }\n\n  var minX,\n      minY,\n      maxX,\n      maxY;\n\n  forEach(elements, function(element) {\n\n    // If element is a connection the bbox must be computed first\n    var bbox = element;\n    if (element.waypoints && !stopRecursion) {\n      bbox = getBBox(element.waypoints, true);\n    }\n\n    var x = bbox.x,\n        y = bbox.y,\n        height = bbox.height || 0,\n        width = bbox.width || 0;\n\n    if (x < minX || minX === undefined) {\n      minX = x;\n    }\n    if (y < minY || minY === undefined) {\n      minY = y;\n    }\n\n    if ((x + width) > maxX || maxX === undefined) {\n      maxX = x + width;\n    }\n    if ((y + height) > maxY || maxY === undefined) {\n      maxY = y + height;\n    }\n  });\n\n  return {\n    x: minX,\n    y: minY,\n    height: maxY - minY,\n    width: maxX - minX\n  };\n}\n\n\n/**\n * Returns all elements that are enclosed from the bounding box.\n *\n *   * If bbox.(width|height) is not specified the method returns\n *     all elements with element.x/y > bbox.x/y\n *   * If only bbox.x or bbox.y is specified, method return all elements with\n *     e.x > bbox.x or e.y > bbox.y\n *\n * @param {Array<djs.model.Shape>} elements List of Elements to search through\n * @param {djs.model.Shape} bbox the enclosing bbox.\n *\n * @return {Array<djs.model.Shape>} enclosed elements\n */\nexport function getEnclosedElements(elements, bbox) {\n\n  var filteredElements = {};\n\n  forEach(elements, function(element) {\n\n    var e = element;\n\n    if (e.waypoints) {\n      e = getBBox(e);\n    }\n\n    if (!isNumber(bbox.y) && (e.x > bbox.x)) {\n      filteredElements[element.id] = element;\n    }\n    if (!isNumber(bbox.x) && (e.y > bbox.y)) {\n      filteredElements[element.id] = element;\n    }\n    if (e.x > bbox.x && e.y > bbox.y) {\n      if (isNumber(bbox.width) && isNumber(bbox.height) &&\n          e.width + e.x < bbox.width + bbox.x &&\n          e.height + e.y < bbox.height + bbox.y) {\n\n        filteredElements[element.id] = element;\n      } else if (!isNumber(bbox.width) || !isNumber(bbox.height)) {\n        filteredElements[element.id] = element;\n      }\n    }\n  });\n\n  return filteredElements;\n}\n\n\nexport function getType(element) {\n\n  if ('waypoints' in element) {\n    return 'connection';\n  }\n\n  if ('x' in element) {\n    return 'shape';\n  }\n\n  return 'root';\n}\n\nexport function isFrameElement(element) {\n\n  return !!(element && element.isFrame);\n}\n\n// helpers ///////////////////////////////\n\nfunction copyObject(src1, src2) {\n  return assign({}, src1 || {}, src2 || {});\n}","import inherits from 'inherits';\n\nimport BaseRenderer from './BaseRenderer';\n\nimport {\n  componentsToPath,\n  createLine\n} from '../util/RenderUtil';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  isFrameElement\n} from '../util/Elements';\n\n// apply default renderer with lowest possible priority\n// so that it only kicks in if noone else could render\nvar DEFAULT_RENDER_PRIORITY = 1;\n\n/**\n * The default renderer used for shapes and connections.\n *\n * @param {EventBus} eventBus\n * @param {Styles} styles\n */\nexport default function DefaultRenderer(eventBus, styles) {\n\n  //\n  BaseRenderer.call(this, eventBus, DEFAULT_RENDER_PRIORITY);\n\n  this.CONNECTION_STYLE = styles.style([ 'no-fill' ], { strokeWidth: 5, stroke: 'fuchsia' });\n  this.SHAPE_STYLE = styles.style({ fill: 'white', stroke: 'fuchsia', strokeWidth: 2 });\n  this.FRAME_STYLE = styles.style([ 'no-fill' ], { stroke: 'fuchsia', strokeDasharray: 4, strokeWidth: 2 });\n}\n\ninherits(DefaultRenderer, BaseRenderer);\n\n\nDefaultRenderer.prototype.canRender = function() {\n  return true;\n};\n\nDefaultRenderer.prototype.drawShape = function drawShape(visuals, element) {\n  var rect = svgCreate('rect');\n\n  svgAttr(rect, {\n    x: 0,\n    y: 0,\n    width: element.width || 0,\n    height: element.height || 0\n  });\n\n  if (isFrameElement(element)) {\n    svgAttr(rect, this.FRAME_STYLE);\n  } else {\n    svgAttr(rect, this.SHAPE_STYLE);\n  }\n\n  svgAppend(visuals, rect);\n\n  return rect;\n};\n\nDefaultRenderer.prototype.drawConnection = function drawConnection(visuals, connection) {\n\n  var line = createLine(connection.waypoints, this.CONNECTION_STYLE);\n  svgAppend(visuals, line);\n\n  return line;\n};\n\nDefaultRenderer.prototype.getShapePath = function getShapePath(shape) {\n\n  var x = shape.x,\n      y = shape.y,\n      width = shape.width,\n      height = shape.height;\n\n  var shapePath = [\n    ['M', x, y],\n    ['l', width, 0],\n    ['l', 0, height],\n    ['l', -width, 0],\n    ['z']\n  ];\n\n  return componentsToPath(shapePath);\n};\n\nDefaultRenderer.prototype.getConnectionPath = function getConnectionPath(connection) {\n  var waypoints = connection.waypoints;\n\n  var idx, point, connectionPath = [];\n\n  for (idx = 0; (point = waypoints[idx]); idx++) {\n\n    // take invisible docking into account\n    // when creating the path\n    point = point.original || point;\n\n    connectionPath.push([ idx === 0 ? 'M' : 'L', point.x, point.y ]);\n  }\n\n  return componentsToPath(connectionPath);\n};\n\n\nDefaultRenderer.$inject = [ 'eventBus', 'styles' ];\n","import {\n  isArray,\n  assign,\n  reduce\n} from 'min-dash';\n\n\n/**\n * A component that manages shape styles\n */\nexport default function Styles() {\n\n  var defaultTraits = {\n\n    'no-fill': {\n      fill: 'none'\n    },\n    'no-border': {\n      strokeOpacity: 0.0\n    },\n    'no-events': {\n      pointerEvents: 'none'\n    }\n  };\n\n  var self = this;\n\n  /**\n   * Builds a style definition from a className, a list of traits and an object of additional attributes.\n   *\n   * @param  {string} className\n   * @param  {Array<string>} traits\n   * @param  {Object} additionalAttrs\n   *\n   * @return {Object} the style defintion\n   */\n  this.cls = function(className, traits, additionalAttrs) {\n    var attrs = this.style(traits, additionalAttrs);\n\n    return assign(attrs, { 'class': className });\n  };\n\n  /**\n   * Builds a style definition from a list of traits and an object of additional attributes.\n   *\n   * @param  {Array<string>} traits\n   * @param  {Object} additionalAttrs\n   *\n   * @return {Object} the style defintion\n   */\n  this.style = function(traits, additionalAttrs) {\n\n    if (!isArray(traits) && !additionalAttrs) {\n      additionalAttrs = traits;\n      traits = [];\n    }\n\n    var attrs = reduce(traits, function(attrs, t) {\n      return assign(attrs, defaultTraits[t] || {});\n    }, {});\n\n    return additionalAttrs ? assign(attrs, additionalAttrs) : attrs;\n  };\n\n  this.computeStyle = function(custom, traits, defaultStyles) {\n    if (!isArray(traits)) {\n      defaultStyles = traits;\n      traits = [];\n    }\n\n    return self.style(traits || [], assign({}, defaultStyles, custom || {}));\n  };\n}\n","import DefaultRenderer from './DefaultRenderer';\nimport Styles from './Styles';\n\nexport default {\n  __init__: [ 'defaultRenderer' ],\n  defaultRenderer: [ 'type', DefaultRenderer ],\n  styles: [ 'type', Styles ]\n};\n","/**\n * Failsafe remove an element from a collection\n *\n * @param  {Array<Object>} [collection]\n * @param  {Object} [element]\n *\n * @return {number} the previous index of the element\n */\nexport function remove(collection, element) {\n\n  if (!collection || !element) {\n    return -1;\n  }\n\n  var idx = collection.indexOf(element);\n\n  if (idx !== -1) {\n    collection.splice(idx, 1);\n  }\n\n  return idx;\n}\n\n/**\n * Fail save add an element to the given connection, ensuring\n * it does not yet exist.\n *\n * @param {Array<Object>} collection\n * @param {Object} element\n * @param {number} idx\n */\nexport function add(collection, element, idx) {\n\n  if (!collection || !element) {\n    return;\n  }\n\n  if (typeof idx !== 'number') {\n    idx = -1;\n  }\n\n  var currentIdx = collection.indexOf(element);\n\n  if (currentIdx !== -1) {\n\n    if (currentIdx === idx) {\n\n      // nothing to do, position has not changed\n      return;\n    } else {\n\n      if (idx !== -1) {\n\n        // remove from current position\n        collection.splice(currentIdx, 1);\n      } else {\n\n        // already exists in collection\n        return;\n      }\n    }\n  }\n\n  if (idx !== -1) {\n\n    // insert at specified position\n    collection.splice(idx, 0, element);\n  } else {\n\n    // push to end\n    collection.push(element);\n  }\n}\n\n\n/**\n * Fail save get the index of an element in a collection.\n *\n * @param {Array<Object>} collection\n * @param {Object} element\n *\n * @return {number} the index or -1 if collection or element do\n *                  not exist or the element is not contained.\n */\nexport function indexOf(collection, element) {\n\n  if (!collection || !element) {\n    return -1;\n  }\n\n  return collection.indexOf(element);\n}\n","import {\n  isNumber,\n  assign,\n  forEach,\n  every,\n  debounce,\n  bind,\n  reduce\n} from 'min-dash';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../util/Collections';\n\nimport {\n  getType\n} from '../util/Elements';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  transform as svgTransform\n} from 'tiny-svg';\n\nimport { createMatrix as createMatrix } from 'tiny-svg';\n\n\nfunction round(number, resolution) {\n  return Math.round(number * resolution) / resolution;\n}\n\nfunction ensurePx(number) {\n  return isNumber(number) ? number + 'px' : number;\n}\n\n/**\n * Creates a HTML container element for a SVG element with\n * the given configuration\n *\n * @param  {Object} options\n * @return {HTMLElement} the container element\n */\nfunction createContainer(options) {\n\n  options = assign({}, { width: '100%', height: '100%' }, options);\n\n  var container = options.container || document.body;\n\n  // create a <div> around the svg element with the respective size\n  // this way we can always get the correct container size\n  // (this is impossible for <svg> elements at the moment)\n  var parent = document.createElement('div');\n  parent.setAttribute('class', 'djs-container');\n\n  assign(parent.style, {\n    position: 'relative',\n    overflow: 'hidden',\n    width: ensurePx(options.width),\n    height: ensurePx(options.height)\n  });\n\n  container.appendChild(parent);\n\n  return parent;\n}\n\nfunction createGroup(parent, cls, childIndex) {\n  var group = svgCreate('g');\n  svgClasses(group).add(cls);\n\n  var index = childIndex !== undefined ? childIndex : parent.childNodes.length - 1;\n\n  // must ensure second argument is node or _null_\n  // cf. https://developer.mozilla.org/en-US/docs/Web/API/Node/insertBefore\n  parent.insertBefore(group, parent.childNodes[index] || null);\n\n  return group;\n}\n\nvar BASE_LAYER = 'base';\n\n\nvar REQUIRED_MODEL_ATTRS = {\n  shape: [ 'x', 'y', 'width', 'height' ],\n  connection: [ 'waypoints' ]\n};\n\n/**\n * The main drawing canvas.\n *\n * @class\n * @constructor\n *\n * @emits Canvas#canvas.init\n *\n * @param {Object} config\n * @param {EventBus} eventBus\n * @param {GraphicsFactory} graphicsFactory\n * @param {ElementRegistry} elementRegistry\n */\nexport default function Canvas(config, eventBus, graphicsFactory, elementRegistry) {\n\n  this._eventBus = eventBus;\n  this._elementRegistry = elementRegistry;\n  this._graphicsFactory = graphicsFactory;\n\n  this._init(config || {});\n}\n\nCanvas.$inject = [\n  'config.canvas',\n  'eventBus',\n  'graphicsFactory',\n  'elementRegistry'\n];\n\n\nCanvas.prototype._init = function(config) {\n\n  var eventBus = this._eventBus;\n\n  // Creates a <svg> element that is wrapped into a <div>.\n  // This way we are always able to correctly figure out the size of the svg element\n  // by querying the parent node.\n  //\n  // (It is not possible to get the size of a svg element cross browser @ 2014-04-01)\n  //\n  // <div class=\"djs-container\" style=\"width: {desired-width}, height: {desired-height}\">\n  //   <svg width=\"100%\" height=\"100%\">\n  //    ...\n  //   </svg>\n  // </div>\n\n  // html container\n  var container = this._container = createContainer(config);\n\n  var svg = this._svg = svgCreate('svg');\n  svgAttr(svg, { width: '100%', height: '100%' });\n\n  svgAppend(container, svg);\n\n  var viewport = this._viewport = createGroup(svg, 'viewport');\n\n  this._layers = {};\n\n  // debounce canvas.viewbox.changed events\n  // for smoother diagram interaction\n  if (config.deferUpdate !== false) {\n    this._viewboxChanged = debounce(bind(this._viewboxChanged, this), 300);\n  }\n\n  eventBus.on('diagram.init', function() {\n\n    /**\n     * An event indicating that the canvas is ready to be drawn on.\n     *\n     * @memberOf Canvas\n     *\n     * @event canvas.init\n     *\n     * @type {Object}\n     * @property {SVGElement} svg the created svg element\n     * @property {SVGElement} viewport the direct parent of diagram elements and shapes\n     */\n    eventBus.fire('canvas.init', {\n      svg: svg,\n      viewport: viewport\n    });\n\n  }, this);\n\n  // reset viewbox on shape changes to\n  // recompute the viewbox\n  eventBus.on([\n    'shape.added',\n    'connection.added',\n    'shape.removed',\n    'connection.removed',\n    'elements.changed'\n  ], function() {\n    delete this._cachedViewbox;\n  }, this);\n\n  eventBus.on('diagram.destroy', 500, this._destroy, this);\n  eventBus.on('diagram.clear', 500, this._clear, this);\n};\n\nCanvas.prototype._destroy = function(emit) {\n  this._eventBus.fire('canvas.destroy', {\n    svg: this._svg,\n    viewport: this._viewport\n  });\n\n  var parent = this._container.parentNode;\n\n  if (parent) {\n    parent.removeChild(this._container);\n  }\n\n  delete this._svg;\n  delete this._container;\n  delete this._layers;\n  delete this._rootElement;\n  delete this._viewport;\n};\n\nCanvas.prototype._clear = function() {\n\n  var self = this;\n\n  var allElements = this._elementRegistry.getAll();\n\n  // remove all elements\n  allElements.forEach(function(element) {\n    var type = getType(element);\n\n    if (type === 'root') {\n      self.setRootElement(null, true);\n    } else {\n      self._removeElement(element, type);\n    }\n  });\n\n  // force recomputation of view box\n  delete this._cachedViewbox;\n};\n\n/**\n * Returns the default layer on which\n * all elements are drawn.\n *\n * @returns {SVGElement}\n */\nCanvas.prototype.getDefaultLayer = function() {\n  return this.getLayer(BASE_LAYER, 0);\n};\n\n/**\n * Returns a layer that is used to draw elements\n * or annotations on it.\n *\n * Non-existing layers retrieved through this method\n * will be created. During creation, the optional index\n * may be used to create layers below or above existing layers.\n * A layer with a certain index is always created above all\n * existing layers with the same index.\n *\n * @param {string} name\n * @param {number} index\n *\n * @returns {SVGElement}\n */\nCanvas.prototype.getLayer = function(name, index) {\n\n  if (!name) {\n    throw new Error('must specify a name');\n  }\n\n  var layer = this._layers[name];\n\n  if (!layer) {\n    layer = this._layers[name] = this._createLayer(name, index);\n  }\n\n  // throw an error if layer creation / retrival is\n  // requested on different index\n  if (typeof index !== 'undefined' && layer.index !== index) {\n    throw new Error('layer <' + name + '> already created at index <' + index + '>');\n  }\n\n  return layer.group;\n};\n\n/**\n * Creates a given layer and returns it.\n *\n * @param {string} name\n * @param {number} [index=0]\n *\n * @return {Object} layer descriptor with { index, group: SVGGroup }\n */\nCanvas.prototype._createLayer = function(name, index) {\n\n  if (!index) {\n    index = 0;\n  }\n\n  var childIndex = reduce(this._layers, function(childIndex, layer) {\n    if (index >= layer.index) {\n      childIndex++;\n    }\n\n    return childIndex;\n  }, 0);\n\n  return {\n    group: createGroup(this._viewport, 'layer-' + name, childIndex),\n    index: index\n  };\n\n};\n\n/**\n * Returns the html element that encloses the\n * drawing canvas.\n *\n * @return {DOMNode}\n */\nCanvas.prototype.getContainer = function() {\n  return this._container;\n};\n\n\n// markers //////////////////////\n\nCanvas.prototype._updateMarker = function(element, marker, add) {\n  var container;\n\n  if (!element.id) {\n    element = this._elementRegistry.get(element);\n  }\n\n  // we need to access all\n  container = this._elementRegistry._elements[element.id];\n\n  if (!container) {\n    return;\n  }\n\n  forEach([ container.gfx, container.secondaryGfx ], function(gfx) {\n    if (gfx) {\n\n      // invoke either addClass or removeClass based on mode\n      if (add) {\n        svgClasses(gfx).add(marker);\n      } else {\n        svgClasses(gfx).remove(marker);\n      }\n    }\n  });\n\n  /**\n   * An event indicating that a marker has been updated for an element\n   *\n   * @event element.marker.update\n   * @type {Object}\n   * @property {djs.model.Element} element the shape\n   * @property {Object} gfx the graphical representation of the shape\n   * @property {string} marker\n   * @property {boolean} add true if the marker was added, false if it got removed\n   */\n  this._eventBus.fire('element.marker.update', { element: element, gfx: container.gfx, marker: marker, add: !!add });\n};\n\n\n/**\n * Adds a marker to an element (basically a css class).\n *\n * Fires the element.marker.update event, making it possible to\n * integrate extension into the marker life-cycle, too.\n *\n * @example\n * canvas.addMarker('foo', 'some-marker');\n *\n * var fooGfx = canvas.getGraphics('foo');\n *\n * fooGfx; // <g class=\"... some-marker\"> ... </g>\n *\n * @param {string|djs.model.Base} element\n * @param {string} marker\n */\nCanvas.prototype.addMarker = function(element, marker) {\n  this._updateMarker(element, marker, true);\n};\n\n\n/**\n * Remove a marker from an element.\n *\n * Fires the element.marker.update event, making it possible to\n * integrate extension into the marker life-cycle, too.\n *\n * @param  {string|djs.model.Base} element\n * @param  {string} marker\n */\nCanvas.prototype.removeMarker = function(element, marker) {\n  this._updateMarker(element, marker, false);\n};\n\n/**\n * Check the existence of a marker on element.\n *\n * @param  {string|djs.model.Base} element\n * @param  {string} marker\n */\nCanvas.prototype.hasMarker = function(element, marker) {\n  if (!element.id) {\n    element = this._elementRegistry.get(element);\n  }\n\n  var gfx = this.getGraphics(element);\n\n  return svgClasses(gfx).has(marker);\n};\n\n/**\n * Toggles a marker on an element.\n *\n * Fires the element.marker.update event, making it possible to\n * integrate extension into the marker life-cycle, too.\n *\n * @param  {string|djs.model.Base} element\n * @param  {string} marker\n */\nCanvas.prototype.toggleMarker = function(element, marker) {\n  if (this.hasMarker(element, marker)) {\n    this.removeMarker(element, marker);\n  } else {\n    this.addMarker(element, marker);\n  }\n};\n\nCanvas.prototype.getRootElement = function() {\n  if (!this._rootElement) {\n    this.setRootElement({ id: '__implicitroot', children: [] });\n  }\n\n  return this._rootElement;\n};\n\n\n\n// root element handling //////////////////////\n\n/**\n * Sets a given element as the new root element for the canvas\n * and returns the new root element.\n *\n * @param {Object|djs.model.Root} element\n * @param {boolean} [override] whether to override the current root element, if any\n *\n * @return {Object|djs.model.Root} new root element\n */\nCanvas.prototype.setRootElement = function(element, override) {\n\n  if (element) {\n    this._ensureValid('root', element);\n  }\n\n  var currentRoot = this._rootElement,\n      elementRegistry = this._elementRegistry,\n      eventBus = this._eventBus;\n\n  if (currentRoot) {\n    if (!override) {\n      throw new Error('rootElement already set, need to specify override');\n    }\n\n    // simulate element remove event sequence\n    eventBus.fire('root.remove', { element: currentRoot });\n    eventBus.fire('root.removed', { element: currentRoot });\n\n    elementRegistry.remove(currentRoot);\n  }\n\n  if (element) {\n    var gfx = this.getDefaultLayer();\n\n    // resemble element add event sequence\n    eventBus.fire('root.add', { element: element });\n\n    elementRegistry.add(element, gfx, this._svg);\n\n    eventBus.fire('root.added', { element: element, gfx: gfx });\n  }\n\n  this._rootElement = element;\n\n  return element;\n};\n\n\n\n// add functionality //////////////////////\n\nCanvas.prototype._ensureValid = function(type, element) {\n  if (!element.id) {\n    throw new Error('element must have an id');\n  }\n\n  if (this._elementRegistry.get(element.id)) {\n    throw new Error('element with id ' + element.id + ' already exists');\n  }\n\n  var requiredAttrs = REQUIRED_MODEL_ATTRS[type];\n\n  var valid = every(requiredAttrs, function(attr) {\n    return typeof element[attr] !== 'undefined';\n  });\n\n  if (!valid) {\n    throw new Error(\n      'must supply { ' + requiredAttrs.join(', ') + ' } with ' + type);\n  }\n};\n\nCanvas.prototype._setParent = function(element, parent, parentIndex) {\n  collectionAdd(parent.children, element, parentIndex);\n  element.parent = parent;\n};\n\n/**\n * Adds an element to the canvas.\n *\n * This wires the parent <-> child relationship between the element and\n * a explicitly specified parent or an implicit root element.\n *\n * During add it emits the events\n *\n *  * <{type}.add> (element, parent)\n *  * <{type}.added> (element, gfx)\n *\n * Extensions may hook into these events to perform their magic.\n *\n * @param {string} type\n * @param {Object|djs.model.Base} element\n * @param {Object|djs.model.Base} [parent]\n * @param {number} [parentIndex]\n *\n * @return {Object|djs.model.Base} the added element\n */\nCanvas.prototype._addElement = function(type, element, parent, parentIndex) {\n\n  parent = parent || this.getRootElement();\n\n  var eventBus = this._eventBus,\n      graphicsFactory = this._graphicsFactory;\n\n  this._ensureValid(type, element);\n\n  eventBus.fire(type + '.add', { element: element, parent: parent });\n\n  this._setParent(element, parent, parentIndex);\n\n  // create graphics\n  var gfx = graphicsFactory.create(type, element, parentIndex);\n\n  this._elementRegistry.add(element, gfx);\n\n  // update its visual\n  graphicsFactory.update(type, element, gfx);\n\n  eventBus.fire(type + '.added', { element: element, gfx: gfx });\n\n  return element;\n};\n\n/**\n * Adds a shape to the canvas\n *\n * @param {Object|djs.model.Shape} shape to add to the diagram\n * @param {djs.model.Base} [parent]\n * @param {number} [parentIndex]\n *\n * @return {djs.model.Shape} the added shape\n */\nCanvas.prototype.addShape = function(shape, parent, parentIndex) {\n  return this._addElement('shape', shape, parent, parentIndex);\n};\n\n/**\n * Adds a connection to the canvas\n *\n * @param {Object|djs.model.Connection} connection to add to the diagram\n * @param {djs.model.Base} [parent]\n * @param {number} [parentIndex]\n *\n * @return {djs.model.Connection} the added connection\n */\nCanvas.prototype.addConnection = function(connection, parent, parentIndex) {\n  return this._addElement('connection', connection, parent, parentIndex);\n};\n\n\n/**\n * Internal remove element\n */\nCanvas.prototype._removeElement = function(element, type) {\n\n  var elementRegistry = this._elementRegistry,\n      graphicsFactory = this._graphicsFactory,\n      eventBus = this._eventBus;\n\n  element = elementRegistry.get(element.id || element);\n\n  if (!element) {\n\n    // element was removed already\n    return;\n  }\n\n  eventBus.fire(type + '.remove', { element: element });\n\n  graphicsFactory.remove(element);\n\n  // unset parent <-> child relationship\n  collectionRemove(element.parent && element.parent.children, element);\n  element.parent = null;\n\n  eventBus.fire(type + '.removed', { element: element });\n\n  elementRegistry.remove(element);\n\n  return element;\n};\n\n\n/**\n * Removes a shape from the canvas\n *\n * @param {string|djs.model.Shape} shape or shape id to be removed\n *\n * @return {djs.model.Shape} the removed shape\n */\nCanvas.prototype.removeShape = function(shape) {\n\n  /**\n   * An event indicating that a shape is about to be removed from the canvas.\n   *\n   * @memberOf Canvas\n   *\n   * @event shape.remove\n   * @type {Object}\n   * @property {djs.model.Shape} element the shape descriptor\n   * @property {Object} gfx the graphical representation of the shape\n   */\n\n  /**\n   * An event indicating that a shape has been removed from the canvas.\n   *\n   * @memberOf Canvas\n   *\n   * @event shape.removed\n   * @type {Object}\n   * @property {djs.model.Shape} element the shape descriptor\n   * @property {Object} gfx the graphical representation of the shape\n   */\n  return this._removeElement(shape, 'shape');\n};\n\n\n/**\n * Removes a connection from the canvas\n *\n * @param {string|djs.model.Connection} connection or connection id to be removed\n *\n * @return {djs.model.Connection} the removed connection\n */\nCanvas.prototype.removeConnection = function(connection) {\n\n  /**\n   * An event indicating that a connection is about to be removed from the canvas.\n   *\n   * @memberOf Canvas\n   *\n   * @event connection.remove\n   * @type {Object}\n   * @property {djs.model.Connection} element the connection descriptor\n   * @property {Object} gfx the graphical representation of the connection\n   */\n\n  /**\n   * An event indicating that a connection has been removed from the canvas.\n   *\n   * @memberOf Canvas\n   *\n   * @event connection.removed\n   * @type {Object}\n   * @property {djs.model.Connection} element the connection descriptor\n   * @property {Object} gfx the graphical representation of the connection\n   */\n  return this._removeElement(connection, 'connection');\n};\n\n\n/**\n * Return the graphical object underlaying a certain diagram element\n *\n * @param {string|djs.model.Base} element descriptor of the element\n * @param {boolean} [secondary=false] whether to return the secondary connected element\n *\n * @return {SVGElement}\n */\nCanvas.prototype.getGraphics = function(element, secondary) {\n  return this._elementRegistry.getGraphics(element, secondary);\n};\n\n\n/**\n * Perform a viewbox update via a given change function.\n *\n * @param {Function} changeFn\n */\nCanvas.prototype._changeViewbox = function(changeFn) {\n\n  // notify others of the upcoming viewbox change\n  this._eventBus.fire('canvas.viewbox.changing');\n\n  // perform actual change\n  changeFn.apply(this);\n\n  // reset the cached viewbox so that\n  // a new get operation on viewbox or zoom\n  // triggers a viewbox re-computation\n  this._cachedViewbox = null;\n\n  // notify others of the change; this step\n  // may or may not be debounced\n  this._viewboxChanged();\n};\n\nCanvas.prototype._viewboxChanged = function() {\n  this._eventBus.fire('canvas.viewbox.changed', { viewbox: this.viewbox() });\n};\n\n\n/**\n * Gets or sets the view box of the canvas, i.e. the\n * area that is currently displayed.\n *\n * The getter may return a cached viewbox (if it is currently\n * changing). To force a recomputation, pass `false` as the first argument.\n *\n * @example\n *\n * canvas.viewbox({ x: 100, y: 100, width: 500, height: 500 })\n *\n * // sets the visible area of the diagram to (100|100) -> (600|100)\n * // and and scales it according to the diagram width\n *\n * var viewbox = canvas.viewbox(); // pass `false` to force recomputing the box.\n *\n * console.log(viewbox);\n * // {\n * //   inner: Dimensions,\n * //   outer: Dimensions,\n * //   scale,\n * //   x, y,\n * //   width, height\n * // }\n *\n * // if the current diagram is zoomed and scrolled, you may reset it to the\n * // default zoom via this method, too:\n *\n * var zoomedAndScrolledViewbox = canvas.viewbox();\n *\n * canvas.viewbox({\n *   x: 0,\n *   y: 0,\n *   width: zoomedAndScrolledViewbox.outer.width,\n *   height: zoomedAndScrolledViewbox.outer.height\n * });\n *\n * @param  {Object} [box] the new view box to set\n * @param  {number} box.x the top left X coordinate of the canvas visible in view box\n * @param  {number} box.y the top left Y coordinate of the canvas visible in view box\n * @param  {number} box.width the visible width\n * @param  {number} box.height\n *\n * @return {Object} the current view box\n */\nCanvas.prototype.viewbox = function(box) {\n\n  if (box === undefined && this._cachedViewbox) {\n    return this._cachedViewbox;\n  }\n\n  var viewport = this._viewport,\n      innerBox,\n      outerBox = this.getSize(),\n      matrix,\n      transform,\n      scale,\n      x, y;\n\n  if (!box) {\n\n    // compute the inner box based on the\n    // diagrams default layer. This allows us to exclude\n    // external components, such as overlays\n    innerBox = this.getDefaultLayer().getBBox();\n\n    transform = svgTransform(viewport);\n    matrix = transform ? transform.matrix : createMatrix();\n    scale = round(matrix.a, 1000);\n\n    x = round(-matrix.e || 0, 1000);\n    y = round(-matrix.f || 0, 1000);\n\n    box = this._cachedViewbox = {\n      x: x ? x / scale : 0,\n      y: y ? y / scale : 0,\n      width: outerBox.width / scale,\n      height: outerBox.height / scale,\n      scale: scale,\n      inner: {\n        width: innerBox.width,\n        height: innerBox.height,\n        x: innerBox.x,\n        y: innerBox.y\n      },\n      outer: outerBox\n    };\n\n    return box;\n  } else {\n\n    this._changeViewbox(function() {\n      scale = Math.min(outerBox.width / box.width, outerBox.height / box.height);\n\n      var matrix = this._svg.createSVGMatrix()\n        .scale(scale)\n        .translate(-box.x, -box.y);\n\n      svgTransform(viewport, matrix);\n    });\n  }\n\n  return box;\n};\n\n\n/**\n * Gets or sets the scroll of the canvas.\n *\n * @param {Object} [delta] the new scroll to apply.\n *\n * @param {number} [delta.dx]\n * @param {number} [delta.dy]\n */\nCanvas.prototype.scroll = function(delta) {\n\n  var node = this._viewport;\n  var matrix = node.getCTM();\n\n  if (delta) {\n    this._changeViewbox(function() {\n      delta = assign({ dx: 0, dy: 0 }, delta || {});\n\n      matrix = this._svg.createSVGMatrix().translate(delta.dx, delta.dy).multiply(matrix);\n\n      setCTM(node, matrix);\n    });\n  }\n\n  return { x: matrix.e, y: matrix.f };\n};\n\n\n/**\n * Gets or sets the current zoom of the canvas, optionally zooming\n * to the specified position.\n *\n * The getter may return a cached zoom level. Call it with `false` as\n * the first argument to force recomputation of the current level.\n *\n * @param {string|number} [newScale] the new zoom level, either a number, i.e. 0.9,\n *                                   or `fit-viewport` to adjust the size to fit the current viewport\n * @param {string|Point} [center] the reference point { x: .., y: ..} to zoom to, 'auto' to zoom into mid or null\n *\n * @return {number} the current scale\n */\nCanvas.prototype.zoom = function(newScale, center) {\n\n  if (!newScale) {\n    return this.viewbox(newScale).scale;\n  }\n\n  if (newScale === 'fit-viewport') {\n    return this._fitViewport(center);\n  }\n\n  var outer,\n      matrix;\n\n  this._changeViewbox(function() {\n\n    if (typeof center !== 'object') {\n      outer = this.viewbox().outer;\n\n      center = {\n        x: outer.width / 2,\n        y: outer.height / 2\n      };\n    }\n\n    matrix = this._setZoom(newScale, center);\n  });\n\n  return round(matrix.a, 1000);\n};\n\nfunction setCTM(node, m) {\n  var mstr = 'matrix(' + m.a + ',' + m.b + ',' + m.c + ',' + m.d + ',' + m.e + ',' + m.f + ')';\n  node.setAttribute('transform', mstr);\n}\n\nCanvas.prototype._fitViewport = function(center) {\n\n  var vbox = this.viewbox(),\n      outer = vbox.outer,\n      inner = vbox.inner,\n      newScale,\n      newViewbox;\n\n  // display the complete diagram without zooming in.\n  // instead of relying on internal zoom, we perform a\n  // hard reset on the canvas viewbox to realize this\n  //\n  // if diagram does not need to be zoomed in, we focus it around\n  // the diagram origin instead\n\n  if (inner.x >= 0 &&\n      inner.y >= 0 &&\n      inner.x + inner.width <= outer.width &&\n      inner.y + inner.height <= outer.height &&\n      !center) {\n\n    newViewbox = {\n      x: 0,\n      y: 0,\n      width: Math.max(inner.width + inner.x, outer.width),\n      height: Math.max(inner.height + inner.y, outer.height)\n    };\n  } else {\n\n    newScale = Math.min(1, outer.width / inner.width, outer.height / inner.height);\n    newViewbox = {\n      x: inner.x + (center ? inner.width / 2 - outer.width / newScale / 2 : 0),\n      y: inner.y + (center ? inner.height / 2 - outer.height / newScale / 2 : 0),\n      width: outer.width / newScale,\n      height: outer.height / newScale\n    };\n  }\n\n  this.viewbox(newViewbox);\n\n  return this.viewbox(false).scale;\n};\n\n\nCanvas.prototype._setZoom = function(scale, center) {\n\n  var svg = this._svg,\n      viewport = this._viewport;\n\n  var matrix = svg.createSVGMatrix();\n  var point = svg.createSVGPoint();\n\n  var centerPoint,\n      originalPoint,\n      currentMatrix,\n      scaleMatrix,\n      newMatrix;\n\n  currentMatrix = viewport.getCTM();\n\n  var currentScale = currentMatrix.a;\n\n  if (center) {\n    centerPoint = assign(point, center);\n\n    // revert applied viewport transformations\n    originalPoint = centerPoint.matrixTransform(currentMatrix.inverse());\n\n    // create scale matrix\n    scaleMatrix = matrix\n      .translate(originalPoint.x, originalPoint.y)\n      .scale(1 / currentScale * scale)\n      .translate(-originalPoint.x, -originalPoint.y);\n\n    newMatrix = currentMatrix.multiply(scaleMatrix);\n  } else {\n    newMatrix = matrix.scale(scale);\n  }\n\n  setCTM(this._viewport, newMatrix);\n\n  return newMatrix;\n};\n\n\n/**\n * Returns the size of the canvas\n *\n * @return {Dimensions}\n */\nCanvas.prototype.getSize = function() {\n  return {\n    width: this._container.clientWidth,\n    height: this._container.clientHeight\n  };\n};\n\n\n/**\n * Return the absolute bounding box for the given element\n *\n * The absolute bounding box may be used to display overlays in the\n * callers (browser) coordinate system rather than the zoomed in/out\n * canvas coordinates.\n *\n * @param  {ElementDescriptor} element\n * @return {Bounds} the absolute bounding box\n */\nCanvas.prototype.getAbsoluteBBox = function(element) {\n  var vbox = this.viewbox();\n  var bbox;\n\n  // connection\n  // use svg bbox\n  if (element.waypoints) {\n    var gfx = this.getGraphics(element);\n\n    bbox = gfx.getBBox();\n  }\n\n  // shapes\n  // use data\n  else {\n    bbox = element;\n  }\n\n  var x = bbox.x * vbox.scale - vbox.x * vbox.scale;\n  var y = bbox.y * vbox.scale - vbox.y * vbox.scale;\n\n  var width = bbox.width * vbox.scale;\n  var height = bbox.height * vbox.scale;\n\n  return {\n    x: x,\n    y: y,\n    width: width,\n    height: height\n  };\n};\n\n/**\n * Fires an event in order other modules can react to the\n * canvas resizing\n */\nCanvas.prototype.resized = function() {\n\n  // force recomputation of view box\n  delete this._cachedViewbox;\n\n  this._eventBus.fire('canvas.resized');\n};\n","var ELEMENT_ID = 'data-element-id';\n\nimport { attr as svgAttr } from 'tiny-svg';\n\n\n/**\n * @class\n *\n * A registry that keeps track of all shapes in the diagram.\n */\nexport default function ElementRegistry(eventBus) {\n  this._elements = {};\n\n  this._eventBus = eventBus;\n}\n\nElementRegistry.$inject = [ 'eventBus' ];\n\n/**\n * Register a pair of (element, gfx, (secondaryGfx)).\n *\n * @param {djs.model.Base} element\n * @param {SVGElement} gfx\n * @param {SVGElement} [secondaryGfx] optional other element to register, too\n */\nElementRegistry.prototype.add = function(element, gfx, secondaryGfx) {\n\n  var id = element.id;\n\n  this._validateId(id);\n\n  // associate dom node with element\n  svgAttr(gfx, ELEMENT_ID, id);\n\n  if (secondaryGfx) {\n    svgAttr(secondaryGfx, ELEMENT_ID, id);\n  }\n\n  this._elements[id] = { element: element, gfx: gfx, secondaryGfx: secondaryGfx };\n};\n\n/**\n * Removes an element from the registry.\n *\n * @param {djs.model.Base} element\n */\nElementRegistry.prototype.remove = function(element) {\n  var elements = this._elements,\n      id = element.id || element,\n      container = id && elements[id];\n\n  if (container) {\n\n    // unset element id on gfx\n    svgAttr(container.gfx, ELEMENT_ID, '');\n\n    if (container.secondaryGfx) {\n      svgAttr(container.secondaryGfx, ELEMENT_ID, '');\n    }\n\n    delete elements[id];\n  }\n};\n\n/**\n * Update the id of an element\n *\n * @param {djs.model.Base} element\n * @param {string} newId\n */\nElementRegistry.prototype.updateId = function(element, newId) {\n\n  this._validateId(newId);\n\n  if (typeof element === 'string') {\n    element = this.get(element);\n  }\n\n  this._eventBus.fire('element.updateId', {\n    element: element,\n    newId: newId\n  });\n\n  var gfx = this.getGraphics(element),\n      secondaryGfx = this.getGraphics(element, true);\n\n  this.remove(element);\n\n  element.id = newId;\n\n  this.add(element, gfx, secondaryGfx);\n};\n\n/**\n * Return the model element for a given id or graphics.\n *\n * @example\n *\n * elementRegistry.get('SomeElementId_1');\n * elementRegistry.get(gfx);\n *\n *\n * @param {string|SVGElement} filter for selecting the element\n *\n * @return {djs.model.Base}\n */\nElementRegistry.prototype.get = function(filter) {\n  var id;\n\n  if (typeof filter === 'string') {\n    id = filter;\n  } else {\n    id = filter && svgAttr(filter, ELEMENT_ID);\n  }\n\n  var container = this._elements[id];\n  return container && container.element;\n};\n\n/**\n * Return all elements that match a given filter function.\n *\n * @param {Function} fn\n *\n * @return {Array<djs.model.Base>}\n */\nElementRegistry.prototype.filter = function(fn) {\n\n  var filtered = [];\n\n  this.forEach(function(element, gfx) {\n    if (fn(element, gfx)) {\n      filtered.push(element);\n    }\n  });\n\n  return filtered;\n};\n\n/**\n * Return the first element that satisfies the provided testing function.\n *\n * @param {Function} fn\n *\n * @return {djs.model.Base}\n */\nElementRegistry.prototype.find = function(fn) {\n  var map = this._elements,\n      keys = Object.keys(map);\n\n  for (var i = 0; i < keys.length; i++) {\n    var id = keys[i],\n        container = map[id],\n        element = container.element,\n        gfx = container.gfx;\n\n    if (fn(element, gfx)) {\n      return element;\n    }\n  }\n};\n\n/**\n * Return all rendered model elements.\n *\n * @return {Array<djs.model.Base>}\n */\nElementRegistry.prototype.getAll = function() {\n  return this.filter(function(e) { return e; });\n};\n\n/**\n * Iterate over all diagram elements.\n *\n * @param {Function} fn\n */\nElementRegistry.prototype.forEach = function(fn) {\n\n  var map = this._elements;\n\n  Object.keys(map).forEach(function(id) {\n    var container = map[id],\n        element = container.element,\n        gfx = container.gfx;\n\n    return fn(element, gfx);\n  });\n};\n\n/**\n * Return the graphical representation of an element or its id.\n *\n * @example\n * elementRegistry.getGraphics('SomeElementId_1');\n * elementRegistry.getGraphics(rootElement); // <g ...>\n *\n * elementRegistry.getGraphics(rootElement, true); // <svg ...>\n *\n *\n * @param {string|djs.model.Base} filter\n * @param {boolean} [secondary=false] whether to return the secondary connected element\n *\n * @return {SVGElement}\n */\nElementRegistry.prototype.getGraphics = function(filter, secondary) {\n  var id = filter.id || filter;\n\n  var container = this._elements[id];\n  return container && (secondary ? container.secondaryGfx : container.gfx);\n};\n\n/**\n * Validate the suitability of the given id and signals a problem\n * with an exception.\n *\n * @param {string} id\n *\n * @throws {Error} if id is empty or already assigned\n */\nElementRegistry.prototype._validateId = function(id) {\n  if (!id) {\n    throw new Error('element must have an id');\n  }\n\n  if (this._elements[id]) {\n    throw new Error('element with id ' + id + ' already added');\n  }\n};\n","import { assign } from 'min-dash';\nimport inherits from 'inherits';\n\nimport Refs from 'object-refs';\n\nvar parentRefs = new Refs({ name: 'children', enumerable: true, collection: true }, { name: 'parent' }),\n    labelRefs = new Refs({ name: 'labels', enumerable: true, collection: true }, { name: 'labelTarget' }),\n    attacherRefs = new Refs({ name: 'attachers', collection: true }, { name: 'host' }),\n    outgoingRefs = new Refs({ name: 'outgoing', collection: true }, { name: 'source' }),\n    incomingRefs = new Refs({ name: 'incoming', collection: true }, { name: 'target' });\n\n/**\n * @namespace djs.model\n */\n\n/**\n * @memberOf djs.model\n */\n\n/**\n * The basic graphical representation\n *\n * @class\n *\n * @abstract\n */\nexport function Base() {\n\n  /**\n   * The object that backs up the shape\n   *\n   * @name Base#businessObject\n   * @type Object\n   */\n  Object.defineProperty(this, 'businessObject', {\n    writable: true\n  });\n\n\n  /**\n   * Single label support, will mapped to multi label array\n   *\n   * @name Base#label\n   * @type Object\n   */\n  Object.defineProperty(this, 'label', {\n    get: function() {\n      return this.labels[0];\n    },\n    set: function(newLabel) {\n\n      var label = this.label,\n          labels = this.labels;\n\n      if (!newLabel && label) {\n        labels.remove(label);\n      } else {\n        labels.add(newLabel, 0);\n      }\n    }\n  });\n\n  /**\n   * The parent shape\n   *\n   * @name Base#parent\n   * @type Shape\n   */\n  parentRefs.bind(this, 'parent');\n\n  /**\n   * The list of labels\n   *\n   * @name Base#labels\n   * @type Label\n   */\n  labelRefs.bind(this, 'labels');\n\n  /**\n   * The list of outgoing connections\n   *\n   * @name Base#outgoing\n   * @type Array<Connection>\n   */\n  outgoingRefs.bind(this, 'outgoing');\n\n  /**\n   * The list of incoming connections\n   *\n   * @name Base#incoming\n   * @type Array<Connection>\n   */\n  incomingRefs.bind(this, 'incoming');\n}\n\n\n/**\n * A graphical object\n *\n * @class\n * @constructor\n *\n * @extends Base\n */\nexport function Shape() {\n  Base.call(this);\n\n  /**\n   * Indicates frame shapes\n   *\n   * @name Shape#isFrame\n   * @type boolean\n   */\n\n  /**\n   * The list of children\n   *\n   * @name Shape#children\n   * @type Array<Base>\n   */\n  parentRefs.bind(this, 'children');\n\n  /**\n   * @name Shape#host\n   * @type Shape\n   */\n  attacherRefs.bind(this, 'host');\n\n  /**\n   * @name Shape#attachers\n   * @type Shape\n   */\n  attacherRefs.bind(this, 'attachers');\n}\n\ninherits(Shape, Base);\n\n\n/**\n * A root graphical object\n *\n * @class\n * @constructor\n *\n * @extends Shape\n */\nexport function Root() {\n  Shape.call(this);\n}\n\ninherits(Root, Shape);\n\n\n/**\n * A label for an element\n *\n * @class\n * @constructor\n *\n * @extends Shape\n */\nexport function Label() {\n  Shape.call(this);\n\n  /**\n   * The labeled element\n   *\n   * @name Label#labelTarget\n   * @type Base\n   */\n  labelRefs.bind(this, 'labelTarget');\n}\n\ninherits(Label, Shape);\n\n\n/**\n * A connection between two elements\n *\n * @class\n * @constructor\n *\n * @extends Base\n */\nexport function Connection() {\n  Base.call(this);\n\n  /**\n   * The element this connection originates from\n   *\n   * @name Connection#source\n   * @type Base\n   */\n  outgoingRefs.bind(this, 'source');\n\n  /**\n   * The element this connection points to\n   *\n   * @name Connection#target\n   * @type Base\n   */\n  incomingRefs.bind(this, 'target');\n}\n\ninherits(Connection, Base);\n\n\nvar types = {\n  connection: Connection,\n  shape: Shape,\n  label: Label,\n  root: Root\n};\n\n/**\n * Creates a new model element of the specified type\n *\n * @method create\n *\n * @example\n *\n * var shape1 = Model.create('shape', { x: 10, y: 10, width: 100, height: 100 });\n * var shape2 = Model.create('shape', { x: 210, y: 210, width: 100, height: 100 });\n *\n * var connection = Model.create('connection', { waypoints: [ { x: 110, y: 55 }, {x: 210, y: 55 } ] });\n *\n * @param  {string} type lower-cased model name\n * @param  {Object} attrs attributes to initialize the new model instance with\n *\n * @return {Base} the new model instance\n */\nexport function create(type, attrs) {\n  var Type = types[type];\n  if (!Type) {\n    throw new Error('unknown type: <' + type + '>');\n  }\n  return assign(new Type(), attrs);\n}","import {\n  create\n} from '../model';\n\nimport { assign } from 'min-dash';\n\n/**\n * A factory for diagram-js shapes\n */\nexport default function ElementFactory() {\n  this._uid = 12;\n}\n\n\nElementFactory.prototype.createRoot = function(attrs) {\n  return this.create('root', attrs);\n};\n\nElementFactory.prototype.createLabel = function(attrs) {\n  return this.create('label', attrs);\n};\n\nElementFactory.prototype.createShape = function(attrs) {\n  return this.create('shape', attrs);\n};\n\nElementFactory.prototype.createConnection = function(attrs) {\n  return this.create('connection', attrs);\n};\n\n/**\n * Create a model element with the given type and\n * a number of pre-set attributes.\n *\n * @param  {string} type\n * @param  {Object} attrs\n * @return {djs.model.Base} the newly created model instance\n */\nElementFactory.prototype.create = function(type, attrs) {\n\n  attrs = assign({}, attrs || {});\n\n  if (!attrs.id) {\n    attrs.id = type + '_' + (this._uid++);\n  }\n\n  return create(type, attrs);\n};","import {\n  isFunction,\n  isArray,\n  isNumber,\n  bind,\n  assign\n} from 'min-dash';\n\nvar FN_REF = '__fn';\n\nvar DEFAULT_PRIORITY = 1000;\n\nvar slice = Array.prototype.slice;\n\n/**\n * A general purpose event bus.\n *\n * This component is used to communicate across a diagram instance.\n * Other parts of a diagram can use it to listen to and broadcast events.\n *\n *\n * ## Registering for Events\n *\n * The event bus provides the {@link EventBus#on} and {@link EventBus#once}\n * methods to register for events. {@link EventBus#off} can be used to\n * remove event registrations. Listeners receive an instance of {@link Event}\n * as the first argument. It allows them to hook into the event execution.\n *\n * ```javascript\n *\n * // listen for event\n * eventBus.on('foo', function(event) {\n *\n *   // access event type\n *   event.type; // 'foo'\n *\n *   // stop propagation to other listeners\n *   event.stopPropagation();\n *\n *   // prevent event default\n *   event.preventDefault();\n * });\n *\n * // listen for event with custom payload\n * eventBus.on('bar', function(event, payload) {\n *   console.log(payload);\n * });\n *\n * // listen for event returning value\n * eventBus.on('foobar', function(event) {\n *\n *   // stop event propagation + prevent default\n *   return false;\n *\n *   // stop event propagation + return custom result\n *   return {\n *     complex: 'listening result'\n *   };\n * });\n *\n *\n * // listen with custom priority (default=1000, higher is better)\n * eventBus.on('priorityfoo', 1500, function(event) {\n *   console.log('invoked first!');\n * });\n *\n *\n * // listen for event and pass the context (`this`)\n * eventBus.on('foobar', function(event) {\n *   this.foo();\n * }, this);\n * ```\n *\n *\n * ## Emitting Events\n *\n * Events can be emitted via the event bus using {@link EventBus#fire}.\n *\n * ```javascript\n *\n * // false indicates that the default action\n * // was prevented by listeners\n * if (eventBus.fire('foo') === false) {\n *   console.log('default has been prevented!');\n * };\n *\n *\n * // custom args + return value listener\n * eventBus.on('sum', function(event, a, b) {\n *   return a + b;\n * });\n *\n * // you can pass custom arguments + retrieve result values.\n * var sum = eventBus.fire('sum', 1, 2);\n * console.log(sum); // 3\n * ```\n */\nexport default function EventBus() {\n  this._listeners = {};\n\n  // cleanup on destroy on lowest priority to allow\n  // message passing until the bitter end\n  this.on('diagram.destroy', 1, this._destroy, this);\n}\n\n\n/**\n * Register an event listener for events with the given name.\n *\n * The callback will be invoked with `event, ...additionalArguments`\n * that have been passed to {@link EventBus#fire}.\n *\n * Returning false from a listener will prevent the events default action\n * (if any is specified). To stop an event from being processed further in\n * other listeners execute {@link Event#stopPropagation}.\n *\n * Returning anything but `undefined` from a listener will stop the listener propagation.\n *\n * @param {string|Array<string>} events\n * @param {number} [priority=1000] the priority in which this listener is called, larger is higher\n * @param {Function} callback\n * @param {Object} [that] Pass context (`this`) to the callback\n */\nEventBus.prototype.on = function(events, priority, callback, that) {\n\n  events = isArray(events) ? events : [ events ];\n\n  if (isFunction(priority)) {\n    that = callback;\n    callback = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (!isNumber(priority)) {\n    throw new Error('priority must be a number');\n  }\n\n  var actualCallback = callback;\n\n  if (that) {\n    actualCallback = bind(callback, that);\n\n    // make sure we remember and are able to remove\n    // bound callbacks via {@link #off} using the original\n    // callback\n    actualCallback[FN_REF] = callback[FN_REF] || callback;\n  }\n\n  var self = this;\n\n  events.forEach(function(e) {\n    self._addListener(e, {\n      priority: priority,\n      callback: actualCallback,\n      next: null\n    });\n  });\n};\n\n\n/**\n * Register an event listener that is executed only once.\n *\n * @param {string} event the event name to register for\n * @param {number} [priority=1000] the priority in which this listener is called, larger is higher\n * @param {Function} callback the callback to execute\n * @param {Object} [that] Pass context (`this`) to the callback\n */\nEventBus.prototype.once = function(event, priority, callback, that) {\n  var self = this;\n\n  if (isFunction(priority)) {\n    that = callback;\n    callback = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (!isNumber(priority)) {\n    throw new Error('priority must be a number');\n  }\n\n  function wrappedCallback() {\n    var result = callback.apply(that, arguments);\n\n    self.off(event, wrappedCallback);\n\n    return result;\n  }\n\n  // make sure we remember and are able to remove\n  // bound callbacks via {@link #off} using the original\n  // callback\n  wrappedCallback[FN_REF] = callback;\n\n  this.on(event, priority, wrappedCallback);\n};\n\n\n/**\n * Removes event listeners by event and callback.\n *\n * If no callback is given, all listeners for a given event name are being removed.\n *\n * @param {string|Array<string>} events\n * @param {Function} [callback]\n */\nEventBus.prototype.off = function(events, callback) {\n\n  events = isArray(events) ? events : [ events ];\n\n  var self = this;\n\n  events.forEach(function(event) {\n    self._removeListener(event, callback);\n  });\n\n};\n\n\n/**\n * Create an EventBus event.\n *\n * @param {Object} data\n *\n * @return {Object} event, recognized by the eventBus\n */\nEventBus.prototype.createEvent = function(data) {\n  var event = new InternalEvent();\n\n  event.init(data);\n\n  return event;\n};\n\n\n/**\n * Fires a named event.\n *\n * @example\n *\n * // fire event by name\n * events.fire('foo');\n *\n * // fire event object with nested type\n * var event = { type: 'foo' };\n * events.fire(event);\n *\n * // fire event with explicit type\n * var event = { x: 10, y: 20 };\n * events.fire('element.moved', event);\n *\n * // pass additional arguments to the event\n * events.on('foo', function(event, bar) {\n *   alert(bar);\n * });\n *\n * events.fire({ type: 'foo' }, 'I am bar!');\n *\n * @param {string} [name] the optional event name\n * @param {Object} [event] the event object\n * @param {...Object} additional arguments to be passed to the callback functions\n *\n * @return {boolean} the events return value, if specified or false if the\n *                   default action was prevented by listeners\n */\nEventBus.prototype.fire = function(type, data) {\n  var event,\n      firstListener,\n      returnValue,\n      args;\n\n  args = slice.call(arguments);\n\n  if (typeof type === 'object') {\n    data = type;\n    type = data.type;\n  }\n\n  if (!type) {\n    throw new Error('no event type specified');\n  }\n\n  firstListener = this._listeners[type];\n\n  if (!firstListener) {\n    return;\n  }\n\n  // we make sure we fire instances of our home made\n  // events here. We wrap them only once, though\n  if (data instanceof InternalEvent) {\n\n    // we are fine, we alread have an event\n    event = data;\n  } else {\n    event = this.createEvent(data);\n  }\n\n  // ensure we pass the event as the first parameter\n  args[0] = event;\n\n  // original event type (in case we delegate)\n  var originalType = event.type;\n\n  // update event type before delegation\n  if (type !== originalType) {\n    event.type = type;\n  }\n\n  try {\n    returnValue = this._invokeListeners(event, args, firstListener);\n  } finally {\n\n    // reset event type after delegation\n    if (type !== originalType) {\n      event.type = originalType;\n    }\n  }\n\n  // set the return value to false if the event default\n  // got prevented and no other return value exists\n  if (returnValue === undefined && event.defaultPrevented) {\n    returnValue = false;\n  }\n\n  return returnValue;\n};\n\n\nEventBus.prototype.handleError = function(error) {\n  return this.fire('error', { error: error }) === false;\n};\n\n\nEventBus.prototype._destroy = function() {\n  this._listeners = {};\n};\n\nEventBus.prototype._invokeListeners = function(event, args, listener) {\n\n  var returnValue;\n\n  while (listener) {\n\n    // handle stopped propagation\n    if (event.cancelBubble) {\n      break;\n    }\n\n    returnValue = this._invokeListener(event, args, listener);\n\n    listener = listener.next;\n  }\n\n  return returnValue;\n};\n\nEventBus.prototype._invokeListener = function(event, args, listener) {\n\n  var returnValue;\n\n  try {\n\n    // returning false prevents the default action\n    returnValue = invokeFunction(listener.callback, args);\n\n    // stop propagation on return value\n    if (returnValue !== undefined) {\n      event.returnValue = returnValue;\n      event.stopPropagation();\n    }\n\n    // prevent default on return false\n    if (returnValue === false) {\n      event.preventDefault();\n    }\n  } catch (e) {\n    if (!this.handleError(e)) {\n      console.error('unhandled error in event listener');\n      console.error(e.stack);\n\n      throw e;\n    }\n  }\n\n  return returnValue;\n};\n\n/*\n * Add new listener with a certain priority to the list\n * of listeners (for the given event).\n *\n * The semantics of listener registration / listener execution are\n * first register, first serve: New listeners will always be inserted\n * after existing listeners with the same priority.\n *\n * Example: Inserting two listeners with priority 1000 and 1300\n *\n *    * before: [ 1500, 1500, 1000, 1000 ]\n *    * after: [ 1500, 1500, (new=1300), 1000, 1000, (new=1000) ]\n *\n * @param {string} event\n * @param {Object} listener { priority, callback }\n */\nEventBus.prototype._addListener = function(event, newListener) {\n\n  var listener = this._getListeners(event),\n      previousListener;\n\n  // no prior listeners\n  if (!listener) {\n    this._setListeners(event, newListener);\n\n    return;\n  }\n\n  // ensure we order listeners by priority from\n  // 0 (high) to n > 0 (low)\n  while (listener) {\n\n    if (listener.priority < newListener.priority) {\n\n      newListener.next = listener;\n\n      if (previousListener) {\n        previousListener.next = newListener;\n      } else {\n        this._setListeners(event, newListener);\n      }\n\n      return;\n    }\n\n    previousListener = listener;\n    listener = listener.next;\n  }\n\n  // add new listener to back\n  previousListener.next = newListener;\n};\n\n\nEventBus.prototype._getListeners = function(name) {\n  return this._listeners[name];\n};\n\nEventBus.prototype._setListeners = function(name, listener) {\n  this._listeners[name] = listener;\n};\n\nEventBus.prototype._removeListener = function(event, callback) {\n\n  var listener = this._getListeners(event),\n      nextListener,\n      previousListener,\n      listenerCallback;\n\n  if (!callback) {\n\n    // clear listeners\n    this._setListeners(event, null);\n\n    return;\n  }\n\n  while (listener) {\n\n    nextListener = listener.next;\n\n    listenerCallback = listener.callback;\n\n    if (listenerCallback === callback || listenerCallback[FN_REF] === callback) {\n      if (previousListener) {\n        previousListener.next = nextListener;\n      } else {\n\n        // new first listener\n        this._setListeners(event, nextListener);\n      }\n    }\n\n    previousListener = listener;\n    listener = nextListener;\n  }\n};\n\n/**\n * A event that is emitted via the event bus.\n */\nfunction InternalEvent() { }\n\nInternalEvent.prototype.stopPropagation = function() {\n  this.cancelBubble = true;\n};\n\nInternalEvent.prototype.preventDefault = function() {\n  this.defaultPrevented = true;\n};\n\nInternalEvent.prototype.init = function(data) {\n  assign(this, data || {});\n};\n\n\n/**\n * Invoke function. Be fast...\n *\n * @param {Function} fn\n * @param {Array<Object>} args\n *\n * @return {Any}\n */\nfunction invokeFunction(fn, args) {\n  return fn.apply(null, args);\n}\n","/**\n * SVGs for elements are generated by the {@link GraphicsFactory}.\n *\n * This utility gives quick access to the important semantic\n * parts of an element.\n */\n\n/**\n * Returns the visual part of a diagram element\n *\n * @param {Snap<SVGElement>} gfx\n *\n * @return {Snap<SVGElement>}\n */\nexport function getVisual(gfx) {\n  return gfx.childNodes[0];\n}\n\n/**\n * Returns the children for a given diagram element.\n *\n * @param {Snap<SVGElement>} gfx\n * @return {Snap<SVGElement>}\n */\nexport function getChildren(gfx) {\n  return gfx.parentNode.childNodes[1];\n}","import {\r\n  transform as svgTransform,\r\n  createTransform\r\n} from 'tiny-svg';\r\n\r\n\r\n/**\r\n * @param {<SVGElement>} element\r\n * @param {number} x\r\n * @param {number} y\r\n * @param {number} angle\r\n * @param {number} amount\r\n */\r\nexport function transform(gfx, x, y, angle, amount) {\r\n  var translate = createTransform();\r\n  translate.setTranslate(x, y);\r\n\r\n  var rotate = createTransform();\r\n  rotate.setRotate(angle || 0, 0, 0);\r\n\r\n  var scale = createTransform();\r\n  scale.setScale(amount || 1, amount || 1);\r\n\r\n  svgTransform(gfx, [ translate, rotate, scale ]);\r\n}\r\n\r\n\r\n/**\r\n * @param {SVGElement} element\r\n * @param {number} x\r\n * @param {number} y\r\n */\r\nexport function translate(gfx, x, y) {\r\n  var translate = createTransform();\r\n  translate.setTranslate(x, y);\r\n\r\n  svgTransform(gfx, translate);\r\n}\r\n\r\n\r\n/**\r\n * @param {SVGElement} element\r\n * @param {number} angle\r\n */\r\nexport function rotate(gfx, angle) {\r\n  var rotate = createTransform();\r\n  rotate.setRotate(angle, 0, 0);\r\n\r\n  svgTransform(gfx, rotate);\r\n}\r\n\r\n\r\n/**\r\n * @param {SVGElement} element\r\n * @param {number} amount\r\n */\r\nexport function scale(gfx, amount) {\r\n  var scale = createTransform();\r\n  scale.setScale(amount, amount);\r\n\r\n  svgTransform(gfx, scale);\r\n}","/**\n * Set attribute `name` to `val`, or get attr `name`.\n *\n * @param {Element} el\n * @param {String} name\n * @param {String} [val]\n * @api public\n */\nfunction attr(el, name, val) {\n  // get\n  if (arguments.length == 2) {\n    return el.getAttribute(name);\n  }\n\n  // remove\n  if (val === null) {\n    return el.removeAttribute(name);\n  }\n\n  // set\n  el.setAttribute(name, val);\n\n  return el;\n}\n\nvar indexOf = [].indexOf;\n\nvar indexof = function(arr, obj){\n  if (indexOf) return arr.indexOf(obj);\n  for (var i = 0; i < arr.length; ++i) {\n    if (arr[i] === obj) return i;\n  }\n  return -1;\n};\n\n/**\n * Taken from https://github.com/component/classes\n *\n * Without the component bits.\n */\n\n/**\n * Whitespace regexp.\n */\n\nvar re = /\\s+/;\n\n/**\n * toString reference.\n */\n\nvar toString = Object.prototype.toString;\n\n/**\n * Wrap `el` in a `ClassList`.\n *\n * @param {Element} el\n * @return {ClassList}\n * @api public\n */\n\nfunction classes(el) {\n  return new ClassList(el);\n}\n\n/**\n * Initialize a new ClassList for `el`.\n *\n * @param {Element} el\n * @api private\n */\n\nfunction ClassList(el) {\n  if (!el || !el.nodeType) {\n    throw new Error('A DOM element reference is required');\n  }\n  this.el = el;\n  this.list = el.classList;\n}\n\n/**\n * Add class `name` if not already present.\n *\n * @param {String} name\n * @return {ClassList}\n * @api public\n */\n\nClassList.prototype.add = function (name) {\n  // classList\n  if (this.list) {\n    this.list.add(name);\n    return this;\n  }\n\n  // fallback\n  var arr = this.array();\n  var i = indexof(arr, name);\n  if (!~i) arr.push(name);\n  this.el.className = arr.join(' ');\n  return this;\n};\n\n/**\n * Remove class `name` when present, or\n * pass a regular expression to remove\n * any which match.\n *\n * @param {String|RegExp} name\n * @return {ClassList}\n * @api public\n */\n\nClassList.prototype.remove = function (name) {\n  if ('[object RegExp]' == toString.call(name)) {\n    return this.removeMatching(name);\n  }\n\n  // classList\n  if (this.list) {\n    this.list.remove(name);\n    return this;\n  }\n\n  // fallback\n  var arr = this.array();\n  var i = indexof(arr, name);\n  if (~i) arr.splice(i, 1);\n  this.el.className = arr.join(' ');\n  return this;\n};\n\n/**\n * Remove all classes matching `re`.\n *\n * @param {RegExp} re\n * @return {ClassList}\n * @api private\n */\n\nClassList.prototype.removeMatching = function (re) {\n  var arr = this.array();\n  for (var i = 0; i < arr.length; i++) {\n    if (re.test(arr[i])) {\n      this.remove(arr[i]);\n    }\n  }\n  return this;\n};\n\n/**\n * Toggle class `name`, can force state via `force`.\n *\n * For browsers that support classList, but do not support `force` yet,\n * the mistake will be detected and corrected.\n *\n * @param {String} name\n * @param {Boolean} force\n * @return {ClassList}\n * @api public\n */\n\nClassList.prototype.toggle = function (name, force) {\n  // classList\n  if (this.list) {\n    if ('undefined' !== typeof force) {\n      if (force !== this.list.toggle(name, force)) {\n        this.list.toggle(name); // toggle again to correct\n      }\n    } else {\n      this.list.toggle(name);\n    }\n    return this;\n  }\n\n  // fallback\n  if ('undefined' !== typeof force) {\n    if (!force) {\n      this.remove(name);\n    } else {\n      this.add(name);\n    }\n  } else {\n    if (this.has(name)) {\n      this.remove(name);\n    } else {\n      this.add(name);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Return an array of classes.\n *\n * @return {Array}\n * @api public\n */\n\nClassList.prototype.array = function () {\n  var className = this.el.getAttribute('class') || '';\n  var str = className.replace(/^\\s+|\\s+$/g, '');\n  var arr = str.split(re);\n  if ('' === arr[0]) arr.shift();\n  return arr;\n};\n\n/**\n * Check if class `name` is present.\n *\n * @param {String} name\n * @return {ClassList}\n * @api public\n */\n\nClassList.prototype.has = ClassList.prototype.contains = function (name) {\n  return this.list ? this.list.contains(name) : !!~indexof(this.array(), name);\n};\n\n/**\n * Remove all children from the given element.\n */\nfunction clear(el) {\n\n  var c;\n\n  while (el.childNodes.length) {\n    c = el.childNodes[0];\n    el.removeChild(c);\n  }\n\n  return el;\n}\n\nvar proto = typeof Element !== 'undefined' ? Element.prototype : {};\nvar vendor = proto.matches\n  || proto.matchesSelector\n  || proto.webkitMatchesSelector\n  || proto.mozMatchesSelector\n  || proto.msMatchesSelector\n  || proto.oMatchesSelector;\n\nvar matchesSelector = match;\n\n/**\n * Match `el` to `selector`.\n *\n * @param {Element} el\n * @param {String} selector\n * @return {Boolean}\n * @api public\n */\n\nfunction match(el, selector) {\n  if (!el || el.nodeType !== 1) return false;\n  if (vendor) return vendor.call(el, selector);\n  var nodes = el.parentNode.querySelectorAll(selector);\n  for (var i = 0; i < nodes.length; i++) {\n    if (nodes[i] == el) return true;\n  }\n  return false;\n}\n\n/**\n * Closest\n *\n * @param {Element} el\n * @param {String} selector\n * @param {Boolean} checkYourSelf (optional)\n */\nfunction closest (element, selector, checkYourSelf) {\n  var currentElem = checkYourSelf ? element : element.parentNode;\n\n  while (currentElem && currentElem.nodeType !== document.DOCUMENT_NODE && currentElem.nodeType !== document.DOCUMENT_FRAGMENT_NODE) {\n\n    if (matchesSelector(currentElem, selector)) {\n      return currentElem;\n    }\n\n    currentElem = currentElem.parentNode;\n  }\n\n  return matchesSelector(currentElem, selector) ? currentElem : null;\n}\n\nvar bind = window.addEventListener ? 'addEventListener' : 'attachEvent',\n    unbind = window.removeEventListener ? 'removeEventListener' : 'detachEvent',\n    prefix = bind !== 'addEventListener' ? 'on' : '';\n\n/**\n * Bind `el` event `type` to `fn`.\n *\n * @param {Element} el\n * @param {String} type\n * @param {Function} fn\n * @param {Boolean} capture\n * @return {Function}\n * @api public\n */\n\nvar bind_1 = function(el, type, fn, capture){\n  el[bind](prefix + type, fn, capture || false);\n  return fn;\n};\n\n/**\n * Unbind `el` event `type`'s callback `fn`.\n *\n * @param {Element} el\n * @param {String} type\n * @param {Function} fn\n * @param {Boolean} capture\n * @return {Function}\n * @api public\n */\n\nvar unbind_1 = function(el, type, fn, capture){\n  el[unbind](prefix + type, fn, capture || false);\n  return fn;\n};\n\nvar componentEvent = {\n\tbind: bind_1,\n\tunbind: unbind_1\n};\n\n/**\n * Module dependencies.\n */\n\n/**\n * Delegate event `type` to `selector`\n * and invoke `fn(e)`. A callback function\n * is returned which may be passed to `.unbind()`.\n *\n * @param {Element} el\n * @param {String} selector\n * @param {String} type\n * @param {Function} fn\n * @param {Boolean} capture\n * @return {Function}\n * @api public\n */\n\n// Some events don't bubble, so we want to bind to the capture phase instead\n// when delegating.\nvar forceCaptureEvents = ['focus', 'blur'];\n\nfunction bind$1(el, selector, type, fn, capture) {\n  if (forceCaptureEvents.indexOf(type) !== -1) {\n    capture = true;\n  }\n\n  return componentEvent.bind(el, type, function (e) {\n    var target = e.target || e.srcElement;\n    e.delegateTarget = closest(target, selector, true, el);\n    if (e.delegateTarget) {\n      fn.call(el, e);\n    }\n  }, capture);\n}\n\n/**\n * Unbind event `type`'s callback `fn`.\n *\n * @param {Element} el\n * @param {String} type\n * @param {Function} fn\n * @param {Boolean} capture\n * @api public\n */\nfunction unbind$1(el, type, fn, capture) {\n  if (forceCaptureEvents.indexOf(type) !== -1) {\n    capture = true;\n  }\n\n  return componentEvent.unbind(el, type, fn, capture);\n}\n\nvar delegate = {\n  bind: bind$1,\n  unbind: unbind$1\n};\n\n/**\n * Expose `parse`.\n */\n\nvar domify = parse;\n\n/**\n * Tests for browser support.\n */\n\nvar innerHTMLBug = false;\nvar bugTestDiv;\nif (typeof document !== 'undefined') {\n  bugTestDiv = document.createElement('div');\n  // Setup\n  bugTestDiv.innerHTML = '  <link/><table></table><a href=\"/a\">a</a><input type=\"checkbox\"/>';\n  // Make sure that link elements get serialized correctly by innerHTML\n  // This requires a wrapper element in IE\n  innerHTMLBug = !bugTestDiv.getElementsByTagName('link').length;\n  bugTestDiv = undefined;\n}\n\n/**\n * Wrap map from jquery.\n */\n\nvar map = {\n  legend: [1, '<fieldset>', '</fieldset>'],\n  tr: [2, '<table><tbody>', '</tbody></table>'],\n  col: [2, '<table><tbody></tbody><colgroup>', '</colgroup></table>'],\n  // for script/link/style tags to work in IE6-8, you have to wrap\n  // in a div with a non-whitespace character in front, ha!\n  _default: innerHTMLBug ? [1, 'X<div>', '</div>'] : [0, '', '']\n};\n\nmap.td =\nmap.th = [3, '<table><tbody><tr>', '</tr></tbody></table>'];\n\nmap.option =\nmap.optgroup = [1, '<select multiple=\"multiple\">', '</select>'];\n\nmap.thead =\nmap.tbody =\nmap.colgroup =\nmap.caption =\nmap.tfoot = [1, '<table>', '</table>'];\n\nmap.polyline =\nmap.ellipse =\nmap.polygon =\nmap.circle =\nmap.text =\nmap.line =\nmap.path =\nmap.rect =\nmap.g = [1, '<svg xmlns=\"http://www.w3.org/2000/svg\" version=\"1.1\">','</svg>'];\n\n/**\n * Parse `html` and return a DOM Node instance, which could be a TextNode,\n * HTML DOM Node of some kind (<div> for example), or a DocumentFragment\n * instance, depending on the contents of the `html` string.\n *\n * @param {String} html - HTML string to \"domify\"\n * @param {Document} doc - The `document` instance to create the Node for\n * @return {DOMNode} the TextNode, DOM Node, or DocumentFragment instance\n * @api private\n */\n\nfunction parse(html, doc) {\n  if ('string' != typeof html) throw new TypeError('String expected');\n\n  // default to the global `document` object\n  if (!doc) doc = document;\n\n  // tag name\n  var m = /<([\\w:]+)/.exec(html);\n  if (!m) return doc.createTextNode(html);\n\n  html = html.replace(/^\\s+|\\s+$/g, ''); // Remove leading/trailing whitespace\n\n  var tag = m[1];\n\n  // body support\n  if (tag == 'body') {\n    var el = doc.createElement('html');\n    el.innerHTML = html;\n    return el.removeChild(el.lastChild);\n  }\n\n  // wrap map\n  var wrap = map[tag] || map._default;\n  var depth = wrap[0];\n  var prefix = wrap[1];\n  var suffix = wrap[2];\n  var el = doc.createElement('div');\n  el.innerHTML = prefix + html + suffix;\n  while (depth--) el = el.lastChild;\n\n  // one element\n  if (el.firstChild == el.lastChild) {\n    return el.removeChild(el.firstChild);\n  }\n\n  // several elements\n  var fragment = doc.createDocumentFragment();\n  while (el.firstChild) {\n    fragment.appendChild(el.removeChild(el.firstChild));\n  }\n\n  return fragment;\n}\n\nfunction query(selector, el) {\n  el = el || document;\n\n  return el.querySelector(selector);\n}\n\nfunction all(selector, el) {\n  el = el || document;\n\n  return el.querySelectorAll(selector);\n}\n\nfunction remove(el) {\n  el.parentNode && el.parentNode.removeChild(el);\n}\n\nexport { attr, classes, clear, closest, delegate, domify, componentEvent as event, matchesSelector as matches, query, all as queryAll, remove };\n","import {\n  forEach,\n  reduce\n} from 'min-dash';\n\nimport {\n  getChildren,\n  getVisual\n} from '../util/GraphicsUtil';\n\nimport { translate } from '../util/SvgTransformUtil';\n\nimport { clear as domClear } from 'min-dom';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  isFrameElement\n} from '../util/Elements';\n\n/**\n * A factory that creates graphical elements\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n */\nexport default function GraphicsFactory(eventBus, elementRegistry) {\n  this._eventBus = eventBus;\n  this._elementRegistry = elementRegistry;\n}\n\nGraphicsFactory.$inject = [ 'eventBus' , 'elementRegistry' ];\n\n\nGraphicsFactory.prototype._getChildrenContainer = function(element) {\n\n  var gfx = this._elementRegistry.getGraphics(element);\n\n  var childrenGfx;\n\n  // root element\n  if (!element.parent) {\n    childrenGfx = gfx;\n  } else {\n    childrenGfx = getChildren(gfx);\n    if (!childrenGfx) {\n      childrenGfx = svgCreate('g');\n      svgClasses(childrenGfx).add('djs-children');\n\n      svgAppend(gfx.parentNode, childrenGfx);\n    }\n  }\n\n  return childrenGfx;\n};\n\n/**\n * Clears the graphical representation of the element and returns the\n * cleared visual (the <g class=\"djs-visual\" /> element).\n */\nGraphicsFactory.prototype._clear = function(gfx) {\n  var visual = getVisual(gfx);\n\n  domClear(visual);\n\n  return visual;\n};\n\n/**\n * Creates a gfx container for shapes and connections\n *\n * The layout is as follows:\n *\n * <g class=\"djs-group\">\n *\n *   <!-- the gfx -->\n *   <g class=\"djs-element djs-(shape|connection|frame)\">\n *     <g class=\"djs-visual\">\n *       <!-- the renderer draws in here -->\n *     </g>\n *\n *     <!-- extensions (overlays, click box, ...) goes here\n *   </g>\n *\n *   <!-- the gfx child nodes -->\n *   <g class=\"djs-children\"></g>\n * </g>\n *\n * @param {string} type the type of the element, i.e. shape | connection\n * @param {SVGElement} [childrenGfx]\n * @param {number} [parentIndex] position to create container in parent\n * @param {boolean} [isFrame] is frame element\n *\n * @return {SVGElement}\n */\nGraphicsFactory.prototype._createContainer = function(\n    type, childrenGfx, parentIndex, isFrame\n) {\n  var outerGfx = svgCreate('g');\n  svgClasses(outerGfx).add('djs-group');\n\n  // insert node at position\n  if (typeof parentIndex !== 'undefined') {\n    prependTo(outerGfx, childrenGfx, childrenGfx.childNodes[parentIndex]);\n  } else {\n    svgAppend(childrenGfx, outerGfx);\n  }\n\n  var gfx = svgCreate('g');\n  svgClasses(gfx).add('djs-element');\n  svgClasses(gfx).add('djs-' + type);\n\n  if (isFrame) {\n    svgClasses(gfx).add('djs-frame');\n  }\n\n  svgAppend(outerGfx, gfx);\n\n  // create visual\n  var visual = svgCreate('g');\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(gfx, visual);\n\n  return gfx;\n};\n\nGraphicsFactory.prototype.create = function(type, element, parentIndex) {\n  var childrenGfx = this._getChildrenContainer(element.parent);\n  return this._createContainer(type, childrenGfx, parentIndex, isFrameElement(element));\n};\n\nGraphicsFactory.prototype.updateContainments = function(elements) {\n\n  var self = this,\n      elementRegistry = this._elementRegistry,\n      parents;\n\n  parents = reduce(elements, function(map, e) {\n\n    if (e.parent) {\n      map[e.parent.id] = e.parent;\n    }\n\n    return map;\n  }, {});\n\n  // update all parents of changed and reorganized their children\n  // in the correct order (as indicated in our model)\n  forEach(parents, function(parent) {\n\n    var children = parent.children;\n\n    if (!children) {\n      return;\n    }\n\n    var childrenGfx = self._getChildrenContainer(parent);\n\n    forEach(children.slice().reverse(), function(child) {\n      var childGfx = elementRegistry.getGraphics(child);\n\n      prependTo(childGfx.parentNode, childrenGfx);\n    });\n  });\n};\n\nGraphicsFactory.prototype.drawShape = function(visual, element) {\n  var eventBus = this._eventBus;\n\n  return eventBus.fire('render.shape', { gfx: visual, element: element });\n};\n\nGraphicsFactory.prototype.getShapePath = function(element) {\n  var eventBus = this._eventBus;\n\n  return eventBus.fire('render.getShapePath', element);\n};\n\nGraphicsFactory.prototype.drawConnection = function(visual, element) {\n  var eventBus = this._eventBus;\n\n  return eventBus.fire('render.connection', { gfx: visual, element: element });\n};\n\nGraphicsFactory.prototype.getConnectionPath = function(waypoints) {\n  var eventBus = this._eventBus;\n\n  return eventBus.fire('render.getConnectionPath', waypoints);\n};\n\nGraphicsFactory.prototype.update = function(type, element, gfx) {\n\n  // do NOT update root element\n  if (!element.parent) {\n    return;\n  }\n\n  var visual = this._clear(gfx);\n\n  // redraw\n  if (type === 'shape') {\n    this.drawShape(visual, element);\n\n    // update positioning\n    translate(gfx, element.x, element.y);\n  } else\n  if (type === 'connection') {\n    this.drawConnection(visual, element);\n  } else {\n    throw new Error('unknown type: ' + type);\n  }\n\n  if (element.hidden) {\n    svgAttr(gfx, 'display', 'none');\n  } else {\n    svgAttr(gfx, 'display', 'block');\n  }\n};\n\nGraphicsFactory.prototype.remove = function(element) {\n  var gfx = this._elementRegistry.getGraphics(element);\n\n  // remove\n  svgRemove(gfx.parentNode);\n};\n\n\n// helpers //////////\n\nfunction prependTo(newNode, parentNode, siblingNode) {\n  var node = siblingNode || parentNode.firstChild;\n\n  // do not prepend node to itself to prevent IE from crashing\n  // https://github.com/bpmn-io/bpmn-js/issues/746\n  if (newNode === node) {\n    return;\n  }\n\n  parentNode.insertBefore(newNode, node);\n}\n","import DrawModule from '../draw';\n\nimport Canvas from './Canvas';\nimport ElementRegistry from './ElementRegistry';\nimport ElementFactory from './ElementFactory';\nimport EventBus from './EventBus';\nimport GraphicsFactory from './GraphicsFactory';\n\nexport default {\n  __depends__: [ DrawModule ],\n  __init__: [ 'canvas' ],\n  canvas: [ 'type', Canvas ],\n  elementRegistry: [ 'type', ElementRegistry ],\n  elementFactory: [ 'type', ElementFactory ],\n  eventBus: [ 'type', EventBus ],\n  graphicsFactory: [ 'type', GraphicsFactory ]\n};","import { Injector } from 'didi';\n\nimport CoreModule from './core';\n\n\n/**\n * Bootstrap an injector from a list of modules, instantiating a number of default components\n *\n * @ignore\n * @param {Array<didi.Module>} bootstrapModules\n *\n * @return {didi.Injector} a injector to use to access the components\n */\nfunction bootstrap(bootstrapModules) {\n\n  var modules = [],\n      components = [];\n\n  function hasModule(m) {\n    return modules.indexOf(m) >= 0;\n  }\n\n  function addModule(m) {\n    modules.push(m);\n  }\n\n  function visit(m) {\n    if (hasModule(m)) {\n      return;\n    }\n\n    (m.__depends__ || []).forEach(visit);\n\n    if (hasModule(m)) {\n      return;\n    }\n\n    addModule(m);\n\n    (m.__init__ || []).forEach(function(c) {\n      components.push(c);\n    });\n  }\n\n  bootstrapModules.forEach(visit);\n\n  var injector = new Injector(modules);\n\n  components.forEach(function(c) {\n\n    try {\n\n      // eagerly resolve component (fn or string)\n      injector[typeof c === 'string' ? 'get' : 'invoke'](c);\n    } catch (e) {\n      console.error('Failed to instantiate component');\n      console.error(e.stack);\n\n      throw e;\n    }\n  });\n\n  return injector;\n}\n\n/**\n * Creates an injector from passed options.\n *\n * @ignore\n * @param  {Object} options\n * @return {didi.Injector}\n */\nfunction createInjector(options) {\n\n  options = options || {};\n\n  var configModule = {\n    'config': ['value', options]\n  };\n\n  var modules = [ configModule, CoreModule ].concat(options.modules || []);\n\n  return bootstrap(modules);\n}\n\n\n/**\n * The main diagram-js entry point that bootstraps the diagram with the given\n * configuration.\n *\n * To register extensions with the diagram, pass them as Array<didi.Module> to the constructor.\n *\n * @class djs.Diagram\n * @memberOf djs\n * @constructor\n *\n * @example\n *\n * <caption>Creating a plug-in that logs whenever a shape is added to the canvas.</caption>\n *\n * // plug-in implemenentation\n * function MyLoggingPlugin(eventBus) {\n *   eventBus.on('shape.added', function(event) {\n *     console.log('shape ', event.shape, ' was added to the diagram');\n *   });\n * }\n *\n * // export as module\n * export default {\n *   __init__: [ 'myLoggingPlugin' ],\n *     myLoggingPlugin: [ 'type', MyLoggingPlugin ]\n * };\n *\n *\n * // instantiate the diagram with the new plug-in\n *\n * import MyLoggingModule from 'path-to-my-logging-plugin';\n *\n * var diagram = new Diagram({\n *   modules: [\n *     MyLoggingModule\n *   ]\n * });\n *\n * diagram.invoke([ 'canvas', function(canvas) {\n *   // add shape to drawing canvas\n *   canvas.addShape({ x: 10, y: 10 });\n * });\n *\n * // 'shape ... was added to the diagram' logged to console\n *\n * @param {Object} options\n * @param {Array<didi.Module>} [options.modules] external modules to instantiate with the diagram\n * @param {didi.Injector} [injector] an (optional) injector to bootstrap the diagram with\n */\nexport default function Diagram(options, injector) {\n\n  // create injector unless explicitly specified\n  this.injector = injector = injector || createInjector(options);\n\n  // API\n\n  /**\n   * Resolves a diagram service\n   *\n   * @method Diagram#get\n   *\n   * @param {string} name the name of the diagram service to be retrieved\n   * @param {boolean} [strict=true] if false, resolve missing services to null\n   */\n  this.get = injector.get;\n\n  /**\n   * Executes a function into which diagram services are injected\n   *\n   * @method Diagram#invoke\n   *\n   * @param {Function|Object[]} fn the function to resolve\n   * @param {Object} locals a number of locals to use to resolve certain dependencies\n   */\n  this.invoke = injector.invoke;\n\n  // init\n\n  // indicate via event\n\n\n  /**\n   * An event indicating that all plug-ins are loaded.\n   *\n   * Use this event to fire other events to interested plug-ins\n   *\n   * @memberOf Diagram\n   *\n   * @event diagram.init\n   *\n   * @example\n   *\n   * eventBus.on('diagram.init', function() {\n   *   eventBus.fire('my-custom-event', { foo: 'BAR' });\n   * });\n   *\n   * @type {Object}\n   */\n  this.get('eventBus').fire('diagram.init');\n}\n\n\n/**\n * Destroys the diagram\n *\n * @method  Diagram#destroy\n */\nDiagram.prototype.destroy = function() {\n  this.get('eventBus').fire('diagram.destroy');\n};\n\n/**\n * Clear the diagram, removing all contents.\n */\nDiagram.prototype.clear = function() {\n  this.get('eventBus').fire('diagram.clear');\n};\n","import {\n  filter,\n  forEach,\n  sortBy\n} from 'min-dash';\n\nfunction last(arr) {\n  return arr && arr[arr.length - 1];\n}\n\nfunction sortTopOrMiddle(element) {\n  return element.y;\n}\n\nfunction sortLeftOrCenter(element) {\n  return element.x;\n}\n\n/**\n * Sorting functions for different types of alignment\n *\n * @type {Object}\n *\n * @return {Function}\n */\nvar ALIGNMENT_SORTING = {\n  left: sortLeftOrCenter,\n  center: sortLeftOrCenter,\n  right: function(element) {\n    return element.x + element.width;\n  },\n  top: sortTopOrMiddle,\n  middle: sortTopOrMiddle,\n  bottom: function(element) {\n    return element.y + element.height;\n  }\n};\n\n\nexport default function AlignElements(modeling) {\n  this._modeling = modeling;\n}\n\nAlignElements.$inject = [ 'modeling' ];\n\n\n/**\n * Get the relevant \"axis\" and \"dimension\" related to the current type of alignment\n *\n * @param  {string} type left|right|center|top|bottom|middle\n *\n * @return {Object} { axis, dimension }\n */\nAlignElements.prototype._getOrientationDetails = function(type) {\n  var vertical = [ 'top', 'bottom', 'middle' ],\n      axis = 'x',\n      dimension = 'width';\n\n  if (vertical.indexOf(type) !== -1) {\n    axis = 'y';\n    dimension = 'height';\n  }\n\n  return {\n    axis: axis,\n    dimension: dimension\n  };\n};\n\nAlignElements.prototype._isType = function(type, types) {\n  return types.indexOf(type) !== -1;\n};\n\n/**\n * Get a point on the relevant axis where elements should align to\n *\n * @param  {string} type left|right|center|top|bottom|middle\n * @param  {Array} sortedElements\n *\n * @return {Object}\n */\nAlignElements.prototype._alignmentPosition = function(type, sortedElements) {\n  var orientation = this._getOrientationDetails(type),\n      axis = orientation.axis,\n      dimension = orientation.dimension,\n      alignment = {},\n      centers = {},\n      hasSharedCenters = false,\n      centeredElements,\n      firstElement,\n      lastElement;\n\n  function getMiddleOrTop(first, last) {\n    return Math.round((first[axis] + last[axis] + last[dimension]) / 2);\n  }\n\n  if (this._isType(type, [ 'left', 'top' ])) {\n    alignment[type] = sortedElements[0][axis];\n\n  } else if (this._isType(type, [ 'right', 'bottom' ])) {\n    lastElement = last(sortedElements);\n\n    alignment[type] = lastElement[axis] + lastElement[dimension];\n\n  } else if (this._isType(type, [ 'center', 'middle' ])) {\n\n    // check if there is a center shared by more than one shape\n    // if not, just take the middle of the range\n    forEach(sortedElements, function(element) {\n      var center = element[axis] + Math.round(element[dimension] / 2);\n\n      if (centers[center]) {\n        centers[center].elements.push(element);\n      } else {\n        centers[center] = {\n          elements: [ element ],\n          center: center\n        };\n      }\n    });\n\n    centeredElements = sortBy(centers, function(center) {\n      if (center.elements.length > 1) {\n        hasSharedCenters = true;\n      }\n\n      return center.elements.length;\n    });\n\n    if (hasSharedCenters) {\n      alignment[type] = last(centeredElements).center;\n\n      return alignment;\n    }\n\n    firstElement = sortedElements[0];\n\n    sortedElements = sortBy(sortedElements, function(element) {\n      return element[axis] + element[dimension];\n    });\n\n    lastElement = last(sortedElements);\n\n    alignment[type] = getMiddleOrTop(firstElement, lastElement);\n  }\n\n  return alignment;\n};\n\n/**\n * Executes the alignment of a selection of elements\n *\n * @param  {Array} elements [description]\n * @param  {string} type left|right|center|top|bottom|middle\n */\nAlignElements.prototype.trigger = function(elements, type) {\n  var modeling = this._modeling;\n\n  var filteredElements = filter(elements, function(element) {\n    return !(element.waypoints || element.host || element.labelTarget);\n  });\n\n  var sortFn = ALIGNMENT_SORTING[type];\n\n  var sortedElements = sortBy(filteredElements, sortFn);\n\n  var alignment = this._alignmentPosition(type, sortedElements);\n\n  modeling.alignElements(sortedElements, alignment);\n};\n","import AlignElements from './AlignElements';\n\nexport default {\n  __init__: [ 'alignElements' ],\n  alignElements: [ 'type', AlignElements ]\n};\n","function __stopPropagation(event) {\n  if (!event || typeof event.stopPropagation !== 'function') {\n    return;\n  }\n\n  event.stopPropagation();\n}\n\n\nexport function getOriginal(event) {\n  return event.originalEvent || event.srcEvent;\n}\n\n\nexport function stopPropagation(event, immediate) {\n  __stopPropagation(event, immediate);\n  __stopPropagation(getOriginal(event), immediate);\n}\n\n\nexport function toPoint(event) {\n\n  if (event.pointers && event.pointers.length) {\n    event = event.pointers[0];\n  }\n\n  if (event.touches && event.touches.length) {\n    event = event.touches[0];\n  }\n\n  return event ? {\n    x: event.clientX,\n    y: event.clientY\n  } : null;\n}","import {\n  closest as domClosest\n} from 'min-dom';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\nvar HIGH_PRIORITY = 1500;\n\n\n/**\n * Browsers may swallow certain events (hover, out ...) if users are to\n * fast with the mouse.\n *\n * @see http://stackoverflow.com/questions/7448468/why-cant-i-reliably-capture-a-mouseout-event\n *\n * The fix implemented in this component ensure that we\n *\n * 1) have a hover state after a successful drag.move event\n * 2) have an out event when dragging leaves an element\n *\n * @param {ElementRegistry} elementRegistry\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function HoverFix(elementRegistry, eventBus, injector) {\n\n  var self = this;\n\n  var dragging = injector.get('dragging', false);\n\n  /**\n   * Make sure we are god damn hovering!\n   *\n   * @param {Event} dragging event\n   */\n  function ensureHover(event) {\n\n    if (event.hover) {\n      return;\n    }\n\n    var originalEvent = event.originalEvent;\n\n    var gfx = self._findTargetGfx(originalEvent);\n\n    var element = gfx && elementRegistry.get(gfx);\n\n    if (gfx && element) {\n\n      // 1) cancel current mousemove\n      event.stopPropagation();\n\n      // 2) emit fake hover for new target\n      dragging.hover({ element: element, gfx: gfx });\n\n      // 3) re-trigger move event\n      dragging.move(originalEvent);\n    }\n  }\n\n\n  if (dragging) {\n\n    /**\n     * We wait for a specific sequence of events before\n     * emitting a fake drag.hover event.\n     *\n     * Event Sequence:\n     *\n     * drag.start\n     * drag.move >> ensure we are hovering\n     */\n    eventBus.on('drag.start', function(event) {\n\n      eventBus.once('drag.move', HIGH_PRIORITY, function(event) {\n\n        ensureHover(event);\n\n      });\n\n    });\n  }\n\n\n  /**\n   * We make sure that element.out is always fired, even if the\n   * browser swallows an element.out event.\n   *\n   * Event sequence:\n   *\n   * element.hover\n   * (element.out >> sometimes swallowed)\n   * element.hover >> ensure we fired element.out\n   */\n  (function() {\n    var hoverGfx;\n    var hover;\n\n    eventBus.on('element.hover', function(event) {\n\n      // (1) remember current hover element\n      hoverGfx = event.gfx;\n      hover = event.element;\n    });\n\n    eventBus.on('element.hover', HIGH_PRIORITY, function(event) {\n\n      // (3) am I on an element still?\n      if (hover) {\n\n        // (4) that is a problem, gotta \"simulate the out\"\n        eventBus.fire('element.out', {\n          element: hover,\n          gfx: hoverGfx\n        });\n      }\n\n    });\n\n    eventBus.on('element.out', function() {\n\n      // (2) unset hover state if we correctly outed us *GG*\n      hoverGfx = null;\n      hover = null;\n    });\n\n  })();\n\n  this._findTargetGfx = function(event) {\n    var position,\n        target;\n\n    if (!(event instanceof MouseEvent)) {\n      return;\n    }\n\n    position = toPoint(event);\n\n    // damn expensive operation, ouch!\n    target = document.elementFromPoint(position.x, position.y);\n\n    return getGfx(target);\n  };\n\n}\n\nHoverFix.$inject = [\n  'elementRegistry',\n  'eventBus',\n  'injector'\n];\n\n\n// helpers /////////////////////\n\nfunction getGfx(target) {\n  return domClosest(target, 'svg, .djs-element', true);\n}","import HoverFix from './HoverFix';\n\nexport default {\n  __init__: [\n    'hoverFix'\n  ],\n  hoverFix: [ 'type', HoverFix ],\n};","export function isMac() {\n  return (/mac/i).test(navigator.platform);\n}","import {\n  getOriginal as getOriginalEvent\n} from './Event';\n\nimport {\n  isMac\n} from './Platform';\n\nexport {\n  isMac\n} from './Platform';\n\n\nexport function isPrimaryButton(event) {\n\n  // button === 0 -> left ka primary mouse button\n  return !(getOriginalEvent(event) || event).button;\n}\n\nexport function hasPrimaryModifier(event) {\n  var originalEvent = getOriginalEvent(event) || event;\n\n  if (!isPrimaryButton(event)) {\n    return false;\n  }\n\n  // Use alt as primary modifier key for mac OS\n  if (isMac()) {\n    return originalEvent.metaKey;\n  } else {\n    return originalEvent.ctrlKey;\n  }\n}\n\n\nexport function hasSecondaryModifier(event) {\n  var originalEvent = getOriginalEvent(event) || event;\n\n  return isPrimaryButton(event) && originalEvent.shiftKey;\n}","import {\n  forEach,\n  assign\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  query as domQuery,\n  queryAll as domQueryAll\n} from 'min-dom';\n\nimport { isPrimaryButton } from '../../util/Mouse';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  createLine,\n  updateLine\n} from '../../util/RenderUtil';\n\nfunction allowAll(e) { return true; }\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * A plugin that provides interaction events for diagram elements.\n *\n * It emits the following events:\n *\n *   * element.click\n *   * element.contextmenu\n *   * element.dblclick\n *   * element.hover\n *   * element.mousedown\n *   * element.mousemove\n *   * element.mouseup\n *   * element.out\n *\n * Each event is a tuple { element, gfx, originalEvent }.\n *\n * Canceling the event via Event#preventDefault()\n * prevents the original DOM operation.\n *\n * @param {EventBus} eventBus\n */\nexport default function InteractionEvents(eventBus, elementRegistry, styles) {\n\n  var self = this;\n\n  /**\n   * Fire an interaction event.\n   *\n   * @param {string} type local event name, e.g. element.click.\n   * @param {DOMEvent} event native event\n   * @param {djs.model.Base} [element] the diagram element to emit the event on;\n   *                                   defaults to the event target\n   */\n  function fire(type, event, element) {\n\n    if (isIgnored(type, event)) {\n      return;\n    }\n\n    var target, gfx, returnValue;\n\n    if (!element) {\n      target = event.delegateTarget || event.target;\n\n      if (target) {\n        gfx = target;\n        element = elementRegistry.get(gfx);\n      }\n    } else {\n      gfx = elementRegistry.getGraphics(element);\n    }\n\n    if (!gfx || !element) {\n      return;\n    }\n\n    returnValue = eventBus.fire(type, {\n      element: element,\n      gfx: gfx,\n      originalEvent: event\n    });\n\n    if (returnValue === false) {\n      event.stopPropagation();\n      event.preventDefault();\n    }\n  }\n\n  // TODO(nikku): document this\n  var handlers = {};\n\n  function mouseHandler(localEventName) {\n    return handlers[localEventName];\n  }\n\n  function isIgnored(localEventName, event) {\n\n    var filter = ignoredFilters[localEventName] || isPrimaryButton;\n\n    // only react on left mouse button interactions\n    // except for interaction events that are enabled\n    // for secundary mouse button\n    return !filter(event);\n  }\n\n  var bindings = {\n    click: 'element.click',\n    contextmenu: 'element.contextmenu',\n    dblclick: 'element.dblclick',\n    mousedown: 'element.mousedown',\n    mousemove: 'element.mousemove',\n    mouseover: 'element.hover',\n    mouseout: 'element.out',\n    mouseup: 'element.mouseup',\n  };\n\n  var ignoredFilters = {\n    'element.contextmenu': allowAll\n  };\n\n\n  // manual event trigger //////////\n\n  /**\n   * Trigger an interaction event (based on a native dom event)\n   * on the target shape or connection.\n   *\n   * @param {string} eventName the name of the triggered DOM event\n   * @param {MouseEvent} event\n   * @param {djs.model.Base} targetElement\n   */\n  function triggerMouseEvent(eventName, event, targetElement) {\n\n    // i.e. element.mousedown...\n    var localEventName = bindings[eventName];\n\n    if (!localEventName) {\n      throw new Error('unmapped DOM event name <' + eventName + '>');\n    }\n\n    return fire(localEventName, event, targetElement);\n  }\n\n\n  var ELEMENT_SELECTOR = 'svg, .djs-element';\n\n  // event handling ///////\n\n  function registerEvent(node, event, localEvent, ignoredFilter) {\n\n    var handler = handlers[localEvent] = function(event) {\n      fire(localEvent, event);\n    };\n\n    if (ignoredFilter) {\n      ignoredFilters[localEvent] = ignoredFilter;\n    }\n\n    handler.$delegate = domDelegate.bind(node, ELEMENT_SELECTOR, event, handler);\n  }\n\n  function unregisterEvent(node, event, localEvent) {\n\n    var handler = mouseHandler(localEvent);\n\n    if (!handler) {\n      return;\n    }\n\n    domDelegate.unbind(node, event, handler.$delegate);\n  }\n\n  function registerEvents(svg) {\n    forEach(bindings, function(val, key) {\n      registerEvent(svg, key, val);\n    });\n  }\n\n  function unregisterEvents(svg) {\n    forEach(bindings, function(val, key) {\n      unregisterEvent(svg, key, val);\n    });\n  }\n\n  eventBus.on('canvas.destroy', function(event) {\n    unregisterEvents(event.svg);\n  });\n\n  eventBus.on('canvas.init', function(event) {\n    registerEvents(event.svg);\n  });\n\n\n  // hit box updating ////////////////\n\n  eventBus.on([ 'shape.added', 'connection.added' ], function(event) {\n    var element = event.element,\n        gfx = event.gfx;\n\n    eventBus.fire('interactionEvents.createHit', { element: element, gfx: gfx });\n  });\n\n  // Update djs-hit on change.\n  // A low priortity is necessary, because djs-hit of labels has to be updated\n  // after the label bounds have been updated in the renderer.\n  eventBus.on([\n    'shape.changed',\n    'connection.changed'\n  ], LOW_PRIORITY, function(event) {\n\n    var element = event.element,\n        gfx = event.gfx;\n\n    eventBus.fire('interactionEvents.updateHit', { element: element, gfx: gfx });\n  });\n\n  eventBus.on('interactionEvents.createHit', LOW_PRIORITY, function(event) {\n    var element = event.element,\n        gfx = event.gfx;\n\n    self.createDefaultHit(element, gfx);\n  });\n\n  eventBus.on('interactionEvents.updateHit', function(event) {\n    var element = event.element,\n        gfx = event.gfx;\n\n    self.updateDefaultHit(element, gfx);\n  });\n\n\n  // hit styles ////////////\n\n  var STROKE_HIT_STYLE = createHitStyle('djs-hit djs-hit-stroke');\n\n  var CLICK_STROKE_HIT_STYLE = createHitStyle('djs-hit djs-hit-click-stroke');\n\n  var ALL_HIT_STYLE = createHitStyle('djs-hit djs-hit-all');\n\n  var HIT_TYPES = {\n    'all': ALL_HIT_STYLE,\n    'click-stroke': CLICK_STROKE_HIT_STYLE,\n    'stroke': STROKE_HIT_STYLE\n  };\n\n  function createHitStyle(classNames, attrs) {\n\n    attrs = assign({\n      stroke: 'white',\n      strokeWidth: 15\n    }, attrs || {});\n\n    return styles.cls(classNames, [ 'no-fill', 'no-border' ], attrs);\n  }\n\n\n  // style helpers ///////////////\n\n  function applyStyle(hit, type) {\n\n    var attrs = HIT_TYPES[type];\n\n    if (!attrs) {\n      throw new Error('invalid hit type <' + type + '>');\n    }\n\n    svgAttr(hit, attrs);\n\n    return hit;\n  }\n\n  function appendHit(gfx, hit) {\n    svgAppend(gfx, hit);\n  }\n\n\n  // API\n\n  /**\n   * Remove hints on the given graphics.\n   *\n   * @param {SVGElement} gfx\n   */\n  this.removeHits = function(gfx) {\n    var hits = domQueryAll('.djs-hit', gfx);\n\n    forEach(hits, svgRemove);\n  };\n\n  /**\n   * Create default hit for the given element.\n   *\n   * @param {djs.model.Base} element\n   * @param {SVGElement} gfx\n   *\n   * @return {SVGElement} created hit\n   */\n  this.createDefaultHit = function(element, gfx) {\n    var waypoints = element.waypoints,\n        isFrame = element.isFrame,\n        boxType;\n\n    if (waypoints) {\n      return this.createWaypointsHit(gfx, waypoints);\n    } else {\n\n      boxType = isFrame ? 'stroke' : 'all';\n\n      return this.createBoxHit(gfx, boxType, {\n        width: element.width,\n        height: element.height\n      });\n    }\n  };\n\n  /**\n   * Create hits for the given waypoints.\n   *\n   * @param {SVGElement} gfx\n   * @param {Array<Point>} waypoints\n   *\n   * @return {SVGElement}\n   */\n  this.createWaypointsHit = function(gfx, waypoints) {\n\n    var hit = createLine(waypoints);\n\n    applyStyle(hit, 'stroke');\n\n    appendHit(gfx, hit);\n\n    return hit;\n  };\n\n  /**\n   * Create hits for a box.\n   *\n   * @param {SVGElement} gfx\n   * @param {string} hitType\n   * @param {Object} attrs\n   *\n   * @return {SVGElement}\n   */\n  this.createBoxHit = function(gfx, type, attrs) {\n\n    attrs = assign({\n      x: 0,\n      y: 0\n    }, attrs);\n\n    var hit = svgCreate('rect');\n\n    applyStyle(hit, type);\n\n    svgAttr(hit, attrs);\n\n    appendHit(gfx, hit);\n\n    return hit;\n  };\n\n  /**\n   * Update default hit of the element.\n   *\n   * @param  {djs.model.Base} element\n   * @param  {SVGElement} gfx\n   *\n   * @return {SVGElement} updated hit\n   */\n  this.updateDefaultHit = function(element, gfx) {\n\n    var hit = domQuery('.djs-hit', gfx);\n\n    if (!hit) {\n      return;\n    }\n\n    if (element.waypoints) {\n      updateLine(hit, element.waypoints);\n    } else {\n      svgAttr(hit, {\n        width: element.width,\n        height: element.height\n      });\n    }\n\n    return hit;\n  };\n\n  this.fire = fire;\n\n  this.triggerMouseEvent = triggerMouseEvent;\n\n  this.mouseHandler = mouseHandler;\n\n  this.registerEvent = registerEvent;\n  this.unregisterEvent = unregisterEvent;\n}\n\n\nInteractionEvents.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'styles'\n];\n\n\n/**\n * An event indicating that the mouse hovered over an element\n *\n * @event element.hover\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the mouse has left an element\n *\n * @event element.out\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the mouse has clicked an element\n *\n * @event element.click\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the mouse has double clicked an element\n *\n * @event element.dblclick\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the mouse has gone down on an element.\n *\n * @event element.mousedown\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the mouse has gone up on an element.\n *\n * @event element.mouseup\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */\n\n/**\n * An event indicating that the context menu action is triggered\n * via mouse or touch controls.\n *\n * @event element.contextmenu\n *\n * @type {Object}\n * @property {djs.model.Base} element\n * @property {SVGElement} gfx\n * @property {Event} originalEvent\n */","import InteractionEvents from './InteractionEvents';\n\nexport default {\n  __init__: [ 'interactionEvents' ],\n  interactionEvents: [ 'type', InteractionEvents ]\n};","import { getBBox } from '../../util/Elements';\n\nvar LOW_PRIORITY = 500;\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  query as domQuery\n} from 'min-dom';\n\nimport {\n  assign\n} from 'min-dash';\n\n\n/**\n * @class\n *\n * A plugin that adds an outline to shapes and connections that may be activated and styled\n * via CSS classes.\n *\n * @param {EventBus} eventBus\n * @param {Styles} styles\n * @param {ElementRegistry} elementRegistry\n */\nexport default function Outline(eventBus, styles, elementRegistry) {\n\n  this.offset = 6;\n\n  var OUTLINE_STYLE = styles.cls('djs-outline', [ 'no-fill' ]);\n\n  var self = this;\n\n  function createOutline(gfx, bounds) {\n    var outline = svgCreate('rect');\n\n    svgAttr(outline, assign({\n      x: 10,\n      y: 10,\n      width: 100,\n      height: 100\n    }, OUTLINE_STYLE));\n\n    svgAppend(gfx, outline);\n\n    return outline;\n  }\n\n  // A low priortity is necessary, because outlines of labels have to be updated\n  // after the label bounds have been updated in the renderer.\n  eventBus.on([ 'shape.added', 'shape.changed' ], LOW_PRIORITY, function(event) {\n    var element = event.element,\n        gfx = event.gfx;\n\n    var outline = domQuery('.djs-outline', gfx);\n\n    if (!outline) {\n      outline = createOutline(gfx, element);\n    }\n\n    self.updateShapeOutline(outline, element);\n  });\n\n  eventBus.on([ 'connection.added', 'connection.changed' ], function(event) {\n    var element = event.element,\n        gfx = event.gfx;\n\n    var outline = domQuery('.djs-outline', gfx);\n\n    if (!outline) {\n      outline = createOutline(gfx, element);\n    }\n\n    self.updateConnectionOutline(outline, element);\n  });\n}\n\n\n/**\n * Updates the outline of a shape respecting the dimension of the\n * element and an outline offset.\n *\n * @param  {SVGElement} outline\n * @param  {djs.model.Base} element\n */\nOutline.prototype.updateShapeOutline = function(outline, element) {\n\n  svgAttr(outline, {\n    x: -this.offset,\n    y: -this.offset,\n    width: element.width + this.offset * 2,\n    height: element.height + this.offset * 2\n  });\n\n};\n\n\n/**\n * Updates the outline of a connection respecting the bounding box of\n * the connection and an outline offset.\n *\n * @param  {SVGElement} outline\n * @param  {djs.model.Base} element\n */\nOutline.prototype.updateConnectionOutline = function(outline, connection) {\n\n  var bbox = getBBox(connection);\n\n  svgAttr(outline, {\n    x: bbox.x - this.offset,\n    y: bbox.y - this.offset,\n    width: bbox.width + this.offset * 2,\n    height: bbox.height + this.offset * 2\n  });\n\n};\n\n\nOutline.$inject = ['eventBus', 'styles', 'elementRegistry'];","import Outline from './Outline';\n\nexport default {\n  __init__: [ 'outline' ],\n  outline: [ 'type', Outline ]\n};","import {\n  isArray,\n  forEach\n} from 'min-dash';\n\n\n/**\n * A service that offers the current selection in a diagram.\n * Offers the api to control the selection, too.\n *\n * @class\n *\n * @param {EventBus} eventBus the event bus\n */\nexport default function Selection(eventBus) {\n\n  this._eventBus = eventBus;\n\n  this._selectedElements = [];\n\n  var self = this;\n\n  eventBus.on([ 'shape.remove', 'connection.remove' ], function(e) {\n    var element = e.element;\n    self.deselect(element);\n  });\n\n  eventBus.on([ 'diagram.clear' ], function(e) {\n    self.select(null);\n  });\n}\n\nSelection.$inject = [ 'eventBus' ];\n\n\nSelection.prototype.deselect = function(element) {\n  var selectedElements = this._selectedElements;\n\n  var idx = selectedElements.indexOf(element);\n\n  if (idx !== -1) {\n    var oldSelection = selectedElements.slice();\n\n    selectedElements.splice(idx, 1);\n\n    this._eventBus.fire('selection.changed', { oldSelection: oldSelection, newSelection: selectedElements });\n  }\n};\n\n\nSelection.prototype.get = function() {\n  return this._selectedElements;\n};\n\nSelection.prototype.isSelected = function(element) {\n  return this._selectedElements.indexOf(element) !== -1;\n};\n\n\n/**\n * This method selects one or more elements on the diagram.\n *\n * By passing an additional add parameter you can decide whether or not the element(s)\n * should be added to the already existing selection or not.\n *\n * @method Selection#select\n *\n * @param  {Object|Object[]} elements element or array of elements to be selected\n * @param  {boolean} [add] whether the element(s) should be appended to the current selection, defaults to false\n */\nSelection.prototype.select = function(elements, add) {\n  var selectedElements = this._selectedElements,\n      oldSelection = selectedElements.slice();\n\n  if (!isArray(elements)) {\n    elements = elements ? [ elements ] : [];\n  }\n\n  // selection may be cleared by passing an empty array or null\n  // to the method\n  if (add) {\n    forEach(elements, function(element) {\n      if (selectedElements.indexOf(element) !== -1) {\n\n        // already selected\n        return;\n      } else {\n        selectedElements.push(element);\n      }\n    });\n  } else {\n    this._selectedElements = selectedElements = elements.slice();\n  }\n\n  this._eventBus.fire('selection.changed', { oldSelection: oldSelection, newSelection: selectedElements });\n};\n","import {\n  forEach\n} from 'min-dash';\n\nvar MARKER_HOVER = 'hover',\n    MARKER_SELECTED = 'selected';\n\n\n/**\n * A plugin that adds a visible selection UI to shapes and connections\n * by appending the <code>hover</code> and <code>selected</code> classes to them.\n *\n * @class\n *\n * Makes elements selectable, too.\n *\n * @param {EventBus} events\n * @param {SelectionService} selection\n * @param {Canvas} canvas\n */\nexport default function SelectionVisuals(events, canvas, selection, styles) {\n\n  this._multiSelectionBox = null;\n\n  function addMarker(e, cls) {\n    canvas.addMarker(e, cls);\n  }\n\n  function removeMarker(e, cls) {\n    canvas.removeMarker(e, cls);\n  }\n\n  events.on('element.hover', function(event) {\n    addMarker(event.element, MARKER_HOVER);\n  });\n\n  events.on('element.out', function(event) {\n    removeMarker(event.element, MARKER_HOVER);\n  });\n\n  events.on('selection.changed', function(event) {\n\n    function deselect(s) {\n      removeMarker(s, MARKER_SELECTED);\n    }\n\n    function select(s) {\n      addMarker(s, MARKER_SELECTED);\n    }\n\n    var oldSelection = event.oldSelection,\n        newSelection = event.newSelection;\n\n    forEach(oldSelection, function(e) {\n      if (newSelection.indexOf(e) === -1) {\n        deselect(e);\n      }\n    });\n\n    forEach(newSelection, function(e) {\n      if (oldSelection.indexOf(e) === -1) {\n        select(e);\n      }\n    });\n  });\n}\n\nSelectionVisuals.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'styles'\n];","import {\n  hasPrimaryModifier,\n  hasSecondaryModifier\n} from '../../util/Mouse';\n\nimport {\n  find,\n  isArray\n} from 'min-dash';\n\n\nexport default function SelectionBehavior(eventBus, selection, canvas, elementRegistry) {\n\n  // Select elements on create\n  eventBus.on('create.end', 500, function(event) {\n    var context = event.context,\n        canExecute = context.canExecute,\n        elements = context.elements,\n        hints = context.hints || {},\n        autoSelect = hints.autoSelect;\n\n    if (canExecute) {\n      if (autoSelect === false) {\n\n        // Select no elements\n        return;\n      }\n\n      if (isArray(autoSelect)) {\n        selection.select(autoSelect);\n      } else {\n\n        // Select all elements by default\n        selection.select(elements.filter(isShown));\n      }\n    }\n  });\n\n  // Select connection targets on connect\n  eventBus.on('connect.end', 500, function(event) {\n    var context = event.context,\n        canExecute = context.canExecute,\n        hover = context.hover;\n\n    if (canExecute && hover) {\n      selection.select(hover);\n    }\n  });\n\n  // Select shapes on move\n  eventBus.on('shape.move.end', 500, function(event) {\n    var previousSelection = event.previousSelection || [];\n\n    var shape = elementRegistry.get(event.context.shape.id);\n\n    // Always select main shape on move\n    var isSelected = find(previousSelection, function(selectedShape) {\n      return shape.id === selectedShape.id;\n    });\n\n    if (!isSelected) {\n      selection.select(shape);\n    }\n  });\n\n  // Select elements on click\n  eventBus.on('element.click', function(event) {\n    var element = event.element;\n\n    if (element === canvas.getRootElement()) {\n      element = null;\n    }\n\n    var isSelected = selection.isSelected(element),\n        isMultiSelect = selection.get().length > 1;\n\n    // Add to selection if CTRL or SHIFT pressed\n    var add = hasPrimaryModifier(event) || hasSecondaryModifier(event);\n\n    if (isSelected && isMultiSelect) {\n      if (add) {\n\n        // Deselect element\n        return selection.deselect(element);\n      } else {\n\n        // Select element only\n        return selection.select(element);\n      }\n    } else if (!isSelected) {\n\n      // Select element\n      selection.select(element, add);\n    } else {\n\n      // Deselect element\n      selection.deselect(element);\n    }\n  });\n}\n\nSelectionBehavior.$inject = [\n  'eventBus',\n  'selection',\n  'canvas',\n  'elementRegistry'\n];\n\n\nfunction isShown(element) {\n  return !element.hidden;\n}\n","import InteractionEventsModule from '../interaction-events';\nimport OutlineModule from '../outline';\n\nimport Selection from './Selection';\nimport SelectionVisuals from './SelectionVisuals';\nimport SelectionBehavior from './SelectionBehavior';\n\n\nexport default {\n  __init__: [ 'selectionVisuals', 'selectionBehavior' ],\n  __depends__: [\n    InteractionEventsModule,\n    OutlineModule\n  ],\n  selection: [ 'type', Selection ],\n  selectionVisuals: [ 'type', SelectionVisuals ],\n  selectionBehavior: [ 'type', SelectionBehavior ]\n};\n","import {\n  classes as domClasses\n} from 'min-dom';\n\nvar CURSOR_CLS_PATTERN = /^djs-cursor-.*$/;\n\n\nexport function set(mode) {\n  var classes = domClasses(document.body);\n\n  classes.removeMatching(CURSOR_CLS_PATTERN);\n\n  if (mode) {\n    classes.add('djs-cursor-' + mode);\n  }\n}\n\nexport function unset() {\n  set(null);\n}\n\nexport function has(mode) {\n  var classes = domClasses(document.body);\n\n  return classes.has('djs-cursor-' + mode);\n}\n","var TRAP_PRIORITY = 5000;\n\n/**\n * Installs a click trap that prevents a ghost click following a dragging operation.\n *\n * @return {Function} a function to immediately remove the installed trap.\n */\nexport function install(eventBus, eventName) {\n\n  eventName = eventName || 'element.click';\n\n  function trap() {\n    return false;\n  }\n\n  eventBus.once(eventName, TRAP_PRIORITY, trap);\n\n  return function() {\n    eventBus.off(eventName, trap);\n  };\n}","export function center(bounds) {\n  return {\n    x: bounds.x + (bounds.width / 2),\n    y: bounds.y + (bounds.height / 2)\n  };\n}\n\n\nexport function delta(a, b) {\n  return {\n    x: a.x - b.x,\n    y: a.y - b.y\n  };\n}","/* global TouchEvent */\n\nvar round = Math.round;\n\nimport { assign } from 'min-dash';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  getOriginal,\n  toPoint,\n  stopPropagation\n} from '../../util/Event';\n\nimport {\n  set as cursorSet,\n  unset as cursorUnset\n} from '../../util/Cursor';\n\nimport {\n  install as installClickTrap\n} from '../../util/ClickTrap';\n\nimport {\n  delta as deltaPos\n} from '../../util/PositionUtil';\n\nvar DRAG_ACTIVE_CLS = 'djs-drag-active';\n\n\nfunction preventDefault(event) {\n  event.preventDefault();\n}\n\nfunction isTouchEvent(event) {\n\n  // check for TouchEvent being available first\n  // (i.e. not available on desktop Firefox)\n  return typeof TouchEvent !== 'undefined' && event instanceof TouchEvent;\n}\n\nfunction getLength(point) {\n  return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n}\n\n/**\n * A helper that fires canvas localized drag events and realizes\n * the general \"drag-and-drop\" look and feel.\n *\n * Calling {@link Dragging#activate} activates dragging on a canvas.\n *\n * It provides the following:\n *\n *   * emits life cycle events, namespaced with a prefix assigned\n *     during dragging activation\n *   * sets and restores the cursor\n *   * sets and restores the selection if elements still exist\n *   * ensures there can be only one drag operation active at a time\n *\n * Dragging may be canceled manually by calling {@link Dragging#cancel}\n * or by pressing ESC.\n *\n *\n * ## Life-cycle events\n *\n * Dragging can be in three different states, off, initialized\n * and active.\n *\n * (1) off: no dragging operation is in progress\n * (2) initialized: a new drag operation got initialized but not yet\n *                  started (i.e. because of no initial move)\n * (3) started: dragging is in progress\n *\n * Eventually dragging will be off again after a drag operation has\n * been ended or canceled via user click or ESC key press.\n *\n * To indicate transitions between these states dragging emits generic\n * life-cycle events with the `drag.` prefix _and_ events namespaced\n * to a prefix choosen by a user during drag initialization.\n *\n * The following events are emitted (appropriately prefixed) via\n * the {@link EventBus}.\n *\n * * `init`\n * * `start`\n * * `move`\n * * `end`\n * * `ended` (dragging already in off state)\n * * `cancel` (only if previously started)\n * * `canceled` (dragging already in off state, only if previously started)\n * * `cleanup`\n *\n *\n * @example\n *\n * function MyDragComponent(eventBus, dragging) {\n *\n *   eventBus.on('mydrag.start', function(event) {\n *     console.log('yes, we start dragging');\n *   });\n *\n *   eventBus.on('mydrag.move', function(event) {\n *     console.log('canvas local coordinates', event.x, event.y, event.dx, event.dy);\n *\n *     // local drag data is passed with the event\n *     event.context.foo; // \"BAR\"\n *\n *     // the original mouse event, too\n *     event.originalEvent; // MouseEvent(...)\n *   });\n *\n *   eventBus.on('element.click', function(event) {\n *     dragging.init(event, 'mydrag', {\n *       cursor: 'grabbing',\n *       data: {\n *         context: {\n *           foo: \"BAR\"\n *         }\n *       }\n *     });\n *   });\n * }\n */\nexport default function Dragging(eventBus, canvas, selection, elementRegistry) {\n\n  var defaultOptions = {\n    threshold: 5,\n    trapClick: true\n  };\n\n  // the currently active drag operation\n  // dragging is active as soon as this context exists.\n  //\n  // it is visually _active_ only when a context.active flag is set to true.\n  var context;\n\n  /* convert a global event into local coordinates */\n  function toLocalPoint(globalPosition) {\n\n    var viewbox = canvas.viewbox();\n\n    var clientRect = canvas._container.getBoundingClientRect();\n\n    return {\n      x: viewbox.x + (globalPosition.x - clientRect.left) / viewbox.scale,\n      y: viewbox.y + (globalPosition.y - clientRect.top) / viewbox.scale\n    };\n  }\n\n  // helpers\n\n  function fire(type, dragContext) {\n    dragContext = dragContext || context;\n\n    var event = eventBus.createEvent(\n      assign(\n        {},\n        dragContext.payload,\n        dragContext.data,\n        { isTouch: dragContext.isTouch }\n      )\n    );\n\n    // default integration\n    if (eventBus.fire('drag.' + type, event) === false) {\n      return false;\n    }\n\n    return eventBus.fire(dragContext.prefix + '.' + type, event);\n  }\n\n  function restoreSelection(previousSelection) {\n    var existingSelection = previousSelection.filter(function(element) {\n      return elementRegistry.get(element.id);\n    });\n\n    existingSelection.length && selection.select(existingSelection);\n  }\n\n  // event listeners\n\n  function move(event, activate) {\n    var payload = context.payload,\n        displacement = context.displacement;\n\n    var globalStart = context.globalStart,\n        globalCurrent = toPoint(event),\n        globalDelta = deltaPos(globalCurrent, globalStart);\n\n    var localStart = context.localStart,\n        localCurrent = toLocalPoint(globalCurrent),\n        localDelta = deltaPos(localCurrent, localStart);\n\n\n    // activate context explicitly or once threshold is reached\n    if (!context.active && (activate || getLength(globalDelta) > context.threshold)) {\n\n      // fire start event with original\n      // starting coordinates\n\n      assign(payload, {\n        x: round(localStart.x + displacement.x),\n        y: round(localStart.y + displacement.y),\n        dx: 0,\n        dy: 0\n      }, { originalEvent: event });\n\n      if (false === fire('start')) {\n        return cancel();\n      }\n\n      context.active = true;\n\n      // unset selection and remember old selection\n      // the previous (old) selection will always passed\n      // with the event via the event.previousSelection property\n      if (!context.keepSelection) {\n        payload.previousSelection = selection.get();\n        selection.select(null);\n      }\n\n      // allow custom cursor\n      if (context.cursor) {\n        cursorSet(context.cursor);\n      }\n\n      // indicate dragging via marker on root element\n      canvas.addMarker(canvas.getRootElement(), DRAG_ACTIVE_CLS);\n    }\n\n    stopPropagation(event);\n\n    if (context.active) {\n\n      // update payload with actual coordinates\n      assign(payload, {\n        x: round(localCurrent.x + displacement.x),\n        y: round(localCurrent.y + displacement.y),\n        dx: round(localDelta.x),\n        dy: round(localDelta.y)\n      }, { originalEvent: event });\n\n      // emit move event\n      fire('move');\n    }\n  }\n\n  function end(event) {\n    var previousContext,\n        returnValue = true;\n\n    if (context.active) {\n\n      if (event) {\n        context.payload.originalEvent = event;\n\n        // suppress original event (click, ...)\n        // because we just ended a drag operation\n        stopPropagation(event);\n      }\n\n      // implementations may stop restoring the\n      // original state (selections, ...) by preventing the\n      // end events default action\n      returnValue = fire('end');\n    }\n\n    if (returnValue === false) {\n      fire('rejected');\n    }\n\n    previousContext = cleanup(returnValue !== true);\n\n    // last event to be fired when all drag operations are done\n    // at this point in time no drag operation is in progress anymore\n    fire('ended', previousContext);\n  }\n\n\n  // cancel active drag operation if the user presses\n  // the ESC key on the keyboard\n\n  function checkCancel(event) {\n\n    if (event.which === 27) {\n      preventDefault(event);\n\n      cancel();\n    }\n  }\n\n\n  // prevent ghost click that might occur after a finished\n  // drag and drop session\n\n  function trapClickAndEnd(event) {\n\n    var untrap;\n\n    // trap the click in case we are part of an active\n    // drag operation. This will effectively prevent\n    // the ghost click that cannot be canceled otherwise.\n    if (context.active) {\n\n      untrap = installClickTrap(eventBus);\n\n      // remove trap after minimal delay\n      setTimeout(untrap, 400);\n\n      // prevent default action (click)\n      preventDefault(event);\n    }\n\n    end(event);\n  }\n\n  function trapTouch(event) {\n    move(event);\n  }\n\n  // update the drag events hover (djs.model.Base) and hoverGfx (Snap<SVGElement>)\n  // properties during hover and out and fire {prefix}.hover and {prefix}.out properties\n  // respectively\n\n  function hover(event) {\n    var payload = context.payload;\n\n    payload.hoverGfx = event.gfx;\n    payload.hover = event.element;\n\n    fire('hover');\n  }\n\n  function out(event) {\n    fire('out');\n\n    var payload = context.payload;\n\n    payload.hoverGfx = null;\n    payload.hover = null;\n  }\n\n\n  // life-cycle methods\n\n  function cancel(restore) {\n    var previousContext;\n\n    if (!context) {\n      return;\n    }\n\n    var wasActive = context.active;\n\n    if (wasActive) {\n      fire('cancel');\n    }\n\n    previousContext = cleanup(restore);\n\n    if (wasActive) {\n\n      // last event to be fired when all drag operations are done\n      // at this point in time no drag operation is in progress anymore\n      fire('canceled', previousContext);\n    }\n  }\n\n  function cleanup(restore) {\n    var previousContext,\n        endDrag;\n\n    fire('cleanup');\n\n    // reset cursor\n    cursorUnset();\n\n    if (context.trapClick) {\n      endDrag = trapClickAndEnd;\n    } else {\n      endDrag = end;\n    }\n\n    // reset dom listeners\n    domEvent.unbind(document, 'mousemove', move);\n\n    domEvent.unbind(document, 'dragstart', preventDefault);\n    domEvent.unbind(document, 'selectstart', preventDefault);\n\n    domEvent.unbind(document, 'mousedown', endDrag, true);\n    domEvent.unbind(document, 'mouseup', endDrag, true);\n\n    domEvent.unbind(document, 'keyup', checkCancel);\n\n    domEvent.unbind(document, 'touchstart', trapTouch, true);\n    domEvent.unbind(document, 'touchcancel', cancel, true);\n    domEvent.unbind(document, 'touchmove', move, true);\n    domEvent.unbind(document, 'touchend', end, true);\n\n    eventBus.off('element.hover', hover);\n    eventBus.off('element.out', out);\n\n    // remove drag marker on root element\n    canvas.removeMarker(canvas.getRootElement(), DRAG_ACTIVE_CLS);\n\n    // restore selection, unless it has changed\n    var previousSelection = context.payload.previousSelection;\n\n    if (restore !== false && previousSelection && !selection.get().length) {\n      restoreSelection(previousSelection);\n    }\n\n    previousContext = context;\n\n    context = null;\n\n    return previousContext;\n  }\n\n  /**\n   * Initialize a drag operation.\n   *\n   * If `localPosition` is given, drag events will be emitted\n   * relative to it.\n   *\n   * @param {MouseEvent|TouchEvent} [event]\n   * @param {Point} [localPosition] actual diagram local position this drag operation should start at\n   * @param {string} prefix\n   * @param {Object} [options]\n   */\n  function init(event, relativeTo, prefix, options) {\n\n    // only one drag operation may be active, at a time\n    if (context) {\n      cancel(false);\n    }\n\n    if (typeof relativeTo === 'string') {\n      options = prefix;\n      prefix = relativeTo;\n      relativeTo = null;\n    }\n\n    options = assign({}, defaultOptions, options || {});\n\n    var data = options.data || {},\n        originalEvent,\n        globalStart,\n        localStart,\n        endDrag,\n        isTouch;\n\n    if (options.trapClick) {\n      endDrag = trapClickAndEnd;\n    } else {\n      endDrag = end;\n    }\n\n    if (event) {\n      originalEvent = getOriginal(event) || event;\n      globalStart = toPoint(event);\n\n      stopPropagation(event);\n\n      // prevent default browser dragging behavior\n      if (originalEvent.type === 'dragstart') {\n        preventDefault(originalEvent);\n      }\n    } else {\n      originalEvent = null;\n      globalStart = { x: 0, y: 0 };\n    }\n\n    localStart = toLocalPoint(globalStart);\n\n    if (!relativeTo) {\n      relativeTo = localStart;\n    }\n\n    isTouch = isTouchEvent(originalEvent);\n\n    context = assign({\n      prefix: prefix,\n      data: data,\n      payload: {},\n      globalStart: globalStart,\n      displacement: deltaPos(relativeTo, localStart),\n      localStart: localStart,\n      isTouch: isTouch\n    }, options);\n\n    // skip dom registration if trigger\n    // is set to manual (during testing)\n    if (!options.manual) {\n\n      // add dom listeners\n\n      if (isTouch) {\n        domEvent.bind(document, 'touchstart', trapTouch, true);\n        domEvent.bind(document, 'touchcancel', cancel, true);\n        domEvent.bind(document, 'touchmove', move, true);\n        domEvent.bind(document, 'touchend', end, true);\n      } else {\n\n        // assume we use the mouse to interact per default\n        domEvent.bind(document, 'mousemove', move);\n\n        // prevent default browser drag and text selection behavior\n        domEvent.bind(document, 'dragstart', preventDefault);\n        domEvent.bind(document, 'selectstart', preventDefault);\n\n        domEvent.bind(document, 'mousedown', endDrag, true);\n        domEvent.bind(document, 'mouseup', endDrag, true);\n      }\n\n      domEvent.bind(document, 'keyup', checkCancel);\n\n      eventBus.on('element.hover', hover);\n      eventBus.on('element.out', out);\n    }\n\n    fire('init');\n\n    if (options.autoActivate) {\n      move(event, true);\n    }\n  }\n\n  // cancel on diagram destruction\n  eventBus.on('diagram.destroy', cancel);\n\n\n  // API\n\n  this.init = init;\n  this.move = move;\n  this.hover = hover;\n  this.out = out;\n  this.end = end;\n\n  this.cancel = cancel;\n\n  // for introspection\n\n  this.context = function() {\n    return context;\n  };\n\n  this.setOptions = function(options) {\n    assign(defaultOptions, options);\n  };\n}\n\nDragging.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'elementRegistry'\n];\n","import HoverFixModule from '../hover-fix';\nimport SelectionModule from '../selection';\n\nimport Dragging from './Dragging';\n\n\nexport default {\n  __depends__: [\n    HoverFixModule,\n    SelectionModule,\n  ],\n  dragging: [ 'type', Dragging ],\n};","/**\n * A service that provides rules for certain diagram actions.\n *\n * The default implementation will hook into the {@link CommandStack}\n * to perform the actual rule evaluation. Make sure to provide the\n * `commandStack` service with this module if you plan to use it.\n *\n * Together with this implementation you may use the {@link RuleProvider}\n * to implement your own rule checkers.\n *\n * This module is ment to be easily replaced, thus the tiny foot print.\n *\n * @param {Injector} injector\n */\nexport default function Rules(injector) {\n  this._commandStack = injector.get('commandStack', false);\n}\n\nRules.$inject = [ 'injector' ];\n\n\n/**\n * Returns whether or not a given modeling action can be executed\n * in the specified context.\n *\n * This implementation will respond with allow unless anyone\n * objects.\n *\n * @param {string} action the action to be checked\n * @param {Object} [context] the context to check the action in\n *\n * @return {boolean} returns true, false or null depending on whether the\n *                   operation is allowed, not allowed or should be ignored.\n */\nRules.prototype.allowed = function(action, context) {\n  var allowed = true;\n\n  var commandStack = this._commandStack;\n\n  if (commandStack) {\n    allowed = commandStack.canExecute(action, context);\n  }\n\n  // map undefined to true, i.e. no rules\n  return allowed === undefined ? true : allowed;\n};","import Rules from './Rules';\n\nexport default {\n  __init__: [ 'rules' ],\n  rules: [ 'type', Rules ]\n};\n","import {\n  every,\n  isArray\n} from 'min-dash';\n\n/**\n * Computes the distance between two points\n *\n * @param  {Point}  p\n * @param  {Point}  q\n *\n * @return {number}  distance\n */\nexport function pointDistance(a, b) {\n  if (!a || !b) {\n    return -1;\n  }\n\n  return Math.sqrt(\n    Math.pow(a.x - b.x, 2) +\n    Math.pow(a.y - b.y, 2)\n  );\n}\n\n\n/**\n * Returns true if the point r is on the line between p and q\n *\n * @param  {Point}  p\n * @param  {Point}  q\n * @param  {Point}  r\n * @param  {number} [accuracy=5] accuracy for points on line check (lower is better)\n *\n * @return {boolean}\n */\nexport function pointsOnLine(p, q, r, accuracy) {\n\n  if (typeof accuracy === 'undefined') {\n    accuracy = 5;\n  }\n\n  if (!p || !q || !r) {\n    return false;\n  }\n\n  var val = (q.x - p.x) * (r.y - p.y) - (q.y - p.y) * (r.x - p.x),\n      dist = pointDistance(p, q);\n\n  // @see http://stackoverflow.com/a/907491/412190\n  return Math.abs(val / dist) <= accuracy;\n}\n\n\nvar ALIGNED_THRESHOLD = 2;\n\n/**\n * Check whether two points are horizontally or vertically aligned.\n *\n * @param {Array<Point>|Point}\n * @param {Point}\n *\n * @return {string|boolean}\n */\nexport function pointsAligned(a, b) {\n  var points;\n\n  if (isArray(a)) {\n    points = a;\n  } else {\n    points = [ a, b ];\n  }\n\n  if (pointsAlignedHorizontally(points)) {\n    return 'h';\n  }\n\n  if (pointsAlignedVertically(points)) {\n    return 'v';\n  }\n\n  return false;\n}\n\nexport function pointsAlignedHorizontally(a, b) {\n  var points;\n\n  if (isArray(a)) {\n    points = a;\n  } else {\n    points = [ a, b ];\n  }\n\n  var firstPoint = points.slice().shift();\n\n  return every(points, function(point) {\n    return Math.abs(firstPoint.y - point.y) <= ALIGNED_THRESHOLD;\n  });\n}\n\nexport function pointsAlignedVertically(a, b) {\n  var points;\n\n  if (isArray(a)) {\n    points = a;\n  } else {\n    points = [ a, b ];\n  }\n\n  var firstPoint = points.slice().shift();\n\n  return every(points, function(point) {\n    return Math.abs(firstPoint.x - point.x) <= ALIGNED_THRESHOLD;\n  });\n}\n\n\n\n/**\n * Returns true if the point p is inside the rectangle rect\n *\n * @param  {Point}  p\n * @param  {Rect} rect\n * @param  {number} tolerance\n *\n * @return {boolean}\n */\nexport function pointInRect(p, rect, tolerance) {\n  tolerance = tolerance || 0;\n\n  return p.x > rect.x - tolerance &&\n         p.y > rect.y - tolerance &&\n         p.x < rect.x + rect.width + tolerance &&\n         p.y < rect.y + rect.height + tolerance;\n}\n\n/**\n * Returns a point in the middle of points p and q\n *\n * @param  {Point}  p\n * @param  {Point}  q\n *\n * @return {Point} middle point\n */\nexport function getMidPoint(p, q) {\n  return {\n    x: Math.round(p.x + ((q.x - p.x) / 2.0)),\n    y: Math.round(p.y + ((q.y - p.y) / 2.0))\n  };\n}\n","import {\n  pointDistance\n} from './Geometry';\n\nimport intersectPaths from 'path-intersection';\n\nvar round = Math.round,\n    max = Math.max;\n\n\nfunction circlePath(center, r) {\n  var x = center.x,\n      y = center.y;\n\n  return [\n    ['M', x, y],\n    ['m', 0, -r],\n    ['a', r, r, 0, 1, 1, 0, 2 * r],\n    ['a', r, r, 0, 1, 1, 0, -2 * r],\n    ['z']\n  ];\n}\n\nfunction linePath(points) {\n  var segments = [];\n\n  points.forEach(function(p, idx) {\n    segments.push([ idx === 0 ? 'M' : 'L', p.x, p.y ]);\n  });\n\n  return segments;\n}\n\n\nvar INTERSECTION_THRESHOLD = 10;\n\nfunction getBendpointIntersection(waypoints, reference) {\n\n  var i, w;\n\n  for (i = 0; (w = waypoints[i]); i++) {\n\n    if (pointDistance(w, reference) <= INTERSECTION_THRESHOLD) {\n      return {\n        point: waypoints[i],\n        bendpoint: true,\n        index: i\n      };\n    }\n  }\n\n  return null;\n}\n\nfunction getPathIntersection(waypoints, reference) {\n\n  var intersections = intersectPaths(circlePath(reference, INTERSECTION_THRESHOLD), linePath(waypoints));\n\n  var a = intersections[0],\n      b = intersections[intersections.length - 1],\n      idx;\n\n  if (!a) {\n\n    // no intersection\n    return null;\n  }\n\n  if (a !== b) {\n\n    if (a.segment2 !== b.segment2) {\n\n      // we use the bendpoint in between both segments\n      // as the intersection point\n\n      idx = max(a.segment2, b.segment2) - 1;\n\n      return {\n        point: waypoints[idx],\n        bendpoint: true,\n        index: idx\n      };\n    }\n\n    return {\n      point: {\n        x: (round(a.x + b.x) / 2),\n        y: (round(a.y + b.y) / 2)\n      },\n      index: a.segment2\n    };\n  }\n\n  return {\n    point: {\n      x: round(a.x),\n      y: round(a.y)\n    },\n    index: a.segment2\n  };\n}\n\n/**\n * Returns the closest point on the connection towards a given reference point.\n *\n * @param  {Array<Point>} waypoints\n * @param  {Point} reference\n *\n * @return {Object} intersection data (segment, point)\n */\nexport function getApproxIntersection(waypoints, reference) {\n  return getBendpointIntersection(waypoints, reference) || getPathIntersection(waypoints, reference);\n}\n","import {\n  toPoint\n} from '../../util/Event';\n\nimport {\n  getMidPoint,\n  pointsAligned\n} from '../../util/Geometry';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  rotate,\n  translate\n} from '../../util/SvgTransformUtil';\n\nimport {\n  getApproxIntersection\n} from '../../util/LineIntersection';\n\nexport var BENDPOINT_CLS = 'djs-bendpoint';\nexport var SEGMENT_DRAGGER_CLS = 'djs-segment-dragger';\n\nexport function toCanvasCoordinates(canvas, event) {\n\n  var position = toPoint(event),\n      clientRect = canvas._container.getBoundingClientRect(),\n      offset;\n\n  // canvas relative position\n\n  offset = {\n    x: clientRect.left,\n    y: clientRect.top\n  };\n\n  // update actual event payload with canvas relative measures\n\n  var viewbox = canvas.viewbox();\n\n  return {\n    x: viewbox.x + (position.x - offset.x) / viewbox.scale,\n    y: viewbox.y + (position.y - offset.y) / viewbox.scale\n  };\n}\n\nexport function getConnectionIntersection(canvas, waypoints, event) {\n  var localPosition = toCanvasCoordinates(canvas, event),\n      intersection = getApproxIntersection(waypoints, localPosition);\n\n  return intersection;\n}\n\nexport function addBendpoint(parentGfx, cls) {\n  var groupGfx = svgCreate('g');\n  svgClasses(groupGfx).add(BENDPOINT_CLS);\n\n  svgAppend(parentGfx, groupGfx);\n\n  var visual = svgCreate('circle');\n  svgAttr(visual, {\n    cx: 0,\n    cy: 0,\n    r: 4\n  });\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(groupGfx, visual);\n\n  var hit = svgCreate('circle');\n  svgAttr(hit, {\n    cx: 0,\n    cy: 0,\n    r: 10\n  });\n  svgClasses(hit).add('djs-hit');\n\n  svgAppend(groupGfx, hit);\n\n  if (cls) {\n    svgClasses(groupGfx).add(cls);\n  }\n\n  return groupGfx;\n}\n\nfunction createParallelDragger(parentGfx, segmentStart, segmentEnd, alignment) {\n  var draggerGfx = svgCreate('g');\n\n  svgAppend(parentGfx, draggerGfx);\n\n  var width = 14,\n      height = 3,\n      padding = 11,\n      hitWidth = calculateHitWidth(segmentStart, segmentEnd, alignment),\n      hitHeight = height + padding;\n\n  var visual = svgCreate('rect');\n  svgAttr(visual, {\n    x: -width / 2,\n    y: -height / 2,\n    width: width,\n    height: height\n  });\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(draggerGfx, visual);\n\n  var hit = svgCreate('rect');\n  svgAttr(hit, {\n    x: -hitWidth / 2,\n    y: -hitHeight / 2,\n    width: hitWidth,\n    height: hitHeight\n  });\n  svgClasses(hit).add('djs-hit');\n\n  svgAppend(draggerGfx, hit);\n\n  rotate(draggerGfx, alignment === 'v' ? 90 : 0, 0, 0);\n\n  return draggerGfx;\n}\n\n\nexport function addSegmentDragger(parentGfx, segmentStart, segmentEnd) {\n\n  var groupGfx = svgCreate('g'),\n      mid = getMidPoint(segmentStart, segmentEnd),\n      alignment = pointsAligned(segmentStart, segmentEnd);\n\n  svgAppend(parentGfx, groupGfx);\n\n  createParallelDragger(groupGfx, segmentStart, segmentEnd, alignment);\n\n  svgClasses(groupGfx).add(SEGMENT_DRAGGER_CLS);\n  svgClasses(groupGfx).add(alignment === 'h' ? 'horizontal' : 'vertical');\n\n  translate(groupGfx, mid.x, mid.y);\n\n  return groupGfx;\n}\n\n/**\n * Calculates region for segment move which is 2/3 of the full segment length\n * @param {number} segmentLength\n *\n * @return {number}\n */\nexport function calculateSegmentMoveRegion(segmentLength) {\n  return Math.abs(Math.round(segmentLength * 2 / 3));\n}\n\n// helper //////////\n\nfunction calculateHitWidth(segmentStart, segmentEnd, alignment) {\n  var segmentLengthXAxis = segmentEnd.x - segmentStart.x,\n      segmentLengthYAxis = segmentEnd.y - segmentStart.y;\n\n  return alignment === 'h' ?\n    calculateSegmentMoveRegion(segmentLengthXAxis) :\n    calculateSegmentMoveRegion(segmentLengthYAxis);\n}\n","import { forEach } from 'min-dash';\n\nimport {\n  event as domEvent,\n  query as domQuery,\n  queryAll as domQueryAll\n} from 'min-dom';\n\nimport {\n  BENDPOINT_CLS,\n  SEGMENT_DRAGGER_CLS,\n  addBendpoint,\n  addSegmentDragger,\n  calculateSegmentMoveRegion,\n  getConnectionIntersection\n} from './BendpointUtil';\n\nimport {\n  escapeCSS\n} from '../../util/EscapeUtil';\n\nimport {\n  pointsAligned,\n  getMidPoint\n} from '../../util/Geometry';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\n\n/**\n * A service that adds editable bendpoints to connections.\n */\nexport default function Bendpoints(\n    eventBus, canvas, interactionEvents,\n    bendpointMove, connectionSegmentMove) {\n\n  /**\n   * Returns true if intersection point is inside middle region of segment, adjusted by\n   * optional threshold\n   */\n  function isIntersectionMiddle(intersection, waypoints, treshold) {\n    var idx = intersection.index,\n        p = intersection.point,\n        p0, p1, mid, aligned, xDelta, yDelta;\n\n    if (idx <= 0 || intersection.bendpoint) {\n      return false;\n    }\n\n    p0 = waypoints[idx - 1];\n    p1 = waypoints[idx];\n    mid = getMidPoint(p0, p1),\n    aligned = pointsAligned(p0, p1);\n    xDelta = Math.abs(p.x - mid.x);\n    yDelta = Math.abs(p.y - mid.y);\n\n    return aligned && xDelta <= treshold && yDelta <= treshold;\n  }\n\n  /**\n   * Calculates the threshold from a connection's middle which fits the two-third-region\n   */\n  function calculateIntersectionThreshold(connection, intersection) {\n    var waypoints = connection.waypoints,\n        relevantSegment, alignment, segmentLength, threshold;\n\n    if (intersection.index <= 0 || intersection.bendpoint) {\n      return null;\n    }\n\n    // segment relative to connection intersection\n    relevantSegment = {\n      start: waypoints[intersection.index - 1],\n      end: waypoints[intersection.index]\n    };\n\n    alignment = pointsAligned(relevantSegment.start, relevantSegment.end);\n\n    if (!alignment) {\n      return null;\n    }\n\n    if (alignment === 'h') {\n      segmentLength = relevantSegment.end.x - relevantSegment.start.x;\n    } else {\n      segmentLength = relevantSegment.end.y - relevantSegment.start.y;\n    }\n\n    // calculate threshold relative to 2/3 of segment length\n    threshold = calculateSegmentMoveRegion(segmentLength) / 2;\n\n    return threshold;\n  }\n\n  function activateBendpointMove(event, connection) {\n    var waypoints = connection.waypoints,\n        intersection = getConnectionIntersection(canvas, waypoints, event),\n        threshold;\n\n    if (!intersection) {\n      return;\n    }\n\n    threshold = calculateIntersectionThreshold(connection, intersection);\n\n    if (isIntersectionMiddle(intersection, waypoints, threshold)) {\n      connectionSegmentMove.start(event, connection, intersection.index);\n    } else {\n      bendpointMove.start(event, connection, intersection.index, !intersection.bendpoint);\n    }\n\n    // we've handled the event\n    return true;\n  }\n\n  function bindInteractionEvents(node, eventName, element) {\n\n    domEvent.bind(node, eventName, function(event) {\n      interactionEvents.triggerMouseEvent(eventName, event, element);\n      event.stopPropagation();\n    });\n  }\n\n  function getBendpointsContainer(element, create) {\n\n    var layer = canvas.getLayer('overlays'),\n        gfx = domQuery('.djs-bendpoints[data-element-id=\"' + escapeCSS(element.id) + '\"]', layer);\n\n    if (!gfx && create) {\n      gfx = svgCreate('g');\n      svgAttr(gfx, { 'data-element-id': element.id });\n      svgClasses(gfx).add('djs-bendpoints');\n\n      svgAppend(layer, gfx);\n\n      bindInteractionEvents(gfx, 'mousedown', element);\n      bindInteractionEvents(gfx, 'click', element);\n      bindInteractionEvents(gfx, 'dblclick', element);\n    }\n\n    return gfx;\n  }\n\n  function getSegmentDragger(idx, parentGfx) {\n    return domQuery(\n      '.djs-segment-dragger[data-segment-idx=\"' + idx + '\"]',\n      parentGfx\n    );\n  }\n\n  function createBendpoints(gfx, connection) {\n    connection.waypoints.forEach(function(p, idx) {\n      var bendpoint = addBendpoint(gfx);\n\n      svgAppend(gfx, bendpoint);\n\n      translate(bendpoint, p.x, p.y);\n    });\n\n    // add floating bendpoint\n    addBendpoint(gfx, 'floating');\n  }\n\n  function createSegmentDraggers(gfx, connection) {\n\n    var waypoints = connection.waypoints;\n\n    var segmentStart,\n        segmentEnd,\n        segmentDraggerGfx;\n\n    for (var i = 1; i < waypoints.length; i++) {\n\n      segmentStart = waypoints[i - 1];\n      segmentEnd = waypoints[i];\n\n      if (pointsAligned(segmentStart, segmentEnd)) {\n        segmentDraggerGfx = addSegmentDragger(gfx, segmentStart, segmentEnd);\n\n        svgAttr(segmentDraggerGfx, { 'data-segment-idx': i });\n\n        bindInteractionEvents(segmentDraggerGfx, 'mousemove', connection);\n      }\n    }\n  }\n\n  function clearBendpoints(gfx) {\n    forEach(domQueryAll('.' + BENDPOINT_CLS, gfx), function(node) {\n      svgRemove(node);\n    });\n  }\n\n  function clearSegmentDraggers(gfx) {\n    forEach(domQueryAll('.' + SEGMENT_DRAGGER_CLS, gfx), function(node) {\n      svgRemove(node);\n    });\n  }\n\n  function addHandles(connection) {\n\n    var gfx = getBendpointsContainer(connection);\n\n    if (!gfx) {\n      gfx = getBendpointsContainer(connection, true);\n\n      createBendpoints(gfx, connection);\n      createSegmentDraggers(gfx, connection);\n    }\n\n    return gfx;\n  }\n\n  function updateHandles(connection) {\n\n    var gfx = getBendpointsContainer(connection);\n\n    if (gfx) {\n      clearSegmentDraggers(gfx);\n      clearBendpoints(gfx);\n      createSegmentDraggers(gfx, connection);\n      createBendpoints(gfx, connection);\n    }\n  }\n\n  function updateFloatingBendpointPosition(parentGfx, intersection) {\n    var floating = domQuery('.floating', parentGfx),\n        point = intersection.point;\n\n    if (!floating) {\n      return;\n    }\n\n    translate(floating, point.x, point.y);\n\n  }\n\n  function updateSegmentDraggerPosition(parentGfx, intersection, waypoints) {\n\n    var draggerGfx = getSegmentDragger(intersection.index, parentGfx),\n        segmentStart = waypoints[intersection.index - 1],\n        segmentEnd = waypoints[intersection.index],\n        point = intersection.point,\n        mid = getMidPoint(segmentStart, segmentEnd),\n        alignment = pointsAligned(segmentStart, segmentEnd),\n        draggerVisual, relativePosition;\n\n    if (!draggerGfx) {\n      return;\n    }\n\n    draggerVisual = getDraggerVisual(draggerGfx);\n\n    relativePosition = {\n      x: point.x - mid.x,\n      y: point.y - mid.y\n    };\n\n    if (alignment === 'v') {\n\n      // rotate position\n      relativePosition = {\n        x: relativePosition.y,\n        y: relativePosition.x\n      };\n    }\n\n    translate(draggerVisual, relativePosition.x, relativePosition.y);\n  }\n\n  eventBus.on('connection.changed', function(event) {\n    updateHandles(event.element);\n  });\n\n  eventBus.on('connection.remove', function(event) {\n    var gfx = getBendpointsContainer(event.element);\n\n    if (gfx) {\n      svgRemove(gfx);\n    }\n  });\n\n  eventBus.on('element.marker.update', function(event) {\n\n    var element = event.element,\n        bendpointsGfx;\n\n    if (!element.waypoints) {\n      return;\n    }\n\n    bendpointsGfx = addHandles(element);\n\n    if (event.add) {\n      svgClasses(bendpointsGfx).add(event.marker);\n    } else {\n      svgClasses(bendpointsGfx).remove(event.marker);\n    }\n  });\n\n  eventBus.on('element.mousemove', function(event) {\n\n    var element = event.element,\n        waypoints = element.waypoints,\n        bendpointsGfx,\n        intersection;\n\n    if (waypoints) {\n      bendpointsGfx = getBendpointsContainer(element, true);\n\n      intersection = getConnectionIntersection(canvas, waypoints, event.originalEvent);\n\n      if (!intersection) {\n        return;\n      }\n\n      updateFloatingBendpointPosition(bendpointsGfx, intersection);\n\n      if (!intersection.bendpoint) {\n        updateSegmentDraggerPosition(bendpointsGfx, intersection, waypoints);\n      }\n\n    }\n  });\n\n  eventBus.on('element.mousedown', function(event) {\n\n    var originalEvent = event.originalEvent,\n        element = event.element;\n\n    if (!element.waypoints) {\n      return;\n    }\n\n    return activateBendpointMove(originalEvent, element);\n  });\n\n  eventBus.on('selection.changed', function(event) {\n    var newSelection = event.newSelection,\n        primary = newSelection[0];\n\n    if (primary && primary.waypoints) {\n      addHandles(primary);\n    }\n  });\n\n  eventBus.on('element.hover', function(event) {\n    var element = event.element;\n\n    if (element.waypoints) {\n      addHandles(element);\n      interactionEvents.registerEvent(event.gfx, 'mousemove', 'element.mousemove');\n    }\n  });\n\n  eventBus.on('element.out', function(event) {\n    interactionEvents.unregisterEvent(event.gfx, 'mousemove', 'element.mousemove');\n  });\n\n  // update bendpoint container data attribute on element ID change\n  eventBus.on('element.updateId', function(context) {\n    var element = context.element,\n        newId = context.newId;\n\n    if (element.waypoints) {\n      var bendpointContainer = getBendpointsContainer(element);\n\n      if (bendpointContainer) {\n        svgAttr(bendpointContainer, { 'data-element-id': newId });\n      }\n    }\n  });\n\n  // API\n\n  this.addHandles = addHandles;\n  this.updateHandles = updateHandles;\n  this.getBendpointsContainer = getBendpointsContainer;\n  this.getSegmentDragger = getSegmentDragger;\n}\n\nBendpoints.$inject = [\n  'eventBus',\n  'canvas',\n  'interactionEvents',\n  'bendpointMove',\n  'connectionSegmentMove'\n];\n\n\n\n// helper /////////////\n\nfunction getDraggerVisual(draggerGfx) {\n  return domQuery('.djs-visual', draggerGfx);\n}","import {\n  isObject,\n  sortBy\n} from 'min-dash';\n\nimport {\n  pointDistance,\n  pointsOnLine\n} from '../util/Geometry';\n\nimport intersectPaths from 'path-intersection';\n\n\nexport function roundBounds(bounds) {\n  return {\n    x: Math.round(bounds.x),\n    y: Math.round(bounds.y),\n    width: Math.round(bounds.width),\n    height: Math.round(bounds.height)\n  };\n}\n\n\nexport function roundPoint(point) {\n\n  return {\n    x: Math.round(point.x),\n    y: Math.round(point.y)\n  };\n}\n\n\n/**\n * Convert the given bounds to a { top, left, bottom, right } descriptor.\n *\n * @param {Bounds|Point} bounds\n *\n * @return {Object}\n */\nexport function asTRBL(bounds) {\n  return {\n    top: bounds.y,\n    right: bounds.x + (bounds.width || 0),\n    bottom: bounds.y + (bounds.height || 0),\n    left: bounds.x\n  };\n}\n\n\n/**\n * Convert a { top, left, bottom, right } to an objects bounds.\n *\n * @param {Object} trbl\n *\n * @return {Bounds}\n */\nexport function asBounds(trbl) {\n  return {\n    x: trbl.left,\n    y: trbl.top,\n    width: trbl.right - trbl.left,\n    height: trbl.bottom - trbl.top\n  };\n}\n\n\n/**\n * Get the mid of the given bounds or point.\n *\n * @param {Bounds|Point} bounds\n *\n * @return {Point}\n */\nexport function getMid(bounds) {\n  return roundPoint({\n    x: bounds.x + (bounds.width || 0) / 2,\n    y: bounds.y + (bounds.height || 0) / 2\n  });\n}\n\n\n// orientation utils //////////////////////\n\n/**\n * Get orientation of the given rectangle with respect to\n * the reference rectangle.\n *\n * A padding (positive or negative) may be passed to influence\n * horizontal / vertical orientation and intersection.\n *\n * @param {Bounds} rect\n * @param {Bounds} reference\n * @param {Point|number} padding\n *\n * @return {string} the orientation; one of top, top-left, left, ..., bottom, right or intersect.\n */\nexport function getOrientation(rect, reference, padding) {\n\n  padding = padding || 0;\n\n  // make sure we can use an object, too\n  // for individual { x, y } padding\n  if (!isObject(padding)) {\n    padding = { x: padding, y: padding };\n  }\n\n\n  var rectOrientation = asTRBL(rect),\n      referenceOrientation = asTRBL(reference);\n\n  var top = rectOrientation.bottom + padding.y <= referenceOrientation.top,\n      right = rectOrientation.left - padding.x >= referenceOrientation.right,\n      bottom = rectOrientation.top - padding.y >= referenceOrientation.bottom,\n      left = rectOrientation.right + padding.x <= referenceOrientation.left;\n\n  var vertical = top ? 'top' : (bottom ? 'bottom' : null),\n      horizontal = left ? 'left' : (right ? 'right' : null);\n\n  if (horizontal && vertical) {\n    return vertical + '-' + horizontal;\n  } else {\n    return horizontal || vertical || 'intersect';\n  }\n}\n\n\n// intersection utils //////////////////////\n\n/**\n * Get intersection between an element and a line path.\n *\n * @param {PathDef} elementPath\n * @param {PathDef} linePath\n * @param {boolean} cropStart crop from start or end\n *\n * @return {Point}\n */\nexport function getElementLineIntersection(elementPath, linePath, cropStart) {\n\n  var intersections = getIntersections(elementPath, linePath);\n\n  // recognize intersections\n  // only one -> choose\n  // two close together -> choose first\n  // two or more distinct -> pull out appropriate one\n  // none -> ok (fallback to point itself)\n  if (intersections.length === 1) {\n    return roundPoint(intersections[0]);\n  } else if (intersections.length === 2 && pointDistance(intersections[0], intersections[1]) < 1) {\n    return roundPoint(intersections[0]);\n  } else if (intersections.length > 1) {\n\n    // sort by intersections based on connection segment +\n    // distance from start\n    intersections = sortBy(intersections, function(i) {\n      var distance = Math.floor(i.t2 * 100) || 1;\n\n      distance = 100 - distance;\n\n      distance = (distance < 10 ? '0' : '') + distance;\n\n      // create a sort string that makes sure we sort\n      // line segment ASC + line segment position DESC (for cropStart)\n      // line segment ASC + line segment position ASC (for cropEnd)\n      return i.segment2 + '#' + distance;\n    });\n\n    return roundPoint(intersections[cropStart ? 0 : intersections.length - 1]);\n  }\n\n  return null;\n}\n\n\nexport function getIntersections(a, b) {\n  return intersectPaths(a, b);\n}\n\n\nexport function filterRedundantWaypoints(waypoints) {\n\n  // alter copy of waypoints, not original\n  waypoints = waypoints.slice();\n\n  var idx = 0,\n      point,\n      previousPoint,\n      nextPoint;\n\n  while (waypoints[idx]) {\n    point = waypoints[idx];\n    previousPoint = waypoints[idx - 1];\n    nextPoint = waypoints[idx + 1];\n\n    if (pointDistance(point, nextPoint) === 0 ||\n        pointsOnLine(previousPoint, nextPoint, point)) {\n\n      // remove point, if overlapping with {nextPoint}\n      // or on line with {previousPoint} -> {point} -> {nextPoint}\n      waypoints.splice(idx, 1);\n    } else {\n      idx++;\n    }\n  }\n\n  return waypoints;\n}\n","import { filterRedundantWaypoints } from '../../layout/LayoutUtil';\n\nvar round = Math.round;\n\nvar RECONNECT_START = 'reconnectStart',\n    RECONNECT_END = 'reconnectEnd',\n    UPDATE_WAYPOINTS = 'updateWaypoints';\n\n\n/**\n * Move bendpoints through drag and drop to add/remove bendpoints or reconnect connection.\n */\nexport default function BendpointMove(injector, eventBus, canvas, dragging, rules, modeling) {\n  this._injector = injector;\n\n  this.start = function(event, connection, bendpointIndex, insert) {\n    var gfx = canvas.getGraphics(connection),\n        source = connection.source,\n        target = connection.target,\n        waypoints = connection.waypoints,\n        type;\n\n    if (!insert && bendpointIndex === 0) {\n      type = RECONNECT_START;\n    } else\n    if (!insert && bendpointIndex === waypoints.length - 1) {\n      type = RECONNECT_END;\n    } else {\n      type = UPDATE_WAYPOINTS;\n    }\n\n    var command = type === UPDATE_WAYPOINTS ? 'connection.updateWaypoints' : 'connection.reconnect';\n\n    var allowed = rules.allowed(command, {\n      connection: connection,\n      source: source,\n      target: target\n    });\n\n    if (allowed === false) {\n      allowed = rules.allowed(command, {\n        connection: connection,\n        source: target,\n        target: source\n      });\n    }\n\n    if (allowed === false) {\n      return;\n    }\n\n    dragging.init(event, 'bendpoint.move', {\n      data: {\n        connection: connection,\n        connectionGfx: gfx,\n        context: {\n          allowed: allowed,\n          bendpointIndex: bendpointIndex,\n          connection: connection,\n          source: source,\n          target: target,\n          insert: insert,\n          type: type\n        }\n      }\n    });\n  };\n\n  eventBus.on('bendpoint.move.hover', function(event) {\n    var context = event.context,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        hover = event.hover,\n        type = context.type;\n\n    // cache hover state\n    context.hover = hover;\n\n    var allowed;\n\n    if (!hover) {\n      return;\n    }\n\n    var command = type === UPDATE_WAYPOINTS ? 'connection.updateWaypoints' : 'connection.reconnect';\n\n    allowed = context.allowed = rules.allowed(command, {\n      connection: connection,\n      source: type === RECONNECT_START ? hover : source,\n      target: type === RECONNECT_END ? hover : target\n    });\n\n    if (allowed) {\n      context.source = type === RECONNECT_START ? hover : source;\n      context.target = type === RECONNECT_END ? hover : target;\n\n      return;\n    }\n\n    if (allowed === false) {\n      allowed = context.allowed = rules.allowed(command, {\n        connection: connection,\n        source: type === RECONNECT_END ? hover : target,\n        target: type === RECONNECT_START ? hover : source\n      });\n    }\n\n    if (allowed) {\n      context.source = type === RECONNECT_END ? hover : target;\n      context.target = type === RECONNECT_START ? hover : source;\n    }\n  });\n\n  eventBus.on([ 'bendpoint.move.out', 'bendpoint.move.cleanup' ], function(event) {\n    var context = event.context;\n\n    context.hover = null;\n    context.source = null;\n    context.target = null;\n\n    context.allowed = false;\n  });\n\n  eventBus.on('bendpoint.move.end', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        bendpointIndex = context.bendpointIndex,\n        connection = context.connection,\n        insert = context.insert,\n        newWaypoints = connection.waypoints.slice(),\n        source = context.source,\n        target = context.target,\n        type = context.type,\n        hints = context.hints || {};\n\n    // ensure integer values (important if zoom level was > 1 during move)\n    var docking = {\n      x: round(event.x),\n      y: round(event.y)\n    };\n\n    if (!allowed) {\n      return false;\n    }\n\n    if (type === UPDATE_WAYPOINTS) {\n      if (insert) {\n\n        // insert new bendpoint\n        newWaypoints.splice(bendpointIndex, 0, docking);\n      } else {\n\n        // swap previous waypoint with moved one\n        newWaypoints[bendpointIndex] = docking;\n      }\n\n      // pass hints about actual moved bendpoint\n      // useful for connection/label layout\n      hints.bendpointMove = {\n        insert: insert,\n        bendpointIndex: bendpointIndex\n      };\n\n      newWaypoints = this.cropWaypoints(connection, newWaypoints);\n\n      modeling.updateWaypoints(connection, filterRedundantWaypoints(newWaypoints), hints);\n    } else {\n      if (type === RECONNECT_START) {\n        hints.docking = 'source';\n\n        if (isReverse(context)) {\n          hints.docking = 'target';\n\n          hints.newWaypoints = newWaypoints.reverse();\n        }\n      } else if (type === RECONNECT_END) {\n        hints.docking = 'target';\n\n        if (isReverse(context)) {\n          hints.docking = 'source';\n\n          hints.newWaypoints = newWaypoints.reverse();\n        }\n      }\n\n      modeling.reconnect(connection, source, target, docking, hints);\n    }\n  }, this);\n}\n\nBendpointMove.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'dragging',\n  'rules',\n  'modeling'\n];\n\nBendpointMove.prototype.cropWaypoints = function(connection, newWaypoints) {\n  var connectionDocking = this._injector.get('connectionDocking', false);\n\n  if (!connectionDocking) {\n    return newWaypoints;\n  }\n\n  var waypoints = connection.waypoints;\n\n  connection.waypoints = newWaypoints;\n\n  connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n\n  newWaypoints = connection.waypoints;\n\n  connection.waypoints = waypoints;\n\n  return newWaypoints;\n};\n\n\n// helpers //////////\n\nexport function isReverse(context) {\n  var hover = context.hover,\n      source = context.source,\n      target = context.target,\n      type = context.type;\n\n  if (type === RECONNECT_START) {\n    return hover && target && hover === target && source !== target;\n  }\n\n  if (type === RECONNECT_END) {\n    return hover && source && hover === source && source !== target;\n  }\n}","import {\n  classes as svgClasses,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport { addBendpoint } from './BendpointUtil';\n\nimport { translate } from '../../util/SvgTransformUtil';\n\nimport { isReverse } from './BendpointMove';\n\nvar RECONNECT_START = 'reconnectStart',\n    RECONNECT_END = 'reconnectEnd',\n    UPDATE_WAYPOINTS = 'updateWaypoints';\n\nvar MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok',\n    MARKER_CONNECT_HOVER = 'connect-hover',\n    MARKER_CONNECT_UPDATING = 'djs-updating',\n    MARKER_ELEMENT_HIDDEN = 'djs-element-hidden';\n\nvar HIGH_PRIORITY = 1100;\n\n/**\n * Preview connection while moving bendpoints.\n */\nexport default function BendpointMovePreview(bendpointMove, injector, eventBus, canvas) {\n  this._injector = injector;\n\n  var connectionPreview = injector.get('connectionPreview', false);\n\n  eventBus.on('bendpoint.move.start', function(event) {\n    var context = event.context,\n        bendpointIndex = context.bendpointIndex,\n        connection = context.connection,\n        insert = context.insert,\n        waypoints = connection.waypoints,\n        newWaypoints = waypoints.slice();\n\n    context.waypoints = waypoints;\n\n    if (insert) {\n\n      // insert placeholder for new bendpoint\n      newWaypoints.splice(bendpointIndex, 0, { x: event.x, y: event.y });\n    }\n\n    connection.waypoints = newWaypoints;\n\n    // add dragger gfx\n    var draggerGfx = context.draggerGfx = addBendpoint(canvas.getLayer('overlays'));\n\n    svgClasses(draggerGfx).add('djs-dragging');\n\n    canvas.addMarker(connection, MARKER_ELEMENT_HIDDEN);\n    canvas.addMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on('bendpoint.move.hover', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        hover = context.hover,\n        type = context.type;\n\n    if (hover) {\n      canvas.addMarker(hover, MARKER_CONNECT_HOVER);\n\n      if (type === UPDATE_WAYPOINTS) {\n        return;\n      }\n\n      if (allowed) {\n        canvas.removeMarker(hover, MARKER_NOT_OK);\n        canvas.addMarker(hover, MARKER_OK);\n      } else if (allowed === false) {\n        canvas.removeMarker(hover, MARKER_OK);\n        canvas.addMarker(hover, MARKER_NOT_OK);\n      }\n    }\n  });\n\n  eventBus.on([\n    'bendpoint.move.out',\n    'bendpoint.move.cleanup'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        hover = context.hover,\n        target = context.target;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_CONNECT_HOVER);\n      canvas.removeMarker(hover, target ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n  eventBus.on('bendpoint.move.move', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        bendpointIndex = context.bendpointIndex,\n        draggerGfx = context.draggerGfx,\n        hover = context.hover,\n        type = context.type,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        newWaypoints = connection.waypoints.slice(),\n        bendpoint = { x: event.x, y: event.y },\n        hints = context.hints || {},\n        drawPreviewHints = {};\n\n    if (connectionPreview) {\n      if (hints.connectionStart) {\n        drawPreviewHints.connectionStart = hints.connectionStart;\n      }\n\n      if (hints.connectionEnd) {\n        drawPreviewHints.connectionEnd = hints.connectionEnd;\n      }\n\n\n      if (type === RECONNECT_START) {\n        if (isReverse(context)) {\n          drawPreviewHints.connectionEnd = drawPreviewHints.connectionEnd || bendpoint;\n\n          drawPreviewHints.source = target;\n          drawPreviewHints.target = hover || source;\n\n          newWaypoints = newWaypoints.reverse();\n        } else {\n          drawPreviewHints.connectionStart = drawPreviewHints.connectionStart || bendpoint;\n\n          drawPreviewHints.source = hover || source;\n          drawPreviewHints.target = target;\n        }\n      } else if (type === RECONNECT_END) {\n        if (isReverse(context)) {\n          drawPreviewHints.connectionStart = drawPreviewHints.connectionStart || bendpoint;\n\n          drawPreviewHints.source = hover || target;\n          drawPreviewHints.target = source;\n\n          newWaypoints = newWaypoints.reverse();\n        } else {\n          drawPreviewHints.connectionEnd = drawPreviewHints.connectionEnd || bendpoint;\n\n          drawPreviewHints.source = source;\n          drawPreviewHints.target = hover || target;\n        }\n\n      } else {\n        drawPreviewHints.noCropping = true;\n        drawPreviewHints.noLayout = true;\n        newWaypoints[ bendpointIndex ] = bendpoint;\n      }\n\n      if (type === UPDATE_WAYPOINTS) {\n        newWaypoints = bendpointMove.cropWaypoints(connection, newWaypoints);\n      }\n\n      drawPreviewHints.waypoints = newWaypoints;\n\n      connectionPreview.drawPreview(context, allowed, drawPreviewHints);\n    }\n\n    translate(draggerGfx, event.x, event.y);\n  }, this);\n\n  eventBus.on([\n    'bendpoint.move.end',\n    'bendpoint.move.cancel'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        connection = context.connection,\n        draggerGfx = context.draggerGfx,\n        hover = context.hover,\n        target = context.target,\n        waypoints = context.waypoints;\n\n    connection.waypoints = waypoints;\n\n    // remove dragger gfx\n    svgRemove(draggerGfx);\n\n    canvas.removeMarker(connection, MARKER_CONNECT_UPDATING);\n    canvas.removeMarker(connection, MARKER_ELEMENT_HIDDEN);\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_OK);\n      canvas.removeMarker(hover, target ? MARKER_OK : MARKER_NOT_OK);\n    }\n\n    if (connectionPreview) {\n      connectionPreview.cleanUp(context);\n    }\n  });\n}\n\nBendpointMovePreview.$inject = [\n  'bendpointMove',\n  'injector',\n  'eventBus',\n  'canvas'\n];","import {\n  pointsAligned,\n  pointsOnLine\n} from '../../util/Geometry';\n\nimport {\n  addSegmentDragger,\n  getConnectionIntersection\n} from './BendpointUtil';\n\nimport {\n  getMid,\n  getOrientation\n} from '../../layout/LayoutUtil';\n\nvar MARKER_CONNECT_HOVER = 'connect-hover',\n    MARKER_CONNECT_UPDATING = 'djs-updating';\n\nimport {\n  classes as svgClasses,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\n\nfunction axisAdd(point, axis, delta) {\n  return axisSet(point, axis, point[axis] + delta);\n}\n\nfunction axisSet(point, axis, value) {\n  return {\n    x: (axis === 'x' ? value : point.x),\n    y: (axis === 'y' ? value : point.y)\n  };\n}\n\nfunction axisFenced(position, segmentStart, segmentEnd, axis) {\n\n  var maxValue = Math.max(segmentStart[axis], segmentEnd[axis]),\n      minValue = Math.min(segmentStart[axis], segmentEnd[axis]);\n\n  var padding = 20;\n\n  var fencedValue = Math.min(Math.max(minValue + padding, position[axis]), maxValue - padding);\n\n  return axisSet(segmentStart, axis, fencedValue);\n}\n\nfunction flipAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\n\n/**\n * Get the docking point on the given element.\n *\n * Compute a reasonable docking, if non exists.\n *\n * @param  {Point} point\n * @param  {djs.model.Shape} referenceElement\n * @param  {string} moveAxis (x|y)\n *\n * @return {Point}\n */\nfunction getDocking(point, referenceElement, moveAxis) {\n\n  var referenceMid,\n      inverseAxis;\n\n  if (point.original) {\n    return point.original;\n  } else {\n    referenceMid = getMid(referenceElement);\n    inverseAxis = flipAxis(moveAxis);\n\n    return axisSet(point, inverseAxis, referenceMid[inverseAxis]);\n  }\n}\n\n/**\n * A component that implements moving of bendpoints\n */\nexport default function ConnectionSegmentMove(\n    injector, eventBus, canvas,\n    dragging, graphicsFactory, modeling) {\n\n  // optional connection docking integration\n  var connectionDocking = injector.get('connectionDocking', false);\n\n\n  // API\n\n  this.start = function(event, connection, idx) {\n\n    var context,\n        gfx = canvas.getGraphics(connection),\n        segmentStartIndex = idx - 1,\n        segmentEndIndex = idx,\n        waypoints = connection.waypoints,\n        segmentStart = waypoints[segmentStartIndex],\n        segmentEnd = waypoints[segmentEndIndex],\n        intersection = getConnectionIntersection(canvas, waypoints, event),\n        direction, axis, dragPosition;\n\n    direction = pointsAligned(segmentStart, segmentEnd);\n\n    // do not move diagonal connection\n    if (!direction) {\n      return;\n    }\n\n    // the axis where we are going to move things\n    axis = direction === 'v' ? 'x' : 'y';\n\n    if (segmentStartIndex === 0) {\n      segmentStart = getDocking(segmentStart, connection.source, axis);\n    }\n\n    if (segmentEndIndex === waypoints.length - 1) {\n      segmentEnd = getDocking(segmentEnd, connection.target, axis);\n    }\n\n    if (intersection) {\n      dragPosition = intersection.point;\n    } else {\n\n      // set to segment center as default\n      dragPosition = {\n        x: (segmentStart.x + segmentEnd.x) / 2,\n        y: (segmentStart.y + segmentEnd.y) / 2\n      };\n    }\n\n    context = {\n      connection: connection,\n      segmentStartIndex: segmentStartIndex,\n      segmentEndIndex: segmentEndIndex,\n      segmentStart: segmentStart,\n      segmentEnd: segmentEnd,\n      axis: axis,\n      dragPosition: dragPosition\n    };\n\n    dragging.init(event, dragPosition, 'connectionSegment.move', {\n      cursor: axis === 'x' ? 'resize-ew' : 'resize-ns',\n      data: {\n        connection: connection,\n        connectionGfx: gfx,\n        context: context\n      }\n    });\n  };\n\n  /**\n   * Crop connection if connection cropping is provided.\n   *\n   * @param {Connection} connection\n   * @param {Array<Point>} newWaypoints\n   *\n   * @return {Array<Point>} cropped connection waypoints\n   */\n  function cropConnection(connection, newWaypoints) {\n\n    // crop connection, if docking service is provided only\n    if (!connectionDocking) {\n      return newWaypoints;\n    }\n\n    var oldWaypoints = connection.waypoints,\n        croppedWaypoints;\n\n    // temporary set new waypoints\n    connection.waypoints = newWaypoints;\n\n    croppedWaypoints = connectionDocking.getCroppedWaypoints(connection);\n\n    // restore old waypoints\n    connection.waypoints = oldWaypoints;\n\n    return croppedWaypoints;\n  }\n\n  // DRAGGING IMPLEMENTATION\n\n  function redrawConnection(data) {\n    graphicsFactory.update('connection', data.connection, data.connectionGfx);\n  }\n\n  function updateDragger(context, segmentOffset, event) {\n\n    var newWaypoints = context.newWaypoints,\n        segmentStartIndex = context.segmentStartIndex + segmentOffset,\n        segmentStart = newWaypoints[segmentStartIndex],\n        segmentEndIndex = context.segmentEndIndex + segmentOffset,\n        segmentEnd = newWaypoints[segmentEndIndex],\n        axis = flipAxis(context.axis);\n\n    // make sure the dragger does not move\n    // outside the connection\n    var draggerPosition = axisFenced(event, segmentStart, segmentEnd, axis);\n\n    // update dragger\n    translate(context.draggerGfx, draggerPosition.x, draggerPosition.y);\n  }\n\n  /**\n   * Filter waypoints for redundant ones (i.e. on the same axis).\n   * Returns the filtered waypoints and the offset related to the segment move.\n   *\n   * @param {Array<Point>} waypoints\n   * @param {Integer} segmentStartIndex of moved segment start\n   *\n   * @return {Object} { filteredWaypoints, segmentOffset }\n   */\n  function filterRedundantWaypoints(waypoints, segmentStartIndex) {\n\n    var segmentOffset = 0;\n\n    var filteredWaypoints = waypoints.filter(function(r, idx) {\n      if (pointsOnLine(waypoints[idx - 1], waypoints[idx + 1], r)) {\n\n        // remove point and increment offset\n        segmentOffset = idx <= segmentStartIndex ? segmentOffset - 1 : segmentOffset;\n        return false;\n      }\n\n      // dont remove point\n      return true;\n    });\n\n    return {\n      waypoints: filteredWaypoints,\n      segmentOffset: segmentOffset\n    };\n  }\n\n  eventBus.on('connectionSegment.move.start', function(event) {\n\n    var context = event.context,\n        connection = event.connection,\n        layer = canvas.getLayer('overlays');\n\n    context.originalWaypoints = connection.waypoints.slice();\n\n    // add dragger gfx\n    context.draggerGfx = addSegmentDragger(layer, context.segmentStart, context.segmentEnd);\n    svgClasses(context.draggerGfx).add('djs-dragging');\n\n    canvas.addMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on('connectionSegment.move.move', function(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        segmentStartIndex = context.segmentStartIndex,\n        segmentEndIndex = context.segmentEndIndex,\n        segmentStart = context.segmentStart,\n        segmentEnd = context.segmentEnd,\n        axis = context.axis;\n\n    var newWaypoints = context.originalWaypoints.slice(),\n        newSegmentStart = axisAdd(segmentStart, axis, event['d' + axis]),\n        newSegmentEnd = axisAdd(segmentEnd, axis, event['d' + axis]);\n\n    // original waypoint count and added / removed\n    // from start waypoint delta. We use the later\n    // to retrieve the updated segmentStartIndex / segmentEndIndex\n    var waypointCount = newWaypoints.length,\n        segmentOffset = 0;\n\n    // move segment start / end by axis delta\n    newWaypoints[segmentStartIndex] = newSegmentStart;\n    newWaypoints[segmentEndIndex] = newSegmentEnd;\n\n    var sourceToSegmentOrientation,\n        targetToSegmentOrientation;\n\n    // handle first segment\n    if (segmentStartIndex < 2) {\n      sourceToSegmentOrientation = getOrientation(connection.source, newSegmentStart);\n\n      // first bendpoint, remove first segment if intersecting\n      if (segmentStartIndex === 1) {\n\n        if (sourceToSegmentOrientation === 'intersect') {\n          newWaypoints.shift();\n          newWaypoints[0] = newSegmentStart;\n          segmentOffset--;\n        }\n      }\n\n      // docking point, add segment if not intersecting anymore\n      else {\n        if (sourceToSegmentOrientation !== 'intersect') {\n          newWaypoints.unshift(segmentStart);\n          segmentOffset++;\n        }\n      }\n    }\n\n    // handle last segment\n    if (segmentEndIndex > waypointCount - 3) {\n      targetToSegmentOrientation = getOrientation(connection.target, newSegmentEnd);\n\n      // last bendpoint, remove last segment if intersecting\n      if (segmentEndIndex === waypointCount - 2) {\n\n        if (targetToSegmentOrientation === 'intersect') {\n          newWaypoints.pop();\n          newWaypoints[newWaypoints.length - 1] = newSegmentEnd;\n        }\n      }\n\n      // last bendpoint, remove last segment if intersecting\n      else {\n        if (targetToSegmentOrientation !== 'intersect') {\n          newWaypoints.push(segmentEnd);\n        }\n      }\n    }\n\n    // update connection waypoints\n    context.newWaypoints = connection.waypoints = cropConnection(connection, newWaypoints);\n\n    // update dragger position\n    updateDragger(context, segmentOffset, event);\n\n    // save segmentOffset in context\n    context.newSegmentStartIndex = segmentStartIndex + segmentOffset;\n\n    // redraw connection\n    redrawConnection(event);\n  });\n\n  eventBus.on('connectionSegment.move.hover', function(event) {\n\n    event.context.hover = event.hover;\n    canvas.addMarker(event.hover, MARKER_CONNECT_HOVER);\n  });\n\n  eventBus.on([\n    'connectionSegment.move.out',\n    'connectionSegment.move.cleanup'\n  ], function(event) {\n\n    // remove connect marker\n    // if it was added\n    var hover = event.context.hover;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_CONNECT_HOVER);\n    }\n  });\n\n  eventBus.on('connectionSegment.move.cleanup', function(event) {\n\n    var context = event.context,\n        connection = context.connection;\n\n    // remove dragger gfx\n    if (context.draggerGfx) {\n      svgRemove(context.draggerGfx);\n    }\n\n    canvas.removeMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on([\n    'connectionSegment.move.cancel',\n    'connectionSegment.move.end'\n  ], function(event) {\n    var context = event.context,\n        connection = context.connection;\n\n    connection.waypoints = context.originalWaypoints;\n\n    redrawConnection(event);\n  });\n\n  eventBus.on('connectionSegment.move.end', function(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        newWaypoints = context.newWaypoints,\n        newSegmentStartIndex = context.newSegmentStartIndex;\n\n    // ensure we have actual pixel values bendpoint\n    // coordinates (important when zoom level was > 1 during move)\n    newWaypoints = newWaypoints.map(function(p) {\n      return {\n        original: p.original,\n        x: Math.round(p.x),\n        y: Math.round(p.y)\n      };\n    });\n\n    // apply filter redunant waypoints\n    var filtered = filterRedundantWaypoints(newWaypoints, newSegmentStartIndex);\n\n    // get filtered waypoints\n    var filteredWaypoints = filtered.waypoints,\n        croppedWaypoints = cropConnection(connection, filteredWaypoints),\n        segmentOffset = filtered.segmentOffset;\n\n    var hints = {\n      segmentMove: {\n        segmentStartIndex: context.segmentStartIndex,\n        newSegmentStartIndex: newSegmentStartIndex + segmentOffset\n      }\n    };\n\n    modeling.updateWaypoints(connection, croppedWaypoints, hints);\n  });\n}\n\nConnectionSegmentMove.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'dragging',\n  'graphicsFactory',\n  'modeling'\n];\n","var abs = Math.abs,\n    round = Math.round;\n\n\n/**\n * Snap value to a collection of reference values.\n *\n * @param  {number} value\n * @param  {Array<number>} values\n * @param  {number} [tolerance=10]\n *\n * @return {number} the value we snapped to or null, if none snapped\n */\nexport function snapTo(value, values, tolerance) {\n  tolerance = tolerance === undefined ? 10 : tolerance;\n\n  var idx, snapValue;\n\n  for (idx = 0; idx < values.length; idx++) {\n    snapValue = values[idx];\n\n    if (abs(snapValue - value) <= tolerance) {\n      return snapValue;\n    }\n  }\n}\n\n\nexport function topLeft(bounds) {\n  return {\n    x: bounds.x,\n    y: bounds.y\n  };\n}\n\nexport function topRight(bounds) {\n  return {\n    x: bounds.x + bounds.width,\n    y: bounds.y\n  };\n}\n\nexport function bottomLeft(bounds) {\n  return {\n    x: bounds.x,\n    y: bounds.y + bounds.height\n  };\n}\n\nexport function bottomRight(bounds) {\n  return {\n    x: bounds.x + bounds.width,\n    y: bounds.y + bounds.height\n  };\n}\n\nexport function mid(bounds, defaultValue) {\n\n  if (!bounds || isNaN(bounds.x) || isNaN(bounds.y)) {\n    return defaultValue;\n  }\n\n  return {\n    x: round(bounds.x + bounds.width / 2),\n    y: round(bounds.y + bounds.height / 2)\n  };\n}\n\n\n/**\n * Retrieve the snap state of the given event.\n *\n * @param  {Event} event\n * @param  {string} axis\n *\n * @return {boolean} the snapped state\n *\n */\nexport function isSnapped(event, axis) {\n  var snapped = event.snapped;\n\n  if (!snapped) {\n    return false;\n  }\n\n  if (typeof axis === 'string') {\n    return snapped[axis];\n  }\n\n  return snapped.x && snapped.y;\n}\n\n\n/**\n * Set the given event as snapped.\n *\n * This method may change the x and/or y position of the shape\n * from the given event!\n *\n * @param {Event} event\n * @param {string} axis\n * @param {number|boolean} value\n *\n * @return {number} old value\n */\nexport function setSnapped(event, axis, value) {\n  if (typeof axis !== 'string') {\n    throw new Error('axis must be in [x, y]');\n  }\n\n  if (typeof value !== 'number' && value !== false) {\n    throw new Error('value must be Number or false');\n  }\n\n  var delta,\n      previousValue = event[axis];\n\n  var snapped = event.snapped = (event.snapped || {});\n\n\n  if (value === false) {\n    snapped[axis] = false;\n  } else {\n    snapped[axis] = true;\n\n    delta = value - previousValue;\n\n    event[axis] += delta;\n    event['d' + axis] += delta;\n  }\n\n  return previousValue;\n}\n\n/**\n * Get children of a shape.\n *\n * @param {djs.model.Shape} parent\n *\n * @returns {Array<djs.model.Shape|djs.model.Connection>}\n */\nexport function getChildren(parent) {\n  return parent.children || [];\n}","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport { setSnapped } from '../snapping/SnapUtil';\n\nvar abs= Math.abs,\n    round = Math.round;\n\nvar TOLERANCE = 10;\n\n\nexport default function BendpointSnapping(eventBus) {\n\n  function snapTo(values, value) {\n\n    if (isArray(values)) {\n      var i = values.length;\n\n      while (i--) if (abs(values[i] - value) <= TOLERANCE) {\n        return values[i];\n      }\n    } else {\n      values = +values;\n      var rem = value % values;\n\n      if (rem < TOLERANCE) {\n        return value - rem;\n      }\n\n      if (rem > values - TOLERANCE) {\n        return value - rem + values;\n      }\n    }\n\n    return value;\n  }\n\n  function mid(element) {\n    if (element.width) {\n      return {\n        x: round(element.width / 2 + element.x),\n        y: round(element.height / 2 + element.y)\n      };\n    }\n  }\n\n  // connection segment snapping //////////////////////\n\n  function getConnectionSegmentSnaps(context) {\n\n    var snapPoints = context.snapPoints,\n        connection = context.connection,\n        waypoints = connection.waypoints,\n        segmentStart = context.segmentStart,\n        segmentStartIndex = context.segmentStartIndex,\n        segmentEnd = context.segmentEnd,\n        segmentEndIndex = context.segmentEndIndex,\n        axis = context.axis;\n\n    if (snapPoints) {\n      return snapPoints;\n    }\n\n    var referenceWaypoints = [\n      waypoints[segmentStartIndex - 1],\n      segmentStart,\n      segmentEnd,\n      waypoints[segmentEndIndex + 1]\n    ];\n\n    if (segmentStartIndex < 2) {\n      referenceWaypoints.unshift(mid(connection.source));\n    }\n\n    if (segmentEndIndex > waypoints.length - 3) {\n      referenceWaypoints.unshift(mid(connection.target));\n    }\n\n    context.snapPoints = snapPoints = { horizontal: [] , vertical: [] };\n\n    forEach(referenceWaypoints, function(p) {\n\n      // we snap on existing bendpoints only,\n      // not placeholders that are inserted during add\n      if (p) {\n        p = p.original || p;\n\n        if (axis === 'y') {\n          snapPoints.horizontal.push(p.y);\n        }\n\n        if (axis === 'x') {\n          snapPoints.vertical.push(p.x);\n        }\n      }\n    });\n\n    return snapPoints;\n  }\n\n  eventBus.on('connectionSegment.move.move', 1500, function(event) {\n    var context = event.context,\n        snapPoints = getConnectionSegmentSnaps(context),\n        x = event.x,\n        y = event.y,\n        sx, sy;\n\n    if (!snapPoints) {\n      return;\n    }\n\n    // snap\n    sx = snapTo(snapPoints.vertical, x);\n    sy = snapTo(snapPoints.horizontal, y);\n\n\n    // correction x/y\n    var cx = (x - sx),\n        cy = (y - sy);\n\n    // update delta\n    assign(event, {\n      dx: event.dx - cx,\n      dy: event.dy - cy,\n      x: sx,\n      y: sy\n    });\n\n    // only set snapped if actually snapped\n    if (cx || snapPoints.vertical.indexOf(x) !== -1) {\n      setSnapped(event, 'x', sx);\n    }\n\n    if (cy || snapPoints.horizontal.indexOf(y) !== -1) {\n      setSnapped(event, 'y', sy);\n    }\n  });\n\n\n  // bendpoint snapping //////////////////////\n\n  function getBendpointSnaps(context) {\n\n    var snapPoints = context.snapPoints,\n        waypoints = context.connection.waypoints,\n        bendpointIndex = context.bendpointIndex;\n\n    if (snapPoints) {\n      return snapPoints;\n    }\n\n    var referenceWaypoints = [ waypoints[bendpointIndex - 1], waypoints[bendpointIndex + 1] ];\n\n    context.snapPoints = snapPoints = { horizontal: [] , vertical: [] };\n\n    forEach(referenceWaypoints, function(p) {\n\n      // we snap on existing bendpoints only,\n      // not placeholders that are inserted during add\n      if (p) {\n        p = p.original || p;\n\n        snapPoints.horizontal.push(p.y);\n        snapPoints.vertical.push(p.x);\n      }\n    });\n\n    return snapPoints;\n  }\n\n\n  eventBus.on([ 'bendpoint.move.move', 'bendpoint.move.end' ], 1500, function(event) {\n\n    var context = event.context,\n        snapPoints = getBendpointSnaps(context),\n        hover = context.hover,\n        hoverMid = hover && mid(hover),\n        x = event.x,\n        y = event.y,\n        sx, sy;\n\n    if (!snapPoints) {\n      return;\n    }\n\n    // snap to hover mid\n    sx = snapTo(hoverMid ? snapPoints.vertical.concat([ hoverMid.x ]) : snapPoints.vertical, x);\n    sy = snapTo(hoverMid ? snapPoints.horizontal.concat([ hoverMid.y ]) : snapPoints.horizontal, y);\n\n    // correction x/y\n    var cx = (x - sx),\n        cy = (y - sy);\n\n    // update delta\n    assign(event, {\n      dx: event.dx - cx,\n      dy: event.dy - cy,\n      x: event.x - cx,\n      y: event.y - cy\n    });\n\n    // only set snapped if actually snapped\n    if (cx || snapPoints.vertical.indexOf(x) !== -1) {\n      setSnapped(event, 'x', sx);\n    }\n\n    if (cy || snapPoints.horizontal.indexOf(y) !== -1) {\n      setSnapped(event, 'y', sy);\n    }\n  });\n}\n\n\nBendpointSnapping.$inject = [ 'eventBus' ];","import DraggingModule from '../dragging';\nimport RulesModule from '../rules';\n\nimport Bendpoints from './Bendpoints';\nimport BendpointMove from './BendpointMove';\nimport BendpointMovePreview from './BendpointMovePreview';\nimport ConnectionSegmentMove from './ConnectionSegmentMove';\nimport BendpointSnapping from './BendpointSnapping';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    RulesModule\n  ],\n  __init__: [ 'bendpoints', 'bendpointSnapping', 'bendpointMovePreview' ],\n  bendpoints: [ 'type', Bendpoints ],\n  bendpointMove: [ 'type', BendpointMove ],\n  bendpointMovePreview: [ 'type', BendpointMovePreview ],\n  connectionSegmentMove: [ 'type', ConnectionSegmentMove ],\n  bendpointSnapping: [ 'type', BendpointSnapping ]\n};\n","import {\n  getMid\n} from '../../layout/LayoutUtil';\n\nimport {\n  isNil,\n  isObject\n} from 'min-dash';\n\n\nexport default function Connect(eventBus, dragging, modeling, rules) {\n\n  // rules\n\n  function canConnect(source, target) {\n    return rules.allowed('connection.create', {\n      source: source,\n      target: target\n    });\n  }\n\n  function canConnectReverse(source, target) {\n    return canConnect(target, source);\n  }\n\n\n  // event handlers\n\n  eventBus.on('connect.hover', function(event) {\n    var context = event.context,\n        start = context.start,\n        hover = event.hover,\n        canExecute;\n\n    // cache hover state\n    context.hover = hover;\n\n    canExecute = context.canExecute = canConnect(start, hover);\n\n    // ignore hover\n    if (isNil(canExecute)) {\n      return;\n    }\n\n    if (canExecute !== false) {\n      context.source = start;\n      context.target = hover;\n\n      return;\n    }\n\n    canExecute = context.canExecute = canConnectReverse(start, hover);\n\n    // ignore hover\n    if (isNil(canExecute)) {\n      return;\n    }\n\n    if (canExecute !== false) {\n      context.source = hover;\n      context.target = start;\n    }\n  });\n\n  eventBus.on([ 'connect.out', 'connect.cleanup' ], function(event) {\n    var context = event.context;\n\n    context.hover = null;\n    context.source = null;\n    context.target = null;\n\n    context.canExecute = false;\n  });\n\n  eventBus.on('connect.end', function(event) {\n    var context = event.context,\n        canExecute = context.canExecute,\n        connectionStart = context.connectionStart,\n        connectionEnd = {\n          x: event.x,\n          y: event.y\n        },\n        source = context.source,\n        target = context.target;\n\n    if (!canExecute) {\n      return false;\n    }\n\n    var attrs = null,\n        hints = {\n          connectionStart: isReverse(context) ? connectionEnd : connectionStart,\n          connectionEnd: isReverse(context) ? connectionStart : connectionEnd\n        };\n\n    if (isObject(canExecute)) {\n      attrs = canExecute;\n    }\n\n    modeling.connect(source, target, attrs, hints);\n  });\n\n\n  // API\n\n  /**\n   * Start connect operation.\n   *\n   * @param {DOMEvent} event\n   * @param {djs.model.Base} start\n   * @param {Point} [connectionStart]\n   * @param {boolean} [autoActivate=false]\n   */\n  this.start = function(event, start, connectionStart, autoActivate) {\n    if (!isObject(connectionStart)) {\n      autoActivate = connectionStart;\n      connectionStart = getMid(start);\n    }\n\n    dragging.init(event, 'connect', {\n      autoActivate: autoActivate,\n      data: {\n        shape: start,\n        context: {\n          start: start,\n          connectionStart: connectionStart\n        }\n      }\n    });\n  };\n}\n\nConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'modeling',\n  'rules'\n];\n\n\n// helpers //////////\n\nexport function isReverse(context) {\n  var hover = context.hover,\n      source = context.source,\n      target = context.target;\n\n  return hover && source && hover === source && source !== target;\n}","import { isReverse } from './Connect';\n\nvar HIGH_PRIORITY = 1100,\n    LOW_PRIORITY = 900;\n\nvar MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n/**\n * Shows connection preview during connect.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function ConnectPreview(injector, eventBus, canvas) {\n  var connectionPreview = injector.get('connectionPreview', false);\n\n  connectionPreview && eventBus.on('connect.move', function(event) {\n    var context = event.context,\n        canConnect = context.canExecute,\n        hover = context.hover,\n        source = context.source,\n        start = context.start,\n        startPosition = context.startPosition,\n        connectionStart = context.connectionStart,\n        connectionEnd = context.connectionEnd,\n        target = context.target;\n\n    if (!connectionStart) {\n      connectionStart = isReverse(context) ? {\n        x: event.x,\n        y: event.y\n      } : startPosition;\n    }\n\n    if (!connectionEnd) {\n      connectionEnd = isReverse(context) ? startPosition : {\n        x: event.x,\n        y: event.y\n      };\n    }\n\n    connectionPreview.drawPreview(context, canConnect, {\n      source: source || start,\n      target: target || hover,\n      connectionStart: connectionStart,\n      connectionEnd: connectionEnd\n    });\n  });\n\n  eventBus.on('connect.hover', LOW_PRIORITY, function(event) {\n    var context = event.context,\n        hover = event.hover,\n        canExecute = context.canExecute;\n\n    // ignore hover\n    if (canExecute === null) {\n      return;\n    }\n\n    canvas.addMarker(hover, canExecute ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n  eventBus.on([\n    'connect.out',\n    'connect.cleanup'\n  ], HIGH_PRIORITY, function(event) {\n    var hover = event.hover;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_OK);\n      canvas.removeMarker(hover, MARKER_NOT_OK);\n    }\n  });\n\n  connectionPreview && eventBus.on('connect.cleanup', function(event) {\n    connectionPreview.cleanUp(event.context);\n  });\n}\n\nConnectPreview.$inject = [\n  'injector',\n  'eventBus',\n  'canvas'\n];\n","import SelectionModule from '../selection';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\n\nimport Connect from './Connect';\nimport ConnectPreview from './ConnectPreview';\n\nexport default {\n  __depends__: [\n    SelectionModule,\n    RulesModule,\n    DraggingModule\n  ],\n  __init__: [\n    'connectPreview'\n  ],\n  connect: [ 'type', Connect ],\n  connectPreview: [ 'type', ConnectPreview ]\n};\n","import {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove,\n  clear as svgClear\n} from 'tiny-svg';\n\nimport {\n  isObject\n} from 'min-dash';\n\nimport {\n  getElementLineIntersection,\n  getMid\n} from '../../layout/LayoutUtil';\n\n\nvar MARKER_CONNECTION_PREVIEW = 'djs-connection-preview';\n\n/**\n * Draws connection preview. Optionally, this can use layouter and connection docking to draw\n * better looking previews.\n *\n * @param {didi.Injector} injector\n * @param {Canvas} canvas\n * @param {GraphicsFactory} graphicsFactory\n * @param {ElementFactory} elementFactory\n */\nexport default function ConnectionPreview(\n    injector,\n    canvas,\n    graphicsFactory,\n    elementFactory\n) {\n  this._canvas = canvas;\n  this._graphicsFactory = graphicsFactory;\n  this._elementFactory = elementFactory;\n\n  // optional components\n  this._connectionDocking = injector.get('connectionDocking', false);\n  this._layouter = injector.get('layouter', false);\n}\n\nConnectionPreview.$inject = [\n  'injector',\n  'canvas',\n  'graphicsFactory',\n  'elementFactory'\n];\n\n/**\n * Draw connection preview.\n *\n * Provide at least one of <source, connectionStart> and <target, connectionEnd> to create a preview.\n * In the clean up stage, call `connectionPreview#cleanUp` with the context to remove preview.\n *\n * @param {Object} context\n * @param {Object|boolean} canConnect\n * @param {Object} hints\n * @param {djs.model.shape} [hints.source] source element\n * @param {djs.model.shape} [hints.target] target element\n * @param {Point} [hints.connectionStart] connection preview start\n * @param {Point} [hints.connectionEnd] connection preview end\n * @param {Array<Point>} [hints.waypoints] provided waypoints for preview\n * @param {boolean} [hints.noLayout] true if preview should not be laid out\n * @param {boolean} [hints.noCropping] true if preview should not be cropped\n * @param {boolean} [hints.noNoop] true if simple connection should not be drawn\n */\nConnectionPreview.prototype.drawPreview = function(context, canConnect, hints) {\n\n  hints = hints || {};\n\n  var connectionPreviewGfx = context.connectionPreviewGfx,\n      getConnection = context.getConnection,\n      source = hints.source,\n      target = hints.target,\n      waypoints = hints.waypoints,\n      connectionStart = hints.connectionStart,\n      connectionEnd = hints.connectionEnd,\n      noLayout = hints.noLayout,\n      noCropping = hints.noCropping,\n      noNoop = hints.noNoop,\n      connection;\n\n  var self = this;\n\n  if (!connectionPreviewGfx) {\n    connectionPreviewGfx = context.connectionPreviewGfx = this.createConnectionPreviewGfx();\n  }\n\n  svgClear(connectionPreviewGfx);\n\n  if (!getConnection) {\n    getConnection = context.getConnection = cacheReturnValues(function(canConnect, source, target) {\n      return self.getConnection(canConnect, source, target);\n    });\n  }\n\n  if (canConnect) {\n    connection = getConnection(canConnect, source, target);\n  }\n\n  if (!connection) {\n    !noNoop && this.drawNoopPreview(connectionPreviewGfx, hints);\n    return;\n  }\n\n  connection.waypoints = waypoints || [];\n\n  // optional layout\n  if (this._layouter && !noLayout) {\n    connection.waypoints = this._layouter.layoutConnection(connection, {\n      source: source,\n      target: target,\n      connectionStart: connectionStart,\n      connectionEnd: connectionEnd,\n      waypoints: hints.waypoints || connection.waypoints\n    });\n  }\n\n  // fallback if no waypoints were provided nor created with layouter\n  if (!connection.waypoints || !connection.waypoints.length) {\n    connection.waypoints = [\n      source ? getMid(source) : connectionStart,\n      target ? getMid(target) : connectionEnd\n    ];\n  }\n\n  // optional cropping\n  if (this._connectionDocking && (source || target) && !noCropping) {\n    connection.waypoints = this._connectionDocking.getCroppedWaypoints(connection, source, target);\n  }\n\n  this._graphicsFactory.drawConnection(connectionPreviewGfx, connection);\n};\n\n/**\n * Draw simple connection between source and target or provided points.\n *\n * @param {SVGElement} connectionPreviewGfx container for the connection\n * @param {Object} hints\n * @param {djs.model.shape} [hints.source] source element\n * @param {djs.model.shape} [hints.target] target element\n * @param {Point} [hints.connectionStart] required if source is not provided\n * @param {Point} [hints.connectionEnd] required if target is not provided\n */\nConnectionPreview.prototype.drawNoopPreview = function(connectionPreviewGfx, hints) {\n  var source = hints.source,\n      target = hints.target,\n      start = hints.connectionStart || getMid(source),\n      end = hints.connectionEnd || getMid(target);\n\n  var waypoints = this.cropWaypoints(start, end, source, target);\n\n  var connection = this.createNoopConnection(waypoints[0], waypoints[1]);\n\n  svgAppend(connectionPreviewGfx, connection);\n};\n\n/**\n * Return cropped waypoints.\n *\n * @param {Point} start\n * @param {Point} end\n * @param {djs.model.shape} source\n * @param {djs.model.shape} target\n *\n * @returns {Array}\n */\nConnectionPreview.prototype.cropWaypoints = function(start, end, source, target) {\n  var graphicsFactory = this._graphicsFactory,\n      sourcePath = source && graphicsFactory.getShapePath(source),\n      targetPath = target && graphicsFactory.getShapePath(target),\n      connectionPath = graphicsFactory.getConnectionPath({ waypoints: [ start, end ] });\n\n  start = (source && getElementLineIntersection(sourcePath, connectionPath, true)) || start;\n  end = (target && getElementLineIntersection(targetPath, connectionPath, false)) || end;\n\n  return [ start, end ];\n};\n\n/**\n * Remove connection preview container if it exists.\n *\n * @param {Object} [context]\n * @param {SVGElement} [context.connectionPreviewGfx] preview container\n */\nConnectionPreview.prototype.cleanUp = function(context) {\n  if (context && context.connectionPreviewGfx) {\n    svgRemove(context.connectionPreviewGfx);\n  }\n};\n\n/**\n * Get connection that connects source and target.\n *\n * @param {Object|boolean} canConnect\n *\n * @returns {djs.model.connection}\n */\nConnectionPreview.prototype.getConnection = function(canConnect) {\n  var attrs = ensureConnectionAttrs(canConnect);\n\n  return this._elementFactory.createConnection(attrs);\n};\n\n\n/**\n * Add and return preview graphics.\n *\n * @returns {SVGElement}\n */\nConnectionPreview.prototype.createConnectionPreviewGfx = function() {\n  var gfx = svgCreate('g');\n\n  svgAttr(gfx, {\n    pointerEvents: 'none'\n  });\n\n  svgClasses(gfx).add(MARKER_CONNECTION_PREVIEW);\n\n  svgAppend(this._canvas.getDefaultLayer(), gfx);\n\n  return gfx;\n};\n\n/**\n * Create and return simple connection.\n *\n * @param {Point} start\n * @param {Point} end\n *\n * @returns {SVGElement}\n */\nConnectionPreview.prototype.createNoopConnection = function(start, end) {\n  var connection = svgCreate('polyline');\n\n  svgAttr(connection, {\n    'stroke': '#333',\n    'strokeDasharray': [ 1 ],\n    'strokeWidth': 2,\n    'pointer-events': 'none'\n  });\n\n  svgAttr(connection, { 'points': [ start.x, start.y, end.x, end.y ] });\n\n  return connection;\n};\n\n// helpers //////////\n\n/**\n * Returns function that returns cached return values referenced by stringified first argument.\n *\n * @param {Function} fn\n *\n * @return {Function}\n */\nfunction cacheReturnValues(fn) {\n  var returnValues = {};\n\n  /**\n   * Return cached return value referenced by stringified first argument.\n   *\n   * @returns {*}\n   */\n  return function(firstArgument) {\n    var key = JSON.stringify(firstArgument);\n\n    var returnValue = returnValues[key];\n\n    if (!returnValue) {\n      returnValue = returnValues[key] = fn.apply(null, arguments);\n    }\n\n    return returnValue;\n  };\n}\n\n/**\n * Ensure connection attributes is object.\n *\n * @param {Object|boolean} canConnect\n *\n * @returns {Object}\n */\nfunction ensureConnectionAttrs(canConnect) {\n  if (isObject(canConnect)) {\n    return canConnect;\n  } else {\n    return {};\n  }\n}\n","import ConnectionPreview from './ConnectionPreview';\n\nexport default {\n  __init__: [ 'connectionPreview' ],\n  connectionPreview: [ 'type', ConnectionPreview ]\n};\n","/**\n * Util that provides unique IDs.\n *\n * @class djs.util.IdGenerator\n * @constructor\n * @memberOf djs.util\n *\n * The ids can be customized via a given prefix and contain a random value to avoid collisions.\n *\n * @param {string} prefix a prefix to prepend to generated ids (for better readability)\n */\nexport default function IdGenerator(prefix) {\n\n  this._counter = 0;\n  this._prefix = (prefix ? prefix + '-' : '') + Math.floor(Math.random() * 1000000000) + '-';\n}\n\n/**\n * Returns a next unique ID.\n *\n * @method djs.util.IdGenerator#next\n *\n * @returns {string} the id\n */\nIdGenerator.prototype.next = function() {\n  return this._prefix + (++this._counter);\n};\n","import {\n  isArray,\n  isString,\n  isObject,\n  assign,\n  forEach,\n  find,\n  filter,\n  matchPattern,\n  isDefined\n} from 'min-dash';\n\nimport {\n  domify,\n  classes as domClasses,\n  attr as domAttr,\n  remove as domRemove,\n  clear as domClear\n} from 'min-dom';\n\nimport {\n  getBBox\n} from '../../util/Elements';\n\nimport Ids from '../../util/IdGenerator';\n\n// document wide unique overlay ids\nvar ids = new Ids('ov');\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * A service that allows users to attach overlays to diagram elements.\n *\n * The overlay service will take care of overlay positioning during updates.\n *\n * @example\n *\n * // add a pink badge on the top left of the shape\n * overlays.add(someShape, {\n *   position: {\n *     top: -5,\n *     left: -5\n *   },\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\n * });\n *\n * // or add via shape id\n *\n * overlays.add('some-element-id', {\n *   position: {\n *     top: -5,\n *     left: -5\n *   }\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\n * });\n *\n * // or add with optional type\n *\n * overlays.add(someShape, 'badge', {\n *   position: {\n *     top: -5,\n *     left: -5\n *   }\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\n * });\n *\n *\n * // remove an overlay\n *\n * var id = overlays.add(...);\n * overlays.remove(id);\n *\n *\n * You may configure overlay defaults during tool by providing a `config` module\n * with `overlays.defaults` as an entry:\n *\n * {\n *   overlays: {\n *     defaults: {\n *       show: {\n *         minZoom: 0.7,\n *         maxZoom: 5.0\n *       },\n *       scale: {\n *         min: 1\n *       }\n *     }\n * }\n *\n * @param {Object} config\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {ElementRegistry} elementRegistry\n */\nexport default function Overlays(config, eventBus, canvas, elementRegistry) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._elementRegistry = elementRegistry;\n\n  this._ids = ids;\n\n  this._overlayDefaults = assign({\n\n    // no show constraints\n    show: null,\n\n    // always scale\n    scale: true\n  }, config && config.defaults);\n\n  /**\n   * Mapping overlayId -> overlay\n   */\n  this._overlays = {};\n\n  /**\n   * Mapping elementId -> overlay container\n   */\n  this._overlayContainers = [];\n\n  // root html element for all overlays\n  this._overlayRoot = createRoot(canvas.getContainer());\n\n  this._init();\n}\n\n\nOverlays.$inject = [\n  'config.overlays',\n  'eventBus',\n  'canvas',\n  'elementRegistry'\n];\n\n\n/**\n * Returns the overlay with the specified id or a list of overlays\n * for an element with a given type.\n *\n * @example\n *\n * // return the single overlay with the given id\n * overlays.get('some-id');\n *\n * // return all overlays for the shape\n * overlays.get({ element: someShape });\n *\n * // return all overlays on shape with type 'badge'\n * overlays.get({ element: someShape, type: 'badge' });\n *\n * // shape can also be specified as id\n * overlays.get({ element: 'element-id', type: 'badge' });\n *\n *\n * @param {Object} search\n * @param {string} [search.id]\n * @param {string|djs.model.Base} [search.element]\n * @param {string} [search.type]\n *\n * @return {Object|Array<Object>} the overlay(s)\n */\nOverlays.prototype.get = function(search) {\n\n  if (isString(search)) {\n    search = { id: search };\n  }\n\n  if (isString(search.element)) {\n    search.element = this._elementRegistry.get(search.element);\n  }\n\n  if (search.element) {\n    var container = this._getOverlayContainer(search.element, true);\n\n    // return a list of overlays when searching by element (+type)\n    if (container) {\n      return search.type ? filter(container.overlays, matchPattern({ type: search.type })) : container.overlays.slice();\n    } else {\n      return [];\n    }\n  } else\n  if (search.type) {\n    return filter(this._overlays, matchPattern({ type: search.type }));\n  } else {\n\n    // return single element when searching by id\n    return search.id ? this._overlays[search.id] : null;\n  }\n};\n\n/**\n * Adds a HTML overlay to an element.\n *\n * @param {string|djs.model.Base}   element   attach overlay to this shape\n * @param {string}                  [type]    optional type to assign to the overlay\n * @param {Object}                  overlay   the overlay configuration\n *\n * @param {string|DOMElement}       overlay.html                 html element to use as an overlay\n * @param {Object}                  [overlay.show]               show configuration\n * @param {number}                  [overlay.show.minZoom]       minimal zoom level to show the overlay\n * @param {number}                  [overlay.show.maxZoom]       maximum zoom level to show the overlay\n * @param {Object}                  overlay.position             where to attach the overlay\n * @param {number}                  [overlay.position.left]      relative to element bbox left attachment\n * @param {number}                  [overlay.position.top]       relative to element bbox top attachment\n * @param {number}                  [overlay.position.bottom]    relative to element bbox bottom attachment\n * @param {number}                  [overlay.position.right]     relative to element bbox right attachment\n * @param {boolean|Object}          [overlay.scale=true]         false to preserve the same size regardless of\n *                                                               diagram zoom\n * @param {number}                  [overlay.scale.min]\n * @param {number}                  [overlay.scale.max]\n *\n * @return {string}                 id that may be used to reference the overlay for update or removal\n */\nOverlays.prototype.add = function(element, type, overlay) {\n\n  if (isObject(type)) {\n    overlay = type;\n    type = null;\n  }\n\n  if (!element.id) {\n    element = this._elementRegistry.get(element);\n  }\n\n  if (!overlay.position) {\n    throw new Error('must specifiy overlay position');\n  }\n\n  if (!overlay.html) {\n    throw new Error('must specifiy overlay html');\n  }\n\n  if (!element) {\n    throw new Error('invalid element specified');\n  }\n\n  var id = this._ids.next();\n\n  overlay = assign({}, this._overlayDefaults, overlay, {\n    id: id,\n    type: type,\n    element: element,\n    html: overlay.html\n  });\n\n  this._addOverlay(overlay);\n\n  return id;\n};\n\n\n/**\n * Remove an overlay with the given id or all overlays matching the given filter.\n *\n * @see Overlays#get for filter options.\n *\n * @param {string} [id]\n * @param {Object} [filter]\n */\nOverlays.prototype.remove = function(filter) {\n\n  var overlays = this.get(filter) || [];\n\n  if (!isArray(overlays)) {\n    overlays = [ overlays ];\n  }\n\n  var self = this;\n\n  forEach(overlays, function(overlay) {\n\n    var container = self._getOverlayContainer(overlay.element, true);\n\n    if (overlay) {\n      domRemove(overlay.html);\n      domRemove(overlay.htmlContainer);\n\n      delete overlay.htmlContainer;\n      delete overlay.element;\n\n      delete self._overlays[overlay.id];\n    }\n\n    if (container) {\n      var idx = container.overlays.indexOf(overlay);\n      if (idx !== -1) {\n        container.overlays.splice(idx, 1);\n      }\n    }\n  });\n\n};\n\n\nOverlays.prototype.show = function() {\n  setVisible(this._overlayRoot);\n};\n\n\nOverlays.prototype.hide = function() {\n  setVisible(this._overlayRoot, false);\n};\n\nOverlays.prototype.clear = function() {\n  this._overlays = {};\n\n  this._overlayContainers = [];\n\n  domClear(this._overlayRoot);\n};\n\nOverlays.prototype._updateOverlayContainer = function(container) {\n  var element = container.element,\n      html = container.html;\n\n  // update container left,top according to the elements x,y coordinates\n  // this ensures we can attach child elements relative to this container\n\n  var x = element.x,\n      y = element.y;\n\n  if (element.waypoints) {\n    var bbox = getBBox(element);\n    x = bbox.x;\n    y = bbox.y;\n  }\n\n  setPosition(html, x, y);\n\n  domAttr(container.html, 'data-container-id', element.id);\n};\n\n\nOverlays.prototype._updateOverlay = function(overlay) {\n\n  var position = overlay.position,\n      htmlContainer = overlay.htmlContainer,\n      element = overlay.element;\n\n  // update overlay html relative to shape because\n  // it is already positioned on the element\n\n  // update relative\n  var left = position.left,\n      top = position.top;\n\n  if (position.right !== undefined) {\n\n    var width;\n\n    if (element.waypoints) {\n      width = getBBox(element).width;\n    } else {\n      width = element.width;\n    }\n\n    left = position.right * -1 + width;\n  }\n\n  if (position.bottom !== undefined) {\n\n    var height;\n\n    if (element.waypoints) {\n      height = getBBox(element).height;\n    } else {\n      height = element.height;\n    }\n\n    top = position.bottom * -1 + height;\n  }\n\n  setPosition(htmlContainer, left || 0, top || 0);\n};\n\n\nOverlays.prototype._createOverlayContainer = function(element) {\n  var html = domify('<div class=\"djs-overlays\" style=\"position: absolute\" />');\n\n  this._overlayRoot.appendChild(html);\n\n  var container = {\n    html: html,\n    element: element,\n    overlays: []\n  };\n\n  this._updateOverlayContainer(container);\n\n  this._overlayContainers.push(container);\n\n  return container;\n};\n\n\nOverlays.prototype._updateRoot = function(viewbox) {\n  var scale = viewbox.scale || 1;\n\n  var matrix = 'matrix(' +\n  [\n    scale,\n    0,\n    0,\n    scale,\n    -1 * viewbox.x * scale,\n    -1 * viewbox.y * scale\n  ].join(',') +\n  ')';\n\n  setTransform(this._overlayRoot, matrix);\n};\n\n\nOverlays.prototype._getOverlayContainer = function(element, raw) {\n  var container = find(this._overlayContainers, function(c) {\n    return c.element === element;\n  });\n\n\n  if (!container && !raw) {\n    return this._createOverlayContainer(element);\n  }\n\n  return container;\n};\n\n\nOverlays.prototype._addOverlay = function(overlay) {\n\n  var id = overlay.id,\n      element = overlay.element,\n      html = overlay.html,\n      htmlContainer,\n      overlayContainer;\n\n  // unwrap jquery (for those who need it)\n  if (html.get && html.constructor.prototype.jquery) {\n    html = html.get(0);\n  }\n\n  // create proper html elements from\n  // overlay HTML strings\n  if (isString(html)) {\n    html = domify(html);\n  }\n\n  overlayContainer = this._getOverlayContainer(element);\n\n  htmlContainer = domify('<div class=\"djs-overlay\" data-overlay-id=\"' + id + '\" style=\"position: absolute\">');\n\n  htmlContainer.appendChild(html);\n\n  if (overlay.type) {\n    domClasses(htmlContainer).add('djs-overlay-' + overlay.type);\n  }\n\n  overlay.htmlContainer = htmlContainer;\n\n  overlayContainer.overlays.push(overlay);\n  overlayContainer.html.appendChild(htmlContainer);\n\n  this._overlays[id] = overlay;\n\n  this._updateOverlay(overlay);\n  this._updateOverlayVisibilty(overlay, this._canvas.viewbox());\n};\n\n\nOverlays.prototype._updateOverlayVisibilty = function(overlay, viewbox) {\n  var show = overlay.show,\n      minZoom = show && show.minZoom,\n      maxZoom = show && show.maxZoom,\n      htmlContainer = overlay.htmlContainer,\n      visible = true;\n\n  if (show) {\n    if (\n      (isDefined(minZoom) && minZoom > viewbox.scale) ||\n      (isDefined(maxZoom) && maxZoom < viewbox.scale)\n    ) {\n      visible = false;\n    }\n\n    setVisible(htmlContainer, visible);\n  }\n\n  this._updateOverlayScale(overlay, viewbox);\n};\n\n\nOverlays.prototype._updateOverlayScale = function(overlay, viewbox) {\n  var shouldScale = overlay.scale,\n      minScale,\n      maxScale,\n      htmlContainer = overlay.htmlContainer;\n\n  var scale, transform = '';\n\n  if (shouldScale !== true) {\n\n    if (shouldScale === false) {\n      minScale = 1;\n      maxScale = 1;\n    } else {\n      minScale = shouldScale.min;\n      maxScale = shouldScale.max;\n    }\n\n    if (isDefined(minScale) && viewbox.scale < minScale) {\n      scale = (1 / viewbox.scale || 1) * minScale;\n    }\n\n    if (isDefined(maxScale) && viewbox.scale > maxScale) {\n      scale = (1 / viewbox.scale || 1) * maxScale;\n    }\n  }\n\n  if (isDefined(scale)) {\n    transform = 'scale(' + scale + ',' + scale + ')';\n  }\n\n  setTransform(htmlContainer, transform);\n};\n\n\nOverlays.prototype._updateOverlaysVisibilty = function(viewbox) {\n\n  var self = this;\n\n  forEach(this._overlays, function(overlay) {\n    self._updateOverlayVisibilty(overlay, viewbox);\n  });\n};\n\n\nOverlays.prototype._init = function() {\n\n  var eventBus = this._eventBus;\n\n  var self = this;\n\n\n  // scroll/zoom integration\n\n  function updateViewbox(viewbox) {\n    self._updateRoot(viewbox);\n    self._updateOverlaysVisibilty(viewbox);\n\n    self.show();\n  }\n\n  eventBus.on('canvas.viewbox.changing', function(event) {\n    self.hide();\n  });\n\n  eventBus.on('canvas.viewbox.changed', function(event) {\n    updateViewbox(event.viewbox);\n  });\n\n\n  // remove integration\n\n  eventBus.on([ 'shape.remove', 'connection.remove' ], function(e) {\n    var element = e.element;\n    var overlays = self.get({ element: element });\n\n    forEach(overlays, function(o) {\n      self.remove(o.id);\n    });\n\n    var container = self._getOverlayContainer(element);\n\n    if (container) {\n      domRemove(container.html);\n      var i = self._overlayContainers.indexOf(container);\n      if (i !== -1) {\n        self._overlayContainers.splice(i, 1);\n      }\n    }\n  });\n\n\n  // move integration\n\n  eventBus.on('element.changed', LOW_PRIORITY, function(e) {\n    var element = e.element;\n\n    var container = self._getOverlayContainer(element, true);\n\n    if (container) {\n      forEach(container.overlays, function(overlay) {\n        self._updateOverlay(overlay);\n      });\n\n      self._updateOverlayContainer(container);\n    }\n  });\n\n\n  // marker integration, simply add them on the overlays as classes, too.\n\n  eventBus.on('element.marker.update', function(e) {\n    var container = self._getOverlayContainer(e.element, true);\n    if (container) {\n      domClasses(container.html)[e.add ? 'add' : 'remove'](e.marker);\n    }\n  });\n\n\n  // clear overlays with diagram\n\n  eventBus.on('diagram.clear', this.clear, this);\n};\n\n\n\n// helpers /////////////////////////////\n\nfunction createRoot(parentNode) {\n  var root = domify(\n    '<div class=\"djs-overlay-container\" style=\"position: absolute; width: 0; height: 0;\" />'\n  );\n\n  parentNode.insertBefore(root, parentNode.firstChild);\n\n  return root;\n}\n\nfunction setPosition(el, x, y) {\n  assign(el.style, { left: x + 'px', top: y + 'px' });\n}\n\nfunction setVisible(el, visible) {\n  el.style.display = visible === false ? 'none' : '';\n}\n\nfunction setTransform(el, transform) {\n\n  el.style['transform-origin'] = 'top left';\n\n  [ '', '-ms-', '-webkit-' ].forEach(function(prefix) {\n    el.style[prefix + 'transform'] = transform;\n  });\n}","import Overlays from './Overlays';\n\nexport default {\n  __init__: [ 'overlays' ],\n  overlays: [ 'type', Overlays ]\n};","import {\n  assign,\n  isFunction,\n  isArray,\n  forEach,\n  isDefined\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  event as domEvent,\n  attr as domAttr,\n  query as domQuery,\n  classes as domClasses,\n  domify as domify\n} from 'min-dom';\n\nvar entrySelector = '.entry';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A context pad that displays element specific, contextual actions next\n * to a diagram element.\n *\n * @param {Object} config\n * @param {boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {number} [config.scale.min]\n * @param {number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Overlays} overlays\n */\nexport default function ContextPad(config, eventBus, overlays) {\n\n  this._eventBus = eventBus;\n  this._overlays = overlays;\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n\n  this._overlaysConfig = {\n    position: {\n      right: -9,\n      top: -6\n    },\n    scale: scale\n  };\n\n  this._current = null;\n\n  this._init();\n}\n\nContextPad.$inject = [\n  'config.contextPad',\n  'eventBus',\n  'overlays'\n];\n\n\n/**\n * Registers events needed for interaction with other components\n */\nContextPad.prototype._init = function() {\n\n  var eventBus = this._eventBus;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n\n    var selection = e.newSelection;\n\n    if (selection.length === 1) {\n      self.open(selection[0]);\n    } else {\n      self.close();\n    }\n  });\n\n  eventBus.on('elements.delete', function(event) {\n    var elements = event.elements;\n\n    forEach(elements, function(e) {\n      if (self.isOpen(e)) {\n        self.close();\n      }\n    });\n  });\n\n  eventBus.on('element.changed', function(event) {\n    var element = event.element,\n        current = self._current;\n\n    // force reopen if element for which we are currently opened changed\n    if (current && current.element === element) {\n      self.open(element, true);\n    }\n  });\n};\n\n\n/**\n * Register a provider with the context pad\n *\n * @param  {number} [priority=1000]\n * @param  {ContextPadProvider} provider\n *\n * @example\n * const contextPadProvider = {\n  *   getContextPadEntries: function(element) {\n  *     return function(entries) {\n  *       return {\n  *         ...entries,\n  *         'entry-1': {\n  *           label: 'My Entry',\n  *           action: function() { alert(\"I have been clicked!\"); }\n  *         }\n  *       };\n  *     }\n  *   }\n  * };\n  *\n * contextPad.registerProvider(800, contextPadProvider);\n */\nContextPad.prototype.registerProvider = function(priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('contextPad.getProviders', priority, function(event) {\n    event.providers.push(provider);\n  });\n};\n\n\n/**\n * Returns the context pad entries for a given element\n *\n * @param {djs.element.Base} element\n *\n * @return {Array<ContextPadEntryDescriptor>} list of entries\n */\nContextPad.prototype.getEntries = function(element) {\n  var providers = this._getProviders();\n\n  var entries = {};\n\n  // loop through all providers and their entries.\n  // group entries by id so that overriding an entry is possible\n  forEach(providers, function(provider) {\n    var entriesOrUpdater = provider.getContextPadEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n};\n\n\n/**\n * Trigger an action available on the opened context pad\n *\n * @param  {string} action\n * @param  {Event} event\n * @param  {boolean} [autoActivate=false]\n */\nContextPad.prototype.trigger = function(action, event, autoActivate) {\n\n  var element = this._current.element,\n      entries = this._current.entries,\n      entry,\n      handler,\n      originalEvent,\n      button = event.delegateTarget || event.target;\n\n  if (!button) {\n    return event.preventDefault();\n  }\n\n  entry = entries[domAttr(button, 'data-action')];\n  handler = entry.action;\n\n  originalEvent = event.originalEvent || event;\n\n  // simple action (via callback function)\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      return handler(originalEvent, element, autoActivate);\n    }\n  } else {\n    if (handler[action]) {\n      return handler[action](originalEvent, element, autoActivate);\n    }\n  }\n\n  // silence other actions\n  event.preventDefault();\n};\n\n\n/**\n * Open the context pad for the given element\n *\n * @param {djs.model.Base} element\n * @param {boolean} force if true, force reopening the context pad\n */\nContextPad.prototype.open = function(element, force) {\n  if (!force && this.isOpen(element)) {\n    return;\n  }\n\n  this.close();\n  this._updateAndOpen(element);\n};\n\nContextPad.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'contextPad.getProviders',\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\nContextPad.prototype._updateAndOpen = function(element) {\n\n  var entries = this.getEntries(element),\n      pad = this.getPad(element),\n      html = pad.html;\n\n  forEach(entries, function(entry, id) {\n    var grouping = entry.group || 'default',\n        control = domify(entry.html || '<div class=\"entry\" draggable=\"true\"></div>'),\n        container;\n\n    domAttr(control, 'data-action', id);\n\n    container = domQuery('[data-group=' + grouping + ']', html);\n    if (!container) {\n      container = domify('<div class=\"group\" data-group=\"' + grouping + '\"></div>');\n      html.appendChild(container);\n    }\n\n    container.appendChild(control);\n\n    if (entry.className) {\n      addClasses(control, entry.className);\n    }\n\n    if (entry.title) {\n      domAttr(control, 'title', entry.title);\n    }\n\n    if (entry.imageUrl) {\n      control.appendChild(domify('<img src=\"' + entry.imageUrl + '\">'));\n    }\n  });\n\n  domClasses(html).add('open');\n\n  this._current = {\n    element: element,\n    pad: pad,\n    entries: entries\n  };\n\n  this._eventBus.fire('contextPad.open', { current: this._current });\n};\n\n\nContextPad.prototype.getPad = function(element) {\n  if (this.isOpen()) {\n    return this._current.pad;\n  }\n\n  var self = this;\n\n  var overlays = this._overlays;\n\n  var html = domify('<div class=\"djs-context-pad\"></div>');\n\n  var overlaysConfig = assign({\n    html: html\n  }, this._overlaysConfig);\n\n  domDelegate.bind(html, entrySelector, 'click', function(event) {\n    self.trigger('click', event);\n  });\n\n  domDelegate.bind(html, entrySelector, 'dragstart', function(event) {\n    self.trigger('dragstart', event);\n  });\n\n  // stop propagation of mouse events\n  domEvent.bind(html, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  this._overlayId = overlays.add(element, 'context-pad', overlaysConfig);\n\n  var pad = overlays.get(this._overlayId);\n\n  this._eventBus.fire('contextPad.create', { element: element, pad: pad });\n\n  return pad;\n};\n\n\n/**\n * Close the context pad\n */\nContextPad.prototype.close = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._overlays.remove(this._overlayId);\n\n  this._overlayId = null;\n\n  this._eventBus.fire('contextPad.close', { current: this._current });\n\n  this._current = null;\n};\n\n/**\n * Check if pad is open. If element is given, will check\n * if pad is opened with given element.\n *\n * @param {Element} element\n * @return {boolean}\n */\nContextPad.prototype.isOpen = function(element) {\n  return !!this._current && (!element ? true : this._current.element === element);\n};\n\n\n\n\n// helpers //////////////////////\n\nfunction addClasses(element, classNames) {\n\n  var classes = domClasses(element);\n\n  var actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\n  actualClassNames.forEach(function(cls) {\n    classes.add(cls);\n  });\n}","import InteractionEventsModule from '../interaction-events';\nimport OverlaysModule from '../overlays';\n\nimport ContextPad from './ContextPad';\n\n\nexport default {\n  __depends__: [\n    InteractionEventsModule,\n    OverlaysModule\n  ],\n  contextPad: [ 'type', ContextPad ]\n};","import {\r\n  forEach\r\n} from 'min-dash';\r\n\r\nimport {\r\n  append as svgAppend,\r\n  attr as svgAttr,\r\n  classes as svgClasses,\r\n  clone as svgClone,\r\n  create as svgCreate,\r\n  remove as svgRemove\r\n} from 'tiny-svg';\r\n\r\nimport { query as domQuery } from 'min-dom';\r\n\r\nimport { getVisual } from '../../util/GraphicsUtil';\r\n\r\nvar MARKER_TYPES = [\r\n  'marker-start',\r\n  'marker-mid',\r\n  'marker-end'\r\n];\r\n\r\nvar NODES_CAN_HAVE_MARKER = [\r\n  'circle',\r\n  'ellipse',\r\n  'line',\r\n  'path',\r\n  'polygon',\r\n  'polyline',\r\n  'rect'\r\n];\r\n\r\n\r\n/**\r\n * Adds support for previews of moving/resizing elements.\r\n */\r\nexport default function PreviewSupport(elementRegistry, eventBus, canvas, styles) {\r\n  this._elementRegistry = elementRegistry;\r\n  this._canvas = canvas;\r\n  this._styles = styles;\r\n\r\n  this._clonedMarkers = {};\r\n\r\n  var self = this;\r\n\r\n  eventBus.on('drag.cleanup', function() {\r\n    forEach(self._clonedMarkers, function(clonedMarker) {\r\n      svgRemove(clonedMarker);\r\n    });\r\n\r\n    self._clonedMarkers = {};\r\n  });\r\n}\r\n\r\nPreviewSupport.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'canvas',\r\n  'styles'\r\n];\r\n\r\n\r\n/**\r\n * Returns graphics of an element.\r\n *\r\n * @param {djs.model.Base} element\r\n *\r\n * @return {SVGElement}\r\n */\r\nPreviewSupport.prototype.getGfx = function(element) {\r\n  return this._elementRegistry.getGraphics(element);\r\n};\r\n\r\n/**\r\n * Adds a move preview of a given shape to a given svg group.\r\n *\r\n * @param {djs.model.Base} element\r\n * @param {SVGElement} group\r\n * @param {SVGElement} [gfx]\r\n *\r\n * @return {SVGElement} dragger\r\n */\r\nPreviewSupport.prototype.addDragger = function(element, group, gfx) {\r\n  gfx = gfx || this.getGfx(element);\r\n\r\n  var dragger = svgClone(gfx);\r\n  var bbox = gfx.getBoundingClientRect();\r\n\r\n  this._cloneMarkers(getVisual(dragger));\r\n\r\n  svgAttr(dragger, this._styles.cls('djs-dragger', [], {\r\n    x: bbox.top,\r\n    y: bbox.left\r\n  }));\r\n\r\n  svgAppend(group, dragger);\r\n\r\n  return dragger;\r\n};\r\n\r\n/**\r\n * Adds a resize preview of a given shape to a given svg group.\r\n *\r\n * @param {djs.model.Base} element\r\n * @param {SVGElement} group\r\n *\r\n * @return {SVGElement} frame\r\n */\r\nPreviewSupport.prototype.addFrame = function(shape, group) {\r\n\r\n  var frame = svgCreate('rect', {\r\n    class: 'djs-resize-overlay',\r\n    width:  shape.width,\r\n    height: shape.height,\r\n    x: shape.x,\r\n    y: shape.y\r\n  });\r\n\r\n  svgAppend(group, frame);\r\n\r\n  return frame;\r\n};\r\n\r\n/**\r\n * Clone all markers referenced by a node and its child nodes.\r\n *\r\n * @param {SVGElement} gfx\r\n */\r\nPreviewSupport.prototype._cloneMarkers = function(gfx) {\r\n  var self = this;\r\n\r\n  if (gfx.childNodes) {\r\n\r\n    // TODO: use forEach once we drop PhantomJS\r\n    for (var i = 0; i < gfx.childNodes.length; i++) {\r\n\r\n      // recursively clone markers of child nodes\r\n      self._cloneMarkers(gfx.childNodes[ i ]);\r\n    }\r\n  }\r\n\r\n  if (!canHaveMarker(gfx)) {\r\n    return;\r\n  }\r\n\r\n  MARKER_TYPES.forEach(function(markerType) {\r\n    if (svgAttr(gfx, markerType)) {\r\n      var marker = getMarker(gfx, markerType, self._canvas.getContainer());\r\n\r\n      self._cloneMarker(gfx, marker, markerType);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Clone marker referenced by an element.\r\n *\r\n * @param {SVGElement} gfx\r\n * @param {SVGElement} marker\r\n * @param {string} markerType\r\n */\r\nPreviewSupport.prototype._cloneMarker = function(gfx, marker, markerType) {\r\n  var markerId = marker.id;\r\n\r\n  var clonedMarker = this._clonedMarkers[ markerId ];\r\n\r\n  if (!clonedMarker) {\r\n    clonedMarker = svgClone(marker);\r\n\r\n    var clonedMarkerId = markerId + '-clone';\r\n\r\n    clonedMarker.id = clonedMarkerId;\r\n\r\n    svgClasses(clonedMarker)\r\n      .add('djs-dragger')\r\n      .add('djs-dragger-marker');\r\n\r\n    this._clonedMarkers[ markerId ] = clonedMarker;\r\n\r\n    var defs = domQuery('defs', this._canvas._svg);\r\n\r\n    if (!defs) {\r\n      defs = svgCreate('defs');\r\n\r\n      svgAppend(this._canvas._svg, defs);\r\n    }\r\n\r\n    svgAppend(defs, clonedMarker);\r\n  }\r\n\r\n  var reference = idToReference(this._clonedMarkers[ markerId ].id);\r\n\r\n  svgAttr(gfx, markerType, reference);\r\n};\r\n\r\n// helpers //////////\r\n\r\n/**\r\n * Get marker of given type referenced by node.\r\n *\r\n * @param {Node} node\r\n * @param {string} markerType\r\n * @param {Node} [parentNode]\r\n *\r\n * @param {Node}\r\n */\r\nfunction getMarker(node, markerType, parentNode) {\r\n  var id = referenceToId(svgAttr(node, markerType));\r\n\r\n  return domQuery('marker#' + id, parentNode || document);\r\n}\r\n\r\n/**\r\n * Get ID of fragment within current document from its functional IRI reference.\r\n * References may use single or double quotes.\r\n *\r\n * @param {string} reference\r\n *\r\n * @returns {string}\r\n */\r\nfunction referenceToId(reference) {\r\n  return reference.match(/url\\(['\"]?#([^'\"]*)['\"]?\\)/)[1];\r\n}\r\n\r\n/**\r\n * Get functional IRI reference for given ID of fragment within current document.\r\n *\r\n * @param {string} id\r\n *\r\n * @returns {string}\r\n */\r\nfunction idToReference(id) {\r\n  return 'url(#' + id + ')';\r\n}\r\n\r\n/**\r\n * Check wether node type can have marker attributes.\r\n *\r\n * @param {Node} node\r\n *\r\n * @returns {boolean}\r\n */\r\nfunction canHaveMarker(node) {\r\n  return NODES_CAN_HAVE_MARKER.indexOf(node.nodeName) !== -1;\r\n}","import PreviewSupport from './PreviewSupport';\n\nexport default {\n  __init__: [ 'previewSupport' ],\n  previewSupport: [ 'type', PreviewSupport ]\n};\n","var MARKER_OK = 'drop-ok',\n    MARKER_NOT_OK = 'drop-not-ok',\n    MARKER_ATTACH = 'attach-ok',\n    MARKER_NEW_PARENT = 'new-parent';\n\nimport {\n  assign,\n  filter,\n  find,\n  forEach,\n  isArray,\n  isNumber,\n  map\n} from 'min-dash';\n\nimport { getBBox } from '../../util/Elements';\n\nvar PREFIX = 'create';\n\nvar HIGH_PRIORITY = 2000;\n\n\n/**\n * Create new elements through drag and drop.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function Create(\n    canvas,\n    dragging,\n    eventBus,\n    modeling,\n    rules\n) {\n\n  // rules //////////\n\n  /**\n   * Check wether elements can be created.\n   *\n   * @param {Array<djs.model.Base>} elements\n   * @param {djs.model.Base} target\n   * @param {Point} position\n   * @param {djs.model.Base} [source]\n   *\n   * @returns {boolean|null|Object}\n   */\n  function canCreate(elements, target, position, source, hints) {\n    if (!target) {\n      return false;\n    }\n\n    // ignore child elements and external labels\n    elements = filter(elements, function(element) {\n      var labelTarget = element.labelTarget;\n\n      return !element.parent && !(isLabel(element) && elements.indexOf(labelTarget) !== -1);\n    });\n\n    var shape = find(elements, function(element) {\n      return !isConnection(element);\n    });\n\n    var attach = false,\n        connect = false,\n        create = false;\n\n    // (1) attaching single shapes\n    if (isSingleShape(elements)) {\n      attach = rules.allowed('shape.attach', {\n        position: position,\n        shape: shape,\n        target: target\n      });\n    }\n\n    if (!attach) {\n\n      // (2) creating elements\n      if (isSingleShape(elements)) {\n        create = rules.allowed('shape.create', {\n          position: position,\n          shape: shape,\n          source: source,\n          target: target\n        });\n      } else {\n        create = rules.allowed('elements.create', {\n          elements: elements,\n          position: position,\n          target: target\n        });\n      }\n\n    }\n\n    var connectionTarget = hints.connectionTarget;\n\n    // (3) appending single shapes\n    if (create || attach) {\n      if (shape && source) {\n        connect = rules.allowed('connection.create', {\n          source: connectionTarget === source ? shape : source,\n          target: connectionTarget === source ? source : shape,\n          hints: {\n            targetParent: target,\n            targetAttach: attach\n          }\n        });\n      }\n\n      return {\n        attach: attach,\n        connect: connect\n      };\n    }\n\n    // ignore wether or not elements can be created\n    if (create === null || attach === null) {\n      return null;\n    }\n\n    return false;\n  }\n\n  function setMarker(element, marker) {\n    [ MARKER_ATTACH, MARKER_OK, MARKER_NOT_OK, MARKER_NEW_PARENT ].forEach(function(m) {\n\n      if (m === marker) {\n        canvas.addMarker(element, m);\n      } else {\n        canvas.removeMarker(element, m);\n      }\n    });\n  }\n\n  // event handling //////////\n\n  eventBus.on([ 'create.move', 'create.hover' ], function(event) {\n    var context = event.context,\n        elements = context.elements,\n        hover = event.hover,\n        source = context.source,\n        hints = context.hints || {};\n\n    if (!hover) {\n      context.canExecute = false;\n      context.target = null;\n\n      return;\n    }\n\n    ensureConstraints(event);\n\n    var position = {\n      x: event.x,\n      y: event.y\n    };\n\n    var canExecute = context.canExecute = hover && canCreate(elements, hover, position, source, hints);\n\n    if (hover && canExecute !== null) {\n      context.target = hover;\n\n      if (canExecute && canExecute.attach) {\n        setMarker(hover, MARKER_ATTACH);\n      } else {\n        setMarker(hover, canExecute ? MARKER_NEW_PARENT : MARKER_NOT_OK);\n      }\n    }\n  });\n\n  eventBus.on([ 'create.end', 'create.out', 'create.cleanup' ], function(event) {\n    var hover = event.hover;\n\n    if (hover) {\n      setMarker(hover, null);\n    }\n  });\n\n  eventBus.on('create.end', function(event) {\n    var context = event.context,\n        source = context.source,\n        shape = context.shape,\n        elements = context.elements,\n        target = context.target,\n        canExecute = context.canExecute,\n        attach = canExecute && canExecute.attach,\n        connect = canExecute && canExecute.connect,\n        hints = context.hints || {};\n\n    if (canExecute === false || !target) {\n      return false;\n    }\n\n    ensureConstraints(event);\n\n    var position = {\n      x: event.x,\n      y: event.y\n    };\n\n    if (connect) {\n      shape = modeling.appendShape(source, shape, position, target, {\n        attach: attach,\n        connection: connect === true ? {} : connect,\n        connectionTarget: hints.connectionTarget\n      });\n    } else {\n      elements = modeling.createElements(elements, position, target, assign({}, hints, {\n        attach: attach\n      }));\n\n      // update shape\n      shape = find(elements, function(element) {\n        return !isConnection(element);\n      });\n    }\n\n    // update elements and shape\n    assign(context, {\n      elements: elements,\n      shape: shape\n    });\n\n    assign(event, {\n      elements: elements,\n      shape: shape\n    });\n  });\n\n  function cancel() {\n    var context = dragging.context();\n\n    if (context && context.prefix === PREFIX) {\n      dragging.cancel();\n    }\n  }\n\n  // cancel on <elements.changed> that is not result of <drag.end>\n  eventBus.on('create.init', function() {\n    eventBus.on('elements.changed', cancel);\n\n    eventBus.once([ 'create.cancel', 'create.end' ], HIGH_PRIORITY, function() {\n      eventBus.off('elements.changed', cancel);\n    });\n  });\n\n  // API //////////\n\n  this.start = function(event, elements, context) {\n    if (!isArray(elements)) {\n      elements = [ elements ];\n    }\n\n    var shape = find(elements, function(element) {\n      return !isConnection(element);\n    });\n\n    if (!shape) {\n\n      // at least one shape is required\n      return;\n    }\n\n    context = assign({\n      elements: elements,\n      hints: {},\n      shape: shape\n    }, context || {});\n\n    // make sure each element has x and y\n    forEach(elements, function(element) {\n      if (!isNumber(element.x)) {\n        element.x = 0;\n      }\n\n      if (!isNumber(element.y)) {\n        element.y = 0;\n      }\n    });\n\n    var bbox = getBBox(elements);\n\n    // center elements around cursor\n    forEach(elements, function(element) {\n      if (isConnection(element)) {\n        element.waypoints = map(element.waypoints, function(waypoint) {\n          return {\n            x: waypoint.x - bbox.x - bbox.width / 2,\n            y: waypoint.y - bbox.y - bbox.height / 2\n          };\n        });\n      }\n\n      assign(element, {\n        x: element.x - bbox.x - bbox.width / 2,\n        y: element.y - bbox.y - bbox.height / 2\n      });\n    });\n\n    dragging.init(event, PREFIX, {\n      cursor: 'grabbing',\n      autoActivate: true,\n      data: {\n        shape: shape,\n        elements: elements,\n        context: context\n      }\n    });\n  };\n}\n\nCreate.$inject = [\n  'canvas',\n  'dragging',\n  'eventBus',\n  'modeling',\n  'rules'\n];\n\n// helpers //////////\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      createConstraints = context.createConstraints;\n\n  if (!createConstraints) {\n    return;\n  }\n\n  if (createConstraints.left) {\n    event.x = Math.max(event.x, createConstraints.left);\n  }\n\n  if (createConstraints.right) {\n    event.x = Math.min(event.x, createConstraints.right);\n  }\n\n  if (createConstraints.top) {\n    event.y = Math.max(event.y, createConstraints.top);\n  }\n\n  if (createConstraints.bottom) {\n    event.y = Math.min(event.y, createConstraints.bottom);\n  }\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isSingleShape(elements) {\n  return elements && elements.length === 1 && !isConnection(elements[0]);\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n","import {\r\n  translate\r\n} from '../../util/SvgTransformUtil';\r\n\r\nimport { getVisual } from '../../util/GraphicsUtil';\r\n\r\nimport {\r\n  append as svgAppend,\r\n  attr as svgAttr,\r\n  create as svgCreate,\r\n  remove as svgRemove\r\n} from 'tiny-svg';\r\n\r\nvar LOW_PRIORITY = 750;\r\n\r\n\r\nexport default function CreatePreview(\r\n    canvas,\r\n    eventBus,\r\n    graphicsFactory,\r\n    previewSupport,\r\n    styles\r\n) {\r\n  function createDragGroup(elements) {\r\n    var dragGroup = svgCreate('g');\r\n\r\n    svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\r\n\r\n    var childrenGfx = svgCreate('g');\r\n\r\n    elements.forEach(function(element) {\r\n\r\n      // create graphics\r\n      var gfx;\r\n\r\n      if (element.hidden) {\r\n        return;\r\n      }\r\n\r\n      if (element.waypoints) {\r\n        gfx = graphicsFactory._createContainer('connection', childrenGfx);\r\n\r\n        graphicsFactory.drawConnection(getVisual(gfx), element);\r\n      } else {\r\n        gfx = graphicsFactory._createContainer('shape', childrenGfx);\r\n\r\n        graphicsFactory.drawShape(getVisual(gfx), element);\r\n\r\n        translate(gfx, element.x, element.y);\r\n      }\r\n\r\n      // add preview\r\n      previewSupport.addDragger(element, dragGroup, gfx);\r\n    });\r\n\r\n    return dragGroup;\r\n  }\r\n\r\n  eventBus.on('create.move', LOW_PRIORITY, function(event) {\r\n\r\n    var hover = event.hover,\r\n        context = event.context,\r\n        elements = context.elements,\r\n        dragGroup = context.dragGroup;\r\n\r\n    // lazily create previews\r\n    if (!dragGroup) {\r\n      dragGroup = context.dragGroup = createDragGroup(elements);\r\n    }\r\n\r\n    var defaultLayer;\r\n\r\n    if (hover) {\r\n      if (!dragGroup.parentNode) {\r\n        defaultLayer = canvas.getDefaultLayer();\r\n\r\n        svgAppend(defaultLayer, dragGroup);\r\n      }\r\n\r\n      translate(dragGroup, event.x, event.y);\r\n    } else {\r\n      svgRemove(dragGroup);\r\n    }\r\n  });\r\n\r\n  eventBus.on('create.cleanup', function(event) {\r\n    var context = event.context,\r\n        dragGroup = context.dragGroup;\r\n\r\n    if (dragGroup) {\r\n      svgRemove(dragGroup);\r\n    }\r\n  });\r\n}\r\n\r\nCreatePreview.$inject = [\r\n  'canvas',\r\n  'eventBus',\r\n  'graphicsFactory',\r\n  'previewSupport',\r\n  'styles'\r\n];\r\n","import DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\nimport RulesModule from '../rules';\nimport SelectionModule from '../selection';\n\nimport Create from './Create';\nimport CreatePreview from './CreatePreview';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    PreviewSupportModule,\n    RulesModule,\n    SelectionModule\n  ],\n  __init__: [\n    'create',\n    'createPreview'\n  ],\n  create: [ 'type', Create ],\n  createPreview: [ 'type', CreatePreview ]\n};\n","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  closest as domClosest\n} from 'min-dom';\n\nvar LOW_PRIORITY = 250;\n\n/**\n * The tool manager acts as middle-man between the available tool's and the Palette,\n * it takes care of making sure that the correct active state is set.\n *\n * @param  {Object}    eventBus\n * @param  {Object}    dragging\n */\nexport default function ToolManager(eventBus, dragging) {\n  this._eventBus = eventBus;\n  this._dragging = dragging;\n\n  this._tools = [];\n  this._active = null;\n}\n\nToolManager.$inject = [ 'eventBus', 'dragging' ];\n\nToolManager.prototype.registerTool = function(name, events) {\n  var tools = this._tools;\n\n  if (!events) {\n    throw new Error('A tool has to be registered with it\\'s \"events\"');\n  }\n\n  tools.push(name);\n\n  this.bindEvents(name, events);\n};\n\nToolManager.prototype.isActive = function(tool) {\n  return tool && this._active === tool;\n};\n\nToolManager.prototype.length = function(tool) {\n  return this._tools.length;\n};\n\nToolManager.prototype.setActive = function(tool) {\n  var eventBus = this._eventBus;\n\n  if (this._active !== tool) {\n    this._active = tool;\n\n    eventBus.fire('tool-manager.update', { tool: tool });\n  }\n};\n\nToolManager.prototype.bindEvents = function(name, events) {\n  var eventBus = this._eventBus,\n      dragging = this._dragging;\n\n  var eventsToRegister = [];\n\n  eventBus.on(events.tool + '.init', function(event) {\n    var context = event.context;\n\n    // Active tools that want to reactivate themselves must do this explicitly\n    if (!context.reactivate && this.isActive(name)) {\n      this.setActive(null);\n\n      dragging.cancel();\n      return;\n    }\n\n    this.setActive(name);\n\n  }, this);\n\n  // Todo[ricardo]: add test cases\n  forEach(events, function(event) {\n    eventsToRegister.push(event + '.ended');\n    eventsToRegister.push(event + '.canceled');\n  });\n\n  eventBus.on(eventsToRegister, LOW_PRIORITY, function(event) {\n    var originalEvent = event.originalEvent;\n\n    // We defer the de-activation of the tool to the .activate phase,\n    // so we're able to check if we want to toggle off the current\n    // active tool or switch to a new one\n    if (!this._active) {\n      return;\n    }\n\n    if (originalEvent && domClosest(originalEvent.target, '.group[data-group=\"tools\"]')) {\n      return;\n    }\n\n    this.setActive(null);\n  }, this);\n};\n","import DraggingModule from '../dragging';\n\nimport ToolManager from './ToolManager';\n\nexport default {\n  __depends__: [\n    DraggingModule\n  ],\n  __init__: [ 'toolManager' ],\n  toolManager: [ 'type', ToolManager ]\n};\n","import { isArray } from 'min-dash';\r\n\r\n/**\r\n * Returns true if event was triggered with any modifier\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function hasModifier(event) {\r\n  return (event.ctrlKey || event.metaKey || event.shiftKey || event.altKey);\r\n}\r\n\r\n/**\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function isCmd(event) {\r\n\r\n  // ensure we don't react to AltGr\r\n  // (mapped to CTRL + ALT)\r\n  if (event.altKey) {\r\n    return false;\r\n  }\r\n\r\n  return event.ctrlKey || event.metaKey;\r\n}\r\n\r\n/**\r\n * Checks if key pressed is one of provided keys.\r\n *\r\n * @param {string|Array<string>} keys\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function isKey(keys, event) {\r\n  keys = isArray(keys) ? keys : [ keys ];\r\n\r\n  return keys.indexOf(event.key) !== -1 || keys.indexOf(event.keyCode) !== -1;\r\n}\r\n\r\n/**\r\n * @param {KeyboardEvent} event\r\n */\r\nexport function isShift(event) {\r\n  return event.shiftKey;\r\n}","import { hasPrimaryModifier } from '../../util/Mouse';\n\nimport { isKey } from '../../features/keyboard/KeyboardUtil';\n\nvar HIGH_PRIORITY = 1500;\nvar HAND_CURSOR = 'grab';\n\n\nexport default function HandTool(eventBus, canvas, dragging, injector, toolManager) {\n  this._dragging = dragging;\n\n  var self = this,\n      keyboard = injector.get('keyboard', false);\n\n  toolManager.registerTool('hand', {\n    tool: 'hand',\n    dragging: 'hand.move'\n  });\n\n  eventBus.on('element.mousedown', HIGH_PRIORITY, function(event) {\n    if (hasPrimaryModifier(event)) {\n      this.activateMove(event.originalEvent);\n\n      return false;\n    }\n  }, this);\n\n  keyboard && keyboard.addListener(HIGH_PRIORITY, function(e) {\n    if (!isSpace(e.keyEvent)) {\n      return;\n    }\n\n    if (self.isActive()) {\n      return;\n    }\n\n    function activateMove(event) {\n      self.activateMove(event);\n\n      window.removeEventListener('mousemove', activateMove);\n    }\n\n    window.addEventListener('mousemove', activateMove);\n\n    function deactivateMove(e) {\n      if (!isSpace(e.keyEvent)) {\n        return;\n      }\n\n      window.removeEventListener('mousemove', activateMove);\n\n      keyboard.removeListener(deactivateMove, 'keyboard.keyup');\n\n      dragging.cancel();\n    }\n\n    keyboard.addListener(HIGH_PRIORITY, deactivateMove, 'keyboard.keyup');\n  }, 'keyboard.keydown');\n\n  eventBus.on('hand.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return false;\n    }\n\n    eventBus.once('hand.ended', function() {\n      this.activateMove(event.originalEvent, { reactivate: true });\n    }, this);\n\n  }, this);\n\n\n  eventBus.on('hand.move.move', function(event) {\n    var scale = canvas.viewbox().scale;\n\n    canvas.scroll({\n      dx: event.dx * scale,\n      dy: event.dy * scale\n    });\n  });\n\n  eventBus.on('hand.move.end', function(event) {\n    var context = event.context,\n        reactivate = context.reactivate;\n\n    // Don't reactivate if the user is using the keyboard keybinding\n    if (!hasPrimaryModifier(event) && reactivate) {\n\n      eventBus.once('hand.move.ended', function(event) {\n        this.activateHand(event.originalEvent, true, true);\n      }, this);\n\n    }\n\n    return false;\n  }, this);\n\n}\n\nHandTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'injector',\n  'toolManager'\n];\n\n\nHandTool.prototype.activateMove = function(event, autoActivate, context) {\n  if (typeof autoActivate === 'object') {\n    context = autoActivate;\n    autoActivate = false;\n  }\n\n  this._dragging.init(event, 'hand.move', {\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: context || {}\n    }\n  });\n};\n\nHandTool.prototype.activateHand = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'hand', {\n    trapClick: false,\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    }\n  });\n};\n\nHandTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateHand();\n  }\n};\n\nHandTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  if (context) {\n    return /^(hand|hand\\.move)$/.test(context.prefix);\n  }\n\n  return false;\n};\n\n// helpers //////////\n\nfunction isSpace(keyEvent) {\n  return isKey(' ', keyEvent);\n}","import ToolManagerModule from '../tool-manager';\n\nimport HandTool from './HandTool';\n\nexport default {\n  __depends__: [\n    ToolManagerModule\n  ],\n  __init__: [ 'handTool' ],\n  handTool: [ 'type', HandTool ]\n};\n","import { values } from 'min-dash';\n\nimport { getEnclosedElements } from '../../util/Elements';\n\nimport { hasSecondaryModifier } from '../../util/Mouse';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nvar LASSO_TOOL_CURSOR = 'crosshair';\n\n\nexport default function LassoTool(\n    eventBus, canvas, dragging,\n    elementRegistry, selection, toolManager) {\n\n  this._selection = selection;\n  this._dragging = dragging;\n\n  var self = this;\n\n  // lasso visuals implementation\n\n  /**\n  * A helper that realizes the selection box visual\n  */\n  var visuals = {\n\n    create: function(context) {\n      var container = canvas.getDefaultLayer(),\n          frame;\n\n      frame = context.frame = svgCreate('rect');\n      svgAttr(frame, {\n        class: 'djs-lasso-overlay',\n        width:  1,\n        height: 1,\n        x: 0,\n        y: 0\n      });\n\n      svgAppend(container, frame);\n    },\n\n    update: function(context) {\n      var frame = context.frame,\n          bbox = context.bbox;\n\n      svgAttr(frame, {\n        x: bbox.x,\n        y: bbox.y,\n        width: bbox.width,\n        height: bbox.height\n      });\n    },\n\n    remove: function(context) {\n\n      if (context.frame) {\n        svgRemove(context.frame);\n      }\n    }\n  };\n\n  toolManager.registerTool('lasso', {\n    tool: 'lasso.selection',\n    dragging: 'lasso'\n  });\n\n  eventBus.on('lasso.selection.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return;\n    }\n\n    eventBus.once('lasso.selection.ended', function() {\n      self.activateLasso(event.originalEvent, true);\n    });\n  });\n\n  // lasso interaction implementation\n\n  eventBus.on('lasso.end', function(event) {\n\n    var bbox = toBBox(event);\n\n    var elements = elementRegistry.filter(function(element) {\n      return element;\n    });\n\n    self.select(elements, bbox);\n  });\n\n  eventBus.on('lasso.start', function(event) {\n\n    var context = event.context;\n\n    context.bbox = toBBox(event);\n    visuals.create(context);\n  });\n\n  eventBus.on('lasso.move', function(event) {\n\n    var context = event.context;\n\n    context.bbox = toBBox(event);\n    visuals.update(context);\n  });\n\n  eventBus.on('lasso.cleanup', function(event) {\n\n    var context = event.context;\n\n    visuals.remove(context);\n  });\n\n\n  // event integration\n\n  eventBus.on('element.mousedown', 1500, function(event) {\n\n    if (hasSecondaryModifier(event)) {\n      self.activateLasso(event.originalEvent);\n\n      // we've handled the event\n      return true;\n    }\n  });\n}\n\nLassoTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'elementRegistry',\n  'selection',\n  'toolManager'\n];\n\n\nLassoTool.prototype.activateLasso = function(event, autoActivate) {\n\n  this._dragging.init(event, 'lasso', {\n    autoActivate: autoActivate,\n    cursor: LASSO_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\nLassoTool.prototype.activateSelection = function(event) {\n\n  this._dragging.init(event, 'lasso.selection', {\n    trapClick: false,\n    cursor: LASSO_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\nLassoTool.prototype.select = function(elements, bbox) {\n  var selectedElements = getEnclosedElements(elements, bbox);\n\n  this._selection.select(values(selectedElements));\n};\n\nLassoTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateSelection();\n  }\n};\n\nLassoTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^lasso/.test(context.prefix);\n};\n\n\n\nfunction toBBox(event) {\n\n  var start = {\n\n    x: event.x - event.dx,\n    y: event.y - event.dy\n  };\n\n  var end = {\n    x: event.x,\n    y: event.y\n  };\n\n  var bbox;\n\n  if ((start.x <= end.x && start.y < end.y) ||\n      (start.x < end.x && start.y <= end.y)) {\n\n    bbox = {\n      x: start.x,\n      y: start.y,\n      width:  end.x - start.x,\n      height: end.y - start.y\n    };\n  } else if ((start.x >= end.x && start.y < end.y) ||\n             (start.x > end.x && start.y <= end.y)) {\n\n    bbox = {\n      x: end.x,\n      y: start.y,\n      width:  start.x - end.x,\n      height: end.y - start.y\n    };\n  } else if ((start.x <= end.x && start.y > end.y) ||\n             (start.x < end.x && start.y >= end.y)) {\n\n    bbox = {\n      x: start.x,\n      y: end.y,\n      width:  end.x - start.x,\n      height: start.y - end.y\n    };\n  } else if ((start.x >= end.x && start.y > end.y) ||\n             (start.x > end.x && start.y >= end.y)) {\n\n    bbox = {\n      x: end.x,\n      y: end.y,\n      width:  start.x - end.x,\n      height: start.y - end.y\n    };\n  } else {\n\n    bbox = {\n      x: end.x,\n      y: end.y,\n      width:  0,\n      height: 0\n    };\n  }\n  return bbox;\n}\n","import ToolManagerModule from '../tool-manager';\n\nimport LassoTool from './LassoTool';\n\nexport default {\n  __depends__: [\n    ToolManagerModule\n  ],\n  __init__: [ 'lassoTool' ],\n  lassoTool: [ 'type', LassoTool ]\n};\n","var MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n/**\n * @class\n * @constructor\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Connect} connect\n * @param {Canvas} canvas\n * @param {ToolManager} toolManager\n * @param {Rules} rules\n */\nexport default function GlobalConnect(\n    eventBus, dragging, connect,\n    canvas, toolManager, rules) {\n\n  var self = this;\n\n  this._dragging = dragging;\n  this._rules = rules;\n\n  toolManager.registerTool('global-connect', {\n    tool: 'global-connect',\n    dragging: 'global-connect.drag'\n  });\n\n  eventBus.on('global-connect.hover', function(event) {\n    var context = event.context,\n        startTarget = event.hover;\n\n    var canStartConnect = context.canStartConnect = self.canStartConnect(startTarget);\n\n    // simply ignore hover\n    if (canStartConnect === null) {\n      return;\n    }\n\n    context.startTarget = startTarget;\n\n    canvas.addMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n\n  eventBus.on([ 'global-connect.out', 'global-connect.cleanup' ], function(event) {\n    var startTarget = event.context.startTarget,\n        canStartConnect = event.context.canStartConnect;\n\n    if (startTarget) {\n      canvas.removeMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n\n  eventBus.on([ 'global-connect.ended' ], function(event) {\n    var context = event.context,\n        startTarget = context.startTarget,\n        startPosition = {\n          x: event.x,\n          y: event.y\n        };\n\n    var canStartConnect = self.canStartConnect(startTarget);\n\n    if (!canStartConnect) {\n      return;\n    }\n\n    eventBus.once('element.out', function() {\n      eventBus.once([ 'connect.ended', 'connect.canceled' ], function() {\n        eventBus.fire('global-connect.drag.ended');\n      });\n\n      connect.start(null, startTarget, startPosition);\n    });\n\n    return false;\n  });\n}\n\nGlobalConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'connect',\n  'canvas',\n  'toolManager',\n  'rules'\n];\n\n/**\n * Initiates tool activity.\n */\nGlobalConnect.prototype.start = function(event) {\n  this._dragging.init(event, 'global-connect', {\n    trapClick: false,\n    data: {\n      context: {}\n    }\n  });\n};\n\nGlobalConnect.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.start();\n  }\n};\n\nGlobalConnect.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^global-connect/.test(context.prefix);\n};\n\n/**\n * Check if source shape can initiate connection.\n *\n * @param  {Shape} startTarget\n * @return {boolean}\n */\nGlobalConnect.prototype.canStartConnect = function(startTarget) {\n  return this._rules.allowed('connection.start', { source: startTarget });\n};\n","import ConnectModule from '../connect';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport ToolManagerModule from '../tool-manager';\n\nimport GlobalConnect from './GlobalConnect';\n\nexport default {\n  __depends__: [\n    ConnectModule,\n    RulesModule,\n    DraggingModule,\n    ToolManagerModule\n  ],\n  globalConnect: [ 'type', GlobalConnect ]\n};\n","import {\n  set as cursorSet,\n  unset as cursorUnset\n} from '../../util/Cursor';\n\nimport {\n  install as installClickTrap\n} from '../../util/ClickTrap';\n\nimport {\n  delta as deltaPos\n} from '../../util/PositionUtil';\n\nimport {\n  event as domEvent,\n  closest as domClosest\n} from 'min-dom';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\n\nvar THRESHOLD = 15;\n\n\n/**\n * Move the canvas via mouse.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function MoveCanvas(eventBus, canvas) {\n\n  var context;\n\n\n  // listen for move on element mouse down;\n  // allow others to hook into the event before us though\n  // (dragging / element moving will do this)\n  eventBus.on('element.mousedown', 500, function(e) {\n    return handleStart(e.originalEvent);\n  });\n\n\n  function handleMove(event) {\n\n    var start = context.start,\n        position = toPoint(event),\n        delta = deltaPos(position, start);\n\n    if (!context.dragging && length(delta) > THRESHOLD) {\n      context.dragging = true;\n\n      installClickTrap(eventBus);\n\n      cursorSet('grab');\n    }\n\n    if (context.dragging) {\n\n      var lastPosition = context.last || context.start;\n\n      delta = deltaPos(position, lastPosition);\n\n      canvas.scroll({\n        dx: delta.x,\n        dy: delta.y\n      });\n\n      context.last = position;\n    }\n\n    // prevent select\n    event.preventDefault();\n  }\n\n\n  function handleEnd(event) {\n    domEvent.unbind(document, 'mousemove', handleMove);\n    domEvent.unbind(document, 'mouseup', handleEnd);\n\n    context = null;\n\n    cursorUnset();\n  }\n\n  function handleStart(event) {\n\n    // event is already handled by '.djs-draggable'\n    if (domClosest(event.target, '.djs-draggable')) {\n      return;\n    }\n\n\n    // reject non-left left mouse button or modifier key\n    if (event.button || event.ctrlKey || event.shiftKey || event.altKey) {\n      return;\n    }\n\n    context = {\n      start: toPoint(event)\n    };\n\n    domEvent.bind(document, 'mousemove', handleMove);\n    domEvent.bind(document, 'mouseup', handleEnd);\n\n    // we've handled the event\n    return true;\n  }\n}\n\n\nMoveCanvas.$inject = [\n  'eventBus',\n  'canvas'\n];\n\n\n\n// helpers ///////\n\nfunction length(point) {\n  return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n}\n","import MoveCanvas from './MoveCanvas';\n\nexport default {\n  __init__: [ 'moveCanvas' ],\n  moveCanvas: [ 'type', MoveCanvas ]\n};","import {\n  assign,\n  filter,\n  groupBy,\n  isObject\n} from 'min-dash';\n\nvar LOW_PRIORITY = 500,\n    MEDIUM_PRIORITY = 1250,\n    HIGH_PRIORITY = 1500;\n\nimport { getOriginal as getOriginalEvent } from '../../util/Event';\n\nvar round = Math.round;\n\nfunction mid(element) {\n  return {\n    x: element.x + round(element.width / 2),\n    y: element.y + round(element.height / 2)\n  };\n}\n\n/**\n * A plugin that makes shapes draggable / droppable.\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Modeling} modeling\n * @param {Selection} selection\n * @param {Rules} rules\n */\nexport default function MoveEvents(\n    eventBus, dragging, modeling,\n    selection, rules) {\n\n  // rules\n\n  function canMove(shapes, delta, position, target) {\n\n    return rules.allowed('elements.move', {\n      shapes: shapes,\n      delta: delta,\n      position: position,\n      target: target\n    });\n  }\n\n\n  // move events\n\n  // assign a high priority to this handler to setup the environment\n  // others may hook up later, e.g. at default priority and modify\n  // the move environment.\n  //\n  // This sets up the context with\n  //\n  // * shape: the primary shape being moved\n  // * shapes: a list of shapes to be moved\n  // * validatedShapes: a list of shapes that are being checked\n  //                    against the rules before and during move\n  //\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(event) {\n\n    var context = event.context,\n        shape = event.shape,\n        shapes = selection.get().slice();\n\n    // move only single shape if the dragged element\n    // is not part of the current selection\n    if (shapes.indexOf(shape) === -1) {\n      shapes = [ shape ];\n    }\n\n    // ensure we remove nested elements in the collection\n    // and add attachers for a proper dragger\n    shapes = removeNested(shapes);\n\n    // attach shapes to drag context\n    assign(context, {\n      shapes: shapes,\n      validatedShapes: shapes,\n      shape: shape\n    });\n  });\n\n\n  // assign a high priority to this handler to setup the environment\n  // others may hook up later, e.g. at default priority and modify\n  // the move environment\n  //\n  eventBus.on('shape.move.start', MEDIUM_PRIORITY, function(event) {\n\n    var context = event.context,\n        validatedShapes = context.validatedShapes,\n        canExecute;\n\n    canExecute = context.canExecute = canMove(validatedShapes);\n\n    // check if we can move the elements\n    if (!canExecute) {\n      return false;\n    }\n  });\n\n  // assign a low priority to this handler\n  // to let others modify the move event before we update\n  // the context\n  //\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        validatedShapes = context.validatedShapes,\n        hover = event.hover,\n        delta = { x: event.dx, y: event.dy },\n        position = { x: event.x, y: event.y },\n        canExecute;\n\n    // check if we can move the elements\n    canExecute = canMove(validatedShapes, delta, position, hover);\n\n    context.delta = delta;\n    context.canExecute = canExecute;\n\n    // simply ignore move over\n    if (canExecute === null) {\n      context.target = null;\n\n      return;\n    }\n\n    context.target = hover;\n  });\n\n  eventBus.on('shape.move.end', function(event) {\n\n    var context = event.context;\n\n    var delta = context.delta,\n        canExecute = context.canExecute,\n        isAttach = canExecute === 'attach',\n        shapes = context.shapes;\n\n    if (canExecute === false) {\n      return false;\n    }\n\n    // ensure we have actual pixel values deltas\n    // (important when zoom level was > 1 during move)\n    delta.x = round(delta.x);\n    delta.y = round(delta.y);\n\n    if (delta.x === 0 && delta.y === 0) {\n\n      // didn't move\n      return;\n    }\n\n    modeling.moveElements(shapes, delta, context.target, {\n      primaryShape: context.shape,\n      attach: isAttach\n    });\n  });\n\n\n  // move activation\n\n  eventBus.on('element.mousedown', function(event) {\n\n    var originalEvent = getOriginalEvent(event);\n\n    if (!originalEvent) {\n      throw new Error('must supply DOM mousedown event');\n    }\n\n    return start(originalEvent, event.element);\n  });\n\n  /**\n   * Start move.\n   *\n   * @param {MouseEvent} event\n   * @param {djs.model.Shape} shape\n   * @param {boolean} [activate]\n   * @param {Object} [context]\n   */\n  function start(event, element, activate, context) {\n    if (isObject(activate)) {\n      context = activate;\n      activate = false;\n    }\n\n    // do not move connections or the root element\n    if (element.waypoints || !element.parent) {\n      return;\n    }\n\n    var referencePoint = mid(element);\n\n    dragging.init(event, referencePoint, 'shape.move', {\n      cursor: 'grabbing',\n      autoActivate: activate,\n      data: {\n        shape: element,\n        context: context || {}\n      }\n    });\n\n    // we've handled the event\n    return true;\n  }\n\n  // API\n\n  this.start = start;\n}\n\nMoveEvents.$inject = [\n  'eventBus',\n  'dragging',\n  'modeling',\n  'selection',\n  'rules'\n];\n\n\n/**\n * Return a filtered list of elements that do not contain\n * those nested into others.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeNested(elements) {\n\n  var ids = groupBy(elements, 'id');\n\n  return filter(elements, function(element) {\n    while ((element = element.parent)) {\n\n      // parent in selection\n      if (ids[element.id]) {\n        return false;\n      }\n    }\n\n    return true;\n  });\n}\n","import {\n  flatten,\n  forEach,\n  filter,\n  find,\n  groupBy,\n  map,\n  matchPattern,\n  size\n} from 'min-dash';\n\nimport {\n  selfAndAllChildren\n} from '../../util/Elements';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport { translate } from '../../util/SvgTransformUtil';\n\nvar LOW_PRIORITY = 499;\n\nvar MARKER_DRAGGING = 'djs-dragging',\n    MARKER_OK = 'drop-ok',\n    MARKER_NOT_OK = 'drop-not-ok',\n    MARKER_NEW_PARENT = 'new-parent',\n    MARKER_ATTACH = 'attach-ok';\n\n\n/**\n * Provides previews for moving shapes when moving.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Canvas} canvas\n * @param {Styles} styles\n */\nexport default function MovePreview(\n    eventBus, canvas, styles, previewSupport) {\n\n  function getVisualDragShapes(shapes) {\n    var elements = getAllDraggedElements(shapes);\n\n    var filteredElements = removeEdges(elements);\n\n    return filteredElements;\n  }\n\n  function getAllDraggedElements(shapes) {\n    var allShapes = selfAndAllChildren(shapes, true);\n\n    var allConnections = map(allShapes, function(shape) {\n      return (shape.incoming || []).concat(shape.outgoing || []);\n    });\n\n    return flatten(allShapes.concat(allConnections));\n  }\n\n  /**\n   * Sets drop marker on an element.\n   */\n  function setMarker(element, marker) {\n\n    [ MARKER_ATTACH, MARKER_OK, MARKER_NOT_OK, MARKER_NEW_PARENT ].forEach(function(m) {\n\n      if (m === marker) {\n        canvas.addMarker(element, m);\n      } else {\n        canvas.removeMarker(element, m);\n      }\n    });\n  }\n\n  /**\n   * Make an element draggable.\n   *\n   * @param {Object} context\n   * @param {djs.model.Base} element\n   * @param {boolean} addMarker\n   */\n  function makeDraggable(context, element, addMarker) {\n\n    previewSupport.addDragger(element, context.dragGroup);\n\n    if (addMarker) {\n      canvas.addMarker(element, MARKER_DRAGGING);\n    }\n\n    if (context.allDraggedElements) {\n      context.allDraggedElements.push(element);\n    } else {\n      context.allDraggedElements = [ element ];\n    }\n  }\n\n  // assign a low priority to this handler\n  // to let others modify the move context before\n  // we draw things\n  eventBus.on('shape.move.start', LOW_PRIORITY, function(event) {\n    var context = event.context,\n        dragShapes = context.shapes,\n        allDraggedElements = context.allDraggedElements;\n\n    var visuallyDraggedShapes = getVisualDragShapes(dragShapes);\n\n    if (!context.dragGroup) {\n      var dragGroup = svgCreate('g');\n\n      svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\n\n      var defaultLayer = canvas.getDefaultLayer();\n\n      svgAppend(defaultLayer, dragGroup);\n\n      context.dragGroup = dragGroup;\n    }\n\n    // add previews\n    visuallyDraggedShapes.forEach(function(shape) {\n      previewSupport.addDragger(shape, context.dragGroup);\n    });\n\n    // cache all dragged elements / gfx\n    // so that we can quickly undo their state changes later\n    if (!allDraggedElements) {\n      allDraggedElements = getAllDraggedElements(dragShapes);\n    } else {\n      allDraggedElements = flatten([\n        allDraggedElements,\n        getAllDraggedElements(dragShapes)\n      ]);\n    }\n\n    // add dragging marker\n    forEach(allDraggedElements, function(e) {\n      canvas.addMarker(e, MARKER_DRAGGING);\n    });\n\n    context.allDraggedElements = allDraggedElements;\n\n    // determine, if any of the dragged elements have different parents\n    context.differentParents = haveDifferentParents(dragShapes);\n  });\n\n  // update previews\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        dragGroup = context.dragGroup,\n        target = context.target,\n        parent = context.shape.parent,\n        canExecute = context.canExecute;\n\n    if (target) {\n      if (canExecute === 'attach') {\n        setMarker(target, MARKER_ATTACH);\n      } else if (context.canExecute && target && target.id !== parent.id) {\n        setMarker(target, MARKER_NEW_PARENT);\n      } else {\n        setMarker(target, context.canExecute ? MARKER_OK : MARKER_NOT_OK);\n      }\n    }\n\n    translate(dragGroup, event.dx, event.dy);\n  });\n\n  eventBus.on([ 'shape.move.out', 'shape.move.cleanup' ], function(event) {\n    var context = event.context,\n        target = context.target;\n\n    if (target) {\n      setMarker(target, null);\n    }\n  });\n\n  // remove previews\n  eventBus.on('shape.move.cleanup', function(event) {\n\n    var context = event.context,\n        allDraggedElements = context.allDraggedElements,\n        dragGroup = context.dragGroup;\n\n\n    // remove dragging marker\n    forEach(allDraggedElements, function(e) {\n      canvas.removeMarker(e, MARKER_DRAGGING);\n    });\n\n    if (dragGroup) {\n      svgRemove(dragGroup);\n    }\n  });\n\n\n  // API //////////////////////\n\n  /**\n   * Make an element draggable.\n   *\n   * @param {Object} context\n   * @param {djs.model.Base} element\n   * @param {boolean} addMarker\n   */\n  this.makeDraggable = makeDraggable;\n}\n\nMovePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'styles',\n  'previewSupport'\n];\n\n\n// helpers //////////////////////\n\n/**\n * returns elements minus all connections\n * where source or target is not elements\n */\nfunction removeEdges(elements) {\n\n  var filteredElements = filter(elements, function(element) {\n\n    if (!isConnection(element)) {\n      return true;\n    } else {\n\n      return (\n        find(elements, matchPattern({ id: element.source.id })) &&\n        find(elements, matchPattern({ id: element.target.id }))\n      );\n    }\n  });\n\n  return filteredElements;\n}\n\nfunction haveDifferentParents(elements) {\n  return size(groupBy(elements, function(e) { return e.parent && e.parent.id; })) !== 1;\n}\n\n/**\n * Checks if an element is a connection.\n */\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import InteractionEventsModule from '../interaction-events';\nimport SelectionModule from '../selection';\nimport OutlineModule from '../outline';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\n\nimport Move from './Move';\nimport MovePreview from './MovePreview';\n\nexport default {\n  __depends__: [\n    InteractionEventsModule,\n    SelectionModule,\n    OutlineModule,\n    RulesModule,\n    DraggingModule,\n    PreviewSupportModule\n  ],\n  __init__: [\n    'move',\n    'movePreview'\n  ],\n  move: [ 'type', Move ],\n  movePreview: [ 'type', MovePreview ]\n};\n","import {\n  isArray,\n  isFunction,\n  forEach\n} from 'min-dash';\n\nimport {\n  domify,\n  query as domQuery,\n  attr as domAttr,\n  clear as domClear,\n  classes as domClasses,\n  matches as domMatches,\n  delegate as domDelegate,\n  event as domEvent\n} from 'min-dom';\n\n\nvar TOGGLE_SELECTOR = '.djs-palette-toggle',\n    ENTRY_SELECTOR = '.entry',\n    ELEMENT_SELECTOR = TOGGLE_SELECTOR + ', ' + ENTRY_SELECTOR;\n\nvar PALETTE_OPEN_CLS = 'open',\n    PALETTE_TWO_COLUMN_CLS = 'two-column';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A palette containing modeling elements.\n */\nexport default function Palette(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n\n  var self = this;\n\n  eventBus.on('tool-manager.update', function(event) {\n    var tool = event.tool;\n\n    self.updateToolHighlight(tool);\n  });\n\n  eventBus.on('i18n.changed', function() {\n    self._update();\n  });\n\n  eventBus.on('diagram.init', function() {\n\n    self._diagramInitialized = true;\n\n    self._rebuild();\n  });\n}\n\nPalette.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Register a provider with the palette\n *\n * @param  {number} [priority=1000]\n * @param  {PaletteProvider} provider\n *\n * @example\n * const paletteProvider = {\n *   getPaletteEntries: function() {\n *     return function(entries) {\n *       return {\n *         ...entries,\n *         'entry-1': {\n *           label: 'My Entry',\n *           action: function() { alert(\"I have been clicked!\"); }\n *         }\n *       };\n *     }\n *   }\n * };\n *\n * palette.registerProvider(800, paletteProvider);\n */\nPalette.prototype.registerProvider = function(priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('palette.getProviders', priority, function(event) {\n    event.providers.push(provider);\n  });\n\n  this._rebuild();\n};\n\n\n/**\n * Returns the palette entries\n *\n * @return {Object<string, PaletteEntryDescriptor>} map of entries\n */\nPalette.prototype.getEntries = function() {\n  var providers = this._getProviders();\n\n  return providers.reduce(addPaletteEntries, {});\n};\n\nPalette.prototype._rebuild = function() {\n\n  if (!this._diagramInitialized) {\n    return;\n  }\n\n  var providers = this._getProviders();\n\n  if (!providers.length) {\n    return;\n  }\n\n  if (!this._container) {\n    this._init();\n  }\n\n  this._update();\n};\n\n/**\n * Initialize\n */\nPalette.prototype._init = function() {\n\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var parentContainer = this._getParentContainer();\n\n  var container = this._container = domify(Palette.HTML_MARKUP);\n\n  parentContainer.appendChild(container);\n\n  domDelegate.bind(container, ELEMENT_SELECTOR, 'click', function(event) {\n\n    var target = event.delegateTarget;\n\n    if (domMatches(target, TOGGLE_SELECTOR)) {\n      return self.toggle();\n    }\n\n    self.trigger('click', event);\n  });\n\n  // prevent drag propagation\n  domEvent.bind(container, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  // prevent drag propagation\n  domDelegate.bind(container, ENTRY_SELECTOR, 'dragstart', function(event) {\n    self.trigger('dragstart', event);\n  });\n\n  eventBus.on('canvas.resized', this._layoutChanged, this);\n\n  eventBus.fire('palette.create', {\n    container: container\n  });\n};\n\nPalette.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'palette.getProviders',\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\n/**\n * Update palette state.\n *\n * @param  {Object} [state] { open, twoColumn }\n */\nPalette.prototype._toggleState = function(state) {\n\n  state = state || {};\n\n  var parent = this._getParentContainer(),\n      container = this._container;\n\n  var eventBus = this._eventBus;\n\n  var twoColumn;\n\n  var cls = domClasses(container);\n\n  if ('twoColumn' in state) {\n    twoColumn = state.twoColumn;\n  } else {\n    twoColumn = this._needsCollapse(parent.clientHeight, this._entries || {});\n  }\n\n  // always update two column\n  cls.toggle(PALETTE_TWO_COLUMN_CLS, twoColumn);\n\n  if ('open' in state) {\n    cls.toggle(PALETTE_OPEN_CLS, state.open);\n  }\n\n  eventBus.fire('palette.changed', {\n    twoColumn: twoColumn,\n    open: this.isOpen()\n  });\n};\n\nPalette.prototype._update = function() {\n\n  var entriesContainer = domQuery('.djs-palette-entries', this._container),\n      entries = this._entries = this.getEntries();\n\n  domClear(entriesContainer);\n\n  forEach(entries, function(entry, id) {\n\n    var grouping = entry.group || 'default';\n\n    var container = domQuery('[data-group=' + grouping + ']', entriesContainer);\n    if (!container) {\n      container = domify('<div class=\"group\" data-group=\"' + grouping + '\"></div>');\n      entriesContainer.appendChild(container);\n    }\n\n    var html = entry.html || (\n      entry.separator ?\n        '<hr class=\"separator\" />' :\n        '<div class=\"entry\" draggable=\"true\"></div>');\n\n\n    var control = domify(html);\n    container.appendChild(control);\n\n    if (!entry.separator) {\n      domAttr(control, 'data-action', id);\n\n      if (entry.title) {\n        domAttr(control, 'title', entry.title);\n      }\n\n      if (entry.className) {\n        addClasses(control, entry.className);\n      }\n\n      if (entry.imageUrl) {\n        control.appendChild(domify('<img src=\"' + entry.imageUrl + '\">'));\n      }\n    }\n  });\n\n  // open after update\n  this.open();\n};\n\n\n/**\n * Trigger an action available on the palette\n *\n * @param  {string} action\n * @param  {Event} event\n */\nPalette.prototype.trigger = function(action, event, autoActivate) {\n  var entries = this._entries,\n      entry,\n      handler,\n      originalEvent,\n      button = event.delegateTarget || event.target;\n\n  if (!button) {\n    return event.preventDefault();\n  }\n\n  entry = entries[domAttr(button, 'data-action')];\n\n  // when user clicks on the palette and not on an action\n  if (!entry) {\n    return;\n  }\n\n  handler = entry.action;\n\n  originalEvent = event.originalEvent || event;\n\n  // simple action (via callback function)\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      handler(originalEvent, autoActivate);\n    }\n  } else {\n    if (handler[action]) {\n      handler[action](originalEvent, autoActivate);\n    }\n  }\n\n  // silence other actions\n  event.preventDefault();\n};\n\nPalette.prototype._layoutChanged = function() {\n  this._toggleState({});\n};\n\n/**\n * Do we need to collapse to two columns?\n *\n * @param {number} availableHeight\n * @param {Object} entries\n *\n * @return {boolean}\n */\nPalette.prototype._needsCollapse = function(availableHeight, entries) {\n\n  // top margin + bottom toggle + bottom margin\n  // implementors must override this method if they\n  // change the palette styles\n  var margin = 20 + 10 + 20;\n\n  var entriesHeight = Object.keys(entries).length * 46;\n\n  return availableHeight < entriesHeight + margin;\n};\n\n/**\n * Close the palette\n */\nPalette.prototype.close = function() {\n\n  this._toggleState({\n    open: false,\n    twoColumn: false\n  });\n};\n\n\n/**\n * Open the palette\n */\nPalette.prototype.open = function() {\n  this._toggleState({ open: true });\n};\n\n\nPalette.prototype.toggle = function(open) {\n  if (this.isOpen()) {\n    this.close();\n  } else {\n    this.open();\n  }\n};\n\nPalette.prototype.isActiveTool = function(tool) {\n  return tool && this._activeTool === tool;\n};\n\nPalette.prototype.updateToolHighlight = function(name) {\n  var entriesContainer,\n      toolsContainer;\n\n  if (!this._toolsContainer) {\n    entriesContainer = domQuery('.djs-palette-entries', this._container);\n\n    this._toolsContainer = domQuery('[data-group=tools]', entriesContainer);\n  }\n\n  toolsContainer = this._toolsContainer;\n\n  forEach(toolsContainer.children, function(tool) {\n    var actionName = tool.getAttribute('data-action');\n\n    if (!actionName) {\n      return;\n    }\n\n    var toolClasses = domClasses(tool);\n\n    actionName = actionName.replace('-tool', '');\n\n    if (toolClasses.contains('entry') && actionName === name) {\n      toolClasses.add('highlighted-entry');\n    } else {\n      toolClasses.remove('highlighted-entry');\n    }\n  });\n};\n\n\n/**\n * Return true if the palette is opened.\n *\n * @example\n *\n * palette.open();\n *\n * if (palette.isOpen()) {\n *   // yes, we are open\n * }\n *\n * @return {boolean} true if palette is opened\n */\nPalette.prototype.isOpen = function() {\n  return domClasses(this._container).has(PALETTE_OPEN_CLS);\n};\n\n/**\n * Get container the palette lives in.\n *\n * @return {Element}\n */\nPalette.prototype._getParentContainer = function() {\n  return this._canvas.getContainer();\n};\n\n\n/* markup definition */\n\nPalette.HTML_MARKUP =\n  '<div class=\"djs-palette\">' +\n    '<div class=\"djs-palette-entries\"></div>' +\n    '<div class=\"djs-palette-toggle\"></div>' +\n  '</div>';\n\n\n// helpers //////////////////////\n\nfunction addClasses(element, classNames) {\n\n  var classes = domClasses(element);\n\n  var actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\n  actualClassNames.forEach(function(cls) {\n    classes.add(cls);\n  });\n}\n\nfunction addPaletteEntries(entries, provider) {\n\n  var entriesOrUpdater = provider.getPaletteEntries();\n\n  if (isFunction(entriesOrUpdater)) {\n    return entriesOrUpdater(entries);\n  }\n\n  forEach(entriesOrUpdater, function(entry, id) {\n    entries[id] = entry;\n  });\n\n  return entries;\n}","import Palette from './Palette';\n\nexport default {\n  __init__: [ 'palette' ],\n  palette: [ 'type', Palette ]\n};\n","/**\n * Get the logarithm of x with base 10\n * @param  {Integer} value\n */\nexport function log10(x) {\n  return Math.log(x) / Math.log(10);\n}\n\nexport { delta as substract } from './PositionUtil';\n","import {\n  log10\n} from '../../util/Math';\n\n/**\n * Get step size for given range and number of steps.\n *\n * @param {Object} range\n * @param {number} range.min\n * @param {number} range.max\n */\nexport function getStepSize(range, steps) {\n\n  var minLinearRange = log10(range.min),\n      maxLinearRange = log10(range.max);\n\n  var absoluteLinearRange = Math.abs(minLinearRange) + Math.abs(maxLinearRange);\n\n  return absoluteLinearRange / steps;\n}\n\nexport function cap(range, scale) {\n  return Math.max(range.min, Math.min(range.max, scale));\n}\n","import {\n  event as domEvent,\n  closest as domClosest\n} from 'min-dom';\n\nimport {\n  getStepSize,\n  cap\n} from './ZoomUtil';\n\nimport {\n  log10\n} from '../../util/Math';\n\nimport {\n  bind\n} from 'min-dash';\n\nvar sign = Math.sign || function(n) {\n  return n >= 0 ? 1 : -1;\n};\n\nvar RANGE = { min: 0.2, max: 4 },\n    NUM_STEPS = 10;\n\nvar DELTA_THRESHOLD = 0.1;\n\nvar DEFAULT_SCALE = 0.75;\n\n/**\n * An implementation of zooming and scrolling within the\n * {@link Canvas} via the mouse wheel.\n *\n * Mouse wheel zooming / scrolling may be disabled using\n * the {@link toggle(enabled)} method.\n *\n * @param {Object} [config]\n * @param {boolean} [config.enabled=true] default enabled state\n * @param {number} [config.scale=.75] scroll sensivity\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function ZoomScroll(config, eventBus, canvas) {\n\n  config = config || {};\n\n  this._enabled = false;\n\n  this._canvas = canvas;\n  this._container = canvas._container;\n\n  this._handleWheel = bind(this._handleWheel, this);\n\n  this._totalDelta = 0;\n  this._scale = config.scale || DEFAULT_SCALE;\n\n  var self = this;\n\n  eventBus.on('canvas.init', function(e) {\n    self._init(config.enabled !== false);\n  });\n}\n\nZoomScroll.$inject = [\n  'config.zoomScroll',\n  'eventBus',\n  'canvas'\n];\n\nZoomScroll.prototype.scroll = function scroll(delta) {\n  this._canvas.scroll(delta);\n};\n\n\nZoomScroll.prototype.reset = function reset() {\n  this._canvas.zoom('fit-viewport');\n};\n\n/**\n * Zoom depending on delta.\n *\n * @param {number} delta\n * @param {Object} position\n */\nZoomScroll.prototype.zoom = function zoom(delta, position) {\n\n  // zoom with half the step size of stepZoom\n  var stepSize = getStepSize(RANGE, NUM_STEPS * 2);\n\n  // add until threshold reached\n  this._totalDelta += delta;\n\n  if (Math.abs(this._totalDelta) > DELTA_THRESHOLD) {\n    this._zoom(delta, position, stepSize);\n\n    // reset\n    this._totalDelta = 0;\n  }\n};\n\n\nZoomScroll.prototype._handleWheel = function handleWheel(event) {\n\n  // event is already handled by '.djs-scrollable'\n  if (domClosest(event.target, '.djs-scrollable', true)) {\n    return;\n  }\n\n  var element = this._container;\n\n  event.preventDefault();\n\n  // pinch to zoom is mapped to wheel + ctrlKey = true\n  // in modern browsers (!)\n\n  var isZoom = event.ctrlKey;\n\n  var isHorizontalScroll = event.shiftKey;\n\n  var factor = -1 * this._scale,\n      delta;\n\n  if (isZoom) {\n    factor *= event.deltaMode === 0 ? 0.020 : 0.32;\n  } else {\n    factor *= event.deltaMode === 0 ? 1.0 : 16.0;\n  }\n\n  if (isZoom) {\n    var elementRect = element.getBoundingClientRect();\n\n    var offset = {\n      x: event.clientX - elementRect.left,\n      y: event.clientY - elementRect.top\n    };\n\n    delta = (\n      Math.sqrt(\n        Math.pow(event.deltaY, 2) +\n        Math.pow(event.deltaX, 2)\n      ) * sign(event.deltaY) * factor\n    );\n\n    // zoom in relative to diagram {x,y} coordinates\n    this.zoom(delta, offset);\n  } else {\n\n    if (isHorizontalScroll) {\n      delta = {\n        dx: factor * event.deltaY,\n        dy: 0\n      };\n    } else {\n      delta = {\n        dx: factor * event.deltaX,\n        dy: factor * event.deltaY\n      };\n    }\n\n    this.scroll(delta);\n  }\n};\n\n/**\n * Zoom with fixed step size.\n *\n * @param {number} delta - Zoom delta (1 for zooming in, -1 for out).\n * @param {Object} position\n */\nZoomScroll.prototype.stepZoom = function stepZoom(delta, position) {\n\n  var stepSize = getStepSize(RANGE, NUM_STEPS);\n\n  this._zoom(delta, position, stepSize);\n};\n\n\n/**\n * Zoom in/out given a step size.\n *\n * @param {number} delta\n * @param {Object} position\n * @param {number} stepSize\n */\nZoomScroll.prototype._zoom = function(delta, position, stepSize) {\n  var canvas = this._canvas;\n\n  var direction = delta > 0 ? 1 : -1;\n\n  var currentLinearZoomLevel = log10(canvas.zoom());\n\n  // snap to a proximate zoom step\n  var newLinearZoomLevel = Math.round(currentLinearZoomLevel / stepSize) * stepSize;\n\n  // increase or decrease one zoom step in the given direction\n  newLinearZoomLevel += stepSize * direction;\n\n  // calculate the absolute logarithmic zoom level based on the linear zoom level\n  // (e.g. 2 for an absolute x2 zoom)\n  var newLogZoomLevel = Math.pow(10, newLinearZoomLevel);\n\n  canvas.zoom(cap(RANGE, newLogZoomLevel), position);\n};\n\n\n/**\n * Toggle the zoom scroll ability via mouse wheel.\n *\n * @param  {boolean} [newEnabled] new enabled state\n */\nZoomScroll.prototype.toggle = function toggle(newEnabled) {\n\n  var element = this._container;\n  var handleWheel = this._handleWheel;\n\n  var oldEnabled = this._enabled;\n\n  if (typeof newEnabled === 'undefined') {\n    newEnabled = !oldEnabled;\n  }\n\n  // only react on actual changes\n  if (oldEnabled !== newEnabled) {\n\n    // add or remove wheel listener based on\n    // changed enabled state\n    domEvent[newEnabled ? 'bind' : 'unbind'](element, 'wheel', handleWheel, false);\n  }\n\n  this._enabled = newEnabled;\n\n  return newEnabled;\n};\n\n\nZoomScroll.prototype._init = function(newEnabled) {\n  this.toggle(newEnabled);\n};\n","import ZoomScroll from './ZoomScroll';\n\nexport default {\n  __init__: [ 'zoomScroll' ],\n  zoomScroll: [ 'type', ZoomScroll ]\n};","import {\n  uniqueBy,\n  isArray\n} from 'min-dash';\n\n\n/**\n * A service that offers un- and redoable execution of commands.\n *\n * The command stack is responsible for executing modeling actions\n * in a un- and redoable manner. To do this it delegates the actual\n * command execution to {@link CommandHandler}s.\n *\n * Command handlers provide {@link CommandHandler#execute(ctx)} and\n * {@link CommandHandler#revert(ctx)} methods to un- and redo a command\n * identified by a command context.\n *\n *\n * ## Life-Cycle events\n *\n * In the process the command stack fires a number of life-cycle events\n * that other components to participate in the command execution.\n *\n *    * preExecute\n *    * preExecuted\n *    * execute\n *    * executed\n *    * postExecute\n *    * postExecuted\n *    * revert\n *    * reverted\n *\n * A special event is used for validating, whether a command can be\n * performed prior to its execution.\n *\n *    * canExecute\n *\n * Each of the events is fired as `commandStack.{eventName}` and\n * `commandStack.{commandName}.{eventName}`, respectively. This gives\n * components fine grained control on where to hook into.\n *\n * The event object fired transports `command`, the name of the\n * command and `context`, the command context.\n *\n *\n * ## Creating Command Handlers\n *\n * Command handlers should provide the {@link CommandHandler#execute(ctx)}\n * and {@link CommandHandler#revert(ctx)} methods to implement\n * redoing and undoing of a command.\n *\n * A command handler _must_ ensure undo is performed properly in order\n * not to break the undo chain. It must also return the shapes that\n * got changed during the `execute` and `revert` operations.\n *\n * Command handlers may execute other modeling operations (and thus\n * commands) in their `preExecute` and `postExecute` phases. The command\n * stack will properly group all commands together into a logical unit\n * that may be re- and undone atomically.\n *\n * Command handlers must not execute other commands from within their\n * core implementation (`execute`, `revert`).\n *\n *\n * ## Change Tracking\n *\n * During the execution of the CommandStack it will keep track of all\n * elements that have been touched during the command's execution.\n *\n * At the end of the CommandStack execution it will notify interested\n * components via an 'elements.changed' event with all the dirty\n * elements.\n *\n * The event can be picked up by components that are interested in the fact\n * that elements have been changed. One use case for this is updating\n * their graphical representation after moving / resizing or deletion.\n *\n * @see CommandHandler\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function CommandStack(eventBus, injector) {\n\n  /**\n   * A map of all registered command handlers.\n   *\n   * @type {Object}\n   */\n  this._handlerMap = {};\n\n  /**\n   * A stack containing all re/undoable actions on the diagram\n   *\n   * @type {Array<Object>}\n   */\n  this._stack = [];\n\n  /**\n   * The current index on the stack\n   *\n   * @type {number}\n   */\n  this._stackIdx = -1;\n\n  /**\n   * Current active commandStack execution\n   *\n   * @type {Object}\n   */\n  this._currentExecution = {\n    actions: [],\n    dirty: []\n  };\n\n\n  this._injector = injector;\n  this._eventBus = eventBus;\n\n  this._uid = 1;\n\n  eventBus.on([\n    'diagram.destroy',\n    'diagram.clear'\n  ], function() {\n    this.clear(false);\n  }, this);\n}\n\nCommandStack.$inject = [ 'eventBus', 'injector' ];\n\n\n/**\n * Execute a command\n *\n * @param {string} command the command to execute\n * @param {Object} context the environment to execute the command in\n */\nCommandStack.prototype.execute = function(command, context) {\n  if (!command) {\n    throw new Error('command required');\n  }\n\n  var action = { command: command, context: context };\n\n  this._pushAction(action);\n  this._internalExecute(action);\n  this._popAction(action);\n};\n\n\n/**\n * Ask whether a given command can be executed.\n *\n * Implementors may hook into the mechanism on two ways:\n *\n *   * in event listeners:\n *\n *     Users may prevent the execution via an event listener.\n *     It must prevent the default action for `commandStack.(<command>.)canExecute` events.\n *\n *   * in command handlers:\n *\n *     If the method {@link CommandHandler#canExecute} is implemented in a handler\n *     it will be called to figure out whether the execution is allowed.\n *\n * @param  {string} command the command to execute\n * @param  {Object} context the environment to execute the command in\n *\n * @return {boolean} true if the command can be executed\n */\nCommandStack.prototype.canExecute = function(command, context) {\n\n  var action = { command: command, context: context };\n\n  var handler = this._getHandler(command);\n\n  var result = this._fire(command, 'canExecute', action);\n\n  // handler#canExecute will only be called if no listener\n  // decided on a result already\n  if (result === undefined) {\n    if (!handler) {\n      return false;\n    }\n\n    if (handler.canExecute) {\n      result = handler.canExecute(context);\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Clear the command stack, erasing all undo / redo history\n */\nCommandStack.prototype.clear = function(emit) {\n  this._stack.length = 0;\n  this._stackIdx = -1;\n\n  if (emit !== false) {\n    this._fire('changed');\n  }\n};\n\n\n/**\n * Undo last command(s)\n */\nCommandStack.prototype.undo = function() {\n  var action = this._getUndoAction(),\n      next;\n\n  if (action) {\n    this._pushAction(action);\n\n    while (action) {\n      this._internalUndo(action);\n      next = this._getUndoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Redo last command(s)\n */\nCommandStack.prototype.redo = function() {\n  var action = this._getRedoAction(),\n      next;\n\n  if (action) {\n    this._pushAction(action);\n\n    while (action) {\n      this._internalExecute(action, true);\n      next = this._getRedoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Register a handler instance with the command stack\n *\n * @param {string} command\n * @param {CommandHandler} handler\n */\nCommandStack.prototype.register = function(command, handler) {\n  this._setHandler(command, handler);\n};\n\n\n/**\n * Register a handler type with the command stack\n * by instantiating it and injecting its dependencies.\n *\n * @param {string} command\n * @param {Function} a constructor for a {@link CommandHandler}\n */\nCommandStack.prototype.registerHandler = function(command, handlerCls) {\n\n  if (!command || !handlerCls) {\n    throw new Error('command and handlerCls must be defined');\n  }\n\n  var handler = this._injector.instantiate(handlerCls);\n  this.register(command, handler);\n};\n\nCommandStack.prototype.canUndo = function() {\n  return !!this._getUndoAction();\n};\n\nCommandStack.prototype.canRedo = function() {\n  return !!this._getRedoAction();\n};\n\n// stack access  //////////////////////\n\nCommandStack.prototype._getRedoAction = function() {\n  return this._stack[this._stackIdx + 1];\n};\n\n\nCommandStack.prototype._getUndoAction = function() {\n  return this._stack[this._stackIdx];\n};\n\n\n// internal functionality //////////////////////\n\nCommandStack.prototype._internalUndo = function(action) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n    self._fire(command, 'revert', action);\n\n    if (handler.revert) {\n      self._markDirty(handler.revert(context));\n    }\n\n    self._revertedAction(action);\n\n    self._fire(command, 'reverted', action);\n  });\n};\n\n\nCommandStack.prototype._fire = function(command, qualifier, event) {\n  if (arguments.length < 3) {\n    event = qualifier;\n    qualifier = null;\n  }\n\n  var names = qualifier ? [ command + '.' + qualifier, qualifier ] : [ command ],\n      i, name, result;\n\n  event = this._eventBus.createEvent(event);\n\n  for (i = 0; (name = names[i]); i++) {\n    result = this._eventBus.fire('commandStack.' + name, event);\n\n    if (event.cancelBubble) {\n      break;\n    }\n  }\n\n  return result;\n};\n\nCommandStack.prototype._createId = function() {\n  return this._uid++;\n};\n\nCommandStack.prototype._atomicDo = function(fn) {\n\n  var execution = this._currentExecution;\n\n  execution.atomic = true;\n\n  try {\n    fn();\n  } finally {\n    execution.atomic = false;\n  }\n};\n\nCommandStack.prototype._internalExecute = function(action, redo) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  if (!handler) {\n    throw new Error('no command handler registered for <' + command + '>');\n  }\n\n  this._pushAction(action);\n\n  if (!redo) {\n    this._fire(command, 'preExecute', action);\n\n    if (handler.preExecute) {\n      handler.preExecute(context);\n    }\n\n    this._fire(command, 'preExecuted', action);\n  }\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n\n    self._fire(command, 'execute', action);\n\n    if (handler.execute) {\n\n      // actual execute + mark return results as dirty\n      self._markDirty(handler.execute(context));\n    }\n\n    // log to stack\n    self._executedAction(action, redo);\n\n    self._fire(command, 'executed', action);\n  });\n\n  if (!redo) {\n    this._fire(command, 'postExecute', action);\n\n    if (handler.postExecute) {\n      handler.postExecute(context);\n    }\n\n    this._fire(command, 'postExecuted', action);\n  }\n\n  this._popAction(action);\n};\n\n\nCommandStack.prototype._pushAction = function(action) {\n\n  var execution = this._currentExecution,\n      actions = execution.actions;\n\n  var baseAction = actions[0];\n\n  if (execution.atomic) {\n    throw new Error('illegal invocation in <execute> or <revert> phase (action: ' + action.command + ')');\n  }\n\n  if (!action.id) {\n    action.id = (baseAction && baseAction.id) || this._createId();\n  }\n\n  actions.push(action);\n};\n\n\nCommandStack.prototype._popAction = function() {\n  var execution = this._currentExecution,\n      actions = execution.actions,\n      dirty = execution.dirty;\n\n  actions.pop();\n\n  if (!actions.length) {\n    this._eventBus.fire('elements.changed', { elements: uniqueBy('id', dirty.reverse()) });\n\n    dirty.length = 0;\n\n    this._fire('changed');\n  }\n};\n\n\nCommandStack.prototype._markDirty = function(elements) {\n  var execution = this._currentExecution;\n\n  if (!elements) {\n    return;\n  }\n\n  elements = isArray(elements) ? elements : [ elements ];\n\n  execution.dirty = execution.dirty.concat(elements);\n};\n\n\nCommandStack.prototype._executedAction = function(action, redo) {\n  var stackIdx = ++this._stackIdx;\n\n  if (!redo) {\n    this._stack.splice(stackIdx, this._stack.length, action);\n  }\n};\n\n\nCommandStack.prototype._revertedAction = function(action) {\n  this._stackIdx--;\n};\n\n\nCommandStack.prototype._getHandler = function(command) {\n  return this._handlerMap[command];\n};\n\nCommandStack.prototype._setHandler = function(command, handler) {\n  if (!command || !handler) {\n    throw new Error('command and handler required');\n  }\n\n  if (this._handlerMap[command]) {\n    throw new Error('overriding handler for command <' + command + '>');\n  }\n\n  this._handlerMap[command] = handler;\n};\n","import CommandStack from './CommandStack';\n\nexport default {\n  commandStack: [ 'type', CommandStack ]\n};\n","/**\n * Remove from the beginning of a collection until it is empty.\n *\n * This is a null-safe operation that ensures elements\n * are being removed from the given collection until the\n * collection is empty.\n *\n * The implementation deals with the fact that a remove operation\n * may touch, i.e. remove multiple elements in the collection\n * at a time.\n *\n * @param {Array<Object>} [collection]\n * @param {Function} removeFn\n *\n * @return {Array<Object>} the cleared collection\n */\nexport function saveClear(collection, removeFn) {\n\n  if (typeof removeFn !== 'function') {\n    throw new Error('removeFn iterator must be a function');\n  }\n\n  if (!collection) {\n    return;\n  }\n\n  var e;\n\n  while ((e = collection[0])) {\n    removeFn(e);\n  }\n\n  return collection;\n}\n","import {\n  forEach,\n  isFunction,\n  isArray,\n  isNumber,\n  isObject\n} from 'min-dash';\n\n\nvar DEFAULT_PRIORITY = 1000;\n\n/**\n * A utility that can be used to plug-in into the command execution for\n * extension and/or validation.\n *\n * @param {EventBus} eventBus\n *\n * @example\n *\n * import inherits from 'inherits';\n *\n * import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n *\n * function CommandLogger(eventBus) {\n *   CommandInterceptor.call(this, eventBus);\n *\n *   this.preExecute(function(event) {\n *     console.log('command pre-execute', event);\n *   });\n * }\n *\n * inherits(CommandLogger, CommandInterceptor);\n *\n */\nexport default function CommandInterceptor(eventBus) {\n  this._eventBus = eventBus;\n}\n\nCommandInterceptor.$inject = [ 'eventBus' ];\n\nfunction unwrapEvent(fn, that) {\n  return function(event) {\n    return fn.call(that || null, event.context, event.command, event);\n  };\n}\n\n/**\n * Register an interceptor for a command execution\n *\n * @param {string|Array<string>} [events] list of commands to register on\n * @param {string} [hook] command hook, i.e. preExecute, executed to listen on\n * @param {number} [priority] the priority on which to hook into the execution\n * @param {Function} handlerFn interceptor to be invoked with (event)\n * @param {boolean} unwrap if true, unwrap the event and pass (context, command, event) to the\n *                          listener instead\n * @param {Object} [that] Pass context (`this`) to the handler function\n */\nCommandInterceptor.prototype.on = function(events, hook, priority, handlerFn, unwrap, that) {\n\n  if (isFunction(hook) || isNumber(hook)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = hook;\n    hook = null;\n  }\n\n  if (isFunction(priority)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (isObject(unwrap)) {\n    that = unwrap;\n    unwrap = false;\n  }\n\n  if (!isFunction(handlerFn)) {\n    throw new Error('handlerFn must be a function');\n  }\n\n  if (!isArray(events)) {\n    events = [ events ];\n  }\n\n  var eventBus = this._eventBus;\n\n  forEach(events, function(event) {\n\n    // concat commandStack(.event)?(.hook)?\n    var fullEvent = [ 'commandStack', event, hook ].filter(function(e) { return e; }).join('.');\n\n    eventBus.on(fullEvent, priority, unwrap ? unwrapEvent(handlerFn, that) : handlerFn, that);\n  });\n};\n\n\nvar hooks = [\n  'canExecute',\n  'preExecute',\n  'preExecuted',\n  'execute',\n  'executed',\n  'postExecute',\n  'postExecuted',\n  'revert',\n  'reverted'\n];\n\n/*\n * Install hook shortcuts\n *\n * This will generate the CommandInterceptor#(preExecute|...|reverted) methods\n * which will in term forward to CommandInterceptor#on.\n */\nforEach(hooks, function(hook) {\n\n  /**\n   * {canExecute|preExecute|preExecuted|execute|executed|postExecute|postExecuted|revert|reverted}\n   *\n   * A named hook for plugging into the command execution\n   *\n   * @param {string|Array<string>} [events] list of commands to register on\n   * @param {number} [priority] the priority on which to hook into the execution\n   * @param {Function} handlerFn interceptor to be invoked with (event)\n   * @param {boolean} [unwrap=false] if true, unwrap the event and pass (context, command, event) to the\n   *                          listener instead\n   * @param {Object} [that] Pass context (`this`) to the handler function\n   */\n  CommandInterceptor.prototype[hook] = function(events, priority, handlerFn, unwrap, that) {\n\n    if (isFunction(events) || isNumber(events)) {\n      that = unwrap;\n      unwrap = handlerFn;\n      handlerFn = priority;\n      priority = events;\n      events = null;\n    }\n\n    this.on(events, hook, priority, handlerFn, unwrap, that);\n  };\n});\n","import {\n  forEach,\n  filter\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nvar LOW_PRIORITY = 250,\n    HIGH_PRIORITY = 1400;\n\nimport {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../util/Collections';\n\nimport { saveClear } from '../../util/Removal';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * A handler that makes sure labels are properly moved with\n * their label targets.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function LabelSupport(injector, eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var movePreview = injector.get('movePreview', false);\n\n  // remove labels from the collection that are being\n  // moved with other elements anyway\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        validatedShapes = context.validatedShapes;\n\n    context.shapes = removeLabels(shapes);\n    context.validatedShapes = removeLabels(validatedShapes);\n  });\n\n  // add labels to visual's group\n  movePreview && eventBus.on('shape.move.start', LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes;\n\n    var labels = [];\n\n    forEach(shapes, function(element) {\n\n      forEach(element.labels, function(label) {\n\n        if (!label.hidden && context.shapes.indexOf(label) === -1) {\n          labels.push(label);\n        }\n\n        if (element.labelTarget) {\n          labels.push(element);\n        }\n      });\n    });\n\n    forEach(labels, function(label) {\n      movePreview.makeDraggable(context, label, true);\n    });\n\n  });\n\n  // add all labels to move closure\n  this.preExecuted('elements.move', HIGH_PRIORITY, function(e) {\n    var context = e.context,\n        closure = context.closure,\n        enclosedElements = closure.enclosedElements;\n\n    var enclosedLabels = [];\n\n    // find labels that are not part of\n    // move closure yet and add them\n    forEach(enclosedElements, function(element) {\n      forEach(element.labels, function(label) {\n\n        if (!enclosedElements[label.id]) {\n          enclosedLabels.push(label);\n        }\n      });\n    });\n\n    closure.addAll(enclosedLabels);\n  });\n\n\n  this.preExecute([\n    'connection.delete',\n    'shape.delete'\n  ], function(e) {\n\n    var context = e.context,\n        element = context.connection || context.shape;\n\n    saveClear(element.labels, function(label) {\n      modeling.removeShape(label, { nested: true });\n    });\n  });\n\n\n  this.execute('shape.delete', function(e) {\n\n    var context = e.context,\n        shape = context.shape,\n        labelTarget = shape.labelTarget;\n\n    // unset labelTarget\n    if (labelTarget) {\n      context.labelTargetIndex = collectionIdx(labelTarget.labels, shape);\n      context.labelTarget = labelTarget;\n\n      shape.labelTarget = null;\n    }\n  });\n\n  this.revert('shape.delete', function(e) {\n\n    var context = e.context,\n        shape = context.shape,\n        labelTarget = context.labelTarget,\n        labelTargetIndex = context.labelTargetIndex;\n\n    // restore labelTarget\n    if (labelTarget) {\n      collectionAdd(labelTarget.labels, shape, labelTargetIndex);\n\n      shape.labelTarget = labelTarget;\n    }\n  });\n\n}\n\ninherits(LabelSupport, CommandInterceptor);\n\nLabelSupport.$inject = [\n  'injector',\n  'eventBus',\n  'modeling'\n];\n\n\n/**\n * Return a filtered list of elements that do not\n * contain attached elements with hosts being part\n * of the selection.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeLabels(elements) {\n\n  return filter(elements, function(element) {\n\n    // filter out labels that are move together\n    // with their label targets\n    return elements.indexOf(element.labelTarget) === -1;\n  });\n}\n","import LabelSupport from './LabelSupport';\n\nexport default {\n  __init__: [ 'labelSupport'],\n  labelSupport: [ 'type', LabelSupport ]\n};\n","/** */\nexport const translate = text => {\n    return text;\n};","import {\n    some\n} from 'min-dash';\n\n/**\n * uuid\n */\nexport const uuid = () => {\n    var s = [];\n    var hexDigits = \"0123456789abcdef\";\n    for (var i = 0; i < 36; i++) {\n      s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);\n    }\n    s[14] = \"4\"; // bits 12-15 of the time_hi_and_version field to 0010\n    s[19] = hexDigits.substr((s[19] & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01\n    s[8] = s[13] = s[18] = s[23] = \"-\";\n  \n    var uuid = s.join(\"\");\n    return uuid;\n}\n\nexport const is = (obj,type) =>{\n    if(obj.type == type){\n        return true;\n    }\n    else{\n        return false;\n    }\n}\n\nexport function isAny(element, types) {\n    return some(types, function(t) {\n        return is(element, t);\n    });\n}","export var DEFAULT_LABEL_SIZE = {\n    width: 90,\n    height: 20\n};","/**\n * diagram-js ElementFactory \n */\nimport { translate} from '@util/translate.js';\nimport { uuid} from '@util/util.js';\nimport {\n    assign\n} from 'min-dash';\nimport inherits from 'inherits';\nimport BaseElementFactory from 'diagram-js/lib/core/ElementFactory';\n\nimport {\n    DEFAULT_LABEL_SIZE\n} from '../component/label';\n\n\nexport default function ElementFactory() {//\n    BaseElementFactory.call(this);\n    this._translate = translate;\n}\n\ninherits(ElementFactory, BaseElementFactory);\n\nElementFactory.$inject = [\n];\n\nElementFactory.prototype.baseCreate = BaseElementFactory.prototype.create;\n\n\n\nElementFactory.prototype.create = function(elementType, attrs) {\n    if (elementType === 'label') {\n      return this.baseCreate(elementType, assign({ type: 'label' }, DEFAULT_LABEL_SIZE, attrs));\n    }\n    return this.createFlowElement(elementType, attrs);\n};\n\nElementFactory.prototype.createFlowElement = function(elementType, attrs) {\n    if(attrs == null || attrs == undefined || attrs == '' ){\n        return this.baseCreate(elementType, attrs);\n    }\n\n    //console.log(attrs,'attrs');\n\n    attrs.businessObject = attrs.businessObject || {\n        id:uuid()\n    };\n    \n\n    if (elementType === 'connection') {\n        attrs.type = 'myline';\n    }\n\n    var businessObject = attrs.businessObject;\n    businessObject.type = attrs.type;\n\n    var size = this._getDefaultSize(businessObject.type);\n\n    attrs = assign({\n        businessObject: businessObject,\n        id: businessObject.id\n    }, size, attrs);\n\n    return this.baseCreate(elementType, attrs);\n};\n\n\nElementFactory.prototype._getDefaultSize = function(type) {\n    var size = { width: 100, height: 80 };\n    switch(type){\n        case 'startEvent':\n        case 'endEvent':\n            size = { width: 36, height: 36 };\n            break;\n        case 'gatewayAnd':\n        case 'gatewayXor':\n        case 'gatewayInclusive':\n            size =  { width: 50, height: 50 };\n            break;\n        case 'subprocess':\n        case 'userTask':\n        case 'scriptTask':\n            size = { width: 100, height: 80 };\n            break;\n    }\n    return size;\n};\n\n\n\n\n","import { forEach } from 'min-dash';\n\n/**\n * A handler that align elements in a certain way.\n *\n */\nexport default function AlignElements(modeling, canvas) {\n  this._modeling = modeling;\n  this._canvas = canvas;\n}\n\nAlignElements.$inject = [ 'modeling', 'canvas' ];\n\n\nAlignElements.prototype.preExecute = function(context) {\n  var modeling = this._modeling;\n\n  var elements = context.elements,\n      alignment = context.alignment;\n\n\n  forEach(elements, function(element) {\n    var delta = {\n      x: 0,\n      y: 0\n    };\n\n    if (alignment.left) {\n      delta.x = alignment.left - element.x;\n\n    } else if (alignment.right) {\n      delta.x = (alignment.right - element.width) - element.x;\n\n    } else if (alignment.center) {\n      delta.x = (alignment.center - Math.round(element.width / 2)) - element.x;\n\n    } else if (alignment.top) {\n      delta.y = alignment.top - element.y;\n\n    } else if (alignment.bottom) {\n      delta.y = (alignment.bottom - element.height) - element.y;\n\n    } else if (alignment.middle) {\n      delta.y = (alignment.middle - Math.round(element.height / 2)) - element.y;\n    }\n\n    modeling.moveElements([ element ], delta, element.parent);\n  });\n};\n\nAlignElements.prototype.postExecute = function(context) {\n\n};\n","import { some } from 'min-dash';\n\n\n/**\n * A handler that implements reversible appending of shapes\n * to a source shape.\n *\n * @param {canvas} Canvas\n * @param {elementFactory} ElementFactory\n * @param {modeling} Modeling\n */\nexport default function AppendShapeHandler(modeling) {\n  this._modeling = modeling;\n}\n\nAppendShapeHandler.$inject = [ 'modeling' ];\n\n\n// api //////////////////////\n\n\n/**\n * Creates a new shape\n *\n * @param {Object} context\n * @param {ElementDescriptor} context.shape the new shape\n * @param {ElementDescriptor} context.source the source object\n * @param {ElementDescriptor} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nAppendShapeHandler.prototype.preExecute = function(context) {\n\n  var source = context.source;\n\n  if (!source) {\n    throw new Error('source required');\n  }\n\n  var target = context.target || source.parent,\n      shape = context.shape,\n      hints = context.hints || {};\n\n  shape = context.shape =\n    this._modeling.createShape(\n      shape,\n      context.position,\n      target, { attach: hints.attach });\n\n  context.shape = shape;\n};\n\nAppendShapeHandler.prototype.postExecute = function(context) {\n  var hints = context.hints || {};\n\n  if (!existsConnection(context.source, context.shape)) {\n\n    // create connection\n    if (hints.connectionTarget === context.source) {\n      this._modeling.connect(context.shape, context.source, context.connection);\n    } else {\n      this._modeling.connect(context.source, context.shape, context.connection);\n    }\n  }\n};\n\n\nfunction existsConnection(source, target) {\n  return some(source.outgoing, function(c) {\n    return c.target === target;\n  });\n}","export default function CreateConnectionHandler(canvas, layouter) {\n  this._canvas = canvas;\n  this._layouter = layouter;\n}\n\nCreateConnectionHandler.$inject = [ 'canvas', 'layouter' ];\n\n\n// api //////////////////////\n\n\n/**\n * Appends a shape to a target shape\n *\n * @param {Object} context\n * @param {djs.element.Base} context.source the source object\n * @param {djs.element.Base} context.target the parent object\n * @param {Point} context.position position of the new element\n */\nCreateConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      source = context.source,\n      target = context.target,\n      parent = context.parent,\n      parentIndex = context.parentIndex,\n      hints = context.hints;\n\n  if (!source || !target) {\n    throw new Error('source and target required');\n  }\n\n  if (!parent) {\n    throw new Error('parent required');\n  }\n\n  connection.source = source;\n  connection.target = target;\n\n  if (!connection.waypoints) {\n    connection.waypoints = this._layouter.layoutConnection(connection, hints);\n  }\n\n  // add connection\n  this._canvas.addConnection(connection, parent, parentIndex);\n\n  return connection;\n};\n\nCreateConnectionHandler.prototype.revert = function(context) {\n  var connection = context.connection;\n\n  this._canvas.removeConnection(connection);\n\n  connection.source = null;\n  connection.target = null;\n\n  return connection;\n};","import {\r\n  assign,\r\n  forEach,\r\n  isNumber,\r\n  map,\r\n  pick,\r\n  values\r\n} from 'min-dash';\r\n\r\nimport {\r\n  getBBox,\r\n  getParents\r\n} from '../../../util/Elements';\r\n\r\nvar round = Math.round;\r\n\r\nexport default function CreateElementsHandler(modeling) {\r\n  this._modeling = modeling;\r\n}\r\n\r\nCreateElementsHandler.$inject = [\r\n  'modeling'\r\n];\r\n\r\nCreateElementsHandler.prototype.preExecute = function(context) {\r\n  var elements = context.elements,\r\n      parent = context.parent,\r\n      parentIndex = context.parentIndex,\r\n      position = context.position,\r\n      hints = context.hints;\r\n\r\n  var modeling = this._modeling;\r\n\r\n  // make sure each element has x and y\r\n  forEach(elements, function(element) {\r\n    if (!isNumber(element.x)) {\r\n      element.x = 0;\r\n    }\r\n\r\n    if (!isNumber(element.y)) {\r\n      element.y = 0;\r\n    }\r\n  });\r\n\r\n  var bbox = getBBox(elements);\r\n\r\n  // center elements around position\r\n  forEach(elements, function(element) {\r\n    if (isConnection(element)) {\r\n      element.waypoints = map(element.waypoints, function(waypoint) {\r\n        return {\r\n          x: round(waypoint.x - bbox.x - bbox.width / 2 + position.x),\r\n          y: round(waypoint.y - bbox.y - bbox.height / 2 + position.y)\r\n        };\r\n      });\r\n    }\r\n\r\n    assign(element, {\r\n      x: round(element.x - bbox.x - bbox.width / 2 + position.x),\r\n      y: round(element.y - bbox.y - bbox.height / 2 + position.y)\r\n    });\r\n  });\r\n\r\n  var parents = getParents(elements);\r\n\r\n  var cache = {};\r\n\r\n  forEach(elements, function(element) {\r\n    if (isConnection(element)) {\r\n      cache[ element.id ] = isNumber(parentIndex) ?\r\n        modeling.createConnection(\r\n          cache[ element.source.id ],\r\n          cache[ element.target.id ],\r\n          parentIndex,\r\n          element,\r\n          element.parent || parent,\r\n          hints\r\n        ) :\r\n        modeling.createConnection(\r\n          cache[ element.source.id ],\r\n          cache[ element.target.id ],\r\n          element,\r\n          element.parent || parent,\r\n          hints\r\n        );\r\n\r\n      return;\r\n    }\r\n\r\n    var createShapeHints = assign({}, hints);\r\n\r\n    if (parents.indexOf(element) === -1) {\r\n      createShapeHints.autoResize = false;\r\n    }\r\n\r\n    cache[ element.id ] = isNumber(parentIndex) ?\r\n      modeling.createShape(\r\n        element,\r\n        pick(element, [ 'x', 'y', 'width', 'height' ]),\r\n        element.parent || parent,\r\n        parentIndex,\r\n        createShapeHints\r\n      ) :\r\n      modeling.createShape(\r\n        element,\r\n        pick(element, [ 'x', 'y', 'width', 'height' ]),\r\n        element.parent || parent,\r\n        createShapeHints\r\n      );\r\n  });\r\n\r\n  context.elements = values(cache);\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}","import { assign } from 'min-dash';\n\nvar round = Math.round;\n\n\n/**\n * A handler that implements reversible addition of shapes.\n *\n * @param {canvas} Canvas\n */\nexport default function CreateShapeHandler(canvas) {\n  this._canvas = canvas;\n}\n\nCreateShapeHandler.$inject = [ 'canvas' ];\n\n\n// api //////////////////////\n\n\n/**\n * Appends a shape to a target shape\n *\n * @param {Object} context\n * @param {djs.model.Base} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nCreateShapeHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      positionOrBounds = context.position,\n      parent = context.parent,\n      parentIndex = context.parentIndex;\n\n  if (!parent) {\n    throw new Error('parent required');\n  }\n\n  if (!positionOrBounds) {\n    throw new Error('position required');\n  }\n\n  // (1) add at event center position _or_ at given bounds\n  if (positionOrBounds.width !== undefined) {\n    assign(shape, positionOrBounds);\n  } else {\n    assign(shape, {\n      x: positionOrBounds.x - round(shape.width / 2),\n      y: positionOrBounds.y - round(shape.height / 2)\n    });\n  }\n\n  // (2) add to canvas\n  this._canvas.addShape(shape, parent, parentIndex);\n\n  return shape;\n};\n\n\n/**\n * Undo append by removing the shape\n */\nCreateShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape;\n\n  // (3) remove form canvas\n  this._canvas.removeShape(shape);\n\n  return shape;\n};","import inherits from 'inherits';\n\nimport CreateShapeHandler from './CreateShapeHandler';\n\n\n/**\n * A handler that attaches a label to a given target shape.\n *\n * @param {Canvas} canvas\n */\nexport default function CreateLabelHandler(canvas) {\n  CreateShapeHandler.call(this, canvas);\n}\n\ninherits(CreateLabelHandler, CreateShapeHandler);\n\nCreateLabelHandler.$inject = [ 'canvas' ];\n\n\n// api //////////////////////\n\n\nvar originalExecute = CreateShapeHandler.prototype.execute;\n\n/**\n * Appends a label to a target shape.\n *\n * @method CreateLabelHandler#execute\n *\n * @param {Object} context\n * @param {ElementDescriptor} context.target the element the label is attached to\n * @param {ElementDescriptor} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nCreateLabelHandler.prototype.execute = function(context) {\n\n  var label = context.shape;\n\n  ensureValidDimensions(label);\n\n  label.labelTarget = context.labelTarget;\n\n  return originalExecute.call(this, context);\n};\n\nvar originalRevert = CreateShapeHandler.prototype.revert;\n\n/**\n * Undo append by removing the shape\n */\nCreateLabelHandler.prototype.revert = function(context) {\n  context.shape.labelTarget = null;\n\n  return originalRevert.call(this, context);\n};\n\n\n// helpers //////////////////////\n\nfunction ensureValidDimensions(label) {\n\n  // make sure a label has valid { width, height } dimensions\n  [ 'width', 'height' ].forEach(function(prop) {\n    if (typeof label[prop] === 'undefined') {\n      label[prop] = 0;\n    }\n  });\n}","import {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../../util/Collections';\n\n\n/**\n * A handler that implements reversible deletion of Connections.\n */\nexport default function DeleteConnectionHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nDeleteConnectionHandler.$inject = [\n  'canvas',\n  'modeling'\n];\n\n\nDeleteConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      parent = connection.parent;\n\n  context.parent = parent;\n\n  // remember containment\n  context.parentIndex = collectionIdx(parent.children, connection);\n\n  context.source = connection.source;\n  context.target = connection.target;\n\n  this._canvas.removeConnection(connection);\n\n  connection.source = null;\n  connection.target = null;\n\n  return connection;\n};\n\n/**\n * Command revert implementation.\n */\nDeleteConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      parent = context.parent,\n      parentIndex = context.parentIndex;\n\n  connection.source = context.source;\n  connection.target = context.target;\n\n  // restore containment\n  collectionAdd(parent.children, connection, parentIndex);\n\n  this._canvas.addConnection(connection, parent);\n\n  return connection;\n};\n","import { forEach } from 'min-dash';\n\n\nexport default function DeleteElementsHandler(modeling, elementRegistry) {\n  this._modeling = modeling;\n  this._elementRegistry = elementRegistry;\n}\n\nDeleteElementsHandler.$inject = [\n  'modeling',\n  'elementRegistry'\n];\n\n\nDeleteElementsHandler.prototype.postExecute = function(context) {\n\n  var modeling = this._modeling,\n      elementRegistry = this._elementRegistry,\n      elements = context.elements;\n\n  forEach(elements, function(element) {\n\n    // element may have been removed with previous\n    // remove operations already (e.g. in case of nesting)\n    if (!elementRegistry.get(element.id)) {\n      return;\n    }\n\n    if (element.waypoints) {\n      modeling.removeConnection(element);\n    } else {\n      modeling.removeShape(element);\n    }\n  });\n};","import {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../../util/Collections';\n\nimport { saveClear } from '../../../util/Removal';\n\n\n/**\n * A handler that implements reversible deletion of shapes.\n *\n */\nexport default function DeleteShapeHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nDeleteShapeHandler.$inject = [ 'canvas', 'modeling' ];\n\n\n/**\n * - Remove connections\n * - Remove all direct children\n */\nDeleteShapeHandler.prototype.preExecute = function(context) {\n\n  var modeling = this._modeling;\n\n  var shape = context.shape;\n\n  // remove connections\n  saveClear(shape.incoming, function(connection) {\n\n    // To make sure that the connection isn't removed twice\n    // For example if a container is removed\n    modeling.removeConnection(connection, { nested: true });\n  });\n\n  saveClear(shape.outgoing, function(connection) {\n    modeling.removeConnection(connection, { nested: true });\n  });\n\n  // remove child shapes and connections\n  saveClear(shape.children, function(child) {\n    if (isConnection(child)) {\n      modeling.removeConnection(child, { nested: true });\n    } else {\n      modeling.removeShape(child, { nested: true });\n    }\n  });\n};\n\n/**\n * Remove shape and remember the parent\n */\nDeleteShapeHandler.prototype.execute = function(context) {\n  var canvas = this._canvas;\n\n  var shape = context.shape,\n      oldParent = shape.parent;\n\n  context.oldParent = oldParent;\n\n  // remove containment\n  context.oldParentIndex = collectionIdx(oldParent.children, shape);\n\n  // remove shape\n  canvas.removeShape(shape);\n\n  return shape;\n};\n\n\n/**\n * Command revert implementation\n */\nDeleteShapeHandler.prototype.revert = function(context) {\n\n  var canvas = this._canvas;\n\n  var shape = context.shape,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex;\n\n  // restore containment\n  collectionAdd(oldParent.children, shape, oldParentIndex);\n\n  canvas.addShape(shape, oldParent);\n\n  return shape;\n};\n\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import {\n  forEach,\n  sortBy\n} from 'min-dash';\n\n\n/**\n * A handler that distributes elements evenly.\n */\nexport default function DistributeElements(modeling) {\n  this._modeling = modeling;\n}\n\nDistributeElements.$inject = [ 'modeling' ];\n\nvar OFF_AXIS = {\n  x: 'y',\n  y: 'x'\n};\n\nDistributeElements.prototype.preExecute = function(context) {\n  var modeling = this._modeling;\n\n  var groups = context.groups,\n      axis = context.axis,\n      dimension = context.dimension;\n\n  function updateRange(group, element) {\n    group.range.min = Math.min(element[axis], group.range.min);\n    group.range.max = Math.max(element[axis] + element[dimension], group.range.max);\n  }\n\n  function center(element) {\n    return element[axis] + element[dimension] / 2;\n  }\n\n  function lastIdx(arr) {\n    return arr.length - 1;\n  }\n\n  function rangeDiff(range) {\n    return range.max - range.min;\n  }\n\n  function centerElement(refCenter, element) {\n    var delta = { y: 0 };\n\n    delta[axis] = refCenter - center(element);\n\n    if (delta[axis]) {\n\n      delta[OFF_AXIS[axis]] = 0;\n\n      modeling.moveElements([ element ], delta, element.parent);\n    }\n  }\n\n  var firstGroup = groups[0],\n      lastGroupIdx = lastIdx(groups),\n      lastGroup = groups[ lastGroupIdx ];\n\n  var margin,\n      spaceInBetween,\n      groupsSize = 0; // the size of each range\n\n  forEach(groups, function(group, idx) {\n    var sortedElements,\n        refElem,\n        refCenter;\n\n    if (group.elements.length < 2) {\n      if (idx && idx !== groups.length - 1) {\n        updateRange(group, group.elements[0]);\n\n        groupsSize += rangeDiff(group.range);\n      }\n      return;\n    }\n\n    sortedElements = sortBy(group.elements, axis);\n\n    refElem = sortedElements[0];\n\n    if (idx === lastGroupIdx) {\n      refElem = sortedElements[lastIdx(sortedElements)];\n    }\n\n    refCenter = center(refElem);\n\n    // wanna update the ranges after the shapes have been centered\n    group.range = null;\n\n    forEach(sortedElements, function(element) {\n\n      centerElement(refCenter, element);\n\n      if (group.range === null) {\n        group.range = {\n          min: element[axis],\n          max: element[axis] + element[dimension]\n        };\n\n        return;\n      }\n\n      // update group's range after centering the range elements\n      updateRange(group, element);\n    });\n\n    if (idx && idx !== groups.length - 1) {\n      groupsSize += rangeDiff(group.range);\n    }\n  });\n\n  spaceInBetween = Math.abs(lastGroup.range.min - firstGroup.range.max);\n\n  margin = Math.round((spaceInBetween - groupsSize) / (groups.length - 1));\n\n  if (margin < groups.length - 1) {\n    return;\n  }\n\n  forEach(groups, function(group, groupIdx) {\n    var delta = {},\n        prevGroup;\n\n    if (group === firstGroup || group === lastGroup) {\n      return;\n    }\n\n    prevGroup = groups[groupIdx - 1];\n\n    group.range.max = 0;\n\n    forEach(group.elements, function(element, idx) {\n      delta[OFF_AXIS[axis]] = 0;\n      delta[axis] = (prevGroup.range.max - element[axis]) + margin;\n\n      if (group.range.min !== element[axis]) {\n        delta[axis] += element[axis] - group.range.min;\n      }\n\n      if (delta[axis]) {\n        modeling.moveElements([ element ], delta, element.parent);\n      }\n\n      group.range.max = Math.max(element[axis] + element[dimension], idx ? group.range.max : 0);\n    });\n  });\n};\n\nDistributeElements.prototype.postExecute = function(context) {\n\n};\n","import { assign } from 'min-dash';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function LayoutConnectionHandler(layouter, canvas) {\n  this._layouter = layouter;\n  this._canvas = canvas;\n}\n\nLayoutConnectionHandler.$inject = [ 'layouter', 'canvas' ];\n\nLayoutConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection;\n\n  var oldWaypoints = connection.waypoints;\n\n  assign(context, {\n    oldWaypoints: oldWaypoints\n  });\n\n  connection.waypoints = this._layouter.layoutConnection(connection, context.hints);\n\n  return connection;\n};\n\nLayoutConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection;\n\n  connection.waypoints = context.oldWaypoints;\n\n  return connection;\n};\n","import { forEach } from 'min-dash';\n\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\n\n/**\n * A handler that implements reversible moving of connections.\n *\n * The handler differs from the layout connection handler in a sense\n * that it preserves the connection layout.\n */\nexport default function MoveConnectionHandler() { }\n\n\nMoveConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      delta = context.delta;\n\n  var newParent = context.newParent || connection.parent,\n      newParentIndex = context.newParentIndex,\n      oldParent = connection.parent;\n\n  // save old parent in context\n  context.oldParent = oldParent;\n  context.oldParentIndex = collectionRemove(oldParent.children, connection);\n\n  // add to new parent at position\n  collectionAdd(newParent.children, connection, newParentIndex);\n\n  // update parent\n  connection.parent = newParent;\n\n  // update waypoint positions\n  forEach(connection.waypoints, function(p) {\n    p.x += delta.x;\n    p.y += delta.y;\n\n    if (p.original) {\n      p.original.x += delta.x;\n      p.original.y += delta.y;\n    }\n  });\n\n  return connection;\n};\n\nMoveConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      newParent = connection.parent,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex,\n      delta = context.delta;\n\n  // remove from newParent\n  collectionRemove(newParent.children, connection);\n\n  // restore previous location in old parent\n  collectionAdd(oldParent.children, connection, oldParentIndex);\n\n  // restore parent\n  connection.parent = oldParent;\n\n  // revert to old waypoint positions\n  forEach(connection.waypoints, function(p) {\n    p.x -= delta.x;\n    p.y -= delta.y;\n\n    if (p.original) {\n      p.original.x -= delta.x;\n      p.original.y -= delta.y;\n    }\n  });\n\n  return connection;\n};","import {\n  asTRBL,\n  getOrientation,\n  roundPoint\n} from '../layout/LayoutUtil';\n\nimport {\n  center,\n  delta\n} from './PositionUtil';\n\n\n/**\n * Calculates the absolute point relative to the new element's position\n *\n * @param {point} point [absolute]\n * @param {bounds} oldBounds\n * @param {bounds} newBounds\n *\n * @return {point} point [absolute]\n */\nexport function getNewAttachPoint(point, oldBounds, newBounds) {\n  var oldCenter = center(oldBounds),\n      newCenter = center(newBounds),\n      oldDelta = delta(point, oldCenter);\n\n  var newDelta = {\n    x: oldDelta.x * (newBounds.width / oldBounds.width),\n    y: oldDelta.y * (newBounds.height / oldBounds.height)\n  };\n\n  return roundPoint({\n    x: newCenter.x + newDelta.x,\n    y: newCenter.y + newDelta.y\n  });\n}\n\n\n/**\n * Calculates the shape's delta relative to a new position\n * of a certain element's bounds\n *\n * @param {djs.model.Shape} point [absolute]\n * @param {bounds} oldBounds\n * @param {bounds} newBounds\n *\n * @return {delta} delta\n */\nexport function getNewAttachShapeDelta(shape, oldBounds, newBounds) {\n  var shapeCenter = center(shape),\n      oldCenter = center(oldBounds),\n      newCenter = center(newBounds),\n      shapeDelta = delta(shape, shapeCenter),\n      oldCenterDelta = delta(shapeCenter, oldCenter),\n      stickyPositionDelta = getStickyPositionDelta(shapeCenter, oldBounds, newBounds);\n\n  if (stickyPositionDelta) {\n    return stickyPositionDelta;\n  }\n\n  var newCenterDelta = {\n    x: oldCenterDelta.x * (newBounds.width / oldBounds.width),\n    y: oldCenterDelta.y * (newBounds.height / oldBounds.height)\n  };\n\n  var newShapeCenter = {\n    x: newCenter.x + newCenterDelta.x,\n    y: newCenter.y + newCenterDelta.y\n  };\n\n  return roundPoint({\n    x: newShapeCenter.x + shapeDelta.x - shape.x,\n    y: newShapeCenter.y + shapeDelta.y - shape.y\n  });\n}\n\nfunction getStickyPositionDelta(oldShapeCenter, oldBounds, newBounds) {\n  var oldTRBL = asTRBL(oldBounds),\n      newTRBL = asTRBL(newBounds);\n\n  if (isMoved(oldTRBL, newTRBL)) {\n    return null;\n  }\n\n  var oldOrientation = getOrientation(oldBounds, oldShapeCenter),\n      stickyPositionDelta,\n      newShapeCenter,\n      newOrientation;\n\n  if (oldOrientation === 'top') {\n    stickyPositionDelta = {\n      x: 0,\n      y: newTRBL.bottom - oldTRBL.bottom\n    };\n  } else if (oldOrientation === 'bottom') {\n    stickyPositionDelta = {\n      x: 0,\n      y: newTRBL.top - oldTRBL.top\n    };\n  } else if (oldOrientation === 'right') {\n    stickyPositionDelta = {\n      x: newTRBL.left - oldTRBL.left,\n      y: 0\n    };\n  } else if (oldOrientation === 'left') {\n    stickyPositionDelta = {\n      x: newTRBL.right - oldTRBL.right,\n      y: 0\n    };\n  } else {\n\n    // fallback to proportional movement for corner-placed attachments\n    return null;\n  }\n\n  newShapeCenter = {\n    x: oldShapeCenter.x + stickyPositionDelta.x,\n    y: oldShapeCenter.y + stickyPositionDelta.y\n  };\n\n  newOrientation = getOrientation(newBounds, newShapeCenter);\n\n  if (newOrientation !== oldOrientation) {\n\n    // fallback to proportional movement if orientation would otherwise change\n    return null;\n  }\n\n  return stickyPositionDelta;\n}\n\nfunction isMoved(oldTRBL, newTRBL) {\n  return isHorizontallyMoved(oldTRBL, newTRBL) || isVerticallyMoved(oldTRBL, newTRBL);\n}\n\nfunction isHorizontallyMoved(oldTRBL, newTRBL) {\n  return oldTRBL.right !== newTRBL.right && oldTRBL.left !== newTRBL.left;\n}\n\nfunction isVerticallyMoved(oldTRBL, newTRBL) {\n  return oldTRBL.top !== newTRBL.top && oldTRBL.bottom !== newTRBL.bottom;\n}\n","import {\n  getNewAttachPoint\n} from '../../../../util/AttachUtil';\n\nimport {\n  getOrientation\n} from '../../../../layout/LayoutUtil';\n\nimport {\n  filter,\n  map\n} from 'min-dash';\n\n\nexport function getResizedSourceAnchor(connection, shape, oldBounds) {\n\n  var waypoints = safeGetWaypoints(connection),\n      waypointsInsideNewBounds = getWaypointsInsideBounds(waypoints, shape),\n      oldAnchor = waypoints[0];\n\n  // new anchor is the last waypoint enclosed be resized source\n  if (waypointsInsideNewBounds.length) {\n    return waypointsInsideNewBounds[ waypointsInsideNewBounds.length - 1 ];\n  }\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, shape);\n}\n\n\nexport function getResizedTargetAnchor(connection, shape, oldBounds) {\n\n  var waypoints = safeGetWaypoints(connection),\n      waypointsInsideNewBounds = getWaypointsInsideBounds(waypoints, shape),\n      oldAnchor = waypoints[waypoints.length - 1];\n\n  // new anchor is the first waypoint enclosed be resized target\n  if (waypointsInsideNewBounds.length) {\n    return waypointsInsideNewBounds[ 0 ];\n  }\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, shape);\n}\n\n\nexport function getMovedSourceAnchor(connection, source, moveDelta) {\n\n  var waypoints = safeGetWaypoints(connection),\n      oldBounds = subtract(source, moveDelta),\n      oldAnchor = waypoints[ 0 ];\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, source);\n}\n\n\nexport function getMovedTargetAnchor(connection, target, moveDelta) {\n\n  var waypoints = safeGetWaypoints(connection),\n      oldBounds = subtract(target, moveDelta),\n      oldAnchor = waypoints[ waypoints.length - 1 ];\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, target);\n}\n\n\n// helpers //////////////////////\n\nfunction subtract(bounds, delta) {\n  return {\n    x: bounds.x - delta.x,\n    y: bounds.y - delta.y,\n    width: bounds.width,\n    height: bounds.height\n  };\n}\n\n\n/**\n * Return waypoints of given connection; throw if non exists (should not happen!!).\n *\n * @param {Connection} connection\n *\n * @return {Array<Point>}\n */\nfunction safeGetWaypoints(connection) {\n\n  var waypoints = connection.waypoints;\n\n  if (!waypoints.length) {\n    throw new Error('connection#' + connection.id + ': no waypoints');\n  }\n\n  return waypoints;\n}\n\nfunction getWaypointsInsideBounds(waypoints, bounds) {\n  var originalWaypoints = map(waypoints, getOriginal);\n\n  return filter(originalWaypoints, function(waypoint) {\n    return isInsideBounds(waypoint, bounds);\n  });\n}\n\n/**\n * Checks if point is inside bounds, incl. edges.\n *\n * @param {Point} point\n * @param {Bounds} bounds\n */\nfunction isInsideBounds(point, bounds) {\n  return getOrientation(bounds, point, 1) === 'intersect';\n}\n\nfunction getOriginal(point) {\n  return point.original || point;\n}\n","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getClosure\n} from '../../../../util/Elements';\n\n\nexport default function MoveClosure() {\n\n  this.allShapes = {};\n  this.allConnections = {};\n\n  this.enclosedElements = {};\n  this.enclosedConnections = {};\n\n  this.topLevel = {};\n}\n\n\nMoveClosure.prototype.add = function(element, isTopLevel) {\n  return this.addAll([ element ], isTopLevel);\n};\n\n\nMoveClosure.prototype.addAll = function(elements, isTopLevel) {\n\n  var newClosure = getClosure(elements, !!isTopLevel, this);\n\n  assign(this, newClosure);\n\n  return this;\n};","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './AnchorsHelper';\n\nimport MoveClosure from './MoveClosure';\n\n\n/**\n * A helper that is able to carry out serialized move\n * operations on multiple elements.\n *\n * @param {Modeling} modeling\n */\nexport default function MoveHelper(modeling) {\n  this._modeling = modeling;\n}\n\n/**\n * Move the specified elements and all children by the given delta.\n *\n * This moves all enclosed connections, too and layouts all affected\n * external connections.\n *\n * @param  {Array<djs.model.Base>} elements\n * @param  {Point} delta\n * @param  {djs.model.Base} newParent applied to the first level of shapes\n *\n * @return {Array<djs.model.Base>} list of touched elements\n */\nMoveHelper.prototype.moveRecursive = function(elements, delta, newParent) {\n  if (!elements) {\n    return [];\n  } else {\n    return this.moveClosure(this.getClosure(elements), delta, newParent);\n  }\n};\n\n/**\n * Move the given closure of elmements.\n *\n * @param {Object} closure\n * @param {Point} delta\n * @param {djs.model.Base} [newParent]\n * @param {djs.model.Base} [newHost]\n */\nMoveHelper.prototype.moveClosure = function(closure, delta, newParent, newHost, primaryShape) {\n  var modeling = this._modeling;\n\n  var allShapes = closure.allShapes,\n      allConnections = closure.allConnections,\n      enclosedConnections = closure.enclosedConnections,\n      topLevel = closure.topLevel,\n      keepParent = false;\n\n  if (primaryShape && primaryShape.parent === newParent) {\n    keepParent = true;\n  }\n\n  // move all shapes\n  forEach(allShapes, function(shape) {\n\n    // move the element according to the given delta\n    modeling.moveShape(shape, delta, topLevel[shape.id] && !keepParent && newParent, {\n      recurse: false,\n      layout: false\n    });\n  });\n\n  // move all child connections / layout external connections\n  forEach(allConnections, function(c) {\n\n    var sourceMoved = !!allShapes[c.source.id],\n        targetMoved = !!allShapes[c.target.id];\n\n    if (enclosedConnections[c.id] && sourceMoved && targetMoved) {\n      modeling.moveConnection(c, delta, topLevel[c.id] && !keepParent && newParent);\n    } else {\n      modeling.layoutConnection(c, {\n        connectionStart: sourceMoved && getMovedSourceAnchor(c, c.source, delta),\n        connectionEnd: targetMoved && getMovedTargetAnchor(c, c.target, delta)\n      });\n    }\n  });\n};\n\n/**\n * Returns the closure for the selected elements\n *\n * @param  {Array<djs.model.Base>} elements\n * @return {MoveClosure} closure\n */\nMoveHelper.prototype.getClosure = function(elements) {\n  return new MoveClosure().addAll(elements, true);\n};","import MoveHelper from './helper/MoveHelper';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function MoveElementsHandler(modeling) {\n  this._helper = new MoveHelper(modeling);\n}\n\nMoveElementsHandler.$inject = [ 'modeling' ];\n\nMoveElementsHandler.prototype.preExecute = function(context) {\n  context.closure = this._helper.getClosure(context.shapes);\n};\n\nMoveElementsHandler.prototype.postExecute = function(context) {\n\n  var hints = context.hints,\n      primaryShape;\n\n  if (hints && hints.primaryShape) {\n    primaryShape = hints.primaryShape;\n    hints.oldParent = primaryShape.parent;\n  }\n\n  this._helper.moveClosure(\n    context.closure,\n    context.delta,\n    context.newParent,\n    context.newHost,\n    primaryShape\n  );\n};","import {\n  assign,\n  forEach,\n  pick\n} from 'min-dash';\n\nimport MoveHelper from './helper/MoveHelper';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function MoveShapeHandler(modeling) {\n  this._modeling = modeling;\n\n  this._helper = new MoveHelper(modeling);\n}\n\nMoveShapeHandler.$inject = [ 'modeling' ];\n\n\nMoveShapeHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      delta = context.delta,\n      newParent = context.newParent || shape.parent,\n      newParentIndex = context.newParentIndex,\n      oldParent = shape.parent;\n\n  context.oldBounds = pick(shape, [ 'x', 'y', 'width', 'height']);\n\n  // save old parent in context\n  context.oldParent = oldParent;\n  context.oldParentIndex = collectionRemove(oldParent.children, shape);\n\n  // add to new parent at position\n  collectionAdd(newParent.children, shape, newParentIndex);\n\n  // update shape parent + position\n  assign(shape, {\n    parent: newParent,\n    x: shape.x + delta.x,\n    y: shape.y + delta.y\n  });\n\n  return shape;\n};\n\nMoveShapeHandler.prototype.postExecute = function(context) {\n\n  var shape = context.shape,\n      delta = context.delta,\n      hints = context.hints;\n\n  var modeling = this._modeling;\n\n  if (hints.layout !== false) {\n\n    forEach(shape.incoming, function(c) {\n      modeling.layoutConnection(c, {\n        connectionEnd: getMovedTargetAnchor(c, shape, delta)\n      });\n    });\n\n    forEach(shape.outgoing, function(c) {\n      modeling.layoutConnection(c, {\n        connectionStart: getMovedSourceAnchor(c, shape, delta)\n      });\n    });\n  }\n\n  if (hints.recurse !== false) {\n    this.moveChildren(context);\n  }\n};\n\nMoveShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex,\n      delta = context.delta;\n\n  // restore previous location in old parent\n  collectionAdd(oldParent.children, shape, oldParentIndex);\n\n  // revert to old position and parent\n  assign(shape, {\n    parent: oldParent,\n    x: shape.x - delta.x,\n    y: shape.y - delta.y\n  });\n\n  return shape;\n};\n\nMoveShapeHandler.prototype.moveChildren = function(context) {\n\n  var delta = context.delta,\n      shape = context.shape;\n\n  this._helper.moveRecursive(shape.children, delta, null);\n};\n\nMoveShapeHandler.prototype.getNewParent = function(context) {\n  return context.newParent || context.shape.parent;\n};\n","import { isArray } from 'min-dash';\n\n\n/**\n * Reconnect connection handler\n */\nexport default function ReconnectConnectionHandler(modeling) {\n  this._modeling = modeling;\n}\n\nReconnectConnectionHandler.$inject = [ 'modeling' ];\n\nReconnectConnectionHandler.prototype.execute = function(context) {\n  var newSource = context.newSource,\n      newTarget = context.newTarget,\n      connection = context.connection,\n      dockingOrPoints = context.dockingOrPoints;\n\n  if (!newSource && !newTarget) {\n    throw new Error('newSource or newTarget required');\n  }\n\n  if (isArray(dockingOrPoints)) {\n    context.oldWaypoints = connection.waypoints;\n    connection.waypoints = dockingOrPoints;\n  }\n\n  if (newSource) {\n    context.oldSource = connection.source;\n    connection.source = newSource;\n  }\n\n  if (newTarget) {\n    context.oldTarget = connection.target;\n    connection.target = newTarget;\n  }\n\n  return connection;\n};\n\nReconnectConnectionHandler.prototype.postExecute = function(context) {\n  var connection = context.connection,\n      newSource = context.newSource,\n      newTarget = context.newTarget,\n      dockingOrPoints = context.dockingOrPoints,\n      hints = context.hints || {};\n\n  var layoutConnectionHints = {};\n\n  if (hints.connectionStart) {\n    layoutConnectionHints.connectionStart = hints.connectionStart;\n  }\n\n  if (hints.connectionEnd) {\n    layoutConnectionHints.connectionEnd = hints.connectionEnd;\n  }\n\n  if (hints.layoutConnection === false) {\n    return;\n  }\n\n  if (newSource && (!newTarget || hints.docking === 'source')) {\n    layoutConnectionHints.connectionStart = layoutConnectionHints.connectionStart\n      || getDocking(isArray(dockingOrPoints) ? dockingOrPoints[ 0 ] : dockingOrPoints);\n  }\n\n  if (newTarget && (!newSource || hints.docking === 'target')) {\n    layoutConnectionHints.connectionEnd = layoutConnectionHints.connectionEnd\n      || getDocking(isArray(dockingOrPoints) ? dockingOrPoints[ dockingOrPoints.length - 1 ] : dockingOrPoints);\n  }\n\n  if (hints.newWaypoints) {\n    layoutConnectionHints.waypoints = hints.newWaypoints;\n  }\n\n  this._modeling.layoutConnection(connection, layoutConnectionHints);\n};\n\nReconnectConnectionHandler.prototype.revert = function(context) {\n  var oldSource = context.oldSource,\n      oldTarget = context.oldTarget,\n      oldWaypoints = context.oldWaypoints,\n      connection = context.connection;\n\n  if (oldSource) {\n    connection.source = oldSource;\n  }\n\n  if (oldTarget) {\n    connection.target = oldTarget;\n  }\n\n  if (oldWaypoints) {\n    connection.waypoints = oldWaypoints;\n  }\n\n  return connection;\n};\n\n\n\n// helpers //////////\n\nfunction getDocking(point) {\n  return point.original || point;\n}","import { forEach } from 'min-dash';\n\nimport {\n  getResizedSourceAnchor,\n  getResizedTargetAnchor\n} from './helper/AnchorsHelper';\n\n/**\n * Replace shape by adding new shape and removing old shape. Incoming and outgoing connections will\n * be kept if possible.\n *\n * @class\n * @constructor\n *\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function ReplaceShapeHandler(modeling, rules) {\n  this._modeling = modeling;\n  this._rules = rules;\n}\n\nReplaceShapeHandler.$inject = [ 'modeling', 'rules' ];\n\n\n/**\n * Add new shape.\n *\n * @param {Object} context\n * @param {djs.model.Shape} context.oldShape\n * @param {Object} context.newData\n * @param {string} context.newData.type\n * @param {number} context.newData.x\n * @param {number} context.newData.y\n * @param {Object} [hints]\n */\nReplaceShapeHandler.prototype.preExecute = function(context) {\n  var self = this,\n      modeling = this._modeling,\n      rules = this._rules;\n\n  var oldShape = context.oldShape,\n      newData = context.newData,\n      hints = context.hints || {},\n      newShape;\n\n  function canReconnect(source, target, connection) {\n    return rules.allowed('connection.reconnect', {\n      connection: connection,\n      source: source,\n      target: target\n    });\n  }\n\n  // (1) add new shape at given position\n  var position = {\n    x: newData.x,\n    y: newData.y\n  };\n\n  var oldBounds = {\n    x: oldShape.x,\n    y: oldShape.y,\n    width: oldShape.width,\n    height: oldShape.height\n  };\n\n  newShape = context.newShape =\n    context.newShape ||\n    self.createShape(newData, position, oldShape.parent, hints);\n\n  // (2) update host\n  if (oldShape.host) {\n    modeling.updateAttachment(newShape, oldShape.host);\n  }\n\n  // (3) adopt all children from old shape\n  var children;\n\n  if (hints.moveChildren !== false) {\n    children = oldShape.children.slice();\n\n    modeling.moveElements(children, { x: 0, y: 0 }, newShape, hints);\n  }\n\n  // (4) reconnect connections to new shape if possible\n  var incoming = oldShape.incoming.slice(),\n      outgoing = oldShape.outgoing.slice();\n\n  forEach(incoming, function(connection) {\n    var source = connection.source,\n        allowed = canReconnect(source, newShape, connection);\n\n    if (allowed) {\n      self.reconnectEnd(\n        connection, newShape,\n        getResizedTargetAnchor(connection, newShape, oldBounds),\n        hints\n      );\n    }\n  });\n\n  forEach(outgoing, function(connection) {\n    var target = connection.target,\n        allowed = canReconnect(newShape, target, connection);\n\n    if (allowed) {\n      self.reconnectStart(\n        connection, newShape,\n        getResizedSourceAnchor(connection, newShape, oldBounds),\n        hints\n      );\n    }\n  });\n};\n\n\n/**\n * Remove old shape.\n */\nReplaceShapeHandler.prototype.postExecute = function(context) {\n  var oldShape = context.oldShape;\n\n  this._modeling.removeShape(oldShape);\n};\n\n\nReplaceShapeHandler.prototype.execute = function(context) {};\n\n\nReplaceShapeHandler.prototype.revert = function(context) {};\n\n\nReplaceShapeHandler.prototype.createShape = function(shape, position, target, hints) {\n  return this._modeling.createShape(shape, position, target, hints);\n};\n\n\nReplaceShapeHandler.prototype.reconnectStart = function(connection, newSource, dockingPoint, hints) {\n  this._modeling.reconnectStart(connection, newSource, dockingPoint, hints);\n};\n\n\nReplaceShapeHandler.prototype.reconnectEnd = function(connection, newTarget, dockingPoint, hints) {\n  this._modeling.reconnectEnd(connection, newTarget, dockingPoint, hints);\n};\n","import {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  getResizedSourceAnchor,\n  getResizedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * A handler that implements reversible resizing of shapes.\n *\n * @param {Modeling} modeling\n */\nexport default function ResizeShapeHandler(modeling) {\n  this._modeling = modeling;\n}\n\nResizeShapeHandler.$inject = [ 'modeling' ];\n\n/**\n * {\n *   shape: {....}\n *   newBounds: {\n *     width:  20,\n *     height: 40,\n *     x:       5,\n *     y:      10\n *   }\n *\n * }\n */\nResizeShapeHandler.prototype.execute = function(context) {\n  var shape = context.shape,\n      newBounds = context.newBounds,\n      minBounds = context.minBounds;\n\n  if (newBounds.x === undefined || newBounds.y === undefined ||\n      newBounds.width === undefined || newBounds.height === undefined) {\n    throw new Error('newBounds must have {x, y, width, height} properties');\n  }\n\n  if (minBounds && (newBounds.width < minBounds.width\n    || newBounds.height < minBounds.height)) {\n    throw new Error('width and height cannot be less than minimum height and width');\n  } else if (!minBounds\n    && newBounds.width < 10 || newBounds.height < 10) {\n    throw new Error('width and height cannot be less than 10px');\n  }\n\n  // save old bbox in context\n  context.oldBounds = {\n    width:  shape.width,\n    height: shape.height,\n    x:      shape.x,\n    y:      shape.y\n  };\n\n  // update shape\n  assign(shape, {\n    width:  newBounds.width,\n    height: newBounds.height,\n    x:      newBounds.x,\n    y:      newBounds.y\n  });\n\n  return shape;\n};\n\nResizeShapeHandler.prototype.postExecute = function(context) {\n  var modeling = this._modeling;\n\n  var shape = context.shape,\n      oldBounds = context.oldBounds,\n      hints = context.hints || {};\n\n  if (hints.layout === false) {\n    return;\n  }\n\n  forEach(shape.incoming, function(c) {\n    modeling.layoutConnection(c, {\n      connectionEnd: getResizedTargetAnchor(c, shape, oldBounds)\n    });\n  });\n\n  forEach(shape.outgoing, function(c) {\n    modeling.layoutConnection(c, {\n      connectionStart: getResizedSourceAnchor(c, shape, oldBounds)\n    });\n  });\n\n};\n\nResizeShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldBounds = context.oldBounds;\n\n  // restore previous bbox\n  assign(shape, {\n    width:  oldBounds.width,\n    height: oldBounds.height,\n    x:      oldBounds.x,\n    y:      oldBounds.y\n  });\n\n  return shape;\n};\n","import { forEach } from 'min-dash';\n\n/**\n * Return direction given axis and delta.\n *\n * @param {string} axis\n * @param {number} delta\n *\n * @return {string}\n */\nexport function getDirection(axis, delta) {\n\n  if (axis === 'x') {\n    if (delta > 0) {\n      return 'e';\n    }\n\n    if (delta < 0) {\n      return 'w';\n    }\n  }\n\n  if (axis === 'y') {\n    if (delta > 0) {\n      return 's';\n    }\n\n    if (delta < 0) {\n      return 'n';\n    }\n  }\n\n  return null;\n}\n\n/**\n * Returns connections whose waypoints are to be updated. Waypoints are to be updated if start\n * or end is to be moved or resized.\n *\n * @param {Array<djs.model.Shape} movingShapes\n * @param {Array<djs.model.Shape} resizingShapes\n *\n * @returns {Array<djs.model.Connection>}\n */\nexport function getWaypointsUpdatingConnections(movingShapes, resizingShapes) {\n  var waypointsUpdatingConnections = [];\n\n  forEach(movingShapes.concat(resizingShapes), function(shape) {\n    var incoming = shape.incoming,\n        outgoing = shape.outgoing;\n\n    forEach(incoming.concat(outgoing), function(connection) {\n      var source = connection.source,\n          target = connection.target;\n\n      if (includes(movingShapes, source) ||\n        includes(movingShapes, target) ||\n        includes(resizingShapes, source) ||\n        includes(resizingShapes, target)) {\n\n        if (!includes(waypointsUpdatingConnections, connection)) {\n          waypointsUpdatingConnections.push(connection);\n        }\n      }\n    });\n  });\n\n  return waypointsUpdatingConnections;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\n/**\n * Resize bounds.\n *\n * @param {Object} bounds\n * @param {number} bounds.x\n * @param {number} bounds.y\n * @param {number} bounds.width\n * @param {number} bounds.height\n * @param {string} direction\n * @param {Object} delta\n * @param {number} delta.x\n * @param {number} delta.y\n *\n * @return {Object}\n */\nexport function resizeBounds(bounds, direction, delta) {\n  var x = bounds.x,\n      y = bounds.y,\n      width = bounds.width,\n      height = bounds.height,\n      dx = delta.x,\n      dy = delta.y;\n\n  switch (direction) {\n  case 'n':\n    return {\n      x: x,\n      y: y + dy,\n      width: width,\n      height: height - dy\n    };\n  case 's':\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height + dy\n    };\n  case 'w':\n    return {\n      x: x + dx,\n      y: y,\n      width: width - dx,\n      height: height\n    };\n  case 'e':\n    return {\n      x: x,\n      y: y,\n      width: width + dx,\n      height: height\n    };\n  default:\n    throw new Error('unknown direction: ' + direction);\n  }\n}","import {\n  assign,\n  forEach,\n  map\n} from 'min-dash';\n\nimport {\n  getWaypointsUpdatingConnections,\n  resizeBounds\n} from '../../space-tool/SpaceUtil';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor,\n  getResizedSourceAnchor,\n  getResizedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * Add or remove space by moving and resizing shapes and updating connection waypoints.\n */\nexport default function SpaceToolHandler(modeling) {\n  this._modeling = modeling;\n}\n\nSpaceToolHandler.$inject = [ 'modeling' ];\n\nSpaceToolHandler.prototype.preExecute = function(context) {\n  var delta = context.delta,\n      direction = context.direction,\n      movingShapes = context.movingShapes,\n      resizingShapes = context.resizingShapes,\n      start = context.start,\n      oldBounds = {};\n\n  // (1) move shapes\n  this.moveShapes(movingShapes, delta);\n\n  // (2a) save old bounds of resized shapes\n  forEach(resizingShapes, function(shape) {\n    oldBounds[shape.id] = getBounds(shape);\n  });\n\n  // (2b) resize shapes\n  this.resizeShapes(resizingShapes, delta, direction);\n\n  // (3) update connection waypoints\n  this.updateConnectionWaypoints(\n    getWaypointsUpdatingConnections(movingShapes, resizingShapes),\n    delta,\n    direction,\n    start,\n    movingShapes,\n    resizingShapes,\n    oldBounds\n  );\n};\n\nSpaceToolHandler.prototype.execute = function() {};\nSpaceToolHandler.prototype.revert = function() {};\n\nSpaceToolHandler.prototype.moveShapes = function(shapes, delta) {\n  var self = this;\n\n  forEach(shapes, function(element) {\n    self._modeling.moveShape(element, delta, null, {\n      autoResize: false,\n      layout: false,\n      recurse: false\n    });\n  });\n};\n\nSpaceToolHandler.prototype.resizeShapes = function(shapes, delta, direction) {\n  var self = this;\n\n  forEach(shapes, function(shape) {\n    var newBounds = resizeBounds(shape, direction, delta);\n\n    self._modeling.resizeShape(shape, newBounds, null, {\n      attachSupport: false,\n      autoResize: false,\n      layout: false\n    });\n  });\n};\n\n/**\n * Update connections waypoints according to the rules:\n *   1. Both source and target are moved/resized => move waypoints by the delta\n *   2. Only one of source and target is moved/resized => re-layout connection with moved start/end\n */\nSpaceToolHandler.prototype.updateConnectionWaypoints = function(\n    connections,\n    delta,\n    direction,\n    start,\n    movingShapes,\n    resizingShapes,\n    oldBounds\n) {\n  var self = this,\n      affectedShapes = movingShapes.concat(resizingShapes);\n\n  forEach(connections, function(connection) {\n    var source = connection.source,\n        target = connection.target,\n        waypoints = copyWaypoints(connection),\n        axis = getAxisFromDirection(direction),\n        layoutHints = {\n          labelBehavior: false\n        };\n\n    if (includes(affectedShapes, source) && includes(affectedShapes, target)) {\n\n      // move waypoints\n      waypoints = map(waypoints, function(waypoint) {\n        if (shouldMoveWaypoint(waypoint, start, direction)) {\n\n          // move waypoint\n          waypoint[ axis ] = waypoint[ axis ] + delta[ axis ];\n        }\n\n        if (waypoint.original && shouldMoveWaypoint(waypoint.original, start, direction)) {\n\n          // move waypoint original\n          waypoint.original[ axis ] = waypoint.original[ axis ] + delta[ axis ];\n        }\n\n        return waypoint;\n      });\n\n      self._modeling.updateWaypoints(connection, waypoints, {\n        labelBehavior: false\n      });\n    } else if (includes(affectedShapes, source) || includes(affectedShapes, target)) {\n\n      // re-layout connection with moved start/end\n      if (includes(movingShapes, source)) {\n        layoutHints.connectionStart = getMovedSourceAnchor(connection, source, delta);\n      } else if (includes(movingShapes, target)) {\n        layoutHints.connectionEnd = getMovedTargetAnchor(connection, target, delta);\n      } else if (includes(resizingShapes, source)) {\n        layoutHints.connectionStart = getResizedSourceAnchor(\n          connection, source, oldBounds[source.id]\n        );\n      } else if (includes(resizingShapes, target)) {\n        layoutHints.connectionEnd = getResizedTargetAnchor(\n          connection, target, oldBounds[target.id]\n        );\n      }\n\n      self._modeling.layoutConnection(connection, layoutHints);\n    }\n  });\n};\n\n\n// helpers //////////\n\nfunction copyWaypoint(waypoint) {\n  return assign({}, waypoint);\n}\n\nfunction copyWaypoints(connection) {\n  return map(connection.waypoints, function(waypoint) {\n\n    waypoint = copyWaypoint(waypoint);\n\n    if (waypoint.original) {\n      waypoint.original = copyWaypoint(waypoint.original);\n    }\n\n    return waypoint;\n  });\n}\n\nfunction getAxisFromDirection(direction) {\n  switch (direction) {\n  case 'n':\n    return 'y';\n  case 'w':\n    return 'x';\n  case 's':\n    return 'y';\n  case 'e':\n    return 'x';\n  }\n}\n\nfunction shouldMoveWaypoint(waypoint, start, direction) {\n  var relevantAxis = getAxisFromDirection(direction);\n\n  if (/e|s/.test(direction)) {\n    return waypoint[ relevantAxis ] > start;\n  } else if (/n|w/.test(direction)) {\n    return waypoint[ relevantAxis ] < start;\n  }\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\nfunction getBounds(shape) {\n  return {\n    x: shape.x,\n    y: shape.y,\n    height: shape.height,\n    width: shape.width\n  };\n}\n","import {\n  assign,\n  forEach\n} from 'min-dash';\n\n/**\n * A handler that toggles the collapsed state of an element\n * and the visibility of all its children.\n *\n * @param {Modeling} modeling\n */\nexport default function ToggleShapeCollapseHandler(modeling) {\n  this._modeling = modeling;\n}\n\nToggleShapeCollapseHandler.$inject = [ 'modeling' ];\n\n\nToggleShapeCollapseHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      children = shape.children;\n\n  // recursively remember previous visibility of children\n  context.oldChildrenVisibility = getElementsVisibilityRecursive(children);\n\n  // toggle state\n  shape.collapsed = !shape.collapsed;\n\n  // recursively hide/show children\n  var result = setHiddenRecursive(children, shape.collapsed);\n\n  return [shape].concat(result);\n};\n\n\nToggleShapeCollapseHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldChildrenVisibility = context.oldChildrenVisibility;\n\n  var children = shape.children;\n\n  // recursively set old visability of children\n  var result = restoreVisibilityRecursive(children, oldChildrenVisibility);\n\n  // retoggle state\n  shape.collapsed = !shape.collapsed;\n\n  return [shape].concat(result);\n};\n\n\n// helpers //////////////////////\n\n/**\n * Return a map { elementId -> hiddenState}.\n *\n * @param {Array<djs.model.Shape>} elements\n *\n * @return {Object}\n */\nfunction getElementsVisibilityRecursive(elements) {\n\n  var result = {};\n\n  forEach(elements, function(element) {\n    result[element.id] = element.hidden;\n\n    if (element.children) {\n      result = assign({}, result, getElementsVisibilityRecursive(element.children));\n    }\n  });\n\n  return result;\n}\n\n\nfunction setHiddenRecursive(elements, newHidden) {\n  var result = [];\n  forEach(elements, function(element) {\n    element.hidden = newHidden;\n\n    result = result.concat(element);\n\n    if (element.children) {\n      result = result.concat(setHiddenRecursive(element.children, element.collapsed || newHidden));\n    }\n  });\n\n  return result;\n}\n\nfunction restoreVisibilityRecursive(elements, lastState) {\n  var result = [];\n  forEach(elements, function(element) {\n    element.hidden = lastState[element.id];\n\n    result = result.concat(element);\n\n    if (element.children) {\n      result = result.concat(restoreVisibilityRecursive(element.children, lastState));\n    }\n  });\n\n  return result;\n}\n","import {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\n/**\n * A handler that implements reversible attaching/detaching of shapes.\n */\nexport default function UpdateAttachmentHandler(modeling) {\n  this._modeling = modeling;\n}\n\nUpdateAttachmentHandler.$inject = [ 'modeling' ];\n\n\nUpdateAttachmentHandler.prototype.execute = function(context) {\n  var shape = context.shape,\n      newHost = context.newHost,\n      oldHost = shape.host;\n\n  // (0) detach from old host\n  context.oldHost = oldHost;\n  context.attacherIdx = removeAttacher(oldHost, shape);\n\n  // (1) attach to new host\n  addAttacher(newHost, shape);\n\n  // (2) update host\n  shape.host = newHost;\n\n  return shape;\n};\n\nUpdateAttachmentHandler.prototype.revert = function(context) {\n  var shape = context.shape,\n      newHost = context.newHost,\n      oldHost = context.oldHost,\n      attacherIdx = context.attacherIdx;\n\n  // (2) update host\n  shape.host = oldHost;\n\n  // (1) attach to new host\n  removeAttacher(newHost, shape);\n\n  // (0) detach from old host\n  addAttacher(oldHost, shape, attacherIdx);\n\n  return shape;\n};\n\n\nfunction removeAttacher(host, attacher) {\n\n  // remove attacher from host\n  return collectionRemove(host && host.attachers, attacher);\n}\n\nfunction addAttacher(host, attacher, idx) {\n\n  if (!host) {\n    return;\n  }\n\n  var attachers = host.attachers;\n\n  if (!attachers) {\n    host.attachers = attachers = [];\n  }\n\n  collectionAdd(attachers, attacher, idx);\n}\n","export default function UpdateWaypointsHandler() { }\n\nUpdateWaypointsHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      newWaypoints = context.newWaypoints;\n\n  context.oldWaypoints = connection.waypoints;\n\n  connection.waypoints = newWaypoints;\n\n  return connection;\n};\n\nUpdateWaypointsHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      oldWaypoints = context.oldWaypoints;\n\n  connection.waypoints = oldWaypoints;\n\n  return connection;\n};","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport {\n  Base\n} from '../../model';\n\nimport AlignElementsHandler from './cmd/AlignElementsHandler';\nimport AppendShapeHandler from './cmd/AppendShapeHandler';\nimport CreateConnectionHandler from './cmd/CreateConnectionHandler';\nimport CreateElementsHandler from './cmd/CreateElementsHandler';\nimport CreateLabelHandler from './cmd/CreateLabelHandler';\nimport CreateShapeHandler from './cmd/CreateShapeHandler';\nimport DeleteConnectionHandler from './cmd/DeleteConnectionHandler';\nimport DeleteElementsHandler from './cmd/DeleteElementsHandler';\nimport DeleteShapeHandler from './cmd/DeleteShapeHandler';\nimport DistributeElementsHandler from './cmd/DistributeElementsHandler';\nimport LayoutConnectionHandler from './cmd/LayoutConnectionHandler';\nimport MoveConnectionHandler from './cmd/MoveConnectionHandler';\nimport MoveElementsHandler from './cmd/MoveElementsHandler';\nimport MoveShapeHandler from './cmd/MoveShapeHandler';\nimport ReconnectConnectionHandler from './cmd/ReconnectConnectionHandler';\nimport ReplaceShapeHandler from './cmd/ReplaceShapeHandler';\nimport ResizeShapeHandler from './cmd/ResizeShapeHandler';\nimport SpaceToolHandler from './cmd/SpaceToolHandler';\nimport ToggleShapeCollapseHandler from './cmd/ToggleShapeCollapseHandler';\nimport UpdateAttachmentHandler from './cmd/UpdateAttachmentHandler';\nimport UpdateWaypointsHandler from './cmd/UpdateWaypointsHandler';\n\n\n/**\n * The basic modeling entry point.\n *\n * @param {EventBus} eventBus\n * @param {ElementFactory} elementFactory\n * @param {CommandStack} commandStack\n */\nexport default function Modeling(eventBus, elementFactory, commandStack) {\n  this._eventBus = eventBus;\n  this._elementFactory = elementFactory;\n  this._commandStack = commandStack;\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n\n    // register modeling handlers\n    self.registerHandlers(commandStack);\n  });\n}\n\nModeling.$inject = [ 'eventBus', 'elementFactory', 'commandStack' ];\n\n\nModeling.prototype.getHandlers = function() {\n  return {\n    'shape.append': AppendShapeHandler,\n    'shape.create': CreateShapeHandler,\n    'shape.delete': DeleteShapeHandler,\n    'shape.move': MoveShapeHandler,\n    'shape.resize': ResizeShapeHandler,\n    'shape.replace': ReplaceShapeHandler,\n    'shape.toggleCollapse': ToggleShapeCollapseHandler,\n\n    'spaceTool': SpaceToolHandler,\n\n    'label.create': CreateLabelHandler,\n\n    'connection.create': CreateConnectionHandler,\n    'connection.delete': DeleteConnectionHandler,\n    'connection.move': MoveConnectionHandler,\n    'connection.layout': LayoutConnectionHandler,\n\n    'connection.updateWaypoints': UpdateWaypointsHandler,\n\n    'connection.reconnect': ReconnectConnectionHandler,\n\n    'elements.create': CreateElementsHandler,\n    'elements.move': MoveElementsHandler,\n    'elements.delete': DeleteElementsHandler,\n\n    'elements.distribute': DistributeElementsHandler,\n    'elements.align': AlignElementsHandler,\n\n    'element.updateAttachment': UpdateAttachmentHandler\n  };\n};\n\n/**\n * Register handlers with the command stack\n *\n * @param {CommandStack} commandStack\n */\nModeling.prototype.registerHandlers = function(commandStack) {\n  forEach(this.getHandlers(), function(handler, id) {\n    commandStack.registerHandler(id, handler);\n  });\n};\n\n\n// modeling helpers //////////////////////\n\nModeling.prototype.moveShape = function(shape, delta, newParent, newParentIndex, hints) {\n\n  if (typeof newParentIndex === 'object') {\n    hints = newParentIndex;\n    newParentIndex = null;\n  }\n\n  var context = {\n    shape: shape,\n    delta:  delta,\n    newParent: newParent,\n    newParentIndex: newParentIndex,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.move', context);\n};\n\n\n/**\n * Update the attachment of the given shape.\n *\n * @param {djs.mode.Base} shape\n * @param {djs.model.Base} [newHost]\n */\nModeling.prototype.updateAttachment = function(shape, newHost) {\n  var context = {\n    shape: shape,\n    newHost: newHost\n  };\n\n  this._commandStack.execute('element.updateAttachment', context);\n};\n\n\n/**\n * Move a number of shapes to a new target, either setting it as\n * the new parent or attaching it.\n *\n * @param {Array<djs.mode.Base>} shapes\n * @param {Point} delta\n * @param {djs.model.Base} [target]\n * @param {Object} [hints]\n * @param {boolean} [hints.attach=false]\n */\nModeling.prototype.moveElements = function(shapes, delta, target, hints) {\n\n  hints = hints || {};\n\n  var attach = hints.attach;\n\n  var newParent = target,\n      newHost;\n\n  if (attach === true) {\n    newHost = target;\n    newParent = target.parent;\n  } else\n\n  if (attach === false) {\n    newHost = null;\n  }\n\n  var context = {\n    shapes: shapes,\n    delta: delta,\n    newParent: newParent,\n    newHost: newHost,\n    hints: hints\n  };\n\n  this._commandStack.execute('elements.move', context);\n};\n\n\nModeling.prototype.moveConnection = function(connection, delta, newParent, newParentIndex, hints) {\n\n  if (typeof newParentIndex === 'object') {\n    hints = newParentIndex;\n    newParentIndex = undefined;\n  }\n\n  var context = {\n    connection: connection,\n    delta: delta,\n    newParent: newParent,\n    newParentIndex: newParentIndex,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.move', context);\n};\n\n\nModeling.prototype.layoutConnection = function(connection, hints) {\n  var context = {\n    connection: connection,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.layout', context);\n};\n\n\n/**\n * Create connection.\n *\n * @param {djs.model.Base} source\n * @param {djs.model.Base} target\n * @param {number} [parentIndex]\n * @param {Object|djs.model.Connection} connection\n * @param {djs.model.Base} parent\n * @param {Object} hints\n *\n * @return {djs.model.Connection} the created connection.\n */\nModeling.prototype.createConnection = function(source, target, parentIndex, connection, parent, hints) {\n\n  if (typeof parentIndex === 'object') {\n    hints = parent;\n    parent = connection;\n    connection = parentIndex;\n    parentIndex = undefined;\n  }\n\n  connection = this._create('connection', connection);\n\n  var context = {\n    source: source,\n    target: target,\n    parent: parent,\n    parentIndex: parentIndex,\n    connection: connection,\n    hints: hints\n  };\n\n  this._commandStack.execute('connection.create', context);\n\n  return context.connection;\n};\n\n\n/**\n * Create a shape at the specified position.\n *\n * @param {djs.model.Shape|Object} shape\n * @param {Point} position\n * @param {djs.model.Shape|djs.model.Root} target\n * @param {number} [parentIndex] position in parents children list\n * @param {Object} [hints]\n * @param {boolean} [hints.attach] whether to attach to target or become a child\n *\n * @return {djs.model.Shape} the created shape\n */\nModeling.prototype.createShape = function(shape, position, target, parentIndex, hints) {\n\n  if (typeof parentIndex !== 'number') {\n    hints = parentIndex;\n    parentIndex = undefined;\n  }\n\n  hints = hints || {};\n\n  var attach = hints.attach,\n      parent,\n      host;\n\n  shape = this._create('shape', shape);\n\n  if (attach) {\n    parent = target.parent;\n    host = target;\n  } else {\n    parent = target;\n  }\n\n  var context = {\n    position: position,\n    shape: shape,\n    parent: parent,\n    parentIndex: parentIndex,\n    host: host,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.create', context);\n\n  return context.shape;\n};\n\n\nModeling.prototype.createElements = function(elements, position, parent, parentIndex, hints) {\n  if (!isArray(elements)) {\n    elements = [ elements ];\n  }\n\n  if (typeof parentIndex !== 'number') {\n    hints = parentIndex;\n    parentIndex = undefined;\n  }\n\n  hints = hints || {};\n\n  var context = {\n    position: position,\n    elements: elements,\n    parent: parent,\n    parentIndex: parentIndex,\n    hints: hints\n  };\n\n  this._commandStack.execute('elements.create', context);\n\n  return context.elements;\n};\n\n\nModeling.prototype.createLabel = function(labelTarget, position, label, parent) {\n\n  label = this._create('label', label);\n\n  var context = {\n    labelTarget: labelTarget,\n    position: position,\n    parent: parent || labelTarget.parent,\n    shape: label\n  };\n\n  this._commandStack.execute('label.create', context);\n\n  return context.shape;\n};\n\n\n/**\n * Append shape to given source, drawing a connection\n * between source and the newly created shape.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape|Object} shape\n * @param {Point} position\n * @param {djs.model.Shape} target\n * @param {Object} [hints]\n * @param {boolean} [hints.attach]\n * @param {djs.model.Connection|Object} [hints.connection]\n * @param {djs.model.Base} [hints.connectionParent]\n *\n * @return {djs.model.Shape} the newly created shape\n */\nModeling.prototype.appendShape = function(source, shape, position, target, hints) {\n\n  hints = hints || {};\n\n  shape = this._create('shape', shape);\n\n  var context = {\n    source: source,\n    position: position,\n    target: target,\n    shape: shape,\n    connection: hints.connection,\n    connectionParent: hints.connectionParent,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.append', context);\n\n  return context.shape;\n};\n\n\nModeling.prototype.removeElements = function(elements) {\n  var context = {\n    elements: elements\n  };\n\n  this._commandStack.execute('elements.delete', context);\n};\n\n\nModeling.prototype.distributeElements = function(groups, axis, dimension) {\n  var context = {\n    groups: groups,\n    axis: axis,\n    dimension: dimension\n  };\n\n  this._commandStack.execute('elements.distribute', context);\n};\n\n\nModeling.prototype.removeShape = function(shape, hints) {\n  var context = {\n    shape: shape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.delete', context);\n};\n\n\nModeling.prototype.removeConnection = function(connection, hints) {\n  var context = {\n    connection: connection,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.delete', context);\n};\n\nModeling.prototype.replaceShape = function(oldShape, newShape, hints) {\n  var context = {\n    oldShape: oldShape,\n    newData: newShape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.replace', context);\n\n  return context.newShape;\n};\n\nModeling.prototype.alignElements = function(elements, alignment) {\n  var context = {\n    elements: elements,\n    alignment: alignment\n  };\n\n  this._commandStack.execute('elements.align', context);\n};\n\nModeling.prototype.resizeShape = function(shape, newBounds, minBounds, hints) {\n  var context = {\n    shape: shape,\n    newBounds: newBounds,\n    minBounds: minBounds,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.resize', context);\n};\n\nModeling.prototype.createSpace = function(movingShapes, resizingShapes, delta, direction, start) {\n  var context = {\n    delta: delta,\n    direction: direction,\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes,\n    start: start\n  };\n\n  this._commandStack.execute('spaceTool', context);\n};\n\nModeling.prototype.updateWaypoints = function(connection, newWaypoints, hints) {\n  var context = {\n    connection: connection,\n    newWaypoints: newWaypoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.updateWaypoints', context);\n};\n\nModeling.prototype.reconnect = function(connection, source, target, dockingOrPoints, hints) {\n  var context = {\n    connection: connection,\n    newSource: source,\n    newTarget: target,\n    dockingOrPoints: dockingOrPoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.reconnect', context);\n};\n\nModeling.prototype.reconnectStart = function(connection, newSource, dockingOrPoints, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  this.reconnect(connection, newSource, connection.target, dockingOrPoints, assign(hints, {\n    docking: 'source'\n  }));\n};\n\nModeling.prototype.reconnectEnd = function(connection, newTarget, dockingOrPoints, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  this.reconnect(connection, connection.source, newTarget, dockingOrPoints, assign(hints, {\n    docking: 'target'\n  }));\n};\n\nModeling.prototype.connect = function(source, target, attrs, hints) {\n  return this.createConnection(source, target, attrs || {}, source.parent, hints);\n};\n\nModeling.prototype._create = function(type, attrs) {\n  if (attrs instanceof Base) {\n    return attrs;\n  } else {\n    return this._elementFactory.create(type, attrs);\n  }\n};\n\nModeling.prototype.toggleCollapse = function(shape, hints) {\n  var context = {\n    shape: shape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.toggleCollapse', context);\n};\n","import {\n    assign\n} from 'min-dash';\nimport { is } from '@util/util';\n\nexport function getLabel(element) {\n  var semantic = element.businessObject;\n    if(!semantic){\n      return undefined;\n    }\n    return semantic.name || '';\n}\nexport function setLabel(element, text) {\n  var semantic = element.businessObject;\n\n  semantic.name = text;\n  return element;\n}\n\n\n\n\n\nexport var DEFAULT_LABEL_SIZE = {\n    width: 90,\n    height: 20\n  };\n  \n  export var FLOW_LABEL_INDENT = 15;\n  \n  \n  /**\n   * Returns true if the given semantic has an external label\n   *\n   * @param {BpmnElement} semantic\n   * @return {boolean} true if has label\n   */\n  export function isLabelExternal(semantic) {\n    return is(semantic, 'startEvent') ||\n           is(semantic, 'endEvent') ||\n           is(semantic, 'gatewayAnd') ||\n           is(semantic, 'gatewayXor') ||\n           is(semantic, 'gatewayInclusive') || is(semantic, 'myline');\n  }\n  \n  /**\n   * Returns true if the given element has an external label\n   *\n   * @param {djs.model.shape} element\n   * @return {boolean} true if has label\n   */\n  export function hasExternalLabel(element) {\n    return isLabel(element.label);\n  }\n  \n  /**\n   * Get the position for sequence flow labels\n   *\n   * @param  {Array<Point>} waypoints\n   * @return {Point} the label position\n   */\n  export function getFlowLabelPosition(waypoints) {\n  \n    // get the waypoints mid\n    var mid = waypoints.length / 2 - 1;\n  \n    var first = waypoints[Math.floor(mid)];\n    var second = waypoints[Math.ceil(mid + 0.01)];\n  \n    // get position\n    var position = getWaypointsMid(waypoints);\n  \n    // calculate angle\n    var angle = Math.atan((second.y - first.y) / (second.x - first.x));\n  \n    var x = position.x,\n        y = position.y;\n  \n    if (Math.abs(angle) < Math.PI / 2) {\n      y -= FLOW_LABEL_INDENT;\n    } else {\n      x += FLOW_LABEL_INDENT;\n    }\n  \n    return { x: x, y: y };\n  }\n  \n  \n  /**\n   * Get the middle of a number of waypoints\n   *\n   * @param  {Array<Point>} waypoints\n   * @return {Point} the mid point\n   */\n  export function getWaypointsMid(waypoints) {\n  \n    var mid = waypoints.length / 2 - 1;\n  \n    var first = waypoints[Math.floor(mid)];\n    var second = waypoints[Math.ceil(mid + 0.01)];\n  \n    return {\n      x: first.x + (second.x - first.x) / 2,\n      y: first.y + (second.y - first.y) / 2\n    };\n  }\n  \n  \n  export function getExternalLabelMid(element) {\n  \n    if (element.waypoints) {\n      return getFlowLabelPosition(element.waypoints);\n    }else {\n      return {\n        x: element.x + element.width / 2,\n        y: element.y + element.height + DEFAULT_LABEL_SIZE.height / 2\n      };\n    }\n  }\n  \n  \n  /**\n   * Returns the bounds of an elements label, parsed from the elements DI or\n   * generated from its bounds.\n   *\n   * @param {BpmnElement} semantic\n   * @param {djs.model.Base} element\n   */\n  export function getExternalLabelBounds(semantic, element) {\n  \n    var mid,\n        size,\n        bounds,\n        di = semantic.di,\n        label = di.label;\n  \n    if (label && label.bounds) {\n      bounds = label.bounds;\n  \n      size = {\n        width: Math.max(DEFAULT_LABEL_SIZE.width, bounds.width),\n        height: bounds.height\n      };\n  \n      mid = {\n        x: bounds.x + bounds.width / 2,\n        y: bounds.y + bounds.height / 2\n      };\n    } else {\n  \n      mid = getExternalLabelMid(element);\n  \n      size = DEFAULT_LABEL_SIZE;\n    }\n  \n    return assign({\n      x: mid.x - size.width / 2,\n      y: mid.y - size.height / 2\n    }, size);\n  }\n  \n  export function isLabel(element) {\n    return element && !!element.labelTarget;\n  }\n  ","import {\n  setLabel,\n  getLabel,\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel\n} from './labelUtil';\n\nvar NULL_DIMENSIONS = {\n  width: 0,\n  height: 0\n};\n\n\n/**\n * A handler that updates the text of a BPMN element.\n */\nexport default function UpdateLabelHandler(modeling, textRenderer) {\n\n  /**\n   * Set the label and return the changed elements.\n   *\n   * Element parameter can be label itself or connection (i.e. sequence flow).\n   *\n   * @param {djs.model.Base} element\n   * @param {string} text\n   */\n  function setText(element, text) {\n\n    // external label if present\n    var label = element.label || element;\n\n    var labelTarget = element.labelTarget || element;\n\n    setLabel(label, text, labelTarget !== label);\n\n    return [ label, labelTarget ];\n  }\n\n  function preExecute(ctx) {\n    var element = ctx.element,\n        businessObject = element.businessObject,\n        newLabel = ctx.newLabel;\n\n    if (!isLabel(element)\n        && isLabelExternal(element)\n        && !hasExternalLabel(element)\n        && !isEmptyText(newLabel)) {\n\n      // create label\n      var paddingTop = 7;\n\n      var labelCenter = getExternalLabelMid(element);\n\n      labelCenter = {\n        x: labelCenter.x,\n        y: labelCenter.y + paddingTop\n      };\n\n      modeling.createLabel(element, labelCenter, {\n        id: businessObject.id + '_label',\n        businessObject: businessObject\n      });\n    }\n  }\n\n  function execute(ctx) {\n    ctx.oldLabel = getLabel(ctx.element);\n    return setText(ctx.element, ctx.newLabel);\n  }\n\n  function revert(ctx) {\n    return setText(ctx.element, ctx.oldLabel);\n  }\n\n  function postExecute(ctx) {\n    var element = ctx.element,\n        label = element.label || element,\n        newLabel = ctx.newLabel,\n        newBounds = ctx.newBounds,\n        hints = ctx.hints || {};\n\n    // ignore internal labels for elements except text annotations\n    if (!isLabel(label)) {\n      return;\n    }\n\n    if (isLabel(label) && isEmptyText(newLabel)) {\n\n      if (hints.removeShape !== false) {\n        modeling.removeShape(label, { unsetLabel: false });\n      }\n\n      return;\n    }\n\n    var text = getLabel(label);\n\n    // resize element based on label _or_ pre-defined bounds\n    if (typeof newBounds === 'undefined') {\n      newBounds = textRenderer.getExternalLabelBounds(label, text);\n    }\n\n    // setting newBounds to false or _null_ will\n    // disable the postExecute resize operation\n    if (newBounds) {\n      modeling.resizeShape(label, newBounds, NULL_DIMENSIONS);\n    }\n  }\n\n  // API\n\n  this.preExecute = preExecute;\n  this.execute = execute;\n  this.revert = revert;\n  this.postExecute = postExecute;\n}\n\nUpdateLabelHandler.$inject = [\n  'modeling',\n  'textRenderer'\n];\n\n// helpers ///////////////////////\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}","import inherits from 'inherits';\nimport BaseModeling from 'diagram-js/lib/features/modeling/Modeling';\nimport UpdateLabelHandler from '../labelEditing/updateLabelHandler';\n\nexport default function Modeling(\n    eventBus, elementFactory, commandStack) {\n  BaseModeling.call(this, eventBus, elementFactory, commandStack);\n}\n\ninherits(Modeling, BaseModeling);\n\nModeling.$inject = [\n  'eventBus',\n  'elementFactory',\n  'commandStack'\n];\n\n\nModeling.prototype.getHandlers = function() {\n  var handlers = BaseModeling.prototype.getHandlers.call(this);\n  handlers['element.updateLabel'] = UpdateLabelHandler;\n  return handlers;\n};\n\n\nModeling.prototype.updateLabel = function(element, newLabel, newBounds, hints) {\n  this._commandStack.execute('element.updateLabel', {\n    element: element,\n    newLabel: newLabel,\n    newBounds: newBounds,\n    hints: hints || {}\n  });\n};\n\n\n","\nimport inherits from 'inherits';\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\n/**\n * A handler responsible for updating the underlying BPMN 2.0 XML + DI\n * once changes on the diagram happen\n */\nexport default function BpmnUpdater(\n    eventBus, connectionDocking) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  // connection cropping //////////////////////\n\n  // crop connection ends during create/update\n  function cropConnection(e) {\n    var context = e.context,\n        hints = context.hints || {},\n        connection;\n\n    if (!context.cropped && hints.createElementsBehavior !== false) {\n      connection = context.connection;\n      connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n      context.cropped = true;\n    }\n  }\n\n  this.executed([\n    'connection.layout',\n    'connection.create'\n  ], cropConnection);\n}\n\ninherits(BpmnUpdater, CommandInterceptor);\n\n\nBpmnUpdater.$inject = [\n    'eventBus',\n    'connectionDocking'\n];","import {\n  getMid\n} from './LayoutUtil';\n\n\n/**\n * A base connection layouter implementation\n * that layouts the connection by directly connecting\n * mid(source) + mid(target).\n */\nexport default function BaseLayouter() {}\n\n\n/**\n * Return the new layouted waypoints for the given connection.\n *\n * The connection passed is still unchanged; you may figure out about\n * the new connection start / end via the layout hints provided.\n *\n * @param {djs.model.Connection} connection\n * @param {Object} [hints]\n * @param {Point} [hints.connectionStart]\n * @param {Point} [hints.connectionEnd]\n * @param {Point} [hints.source]\n * @param {Point} [hints.target]\n *\n * @return {Array<Point>} the layouted connection waypoints\n */\nBaseLayouter.prototype.layoutConnection = function(connection, hints) {\n\n  hints = hints || {};\n\n  return [\n    hints.connectionStart || getMid(hints.source || connection.source),\n    hints.connectionEnd || getMid(hints.target || connection.target)\n  ];\n};\n","import {\n  assign,\n  find,\n  isArray,\n  without\n} from 'min-dash';\n\nimport {\n  getOrientation,\n  getMid\n} from './LayoutUtil';\n\nimport {\n  pointInRect,\n  pointDistance,\n  pointsAligned,\n  pointsOnLine\n} from '../util/Geometry';\n\nvar MIN_SEGMENT_LENGTH = 20,\n    POINT_ORIENTATION_PADDING = 5;\n\nvar round = Math.round;\n\nvar INTERSECTION_THRESHOLD = 20,\n    ORIENTATION_THRESHOLD = {\n      'h:h': 20,\n      'v:v': 20,\n      'h:v': -10,\n      'v:h': -10\n    };\n\nfunction needsTurn(orientation, startDirection) {\n  return !{\n    t: /top/,\n    r: /right/,\n    b: /bottom/,\n    l: /left/,\n    h: /./,\n    v: /./\n  }[startDirection].test(orientation);\n}\n\nfunction canLayoutStraight(direction, targetOrientation) {\n  return {\n    t: /top/,\n    r: /right/,\n    b: /bottom/,\n    l: /left/,\n    h: /left|right/,\n    v: /top|bottom/\n  }[direction].test(targetOrientation);\n}\n\nfunction getSegmentBendpoints(a, b, directions) {\n  var orientation = getOrientation(b, a, POINT_ORIENTATION_PADDING);\n\n  var startDirection = directions.split(':')[0];\n\n  var xmid = round((b.x - a.x) / 2 + a.x),\n      ymid = round((b.y - a.y) / 2 + a.y);\n\n  var segmentEnd, segmentDirections;\n\n  var layoutStraight = canLayoutStraight(startDirection, orientation),\n      layoutHorizontal = /h|r|l/.test(startDirection),\n      layoutTurn = false;\n\n  var turnNextDirections = false;\n\n  if (layoutStraight) {\n    segmentEnd = layoutHorizontal ? { x: xmid, y: a.y } : { x: a.x, y: ymid };\n\n    segmentDirections = layoutHorizontal ? 'h:h' : 'v:v';\n  } else {\n    layoutTurn = needsTurn(orientation, startDirection);\n\n    segmentDirections = layoutHorizontal ? 'h:v' : 'v:h';\n\n    if (layoutTurn) {\n\n      if (layoutHorizontal) {\n        turnNextDirections = ymid === a.y;\n\n        segmentEnd = {\n          x: a.x + MIN_SEGMENT_LENGTH * (/l/.test(startDirection) ? -1 : 1),\n          y: turnNextDirections ? ymid + MIN_SEGMENT_LENGTH : ymid\n        };\n      } else {\n        turnNextDirections = xmid === a.x;\n\n        segmentEnd = {\n          x: turnNextDirections ? xmid + MIN_SEGMENT_LENGTH : xmid,\n          y: a.y + MIN_SEGMENT_LENGTH * (/t/.test(startDirection) ? -1 : 1)\n        };\n      }\n\n    } else {\n      segmentEnd = {\n        x: xmid,\n        y: ymid\n      };\n    }\n  }\n\n  return {\n    waypoints: getBendpoints(a, segmentEnd, segmentDirections).concat(segmentEnd),\n    directions:  segmentDirections,\n    turnNextDirections: turnNextDirections\n  };\n}\n\nfunction getStartSegment(a, b, directions) {\n  return getSegmentBendpoints(a, b, directions);\n}\n\nfunction getEndSegment(a, b, directions) {\n  var invertedSegment = getSegmentBendpoints(b, a, invertDirections(directions));\n\n  return {\n    waypoints: invertedSegment.waypoints.slice().reverse(),\n    directions: invertDirections(invertedSegment.directions),\n    turnNextDirections: invertedSegment.turnNextDirections\n  };\n}\n\nfunction getMidSegment(startSegment, endSegment) {\n\n  var startDirection = startSegment.directions.split(':')[1],\n      endDirection = endSegment.directions.split(':')[0];\n\n  if (startSegment.turnNextDirections) {\n    startDirection = startDirection == 'h' ? 'v' : 'h';\n  }\n\n  if (endSegment.turnNextDirections) {\n    endDirection = endDirection == 'h' ? 'v' : 'h';\n  }\n\n  var directions = startDirection + ':' + endDirection;\n\n  var bendpoints = getBendpoints(\n    startSegment.waypoints[startSegment.waypoints.length - 1],\n    endSegment.waypoints[0],\n    directions\n  );\n\n  return {\n    waypoints: bendpoints,\n    directions: directions\n  };\n}\n\nfunction invertDirections(directions) {\n  return directions.split(':').reverse().join(':');\n}\n\n/**\n * Handle simple layouts with maximum two bendpoints.\n */\nfunction getSimpleBendpoints(a, b, directions) {\n\n  var xmid = round((b.x - a.x) / 2 + a.x),\n      ymid = round((b.y - a.y) / 2 + a.y);\n\n  // one point, right or left from a\n  if (directions === 'h:v') {\n    return [ { x: b.x, y: a.y } ];\n  }\n\n  // one point, above or below a\n  if (directions === 'v:h') {\n    return [ { x: a.x, y: b.y } ];\n  }\n\n  // vertical segment between a and b\n  if (directions === 'h:h') {\n    return [\n      { x: xmid, y: a.y },\n      { x: xmid, y: b.y }\n    ];\n  }\n\n  // horizontal segment between a and b\n  if (directions === 'v:v') {\n    return [\n      { x: a.x, y: ymid },\n      { x: b.x, y: ymid }\n    ];\n  }\n\n  throw new Error('invalid directions: can only handle varians of [hv]:[hv]');\n}\n\n\n/**\n * Returns the mid points for a manhattan connection between two points.\n *\n * @example h:h (horizontal:horizontal)\n *\n * [a]----[x]\n *         |\n *        [x]----[b]\n *\n * @example h:v (horizontal:vertical)\n *\n * [a]----[x]\n *         |\n *        [b]\n *\n * @example h:r (horizontal:right)\n *\n * [a]----[x]\n *         |\n *    [b]-[x]\n *\n * @param  {Point} a\n * @param  {Point} b\n * @param  {string} directions\n *\n * @return {Array<Point>}\n */\nfunction getBendpoints(a, b, directions) {\n  directions = directions || 'h:h';\n\n  if (!isValidDirections(directions)) {\n    throw new Error(\n      'unknown directions: <' + directions + '>: ' +\n      'must be specified as <start>:<end> ' +\n      'with start/end in { h,v,t,r,b,l }'\n    );\n  }\n\n  // compute explicit directions, involving trbl dockings\n  // using a three segmented layouting algorithm\n  if (isExplicitDirections(directions)) {\n    var startSegment = getStartSegment(a, b, directions),\n        endSegment = getEndSegment(a, b, directions),\n        midSegment = getMidSegment(startSegment, endSegment);\n\n    return [].concat(\n      startSegment.waypoints,\n      midSegment.waypoints,\n      endSegment.waypoints\n    );\n  }\n\n  // handle simple [hv]:[hv] cases that can be easily computed\n  return getSimpleBendpoints(a, b, directions);\n}\n\n/**\n * Create a connection between the two points according\n * to the manhattan layout (only horizontal and vertical) edges.\n *\n * @param {Point} a\n * @param {Point} b\n *\n * @param {string} [directions='h:h'] specifies manhattan directions for each point as {adirection}:{bdirection}.\n                   A directionfor a point is either `h` (horizontal) or `v` (vertical)\n *\n * @return {Array<Point>}\n */\nexport function connectPoints(a, b, directions) {\n\n  var points = getBendpoints(a, b, directions);\n\n  points.unshift(a);\n  points.push(b);\n\n  return withoutRedundantPoints(points);\n}\n\n\n/**\n * Connect two rectangles using a manhattan layouted connection.\n *\n * @param {Bounds} source source rectangle\n * @param {Bounds} target target rectangle\n * @param {Point} [start] source docking\n * @param {Point} [end] target docking\n *\n * @param {Object} [hints]\n * @param {string} [hints.preserveDocking=source] preserve docking on selected side\n * @param {Array<string>} [hints.preferredLayouts]\n * @param {Point|boolean} [hints.connectionStart] whether the start changed\n * @param {Point|boolean} [hints.connectionEnd] whether the end changed\n *\n * @return {Array<Point>} connection points\n */\nexport function connectRectangles(source, target, start, end, hints) {\n\n  var preferredLayouts = hints && hints.preferredLayouts || [];\n\n  var preferredLayout = without(preferredLayouts, 'straight')[0] || 'h:h';\n\n  var threshold = ORIENTATION_THRESHOLD[preferredLayout] || 0;\n\n  var orientation = getOrientation(source, target, threshold);\n\n  var directions = getDirections(orientation, preferredLayout);\n\n  start = start || getMid(source);\n  end = end || getMid(target);\n\n  var directionSplit = directions.split(':');\n\n  // compute actual docking points for start / end\n  // this ensures we properly layout only parts of the\n  // connection that lies in between the two rectangles\n  var startDocking = getDockingPoint(start, source, directionSplit[0], invertOrientation(orientation)),\n      endDocking = getDockingPoint(end, target, directionSplit[1], orientation);\n\n  return connectPoints(startDocking, endDocking, directions);\n}\n\n\n/**\n * Repair the connection between two rectangles, of which one has been updated.\n *\n * @param {Bounds} source\n * @param {Bounds} target\n * @param {Point} [start]\n * @param {Point} [end]\n * @param {Array<Point>} [waypoints]\n * @param {Object} [hints]\n * @param {Array<string>} [hints.preferredLayouts] list of preferred layouts\n * @param {boolean} [hints.connectionStart]\n * @param {boolean} [hints.connectionEnd]\n *\n * @return {Array<Point>} repaired waypoints\n */\nexport function repairConnection(source, target, start, end, waypoints, hints) {\n\n  if (isArray(start)) {\n    waypoints = start;\n    hints = end;\n\n    start = getMid(source);\n    end = getMid(target);\n  }\n\n  hints = assign({ preferredLayouts: [] }, hints);\n  waypoints = waypoints || [];\n\n  var preferredLayouts = hints.preferredLayouts,\n      preferStraight = preferredLayouts.indexOf('straight') !== -1,\n      repairedWaypoints;\n\n  // just layout non-existing or simple connections\n  // attempt to render straight lines, if required\n\n  // attempt to layout a straight line\n  repairedWaypoints = preferStraight && tryLayoutStraight(source, target, start, end, hints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // try to layout from end\n  repairedWaypoints = hints.connectionEnd && tryRepairConnectionEnd(target, source, end, waypoints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // try to layout from start\n  repairedWaypoints = hints.connectionStart && tryRepairConnectionStart(source, target, start, waypoints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // or whether nothing seems to have changed\n  if (!hints.connectionStart && !hints.connectionEnd && waypoints && waypoints.length) {\n    return waypoints;\n  }\n\n  // simply reconnect if nothing else worked\n  return connectRectangles(source, target, start, end, hints);\n}\n\n\nfunction inRange(a, start, end) {\n  return a >= start && a <= end;\n}\n\nfunction isInRange(axis, a, b) {\n  var size = {\n    x: 'width',\n    y: 'height'\n  };\n\n  return inRange(a[axis], b[axis], b[axis] + b[size[axis]]);\n}\n\n/**\n * Layout a straight connection\n *\n * @param {Bounds} source\n * @param {Bounds} target\n * @param {Point} start\n * @param {Point} end\n * @param {Object} [hints]\n *\n * @return {Array<Point>|null} waypoints if straight layout worked\n */\nexport function tryLayoutStraight(source, target, start, end, hints) {\n  var axis = {},\n      primaryAxis,\n      orientation;\n\n  orientation = getOrientation(source, target);\n\n  // only layout a straight connection if shapes are\n  // horizontally or vertically aligned\n  if (!/^(top|bottom|left|right)$/.test(orientation)) {\n    return null;\n  }\n\n  if (/top|bottom/.test(orientation)) {\n    primaryAxis = 'x';\n  }\n\n  if (/left|right/.test(orientation)) {\n    primaryAxis = 'y';\n  }\n\n  if (hints.preserveDocking === 'target') {\n\n    if (!isInRange(primaryAxis, end, source)) {\n      return null;\n    }\n\n    axis[primaryAxis] = end[primaryAxis];\n\n    return [\n      {\n        x: axis.x !== undefined ? axis.x : start.x,\n        y: axis.y !== undefined ? axis.y : start.y,\n        original: {\n          x: axis.x !== undefined ? axis.x : start.x,\n          y: axis.y !== undefined ? axis.y : start.y\n        }\n      },\n      {\n        x: end.x,\n        y: end.y\n      }\n    ];\n\n  } else {\n\n    if (!isInRange(primaryAxis, start, target)) {\n      return null;\n    }\n\n    axis[primaryAxis] = start[primaryAxis];\n\n    return [\n      {\n        x: start.x,\n        y: start.y\n      },\n      {\n        x: axis.x !== undefined ? axis.x : end.x,\n        y: axis.y !== undefined ? axis.y : end.y,\n        original: {\n          x: axis.x !== undefined ? axis.x : end.x,\n          y: axis.y !== undefined ? axis.y : end.y\n        }\n      }\n    ];\n  }\n\n}\n\n/**\n * Repair a connection from start.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>|null} the repaired points between the two rectangles\n */\nfunction tryRepairConnectionStart(moved, other, newDocking, points) {\n  return _tryRepairConnectionSide(moved, other, newDocking, points);\n}\n\n/**\n * Repair a connection from end.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>|null} the repaired points between the two rectangles\n */\nfunction tryRepairConnectionEnd(moved, other, newDocking, points) {\n  var waypoints = points.slice().reverse();\n\n  waypoints = _tryRepairConnectionSide(moved, other, newDocking, waypoints);\n\n  return waypoints ? waypoints.reverse() : null;\n}\n\n/**\n * Repair a connection from one side that moved.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>} the repaired points between the two rectangles\n */\nfunction _tryRepairConnectionSide(moved, other, newDocking, points) {\n\n  function needsRelayout(points) {\n    if (points.length < 3) {\n      return true;\n    }\n\n    if (points.length > 4) {\n      return false;\n    }\n\n    // relayout if two points overlap\n    // this is most likely due to\n    return !!find(points, function(p, idx) {\n      var q = points[idx - 1];\n\n      return q && pointDistance(p, q) < 3;\n    });\n  }\n\n  function repairBendpoint(candidate, oldPeer, newPeer) {\n\n    var alignment = pointsAligned(oldPeer, candidate);\n\n    switch (alignment) {\n    case 'v':\n\n      // repair horizontal alignment\n      return { x: newPeer.x, y: candidate.y };\n    case 'h':\n\n      // repair vertical alignment\n      return { x: candidate.x, y: newPeer.y };\n    }\n\n    return { x: candidate.x, y: candidate. y };\n  }\n\n  function removeOverlapping(points, a, b) {\n    var i;\n\n    for (i = points.length - 2; i !== 0; i--) {\n\n      // intersects (?) break, remove all bendpoints up to this one and relayout\n      if (pointInRect(points[i], a, INTERSECTION_THRESHOLD) ||\n          pointInRect(points[i], b, INTERSECTION_THRESHOLD)) {\n\n        // return sliced old connection\n        return points.slice(i);\n      }\n    }\n\n    return points;\n  }\n\n  // (0) only repair what has layoutable bendpoints\n\n  // (1) if only one bendpoint and on shape moved onto other shapes axis\n  //     (horizontally / vertically), relayout\n\n  if (needsRelayout(points)) {\n    return null;\n  }\n\n  var oldDocking = points[0],\n      newPoints = points.slice(),\n      slicedPoints;\n\n  // (2) repair only last line segment and only if it was layouted before\n\n  newPoints[0] = newDocking;\n  newPoints[1] = repairBendpoint(newPoints[1], oldDocking, newDocking);\n\n\n  // (3) if shape intersects with any bendpoint after repair,\n  //     remove all segments up to this bendpoint and repair from there\n  slicedPoints = removeOverlapping(newPoints, moved, other);\n\n  if (slicedPoints !== newPoints) {\n    newPoints = _tryRepairConnectionSide(moved, other, newDocking, slicedPoints);\n  }\n\n  // (4) do NOT repair if repaired bendpoints are aligned\n  if (newPoints && pointsAligned(newPoints)) {\n    return null;\n  }\n\n  return newPoints;\n}\n\n\n/**\n * Returns the manhattan directions connecting two rectangles\n * with the given orientation.\n *\n * Will always return the default layout, if it is specific\n * regarding sides already (trbl).\n *\n * @example\n *\n * getDirections('top'); // -> 'v:v'\n * getDirections('intersect'); // -> 't:t'\n *\n * getDirections('top-right', 'v:h'); // -> 'v:h'\n * getDirections('top-right', 'h:h'); // -> 'h:h'\n *\n *\n * @param {string} orientation\n * @param {string} defaultLayout\n *\n * @return {string}\n */\nfunction getDirections(orientation, defaultLayout) {\n\n  // don't override specific trbl directions\n  if (isExplicitDirections(defaultLayout)) {\n    return defaultLayout;\n  }\n\n  switch (orientation) {\n  case 'intersect':\n    return 't:t';\n\n  case 'top':\n  case 'bottom':\n    return 'v:v';\n\n  case 'left':\n  case 'right':\n    return 'h:h';\n\n  // 'top-left'\n  // 'top-right'\n  // 'bottom-left'\n  // 'bottom-right'\n  default:\n    return defaultLayout;\n  }\n}\n\nfunction isValidDirections(directions) {\n  return directions && /^h|v|t|r|b|l:h|v|t|r|b|l$/.test(directions);\n}\n\nfunction isExplicitDirections(directions) {\n  return directions && /t|r|b|l/.test(directions);\n}\n\nfunction invertOrientation(orientation) {\n  return {\n    'top': 'bottom',\n    'bottom': 'top',\n    'left': 'right',\n    'right': 'left',\n    'top-left': 'bottom-right',\n    'bottom-right': 'top-left',\n    'top-right': 'bottom-left',\n    'bottom-left': 'top-right',\n  }[orientation];\n}\n\nfunction getDockingPoint(point, rectangle, dockingDirection, targetOrientation) {\n\n  // ensure we end up with a specific docking direction\n  // based on the targetOrientation, if <h|v> is being passed\n\n  if (dockingDirection === 'h') {\n    dockingDirection = /left/.test(targetOrientation) ? 'l' : 'r';\n  }\n\n  if (dockingDirection === 'v') {\n    dockingDirection = /top/.test(targetOrientation) ? 't' : 'b';\n  }\n\n  if (dockingDirection === 't') {\n    return { original: point, x: point.x, y: rectangle.y };\n  }\n\n  if (dockingDirection === 'r') {\n    return { original: point, x: rectangle.x + rectangle.width, y: point.y };\n  }\n\n  if (dockingDirection === 'b') {\n    return { original: point, x: point.x, y: rectangle.y + rectangle.height };\n  }\n\n  if (dockingDirection === 'l') {\n    return { original: point, x: rectangle.x, y: point.y };\n  }\n\n  throw new Error('unexpected dockingDirection: <' + dockingDirection + '>');\n}\n\n\n/**\n * Return list of waypoints with redundant ones filtered out.\n *\n * @example\n *\n * Original points:\n *\n *   [x] ----- [x] ------ [x]\n *                         |\n *                        [x] ----- [x] - [x]\n *\n * Filtered:\n *\n *   [x] ---------------- [x]\n *                         |\n *                        [x] ----------- [x]\n *\n * @param  {Array<Point>} waypoints\n *\n * @return {Array<Point>}\n */\nexport function withoutRedundantPoints(waypoints) {\n  return waypoints.reduce(function(points, p, idx) {\n\n    var previous = points[points.length - 1],\n        next = waypoints[idx + 1];\n\n    if (!pointsOnLine(previous, next, p, 0)) {\n      points.push(p);\n    }\n\n    return points;\n  }, []);\n}\n","import inherits from 'inherits';\n\nimport {\n  assign\n} from 'min-dash';\n\nimport BaseLayouter from 'diagram-js/lib/layout/BaseLayouter';\n\nimport {\n  repairConnection,\n  withoutRedundantPoints\n} from 'diagram-js/lib/layout/ManhattanLayout';\n\nimport {\n  getMid,\n  getOrientation\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport { is } from '@util/util';\n\nexport default function elementLayouter() {}\n\ninherits(elementLayouter, BaseLayouter);\n\nelementLayouter.prototype.layoutConnection = function(connection, hints) {\n  if (!hints) {\n    hints = {};\n  }\n  var source = hints.source || connection.source,\n      target = hints.target || connection.target,\n      waypoints = hints.waypoints || connection.waypoints,\n      connectionStart = hints.connectionStart,\n      connectionEnd = hints.connectionEnd;\n\n  var manhattanOptions,\n      updatedWaypoints;\n\n\n  \n  if(connectionEnd == undefined){\n    connectionStart = getConnectionDocking(waypoints && waypoints[ 0 ], source);\n    connectionEnd = getConnectionDocking(waypoints && waypoints[ waypoints.length - 1 ], target);\n  }\n\n  if (!connectionStart) {\n    connectionStart = getConnectionDocking(waypoints && waypoints[ 0 ], source);\n  }\n\n  if (!connectionEnd) {\n    connectionEnd = getConnectionDocking(waypoints && waypoints[ waypoints.length - 1 ], target);\n  }\n   if (is(connection, 'myline') ) {\n    if (source === target) {\n      manhattanOptions = {\n        preferredLayouts: getLoopPreferredLayout(source, connection)\n      };\n    } else if (is(source, 'gatewayAnd') || is(source, 'gatewayXor') || is(source, 'gatewayInclusive')) {\n      manhattanOptions = {\n        preferredLayouts: [ 'v:h' ]\n      };\n    } else if (is(target, 'gatewayAnd') || is(target, 'gatewayXor') || is(target, 'gatewayInclusive')) {\n      manhattanOptions = {\n        preferredLayouts: [ 'h:v' ]\n      };\n    } else {\n      manhattanOptions = {\n        preferredLayouts: [ 'h:h' ]\n      };\n    }\n  }\n\n  if (manhattanOptions) {\n    manhattanOptions = assign(manhattanOptions, hints);\n\n    updatedWaypoints = withoutRedundantPoints(repairConnection(\n      source,\n      target,\n      connectionStart,\n      connectionEnd,\n      waypoints,\n      manhattanOptions\n    ));\n  }\n\n  return updatedWaypoints || [ connectionStart, connectionEnd ];\n};\nfunction getConnectionDocking(point, shape) {\n  return point ? (point.original || point) : getMid(shape);\n}\nfunction getLoopPreferredLayout(source, connection) {\n  var waypoints = connection.waypoints;\n\n  var orientation = waypoints && waypoints.length && getOrientation(waypoints[0], source);\n\n  if (orientation === 'top') {\n    return [ 't:r' ];\n  } else if (orientation === 'right') {\n    return [ 'r:b' ];\n  } else if (orientation === 'left') {\n    return [ 'l:t' ];\n  }\n\n  return [ 'b:l' ];\n}\n\n","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getElementLineIntersection\n} from './LayoutUtil';\n\n\nfunction dockingToPoint(docking) {\n\n  // use the dockings actual point and\n  // retain the original docking\n  return assign({ original: docking.point.original || docking.point }, docking.actual);\n}\n\n\n/**\n * A {@link ConnectionDocking} that crops connection waypoints based on\n * the path(s) of the connection source and target.\n *\n * @param {djs.core.ElementRegistry} elementRegistry\n */\nexport default function CroppingConnectionDocking(elementRegistry, graphicsFactory) {\n  this._elementRegistry = elementRegistry;\n  this._graphicsFactory = graphicsFactory;\n}\n\nCroppingConnectionDocking.$inject = [ 'elementRegistry', 'graphicsFactory' ];\n\n\n/**\n * @inheritDoc ConnectionDocking#getCroppedWaypoints\n */\nCroppingConnectionDocking.prototype.getCroppedWaypoints = function(connection, source, target) {\n\n  source = source || connection.source;\n  target = target || connection.target;\n\n  var sourceDocking = this.getDockingPoint(connection, source, true),\n      targetDocking = this.getDockingPoint(connection, target);\n\n  var croppedWaypoints = connection.waypoints.slice(sourceDocking.idx + 1, targetDocking.idx);\n\n  croppedWaypoints.unshift(dockingToPoint(sourceDocking));\n  croppedWaypoints.push(dockingToPoint(targetDocking));\n\n  return croppedWaypoints;\n};\n\n/**\n * Return the connection docking point on the specified shape\n *\n * @inheritDoc ConnectionDocking#getDockingPoint\n */\nCroppingConnectionDocking.prototype.getDockingPoint = function(connection, shape, dockStart) {\n\n  var waypoints = connection.waypoints,\n      dockingIdx,\n      dockingPoint,\n      croppedPoint;\n\n  dockingIdx = dockStart ? 0 : waypoints.length - 1;\n  dockingPoint = waypoints[dockingIdx];\n\n  croppedPoint = this._getIntersection(shape, connection, dockStart);\n\n  return {\n    point: dockingPoint,\n    actual: croppedPoint || dockingPoint,\n    idx: dockingIdx\n  };\n};\n\n\n// helpers //////////////////////\n\nCroppingConnectionDocking.prototype._getIntersection = function(shape, connection, takeFirst) {\n\n  var shapePath = this._getShapePath(shape),\n      connectionPath = this._getConnectionPath(connection);\n\n  return getElementLineIntersection(shapePath, connectionPath, takeFirst);\n};\n\nCroppingConnectionDocking.prototype._getConnectionPath = function(connection) {\n  return this._graphicsFactory.getConnectionPath(connection);\n};\n\nCroppingConnectionDocking.prototype._getShapePath = function(shape) {\n  return this._graphicsFactory.getShapePath(shape);\n};\n\nCroppingConnectionDocking.prototype._getGfx = function(element) {\n  return this._elementRegistry.getGraphics(element);\n};\n","\nimport CommandModule from 'diagram-js/lib/command';\nimport LabelSupportModule from 'diagram-js/lib/features/label-support';\nimport SelectionModule from 'diagram-js/lib/features/selection';\nimport ElementFactory from './elementFactory';\nimport Modeling from './modeling';\n\nimport ElementUpdater from './elementUpdater';\nimport ElementLayouter from './elementLayouter';\nimport CroppingConnectionDocking from 'diagram-js/lib/layout/CroppingConnectionDocking';\nexport default {\n  __depends__: [\n    CommandModule,\n    LabelSupportModule,\n    SelectionModule\n  ],\n  __init__: [\n    'modeling',\n    'elementUpdater'\n  ],\n  modeling: [ 'type', Modeling ],\n  layouter: [ 'type', ElementLayouter ],\n  elementUpdater:['type',ElementUpdater],\n  elementFactory: [ 'type', ElementFactory ],\n  connectionDocking: [ 'type', CroppingConnectionDocking ]\n};","\n  \n  import {\n    componentsToPath\n  } from 'diagram-js/lib/util/RenderUtil';\n  \n  \n  // element utils //////////////////////\n\n  \n  export function getSemantic(element) {\n    return element.businessObject;\n  }\n  // width /////////////////////////////\n  export function getStrokeWidth(element, defaultWidth) {//element, defaultColor\n    return element.businessObject.strokeWidth || defaultWidth || 1;\n  }\n  \n  // color access //////////////////////\n  \n  export function getFillColor(element, defaultColor) {//element, defaultColor\n    return element.businessObject.fillColor || defaultColor || 'white';\n  }\n  \n  export function getStrokeColor(element, defaultColor) {//element, defaultColor\n    return element.businessObject.strokeColor || defaultColor || 'black';\n  }\n  \n  // cropping path customizations //////////////////////\n  \n  export function getCirclePath(shape) {\n  \n    var cx = shape.x + shape.width / 2,\n        cy = shape.y + shape.height / 2,\n        radius = shape.width / 2;\n  \n    var circlePath = [\n      ['M', cx, cy],\n      ['m', 0, -radius],\n      ['a', radius, radius, 0, 1, 1, 0, 2 * radius],\n      ['a', radius, radius, 0, 1, 1, 0, -2 * radius],\n      ['z']\n    ];\n  \n    return componentsToPath(circlePath);\n  }\n  \n  export function getRoundRectPath(shape, borderRadius) {\n  \n    var x = shape.x,\n        y = shape.y,\n        width = shape.width,\n        height = shape.height;\n  \n    var roundRectPath = [\n      ['M', x + borderRadius, y],\n      ['l', width - borderRadius * 2, 0],\n      ['a', borderRadius, borderRadius, 0, 0, 1, borderRadius, borderRadius],\n      ['l', 0, height - borderRadius * 2],\n      ['a', borderRadius, borderRadius, 0, 0, 1, -borderRadius, borderRadius],\n      ['l', borderRadius * 2 - width, 0],\n      ['a', borderRadius, borderRadius, 0, 0, 1, -borderRadius, -borderRadius],\n      ['l', 0, borderRadius * 2 - height],\n      ['a', borderRadius, borderRadius, 0, 0, 1, borderRadius, -borderRadius],\n      ['z']\n    ];\n  \n    return componentsToPath(roundRectPath);\n  }\n  \n  export function getDiamondPath(shape) {\n  \n    var width = shape.width,\n        height = shape.height,\n        x = shape.x,\n        y = shape.y,\n        halfWidth = width / 2,\n        halfHeight = height / 2;\n  \n    var diamondPath = [\n      ['M', x + halfWidth, y],\n      ['l', halfWidth, halfHeight],\n      ['l', -halfWidth, halfHeight],\n      ['l', -halfWidth, -halfHeight],\n      ['z']\n    ];\n  \n    return componentsToPath(diamondPath);\n  }\n  \n  export function getRectPath(shape) {\n    var x = shape.x,\n        y = shape.y,\n        width = shape.width,\n        height = shape.height;\n  \n    var rectPath = [\n      ['M', x, y],\n      ['l', width, 0],\n      ['l', 0, height],\n      ['l', -width, 0],\n      ['z']\n    ];\n  \n    return componentsToPath(rectPath);\n  }","import inherits from 'inherits';\n\nimport {\n  isObject,\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  query as domQuery\n} from 'min-dom';\n\n/** diagram-js*/\nimport BaseRenderer from 'diagram-js/lib/draw/BaseRenderer';\nimport {\n  translate\n} from 'diagram-js/lib/util/SvgTransformUtil';\nimport {\n    getSemantic,\n    getCirclePath,\n    getRoundRectPath,\n    getDiamondPath,\n    getRectPath,\n    getFillColor,\n    getStrokeColor,\n    getStrokeWidth\n  } from './renderUtil';\n\n  import {\n    append as svgAppend,\n    attr as svgAttr,\n    create as svgCreate,\n    classes as svgClasses\n  } from 'tiny-svg';\n\n\n  import {\n    getLabel\n  } from '../labelEditing/labelUtil';\n  import { uuid} from '@util/util.js';\n\nvar TASK_BORDER_RADIUS = 10;\nvar DEFAULT_FILL_OPACITY = .95;\nfunction is(element,type){\n  if(element.type == type){\n    return true;\n  }\n  else{\n    return false;\n  }\n}\n\nexport default function myRenderer(\n    eventBus, styles, pathMap,\n    canvas, textRenderer,myOptions, priority) {\n\n  BaseRenderer.call(this, eventBus, priority);\n  var defaultFillColor = 'white',\n      defaultStrokeColor = 'black';\n\n  var computeStyle = styles.computeStyle;\n\n  var markers = {};\n\n  function renderer(type) {\n    return handlers[type];\n  }\n\n  function drawCircle(parentGfx, width, height, offset, attrs) {\n\n    if (isObject(offset)) {\n      attrs = offset;\n      offset = 0;\n    }\n\n    offset = offset || 0;\n\n    attrs = computeStyle(attrs, {\n      stroke: 'black',\n      strokeWidth: 2,\n      fill: 'white'\n    });\n\n    if (attrs.fill === 'none') {\n      delete attrs.fillOpacity;\n    }\n\n    var cx = width / 2,\n        cy = height / 2;\n\n    var circle = svgCreate('circle');\n    svgAttr(circle, {\n      cx: cx,\n      cy: cy,\n      r: Math.round((width + height) / 4 - offset)\n    });\n    svgAttr(circle, attrs);\n\n    svgAppend(parentGfx, circle);\n\n    return circle;\n  }\n\n  function drawRect(parentGfx, width, height, r, offset, attrs) {\n\n    if (isObject(offset)) {\n      attrs = offset;\n      offset = 0;\n    }\n\n    offset = offset || 0;\n\n    attrs = computeStyle(attrs, {\n      stroke: 'black',\n      strokeWidth: 2,\n      fill: 'white'\n    });\n\n    var rect = svgCreate('rect');\n    svgAttr(rect, {\n      x: offset,\n      y: offset,\n      width: width - offset * 2,\n      height: height - offset * 2,\n      rx: r,\n      ry: r\n    });\n    svgAttr(rect, attrs);\n\n    svgAppend(parentGfx, rect);\n\n    return rect;\n  }\n\n  function drawPath(parentGfx, d, attrs) {\n\n    attrs = computeStyle(attrs, [ 'no-fill' ], {\n      strokeWidth: 2,\n      stroke: 'black'\n    });\n\n    var path = svgCreate('path');\n    svgAttr(path, { d: d });\n    svgAttr(path, attrs);\n\n    svgAppend(parentGfx, path);\n\n    return path;\n  }\n\n\n  function drawDiamond(parentGfx, width, height, attrs) {\n\n    var x_2 = width / 2;\n    var y_2 = height / 2;\n\n    var points = [{ x: x_2, y: 0 }, { x: width, y: y_2 }, { x: x_2, y: height }, { x: 0, y: y_2 }];\n\n    var pointsString = points.map(function(point) {\n      return point.x + ',' + point.y;\n    }).join(' ');\n\n    attrs = computeStyle(attrs, {\n      stroke: 'black',\n      strokeWidth: 2,\n      fill: 'white'\n    });\n\n    var polygon = svgCreate('polygon');\n    svgAttr(polygon, {\n      points: pointsString\n    });\n    svgAttr(polygon, attrs);\n\n    svgAppend(parentGfx, polygon);\n\n    return polygon;\n  }\n\n  function drawMarker(type, parentGfx, path, attrs) {\n    return drawPath(parentGfx, path, assign({ 'data-marker': type }, attrs));\n  }\n\n  function renderLabel(parentGfx, label, options) {\n\n    options = assign({\n      size: {\n        width: 100\n      }\n    }, options);\n\n    var text = textRenderer.createText(label || '', options);\n\n    svgClasses(text).add('djs-label');\n\n    svgAppend(parentGfx, text);\n\n    return text;\n  }\n\n  function renderEmbeddedLabel(parentGfx, element, align) {\n    var semantic = getSemantic(element);\n\n    return renderLabel(parentGfx, semantic.name, {\n      box: element,\n      align: align,\n      padding: 5,\n      style: {\n        fill: getStrokeColor(element, defaultStrokeColor)\n      }\n    });\n  }\n\n  function renderExternalLabel(parentGfx, element) {\n\n    var box = {\n      width: 90,\n      height: 30,\n      x: element.width / 2 + element.x,\n      y: element.height / 2 + element.y\n    };\n\n    return renderLabel(parentGfx, getLabel(element), {\n      box: box,\n      fitBox: true,\n      style: assign(\n        {},\n        textRenderer.getExternalStyle(),\n        {\n          fill: getStrokeColor(element, defaultStrokeColor)\n        }\n      )\n    });\n  }\n\n\n  function attachTaskMarkers(parentGfx, element, taskMarkers) {\n    var subprocess = taskMarkers && taskMarkers.indexOf('SubProcessMarker') !== -1;\n    var position;\n    if (subprocess) {\n      position = {\n        seq: -21,\n        parallel: -22,\n        compensation: -42,\n        loop: -18,\n        adhoc: 10\n      };\n    } else {\n      position = {\n        seq: -3,\n        parallel: -6,\n        compensation: -27,\n        loop: 0,\n        adhoc: 10\n      };\n    }\n\n    forEach(taskMarkers, function(marker) {\n      renderer(marker)(parentGfx, element, position);\n    });\n\n  }\n\n  function createPathFromConnection(connection) {\n    var waypoints = connection.waypoints;\n\n    var pathData = 'm  ' + waypoints[0].x + ',' + waypoints[0].y;\n    for (var i = 1; i < waypoints.length; i++) {\n      pathData += 'L' + waypoints[i].x + ',' + waypoints[i].y + ' ';\n    }\n    return pathData;\n  }\n\n  function colorEscape(str) {\n\n    // only allow characters and numbers\n    return str.replace(/[^0-9a-zA-z]+/g, '_');\n  }\n\n  function addMarker(id, options) {\n    var attrs = assign({\n      fill: 'black',\n      strokeWidth: 1,\n      strokeLinecap: 'round',\n      strokeDasharray: 'none'\n    }, options.attrs);\n\n    var ref = options.ref || { x: 0, y: 0 };\n\n    var scale = options.scale || 1;\n\n    // fix for safari / chrome / firefox bug not correctly\n    // resetting stroke dash array\n    if (attrs.strokeDasharray === 'none') {\n      attrs.strokeDasharray = [10000, 1];\n    }\n\n    var marker = svgCreate('marker');\n\n    svgAttr(options.element, attrs);\n\n    svgAppend(marker, options.element);\n\n    svgAttr(marker, {\n      id: id,\n      viewBox: '0 0 20 20',\n      refX: ref.x,\n      refY: ref.y,\n      markerWidth: 20 * scale,\n      markerHeight: 20 * scale,\n      orient: 'auto'\n    });\n\n    var defs = domQuery('defs', canvas._svg);\n\n    if (!defs) {\n      defs = svgCreate('defs');\n\n      svgAppend(canvas._svg, defs);\n    }\n\n    svgAppend(defs, marker);\n\n    markers[id] = marker;\n  }\n  function marker(type, fill, stroke) {\n    var id = type + '-' + colorEscape(fill) + '-' + colorEscape(stroke) + '-' + uuid();\n\n    if (!markers[id]) {\n      createMarker(id, type, fill, stroke);\n    }\n\n    return 'url(#' + id + ')';\n  }\n\n  function createMarker(id, type, fill, stroke) {\n\n    if (type === 'sequenceflow-end') {\n      var sequenceflowEnd = svgCreate('path');\n      svgAttr(sequenceflowEnd, { d: 'M 1 5 L 11 10 L 1 15 Z' });\n\n      addMarker(id, {\n        element: sequenceflowEnd,\n        ref: { x: 11, y: 10 },\n        scale: 0.5,\n        attrs: {\n          fill: stroke,\n          stroke: stroke\n        }\n      });\n    }\n\n    if (type === 'messageflow-start') {\n      var messageflowStart = svgCreate('circle');\n      svgAttr(messageflowStart, { cx: 6, cy: 6, r: 3.5 });\n\n      addMarker(id, {\n        element: messageflowStart,\n        attrs: {\n          fill: fill,\n          stroke: stroke\n        },\n        ref: { x: 6, y: 6 }\n      });\n    }\n\n    if (type === 'messageflow-end') {\n      var messageflowEnd = svgCreate('path');\n      svgAttr(messageflowEnd, { d: 'm 1 5 l 0 -3 l 7 3 l -7 3 z' });\n\n      addMarker(id, {\n        element: messageflowEnd,\n        attrs: {\n          fill: fill,\n          stroke: stroke,\n          strokeLinecap: 'butt'\n        },\n        ref: { x: 8.5, y: 5 }\n      });\n    }\n\n    if (type === 'association-start') {\n      var associationStart = svgCreate('path');\n      svgAttr(associationStart, { d: 'M 11 5 L 1 10 L 11 15' });\n\n      addMarker(id, {\n        element: associationStart,\n        attrs: {\n          fill: 'none',\n          stroke: stroke,\n          strokeWidth: 1.5\n        },\n        ref: { x: 1, y: 10 },\n        scale: 0.5\n      });\n    }\n\n    if (type === 'association-end') {\n      var associationEnd = svgCreate('path');\n      svgAttr(associationEnd, { d: 'M 1 5 L 11 10 L 1 15' });\n\n      addMarker(id, {\n        element: associationEnd,\n        attrs: {\n          fill: 'none',\n          stroke: stroke,\n          strokeWidth: 1.5\n        },\n        ref: { x: 12, y: 10 },\n        scale: 0.5\n      });\n    }\n\n    if (type === 'conditional-flow-marker') {\n      var conditionalflowMarker = svgCreate('path');\n      svgAttr(conditionalflowMarker, { d: 'M 0 10 L 8 6 L 16 10 L 8 14 Z' });\n\n      addMarker(id, {\n        element: conditionalflowMarker,\n        attrs: {\n          fill: fill,\n          stroke: stroke\n        },\n        ref: { x: -1, y: 10 },\n        scale: 0.5\n      });\n    }\n\n    if (type === 'conditional-default-flow-marker') {\n      var conditionaldefaultflowMarker = svgCreate('path');\n      svgAttr(conditionaldefaultflowMarker, { d: 'M 6 4 L 10 16' });\n\n      addMarker(id, {\n        element: conditionaldefaultflowMarker,\n        attrs: {\n          stroke: stroke\n        },\n        ref: { x: 0, y: 10 },\n        scale: 0.5\n      });\n    }\n  }\n\n  function drawIcon(parentGfx,element,x,y){\n    if(element.icon){\n      var pathData = pathMap.getScaledPath(element.icon, {\n        abspos: {\n          x: x,\n          y: y\n        }\n      });\n      /* parallel path */ \n      drawPath(parentGfx, pathData, {\n        strokeWidth: 0,\n        fill: getStrokeColor(element, element.iconFill),\n      });\n    }\n  }\n\n  var handlers = this.handlers = {\n    'event': function(parentGfx, element, attrs) {\n      if (!('fillOpacity' in attrs)) {\n        attrs.fillOpacity = DEFAULT_FILL_OPACITY;\n      }\n      return drawCircle(parentGfx, element.width, element.height, attrs);\n    },\n    'startEvent':function(parentGfx, element){\n      var attrs = {\n        fill: getFillColor(element, element.fill),\n        stroke: getStrokeColor(element, element.stroke),\n        strokeWidth:getStrokeWidth(element, element.strokeWidth)\n      };\n      var circle = renderer('event')(parentGfx, element, attrs);\n\n      drawIcon(parentGfx, element,18,18);\n      \n\n      return circle;\n    },\n    'endEvent': function(parentGfx, element) {\n      var circle = renderer('event')(parentGfx, element, {\n        strokeWidth:getStrokeWidth(element, element.strokeWidth || 4),\n        fill: getFillColor(element, element.fill),\n        stroke: getStrokeColor(element, element.stroke),\n      });\n\n      drawIcon(parentGfx, element,18,18);\n\n      return circle;\n    },\n    'gateway': function(parentGfx, element) {\n      var attrs = {\n        fillOpacity: DEFAULT_FILL_OPACITY,\n\n        strokeWidth:getStrokeWidth(element, element.strokeWidth || 4),\n        fill: getFillColor(element, element.fill),\n        stroke: getStrokeColor(element, element.stroke),\n      };\n\n      return drawDiamond(parentGfx, element.width, element.height, attrs);\n    },\n    'gatewayAnd':function(parentGfx, element){\n      var diamond = renderer('gateway')(parentGfx, element);\n\n      var pathData = pathMap.getScaledPath('GATEWAY_PARALLEL', {\n        xScaleFactor: 0.4,\n        yScaleFactor:0.4,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.47,\n          my: 0.29\n        }\n      });\n\n      /* parallel path */ \n      drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: getStrokeColor(element, element.iconFill),\n        stroke: getStrokeColor(element, element.iconFill)\n      });\n\n      return diamond;\n    },\n    'gatewayXor':function(parentGfx, element){\n      var diamond = renderer('gateway')(parentGfx, element);\n      var pathData = pathMap.getScaledPath('GATEWAY_EXCLUSIVE', {\n        xScaleFactor: 0.4,\n        yScaleFactor: 0.4,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.32,\n          my: 0.3\n        }\n      });\n\n      drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        fill: getStrokeColor(element, element.iconFill),\n        stroke: getStrokeColor(element, element.iconFill)\n      });\n      return diamond;\n    },\n    'gatewayInclusive':function(parentGfx, element){\n      var diamond = renderer('gateway')(parentGfx, element);\n\n      /* circle path */\n      drawCircle(parentGfx, element.width, element.height, element.height * 0.24, {\n        strokeWidth: 2.5,\n        fill: getStrokeColor(element, element.iconFill),\n        stroke: getStrokeColor(element, element.iconFill)\n      });\n\n      return diamond;\n    },\n    'activity': function(parentGfx, element, attrs) {\n\n      attrs = attrs || {};\n\n      if (!('fillOpacity' in attrs)) {\n        attrs.fillOpacity = DEFAULT_FILL_OPACITY;\n      }\n\n      return drawRect(parentGfx, element.width, element.height, TASK_BORDER_RADIUS, attrs);\n    },\n    'task': function(parentGfx, element) {\n      var attrs = {\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor)\n      };\n\n      var rect = renderer('activity')(parentGfx, element, attrs);\n\n      renderEmbeddedLabel(parentGfx, element, 'center-middle');\n      attachTaskMarkers(parentGfx, element);\n\n      return rect;\n    },\n    'userTask': function(parentGfx, element) {\n      var task = renderer('task')(parentGfx, element);\n\n      var x = 15;\n      var y = 12;\n\n      var pathData = pathMap.getScaledPath('TASK_TYPE_USER_1', {\n        abspos: {\n          x: x,\n          y: y\n        }\n      });\n\n      /* user path */ drawPath(parentGfx, pathData, {\n        strokeWidth: 0.5,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor)\n      });\n\n      var pathData2 = pathMap.getScaledPath('TASK_TYPE_USER_2', {\n        abspos: {\n          x: x,\n          y: y\n        }\n      });\n\n      /* user2 path */ drawPath(parentGfx, pathData2, {\n        strokeWidth: 0.5,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor)\n      });\n\n      var pathData3 = pathMap.getScaledPath('TASK_TYPE_USER_3', {\n        abspos: {\n          x: x,\n          y: y\n        }\n      });\n\n      /* user3 path */ drawPath(parentGfx, pathData3, {\n        strokeWidth: 0.5,\n        fill: getStrokeColor(element, defaultStrokeColor),\n        stroke: getStrokeColor(element, defaultStrokeColor)\n      });\n\n      return task;\n    },\n    'scriptTask': function(parentGfx, element) {\n      var task = renderer('task')(parentGfx, element);\n\n      var pathData = pathMap.getScaledPath('TASK_TYPE_SCRIPT', {\n        abspos: {\n          x: 15,\n          y: 20\n        }\n      });\n\n      /* script path */ \n      drawPath(parentGfx, pathData, {\n        strokeWidth: 1,\n        stroke: getStrokeColor(element, defaultStrokeColor)\n      });\n\n      return task;\n    },\n    'SubProcessMarker': function(parentGfx, element) {\n      var markerRect = drawRect(parentGfx, 14, 14, 0, {\n        strokeWidth: 1,\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor)\n      });\n\n      // Process marker is placed in the middle of the box\n      // therefore fixed values can be used here\n      translate(markerRect, element.width / 2 - 7.5, element.height - 20);\n\n      var markerPath = pathMap.getScaledPath('MARKER_SUB_PROCESS', {\n        xScaleFactor: 1.5,\n        yScaleFactor: 1.5,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: (element.width / 2 - 7.5) / element.width,\n          my: (element.height - 20) / element.height\n        }\n      });\n\n      drawMarker('sub-process', parentGfx, markerPath, {\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor)\n      });\n    },\n    'subprocess': function(parentGfx, element, attrs) {\n      attrs = assign({\n        fill: getFillColor(element, defaultFillColor),\n        stroke: getStrokeColor(element, defaultStrokeColor)\n      }, attrs);\n      var rect = renderer('activity')(parentGfx, element, attrs);\n      renderEmbeddedLabel(parentGfx, element, 'center-middle' );//center-top\n      attachTaskMarkers(parentGfx, element, ['SubProcessMarker']);\n      return rect;\n    },\n\n    'label': function(parentGfx, element) {\n      return renderExternalLabel(parentGfx, element);\n    },\n\n    'myline': function(parentGfx, element) {\n      var pathData = createPathFromConnection(element);\n      var fill = getFillColor(element,myOptions.lineStroke ||  defaultFillColor),\n          stroke = getStrokeColor(element,myOptions.lineStroke || defaultStrokeColor);\n\n\n      var attrs = {\n        strokeLinejoin: 'round',\n        markerEnd: marker('sequenceflow-end', fill, stroke),\n        strokeWidth:2,\n        stroke: getStrokeColor(element, myOptions.lineStroke || defaultStrokeColor)\n      };\n      var path = drawPath(parentGfx, pathData, attrs);\n\n      return path;\n    },\n\n    'default': function(parentGfx, element) {\n      var attrs = {\n        strokeWidth:getStrokeWidth(element, element.strokeWidth || 1),\n        fill: getFillColor(element, element.fill),\n        stroke: getStrokeColor(element, element.stroke),\n      };\n\n      var rect = drawRect(parentGfx, element.width, element.height, element.radius || TASK_BORDER_RADIUS, attrs);\n      renderEmbeddedLabel(parentGfx, element, 'center-middle');\n      attachTaskMarkers(parentGfx, element);\n\n      drawIcon(parentGfx, element,element.iconX,element.iconY);\n      return rect;\n    }\n\n  };\n\n\n\n  // extension API, use at your own risk\n  this._drawPath = drawPath;\n\n}\n\ninherits(myRenderer, BaseRenderer);\n\nmyRenderer.$inject = [\n  'eventBus',\n  'styles',\n  'pathMap',\n  'canvas',\n  'textRenderer',\n\n  'myOptions'\n];\n\n\nmyRenderer.prototype.canRender = function() {\n  //var h = this.handlers[element.type || 'default'];\n  return true; //h != undefined;\n};\n\nmyRenderer.prototype.drawShape = function(parentGfx, element) {\n  var type = element.type;\n  var h = this.handlers[type] || this.handlers.default;\n  //console.log('drawShape',type,parentGfx, element);\n  /* jshint -W040 */\n  return h(parentGfx, element);\n};\n\nmyRenderer.prototype.drawConnection = function(parentGfx, element) {\n  var type = element.type;\n  var h = this.handlers[type];\n  /* jshint -W040 */\n  return h(parentGfx, element);\n};\n\nmyRenderer.prototype.getShapePath = function(element) {\n\n  if (is(element, 'startEvent') || is(element, 'endEvent')) {\n    return getCirclePath(element);\n  }\n  if (is(element, 'userTask') || is(element, 'scriptTask') || is(element, 'subprocess')) {\n    return getRoundRectPath(element, TASK_BORDER_RADIUS);\n  }\n\n  if (is(element, 'gatewayAnd') || is(element, 'gatewayXor') || is(element, 'gatewayInclusive')) {\n    return getDiamondPath(element);\n  }\n\n  return getRectPath(element);\n};\n\n\n\n","import {\n  isObject,\n  assign,\n  forEach,\n  reduce\n} from 'min-dash';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nvar DEFAULT_BOX_PADDING = 0;\n\nvar DEFAULT_LABEL_SIZE = {\n  width: 150,\n  height: 50\n};\n\n\nfunction parseAlign(align) {\n\n  var parts = align.split('-');\n\n  return {\n    horizontal: parts[0] || 'center',\n    vertical: parts[1] || 'top'\n  };\n}\n\nfunction parsePadding(padding) {\n\n  if (isObject(padding)) {\n    return assign({ top: 0, left: 0, right: 0, bottom: 0 }, padding);\n  } else {\n    return {\n      top: padding,\n      left: padding,\n      right: padding,\n      bottom: padding\n    };\n  }\n}\n\nfunction getTextBBox(text, fakeText) {\n\n  fakeText.textContent = text;\n\n  var textBBox;\n\n  try {\n    var bbox,\n        emptyLine = text === '';\n\n    // add dummy text, when line is empty to\n    // determine correct height\n    fakeText.textContent = emptyLine ? 'dummy' : text;\n\n    textBBox = fakeText.getBBox();\n\n    // take text rendering related horizontal\n    // padding into account\n    bbox = {\n      width: textBBox.width + textBBox.x * 2,\n      height: textBBox.height\n    };\n\n    if (emptyLine) {\n\n      // correct width\n      bbox.width = 0;\n    }\n\n    return bbox;\n  } catch (e) {\n    return { width: 0, height: 0 };\n  }\n}\n\n\n/**\n * Layout the next line and return the layouted element.\n *\n * Alters the lines passed.\n *\n * @param  {Array<string>} lines\n * @return {Object} the line descriptor, an object { width, height, text }\n */\nfunction layoutNext(lines, maxWidth, fakeText) {\n\n  var originalLine = lines.shift(),\n      fitLine = originalLine;\n\n  var textBBox;\n\n  for (;;) {\n    textBBox = getTextBBox(fitLine, fakeText);\n\n    textBBox.width = fitLine ? textBBox.width : 0;\n\n    // try to fit\n    if (fitLine === ' ' || fitLine === '' || textBBox.width < Math.round(maxWidth) || fitLine.length < 2) {\n      return fit(lines, fitLine, originalLine, textBBox);\n    }\n\n    fitLine = shortenLine(fitLine, textBBox.width, maxWidth);\n  }\n}\n\nfunction fit(lines, fitLine, originalLine, textBBox) {\n  if (fitLine.length < originalLine.length) {\n    var remainder = originalLine.slice(fitLine.length).trim();\n\n    lines.unshift(remainder);\n  }\n\n  return {\n    width: textBBox.width,\n    height: textBBox.height,\n    text: fitLine\n  };\n}\n\n\n/**\n * Shortens a line based on spacing and hyphens.\n * Returns the shortened result on success.\n *\n * @param  {string} line\n * @param  {number} maxLength the maximum characters of the string\n * @return {string} the shortened string\n */\nfunction semanticShorten(line, maxLength) {\n  var parts = line.split(/(\\s|-)/g),\n      part,\n      shortenedParts = [],\n      length = 0;\n\n  // try to shorten via spaces + hyphens\n  if (parts.length > 1) {\n    while ((part = parts.shift())) {\n      if (part.length + length < maxLength) {\n        shortenedParts.push(part);\n        length += part.length;\n      } else {\n\n        // remove previous part, too if hyphen does not fit anymore\n        if (part === '-') {\n          shortenedParts.pop();\n        }\n\n        break;\n      }\n    }\n  }\n\n  return shortenedParts.join('');\n}\n\n\nfunction shortenLine(line, width, maxWidth) {\n  var length = Math.max(line.length * (maxWidth / width), 1);\n\n  // try to shorten semantically (i.e. based on spaces and hyphens)\n  var shortenedLine = semanticShorten(line, length);\n\n  if (!shortenedLine) {\n\n    // force shorten by cutting the long word\n    shortenedLine = line.slice(0, Math.max(Math.round(length - 1), 1));\n  }\n\n  return shortenedLine;\n}\n\n\nfunction getHelperSvg() {\n  var helperSvg = document.getElementById('helper-svg');\n\n  if (!helperSvg) {\n    helperSvg = svgCreate('svg');\n\n    svgAttr(helperSvg, {\n      id: 'helper-svg',\n      width: 0,\n      height: 0,\n      style: 'visibility: hidden; position: fixed'\n    });\n\n    document.body.appendChild(helperSvg);\n  }\n\n  return helperSvg;\n}\n\n\n/**\n * Creates a new label utility\n *\n * @param {Object} config\n * @param {Dimensions} config.size\n * @param {number} config.padding\n * @param {Object} config.style\n * @param {string} config.align\n */\nexport default function Text(config) {\n\n  this._config = assign({}, {\n    size: DEFAULT_LABEL_SIZE,\n    padding: DEFAULT_BOX_PADDING,\n    style: {},\n    align: 'center-top'\n  }, config || {});\n}\n\n/**\n * Returns the layouted text as an SVG element.\n *\n * @param {string} text\n * @param {Object} options\n *\n * @return {SVGElement}\n */\nText.prototype.createText = function(text, options) {\n  return this.layoutText(text, options).element;\n};\n\n/**\n * Returns a labels layouted dimensions.\n *\n * @param {string} text to layout\n * @param {Object} options\n *\n * @return {Dimensions}\n */\nText.prototype.getDimensions = function(text, options) {\n  return this.layoutText(text, options).dimensions;\n};\n\n/**\n * Creates and returns a label and its bounding box.\n *\n * @method Text#createText\n *\n * @param {string} text the text to render on the label\n * @param {Object} options\n * @param {string} options.align how to align in the bounding box.\n *                               Any of { 'center-middle', 'center-top' },\n *                               defaults to 'center-top'.\n * @param {string} options.style style to be applied to the text\n * @param {boolean} options.fitBox indicates if box will be recalculated to\n *                                 fit text\n *\n * @return {Object} { element, dimensions }\n */\nText.prototype.layoutText = function(text, options) {\n  var box = assign({}, this._config.size, options.box),\n      style = assign({}, this._config.style, options.style),\n      align = parseAlign(options.align || this._config.align),\n      padding = parsePadding(options.padding !== undefined ? options.padding : this._config.padding),\n      fitBox = options.fitBox || false;\n\n  var lineHeight = getLineHeight(style);\n\n  var lines = text.split(/\\r?\\n/g),\n      layouted = [];\n\n  var maxWidth = box.width - padding.left - padding.right;\n\n  // ensure correct rendering by attaching helper text node to invisible SVG\n  var helperText = svgCreate('text');\n  svgAttr(helperText, { x: 0, y: 0 });\n  svgAttr(helperText, style);\n\n  var helperSvg = getHelperSvg();\n\n  svgAppend(helperSvg, helperText);\n\n  while (lines.length) {\n    layouted.push(layoutNext(lines, maxWidth, helperText));\n  }\n\n  if (align.vertical === 'middle') {\n    padding.top = padding.bottom = 0;\n  }\n\n  var totalHeight = reduce(layouted, function(sum, line, idx) {\n    return sum + (lineHeight || line.height);\n  }, 0) + padding.top + padding.bottom;\n\n  var maxLineWidth = reduce(layouted, function(sum, line, idx) {\n    return line.width > sum ? line.width : sum;\n  }, 0);\n\n  // the y position of the next line\n  var y = padding.top;\n\n  if (align.vertical === 'middle') {\n    y += (box.height - totalHeight) / 2;\n  }\n\n  // magic number initial offset\n  y -= (lineHeight || layouted[0].height) / 4;\n\n\n  var textElement = svgCreate('text');\n\n  svgAttr(textElement, style);\n\n  // layout each line taking into account that parent\n  // shape might resize to fit text size\n  forEach(layouted, function(line) {\n\n    var x;\n\n    y += (lineHeight || line.height);\n\n    switch (align.horizontal) {\n    case 'left':\n      x = padding.left;\n      break;\n\n    case 'right':\n      x = ((fitBox ? maxLineWidth : maxWidth)\n        - padding.right - line.width);\n      break;\n\n    default:\n\n      // aka center\n      x = Math.max((((fitBox ? maxLineWidth : maxWidth)\n        - line.width) / 2 + padding.left), 0);\n    }\n\n    var tspan = svgCreate('tspan');\n    svgAttr(tspan, { x: x, y: y });\n\n    tspan.textContent = line.text;\n\n    svgAppend(textElement, tspan);\n  });\n\n  svgRemove(helperText);\n\n  var dimensions = {\n    width: maxLineWidth,\n    height: totalHeight\n  };\n\n  return {\n    dimensions: dimensions,\n    element: textElement\n  };\n};\n\n\nfunction getLineHeight(style) {\n  if ('fontSize' in style && 'lineHeight' in style) {\n    return style.lineHeight * parseInt(style.fontSize, 10);\n  }\n}","import { assign } from 'min-dash';\n\nimport TextUtil from 'diagram-js/lib/util/Text';\n\nvar DEFAULT_FONT_SIZE = 12;\nvar LINE_HEIGHT_RATIO = 1.2;\n\nvar MIN_TEXT_ANNOTATION_HEIGHT = 30;\n\n\nexport default function textRenderer(config) {\n\n  var defaultStyle = assign({\n    fontFamily: 'Arial, sans-serif',\n    fontSize: DEFAULT_FONT_SIZE,\n    fontWeight: 'normal',\n    lineHeight: LINE_HEIGHT_RATIO\n  }, config && config.defaultStyle || {});\n\n  var fontSize = parseInt(defaultStyle.fontSize, 10) - 1;\n\n  var externalStyle = assign({}, defaultStyle, {\n    fontSize: fontSize\n  }, config && config.externalStyle || {});\n\n  var textUtil = new TextUtil({\n    style: defaultStyle\n  });\n\n  /**\n   * Get the new bounds of an externally rendered,\n   * layouted label.\n   *\n   * @param  {Bounds} bounds\n   * @param  {string} text\n   *\n   * @return {Bounds}\n   */\n  this.getExternalLabelBounds = function(bounds, text) {\n\n    var layoutedDimensions = textUtil.getDimensions(text, {\n      box: {\n        width: 90,\n        height: 30,\n        x: bounds.width / 2 + bounds.x,\n        y: bounds.height / 2 + bounds.y\n      },\n      style: externalStyle\n    });\n\n    // resize label shape to fit label text\n    return {\n      x: Math.round(bounds.x + bounds.width / 2 - layoutedDimensions.width / 2),\n      y: Math.round(bounds.y),\n      width: Math.ceil(layoutedDimensions.width),\n      height: Math.ceil(layoutedDimensions.height)\n    };\n\n  };\n\n  /**\n   * Get the new bounds of text annotation.\n   *\n   * @param  {Bounds} bounds\n   * @param  {string} text\n   *\n   * @return {Bounds}\n   */\n  this.getTextAnnotationBounds = function(bounds, text) {\n\n    var layoutedDimensions = textUtil.getDimensions(text, {\n      box: bounds,\n      style: defaultStyle,\n      align: 'left-top',\n      padding: 5\n    });\n\n    return {\n      x: bounds.x,\n      y: bounds.y,\n      width: bounds.width,\n      height: Math.max(MIN_TEXT_ANNOTATION_HEIGHT, Math.round(layoutedDimensions.height))\n    };\n  };\n\n  /**\n   * Create a layouted text element.\n   *\n   * @param {string} text\n   * @param {Object} [options]\n   *\n   * @return {SVGElement} rendered text\n   */\n  this.createText = function(text, options) {\n    return textUtil.createText(text, options || {});\n  };\n\n  /**\n   * Get default text style.\n   */\n  this.getDefaultStyle = function() {\n    return defaultStyle;\n  };\n\n  /**\n   * Get the external text style.\n   */\n  this.getExternalStyle = function() {\n    return externalStyle;\n  };\n\n}\n\ntextRenderer.$inject = [\n  'config.textRenderer'\n];","import _Symbol$iterator from \"@babel/runtime-corejs2/core-js/symbol/iterator\";\nimport _Symbol from \"@babel/runtime-corejs2/core-js/symbol\";\nexport default function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof _Symbol === \"function\" && typeof _Symbol$iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof _Symbol === \"function\" && obj.constructor === _Symbol && obj !== _Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}","\nexport default function PathMap() {\n\n    /**\n     * Contains a map of path elements\n     *\n     * <h1>Path definition</h1>\n     * A parameterized path is defined like this:\n     * <pre>\n     * 'GATEWAY_PARALLEL': {\n     *   d: 'm {mx},{my} {e.x0},0 0,{e.x1} {e.x1},0 0,{e.y0} -{e.x1},0 0,{e.y1} ' +\n            '-{e.x0},0 0,-{e.y1} -{e.x1},0 0,-{e.y0} {e.x1},0 z',\n     *   height: 17.5,\n     *   width:  17.5,\n     *   heightElements: [2.5, 7.5],\n     *   widthElements: [2.5, 7.5]\n     * }\n     * </pre>\n     * <p>It's important to specify a correct <b>height and width</b> for the path as the scaling\n     * is based on the ratio between the specified height and width in this object and the\n     * height and width that is set as scale target (Note x,y coordinates will be scaled with\n     * individual ratios).</p>\n     * <p>The '<b>heightElements</b>' and '<b>widthElements</b>' array must contain the values that will be scaled.\n     * The scaling is based on the computed ratios.\n     * Coordinates on the y axis should be in the <b>heightElement</b>'s array, they will be scaled using\n     * the computed ratio coefficient.\n     * In the parameterized path the scaled values can be accessed through the 'e' object in {} brackets.\n     *   <ul>\n     *    <li>The values for the y axis can be accessed in the path string using {e.y0}, {e.y1}, ....</li>\n     *    <li>The values for the x axis can be accessed in the path string using {e.x0}, {e.x1}, ....</li>\n     *   </ul>\n     *   The numbers x0, x1 respectively y0, y1, ... map to the corresponding array index.\n     * </p>\n     */\n    this.pathMap = {\n      'GATEWAY_EXCLUSIVE': {\n        d:'m {mx},{my} {e.x0},{e.y0} {e.x1},{e.y0} {e.x2},0 {e.x4},{e.y2} ' +\n                      '{e.x4},{e.y1} {e.x2},0 {e.x1},{e.y3} {e.x0},{e.y3} ' +\n                      '{e.x3},0 {e.x5},{e.y1} {e.x5},{e.y2} {e.x3},0 z',\n        height: 17.5,\n        width:  17.5,\n        heightElements: [8.5, 6.5312, -6.5312, -8.5],\n        widthElements:  [6.5, -6.5, 3, -3, 5, -5]\n      },\n      'GATEWAY_PARALLEL': {\n        d:'m {mx},{my} 0,{e.y1} -{e.x1},0 0,{e.y0} {e.x1},0 0,{e.y1} {e.x0},0 ' +\n          '0,-{e.y1} {e.x1},0 0,-{e.y0} -{e.x1},0 0,-{e.y1} -{e.x0},0 z',\n        height: 30,\n        width:  30,\n        heightElements: [5, 12.5],\n        widthElements: [5, 12.5]\n      },\n      'TEXT_ANNOTATION': {\n        d: 'm {mx}, {my} m 10,0 l -10,0 l 0,{e.y0} l 10,0',\n        height: 30,\n        width: 10,\n        heightElements: [30],\n        widthElements: [10]\n      },\n      'MARKER_SUB_PROCESS': {\n        d: 'm{mx},{my} m 7,2 l 0,10 m -5,-5 l 10,0',\n        height: 10,\n        width: 10,\n        heightElements: [],\n        widthElements: []\n      },\n      'TASK_TYPE_SCRIPT': {\n        d: 'm {mx},{my} c 9.966553,-6.27276 -8.000926,-7.91932 2.968968,-14.938 l -8.802728,0 ' +\n          'c -10.969894,7.01868 6.997585,8.66524 -2.968967,14.938 z ' +\n          'm -7,-12 l 5,0 ' +\n          'm -4.5,3 l 4.5,0 ' +\n          'm -3,3 l 5,0' +\n          'm -4,3 l 5,0',\n        height: 15,\n        width:  12.6,\n        heightElements: [6, 14],\n        widthElements: [10.5, 21]\n      },\n      'TASK_TYPE_USER_1': {\n        d: 'm {mx},{my} c 0.909,-0.845 1.594,-2.049 1.594,-3.385 0,-2.554 -1.805,-4.62199999 ' +\n          '-4.357,-4.62199999 -2.55199998,0 -4.28799998,2.06799999 -4.28799998,4.62199999 0,1.348 ' +\n          '0.974,2.562 1.89599998,3.405 -0.52899998,0.187 -5.669,2.097 -5.794,4.7560005 v 6.718 ' +\n          'h 17 v -6.718 c 0,-2.2980005 -5.5279996,-4.5950005 -6.0509996,-4.7760005 z' +\n          'm -8,6 l 0,5.5 m 11,0 l 0,-5'\n      },\n      'TASK_TYPE_USER_2': {\n        d: 'm {mx},{my} m 2.162,1.009 c 0,2.4470005 -2.158,4.4310005 -4.821,4.4310005 ' +\n          '-2.66499998,0 -4.822,-1.981 -4.822,-4.4310005 '\n      },\n      'TASK_TYPE_USER_3': {\n        d: 'm {mx},{my} m -6.9,-3.80 c 0,0 2.25099998,-2.358 4.27399998,-1.177 2.024,1.181 4.221,1.537 ' +\n          '4.124,0.965 -0.098,-0.57 -0.117,-3.79099999 -4.191,-4.13599999 -3.57499998,0.001 ' +\n          '-4.20799998,3.36699999 -4.20699998,4.34799999 z'\n      }\n    };\n\n  \n    this.getRawPath = function getRawPath(pathId) {\n      return this.pathMap[pathId].d;\n    };\n  \n    /**\n     * Scales the path to the given height and width.\n     * <h1>Use case</h1>\n     * <p>Use case is to scale the content of elements (event, gateways) based\n     * on the element bounding box's size.\n     * </p>\n     * <h1>Why not transform</h1>\n     * <p>Scaling a path with transform() will also scale the stroke and IE does not support\n     * the option 'non-scaling-stroke' to prevent this.\n     * Also there are use cases where only some parts of a path should be\n     * scaled.</p>\n     *\n     * @param {string} pathId The ID of the path.\n     * @param {Object} param <p>\n     *   Example param object scales the path to 60% size of the container (data.width, data.height).\n     *   <pre>\n     *   {\n     *     xScaleFactor: 0.6,\n     *     yScaleFactor:0.6,\n     *     containerWidth: data.width,\n     *     containerHeight: data.height,\n     *     position: {\n     *       mx: 0.46,\n     *       my: 0.2,\n     *     }\n     *   }\n     *   </pre>\n     *   <ul>\n     *    <li>targetpathwidth = xScaleFactor * containerWidth</li>\n     *    <li>targetpathheight = yScaleFactor * containerHeight</li>\n     *    <li>Position is used to set the starting coordinate of the path. M is computed:\n      *    <ul>\n      *      <li>position.x * containerWidth</li>\n      *      <li>position.y * containerHeight</li>\n      *    </ul>\n      *    Center of the container <pre> position: {\n     *       mx: 0.5,\n     *       my: 0.5,\n     *     }</pre>\n     *     Upper left corner of the container\n     *     <pre> position: {\n     *       mx: 0.0,\n     *       my: 0.0,\n     *     }</pre>\n     *    </li>\n     *   </ul>\n     * </p>\n     *\n     */\n    this.getScaledPath = function getScaledPath(pathId, param) {\n      var mx, my;\n      if (param.abspos) {\n        mx = param.abspos.x;\n        my = param.abspos.y;\n      } else {\n        mx = param.containerWidth * param.position.mx;\n        my = param.containerHeight * param.position.my;\n      }\n\n      var rawPath = {}\n      if(typeof pathId == 'object'){\n        rawPath = pathId;\n        if(rawPath.d.indexOf('{mx},{my}') == -1){\n          rawPath.d = \"m {mx},{my}\" +  rawPath.d\n        }\n        \n        if(rawPath.width){\n          mx = mx - rawPath.width/2;\n        }\n        if(rawPath.height){\n          my = my - rawPath.height/2;\n        }\n      }\n      else{\n        rawPath = this.pathMap[pathId];\n       \n      }\n      \n      // positioning\n      // compute the start point of the path\n  \n      var coordinates = {}; // map for the scaled coordinates\n      if (param.position) {\n  \n        // path\n        var heightRatio = (param.containerHeight / rawPath.height) * param.yScaleFactor;\n        var widthRatio = (param.containerWidth / rawPath.width) * param.xScaleFactor;\n  \n  \n        // Apply height ratio\n        for (var heightIndex = 0; heightIndex < rawPath.heightElements.length; heightIndex++) {\n          coordinates['y' + heightIndex] = rawPath.heightElements[heightIndex] * heightRatio;\n        }\n  \n        // Apply width ratio\n        for (var widthIndex = 0; widthIndex < rawPath.widthElements.length; widthIndex++) {\n          coordinates['x' + widthIndex] = rawPath.widthElements[widthIndex] * widthRatio;\n        }\n      }\n  \n      // Apply value to raw path\n      var path = format(\n        rawPath.d, {\n          mx: mx,\n          my: my,\n          e: coordinates\n        }\n      );\n      return path;\n    };\n\n   \n  }\n  \n  // helpers //////////////////////\n  \n  // copied from https://github.com/adobe-webplatform/Snap.svg/blob/master/src/svg.js\n  var tokenRegex = /\\{([^}]+)\\}/g,\n      objNotationRegex = /(?:(?:^|\\.)(.+?)(?=\\[|\\.|$|\\()|\\[('|\")(.+?)\\2\\])(\\(\\))?/g; // matches .xxxxx or [\"xxxxx\"] to run over object properties\n  \n  function replacer(all, key, obj) {\n    var res = obj;\n    key.replace(objNotationRegex, function(all, name, quote, quotedName, isFunc) {\n      name = name || quotedName;\n      if (res) {\n        if (name in res) {\n          res = res[name];\n        }\n        typeof res == 'function' && isFunc && (res = res());\n      }\n    });\n    res = (res == null || res == obj ? all : res) + '';\n  \n    return res;\n  }\n  \n  function format(str, obj) {\n    return String(str).replace(tokenRegex, function(all, key) {\n      return replacer(all, key, obj);\n    });\n  }\n  ","import myRenderer from './myRenderer';\nimport textRenderer from './textRenderer';\nimport pathMap from './pathMap';\n\nexport default {\n  __init__: [ 'myRenderer' ],\n  myRenderer: [ 'type', myRenderer ],\n  textRenderer: [ 'type', textRenderer ],\n  pathMap: [ 'type', pathMap ]\n};","import {\n  getType as getElementType\n} from '../../util/Elements';\n\n/**\n * Adds change support to the diagram, including\n *\n * <ul>\n *   <li>redrawing shapes and connections on change</li>\n * </ul>\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {ElementRegistry} elementRegistry\n * @param {GraphicsFactory} graphicsFactory\n */\nexport default function ChangeSupport(\n    eventBus, canvas, elementRegistry,\n    graphicsFactory) {\n\n\n  // redraw shapes / connections on change\n\n  eventBus.on('element.changed', function(event) {\n\n    var element = event.element;\n\n    // element might have been deleted and replaced by new element with same ID\n    // thus check for parent of element except for root element\n    if (element.parent || element === canvas.getRootElement()) {\n      event.gfx = elementRegistry.getGraphics(element);\n    }\n\n    // shape + gfx may have been deleted\n    if (!event.gfx) {\n      return;\n    }\n\n    eventBus.fire(getElementType(element) + '.changed', event);\n  });\n\n  eventBus.on('elements.changed', function(event) {\n\n    var elements = event.elements;\n\n    elements.forEach(function(e) {\n      eventBus.fire('element.changed', { element: e });\n    });\n\n    graphicsFactory.updateContainments(elements);\n  });\n\n  eventBus.on('shape.changed', function(event) {\n    graphicsFactory.update('shape', event.element, event.gfx);\n  });\n\n  eventBus.on('connection.changed', function(event) {\n    graphicsFactory.update('connection', event.element, event.gfx);\n  });\n}\n\nChangeSupport.$inject = [\n  'eventBus',\n  'canvas',\n  'elementRegistry',\n  'graphicsFactory'\n];","import ChangeSupport from './ChangeSupport';\n\nexport default {\n  __init__: [ 'changeSupport'],\n  changeSupport: [ 'type', ChangeSupport ]\n};","import {\n  filter,\n  isNumber\n} from 'min-dash';\n\nvar max = Math.max,\n    min = Math.min;\n\nvar DEFAULT_CHILD_BOX_PADDING = 20;\n\nimport {\n  getBBox\n} from '../../util/Elements';\n\nimport {\n  asTRBL,\n  asBounds\n} from '../../layout/LayoutUtil';\n\n\n/**\n * Substract a TRBL from another\n *\n * @param  {TRBL} trblA\n * @param  {TRBL} trblB\n *\n * @return {TRBL}\n */\nexport function substractTRBL(trblA, trblB) {\n  return {\n    top: trblA.top - trblB.top,\n    right: trblA.right - trblB.right,\n    bottom: trblA.bottom - trblB.bottom,\n    left: trblA.left - trblB.left\n  };\n}\n\n/**\n * Resize the given bounds by the specified delta from a given anchor point.\n *\n * @param {Bounds} bounds the bounding box that should be resized\n * @param {string} direction in which the element is resized (nw, ne, se, sw)\n * @param {Point} delta of the resize operation\n *\n * @return {Bounds} resized bounding box\n */\nexport function resizeBounds(bounds, direction, delta) {\n  var dx = delta.x,\n      dy = delta.y;\n\n  var newBounds = {\n    x: bounds.x,\n    y: bounds.y,\n    width: bounds.width,\n    height: bounds.height\n  };\n\n  if (direction.indexOf('n') !== -1) {\n    newBounds.y = bounds.y + dy;\n    newBounds.height = bounds.height - dy;\n  } else if (direction.indexOf('s') !== -1) {\n    newBounds.height = bounds.height + dy;\n  }\n\n  if (direction.indexOf('e') !== -1) {\n    newBounds.width = bounds.width + dx;\n  } else if (direction.indexOf('w') !== -1) {\n    newBounds.x = bounds.x + dx;\n    newBounds.width = bounds.width - dx;\n  }\n\n  return newBounds;\n}\n\n\n/**\n * Resize the given bounds by applying the passed\n * { top, right, bottom, left } delta.\n *\n * @param {Bounds} bounds\n * @param {TRBL} trblResize\n *\n * @return {Bounds}\n */\nexport function resizeTRBL(bounds, resize) {\n  return {\n    x: bounds.x + (resize.left || 0),\n    y: bounds.y + (resize.top || 0),\n    width: bounds.width - (resize.left || 0) + (resize.right || 0),\n    height: bounds.height - (resize.top || 0) + (resize.bottom || 0)\n  };\n}\n\n\nexport function reattachPoint(bounds, newBounds, point) {\n\n  var sx = bounds.width / newBounds.width,\n      sy = bounds.height / newBounds.height;\n\n  return {\n    x: Math.round((newBounds.x + newBounds.width / 2)) - Math.floor(((bounds.x + bounds.width / 2) - point.x) / sx),\n    y: Math.round((newBounds.y + newBounds.height / 2)) - Math.floor(((bounds.y + bounds.height / 2) - point.y) / sy)\n  };\n}\n\n\nfunction applyConstraints(attr, trbl, resizeConstraints) {\n\n  var value = trbl[attr],\n      minValue = resizeConstraints.min && resizeConstraints.min[attr],\n      maxValue = resizeConstraints.max && resizeConstraints.max[attr];\n\n  if (isNumber(minValue)) {\n    value = (/top|left/.test(attr) ? min : max)(value, minValue);\n  }\n\n  if (isNumber(maxValue)) {\n    value = (/top|left/.test(attr) ? max : min)(value, maxValue);\n  }\n\n  return value;\n}\n\nexport function ensureConstraints(currentBounds, resizeConstraints) {\n\n  if (!resizeConstraints) {\n    return currentBounds;\n  }\n\n  var currentTrbl = asTRBL(currentBounds);\n\n  return asBounds({\n    top: applyConstraints('top', currentTrbl, resizeConstraints),\n    right: applyConstraints('right', currentTrbl, resizeConstraints),\n    bottom: applyConstraints('bottom', currentTrbl, resizeConstraints),\n    left: applyConstraints('left', currentTrbl, resizeConstraints)\n  });\n}\n\n\nexport function getMinResizeBounds(direction, currentBounds, minDimensions, childrenBounds) {\n\n  var currentBox = asTRBL(currentBounds);\n\n  var minBox = {\n    top: /n/.test(direction) ? currentBox.bottom - minDimensions.height : currentBox.top,\n    left: /w/.test(direction) ? currentBox.right - minDimensions.width : currentBox.left,\n    bottom: /s/.test(direction) ? currentBox.top + minDimensions.height : currentBox.bottom,\n    right: /e/.test(direction) ? currentBox.left + minDimensions.width : currentBox.right\n  };\n\n  var childrenBox = childrenBounds ? asTRBL(childrenBounds) : minBox;\n\n  var combinedBox = {\n    top: min(minBox.top, childrenBox.top),\n    left: min(minBox.left, childrenBox.left),\n    bottom: max(minBox.bottom, childrenBox.bottom),\n    right: max(minBox.right, childrenBox.right)\n  };\n\n  return asBounds(combinedBox);\n}\n\nfunction asPadding(mayBePadding, defaultValue) {\n  if (typeof mayBePadding !== 'undefined') {\n    return mayBePadding;\n  } else {\n    return DEFAULT_CHILD_BOX_PADDING;\n  }\n}\n\nexport function addPadding(bbox, padding) {\n  var left, right, top, bottom;\n\n  if (typeof padding === 'object') {\n    left = asPadding(padding.left);\n    right = asPadding(padding.right);\n    top = asPadding(padding.top);\n    bottom = asPadding(padding.bottom);\n  } else {\n    left = right = top = bottom = asPadding(padding);\n  }\n\n  return {\n    x: bbox.x - left,\n    y: bbox.y - top,\n    width: bbox.width + left + right,\n    height: bbox.height + top + bottom\n  };\n}\n\n\n/**\n * Is the given element part of the resize\n * targets min boundary box?\n *\n * This is the default implementation which excludes\n * connections and labels.\n *\n * @param {djs.model.Base} element\n */\nfunction isBBoxChild(element) {\n\n  // exclude connections\n  if (element.waypoints) {\n    return false;\n  }\n\n  // exclude labels\n  if (element.type === 'label') {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Return children bounding computed from a shapes children\n * or a list of prefiltered children.\n *\n * @param  {djs.model.Shape|Array<djs.model.Shape>} shapeOrChildren\n * @param  {number|Object} padding\n *\n * @return {Bounds}\n */\nexport function computeChildrenBBox(shapeOrChildren, padding) {\n\n  var elements;\n\n  // compute based on shape\n  if (shapeOrChildren.length === undefined) {\n\n    // grab all the children that are part of the\n    // parents children box\n    elements = filter(shapeOrChildren.children, isBBoxChild);\n\n  } else {\n    elements = shapeOrChildren;\n  }\n\n  if (elements.length) {\n    return addPadding(getBBox(elements), padding);\n  }\n}\n","import {\n  pick,\n  assign\n} from 'min-dash';\n\nimport {\n  resizeBounds,\n  ensureConstraints,\n  computeChildrenBBox,\n  getMinResizeBounds\n} from './ResizeUtil';\n\nimport {\n  asTRBL,\n  getMid,\n  roundBounds\n} from '../../layout/LayoutUtil';\n\nvar DEFAULT_MIN_WIDTH = 10;\n\n\n/**\n * A component that provides resizing of shapes on the canvas.\n *\n * The following components are part of shape resize:\n *\n *  * adding resize handles,\n *  * creating a visual during resize\n *  * checking resize rules\n *  * committing a change once finished\n *\n *\n * ## Customizing\n *\n * It's possible to customize the resizing behaviour by intercepting 'resize.start'\n * and providing the following parameters through the 'context':\n *\n *   * minDimensions ({ width, height }): minimum shape dimensions\n *\n *   * childrenBoxPadding ({ left, top, bottom, right } || number):\n *     gap between the minimum bounding box and the container\n *\n * f.ex:\n *\n * ```javascript\n * eventBus.on('resize.start', 1500, function(event) {\n *   var context = event.context,\n *\n *  context.minDimensions = { width: 140, height: 120 };\n *\n *  // Passing general padding\n *  context.childrenBoxPadding = 30;\n *\n *  // Passing padding to a specific side\n *  context.childrenBoxPadding.left = 20;\n * });\n * ```\n */\nexport default function Resize(eventBus, rules, modeling, dragging) {\n\n  this._dragging = dragging;\n  this._rules = rules;\n\n  var self = this;\n\n\n  /**\n   * Handle resize move by specified delta.\n   *\n   * @param {Object} context\n   * @param {Point} delta\n   */\n  function handleMove(context, delta) {\n\n    var shape = context.shape,\n        direction = context.direction,\n        resizeConstraints = context.resizeConstraints,\n        newBounds;\n\n    context.delta = delta;\n\n    newBounds = resizeBounds(shape, direction, delta);\n\n    // ensure constraints during resize\n    context.newBounds = ensureConstraints(newBounds, resizeConstraints);\n\n    // update + cache executable state\n    context.canExecute = self.canResize(context);\n  }\n\n  /**\n   * Handle resize start.\n   *\n   * @param  {Object} context\n   */\n  function handleStart(context) {\n\n    var resizeConstraints = context.resizeConstraints,\n\n        // evaluate minBounds for backwards compatibility\n        minBounds = context.minBounds;\n\n    if (resizeConstraints !== undefined) {\n      return;\n    }\n\n    if (minBounds === undefined) {\n      minBounds = self.computeMinResizeBox(context);\n    }\n\n    context.resizeConstraints = {\n      min: asTRBL(minBounds)\n    };\n  }\n\n  /**\n   * Handle resize end.\n   *\n   * @param  {Object} context\n   */\n  function handleEnd(context) {\n    var shape = context.shape,\n        canExecute = context.canExecute,\n        newBounds = context.newBounds;\n\n    if (canExecute) {\n\n      // ensure we have actual pixel values for new bounds\n      // (important when zoom level was > 1 during move)\n      newBounds = roundBounds(newBounds);\n\n      if (!boundsChanged(shape, newBounds)) {\n\n        // no resize necessary\n        return;\n      }\n\n      // perform the actual resize\n      modeling.resizeShape(shape, newBounds);\n    }\n  }\n\n\n  eventBus.on('resize.start', function(event) {\n    handleStart(event.context);\n  });\n\n  eventBus.on('resize.move', function(event) {\n    var delta = {\n      x: event.dx,\n      y: event.dy\n    };\n\n    handleMove(event.context, delta);\n  });\n\n  eventBus.on('resize.end', function(event) {\n    handleEnd(event.context);\n  });\n\n}\n\n\nResize.prototype.canResize = function(context) {\n  var rules = this._rules;\n\n  var ctx = pick(context, [ 'newBounds', 'shape', 'delta', 'direction' ]);\n\n  return rules.allowed('shape.resize', ctx);\n};\n\n/**\n * Activate a resize operation.\n *\n * You may specify additional contextual information and must specify a\n * resize direction during activation of the resize event.\n *\n * @param {MouseEvent} event\n * @param {djs.model.Shape} shape\n * @param {Object|string} contextOrDirection\n */\nResize.prototype.activate = function(event, shape, contextOrDirection) {\n  var dragging = this._dragging,\n      context,\n      direction;\n\n  if (typeof contextOrDirection === 'string') {\n    contextOrDirection = {\n      direction: contextOrDirection\n    };\n  }\n\n  context = assign({ shape: shape }, contextOrDirection);\n\n  direction = context.direction;\n\n  if (!direction) {\n    throw new Error('must provide a direction (n|w|s|e|nw|se|ne|sw)');\n  }\n\n  dragging.init(event, getReferencePoint(shape, direction), 'resize', {\n    autoActivate: true,\n    cursor: getCursor(direction),\n    data: {\n      shape: shape,\n      context: context\n    }\n  });\n};\n\nResize.prototype.computeMinResizeBox = function(context) {\n  var shape = context.shape,\n      direction = context.direction,\n      minDimensions,\n      childrenBounds;\n\n  minDimensions = context.minDimensions || {\n    width: DEFAULT_MIN_WIDTH,\n    height: DEFAULT_MIN_WIDTH\n  };\n\n  // get children bounds\n  childrenBounds = computeChildrenBBox(shape, context.childrenBoxPadding);\n\n  // get correct minimum bounds from given resize direction\n  // basically ensures that the minBounds is max(childrenBounds, minDimensions)\n  return getMinResizeBounds(direction, shape, minDimensions, childrenBounds);\n};\n\n\nResize.$inject = [\n  'eventBus',\n  'rules',\n  'modeling',\n  'dragging'\n];\n\n// helpers //////////\n\nfunction boundsChanged(shape, newBounds) {\n  return shape.x !== newBounds.x ||\n    shape.y !== newBounds.y ||\n    shape.width !== newBounds.width ||\n    shape.height !== newBounds.height;\n}\n\nexport function getReferencePoint(shape, direction) {\n  var mid = getMid(shape),\n      trbl = asTRBL(shape);\n\n  var referencePoint = {\n    x: mid.x,\n    y: mid.y\n  };\n\n  if (direction.indexOf('n') !== -1) {\n    referencePoint.y = trbl.top;\n  } else if (direction.indexOf('s') !== -1) {\n    referencePoint.y = trbl.bottom;\n  }\n\n  if (direction.indexOf('e') !== -1) {\n    referencePoint.x = trbl.right;\n  } else if (direction.indexOf('w') !== -1) {\n    referencePoint.x = trbl.left;\n  }\n\n  return referencePoint;\n}\n\nfunction getCursor(direction) {\n  var prefix = 'resize-';\n\n  if (direction === 'n' || direction === 's') {\n    return prefix + 'ns';\n  } else if (direction === 'e' || direction === 'w') {\n    return prefix + 'ew';\n  } else if (direction === 'nw' || direction === 'se') {\n    return prefix + 'nwse';\n  } else {\n    return prefix + 'nesw';\n  }\n}","var MARKER_RESIZING = 'djs-resizing',\n    MARKER_RESIZE_NOT_OK = 'resize-not-ok';\n\nvar LOW_PRIORITY = 500;\n\nimport {\n  attr as svgAttr,\n  remove as svgRemove,\n  classes as svgClasses\n} from 'tiny-svg';\n\n\n/**\n * Provides previews for resizing shapes when resizing.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {PreviewSupport} previewSupport\n */\nexport default function ResizePreview(eventBus, canvas, previewSupport) {\n\n  /**\n   * Update resizer frame.\n   *\n   * @param {Object} context\n   */\n  function updateFrame(context) {\n\n    var shape = context.shape,\n        bounds = context.newBounds,\n        frame = context.frame;\n\n    if (!frame) {\n      frame = context.frame = previewSupport.addFrame(shape, canvas.getDefaultLayer());\n\n      canvas.addMarker(shape, MARKER_RESIZING);\n    }\n\n    if (bounds.width > 5) {\n      svgAttr(frame, { x: bounds.x, width: bounds.width });\n    }\n\n    if (bounds.height > 5) {\n      svgAttr(frame, { y: bounds.y, height: bounds.height });\n    }\n\n    if (context.canExecute) {\n      svgClasses(frame).remove(MARKER_RESIZE_NOT_OK);\n    } else {\n      svgClasses(frame).add(MARKER_RESIZE_NOT_OK);\n    }\n  }\n\n  /**\n   * Remove resizer frame.\n   *\n   * @param {Object} context\n   */\n  function removeFrame(context) {\n    var shape = context.shape,\n        frame = context.frame;\n\n    if (frame) {\n      svgRemove(context.frame);\n    }\n\n    canvas.removeMarker(shape, MARKER_RESIZING);\n  }\n\n  // add and update previews\n  eventBus.on('resize.move', LOW_PRIORITY, function(event) {\n    updateFrame(event.context);\n  });\n\n  // remove previews\n  eventBus.on('resize.cleanup', function(event) {\n    removeFrame(event.context);\n  });\n\n}\n\nResizePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'previewSupport'\n];","import {\n  bind,\n  forEach\n} from 'min-dash';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  clear as svgClear,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  isPrimaryButton\n} from '../../util/Mouse';\n\nimport {\n  transform\n} from '../../util/SvgTransformUtil';\n\nimport { getReferencePoint } from './Resize';\n\nvar HANDLE_OFFSET = -6,\n    HANDLE_SIZE = 4,\n    HANDLE_HIT_SIZE = 20;\n\nvar CLS_RESIZER = 'djs-resizer';\n\nvar directions = [ 'n', 'w', 's', 'e', 'nw', 'ne', 'se', 'sw' ];\n\n\n/**\n * This component is responsible for adding resize handles.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Selection} selection\n * @param {Resize} resize\n */\nexport default function ResizeHandles(eventBus, canvas, selection, resize) {\n\n  this._resize = resize;\n  this._canvas = canvas;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n    var newSelection = e.newSelection;\n\n    // remove old selection markers\n    self.removeResizers();\n\n    // add new selection markers ONLY if single selection\n    if (newSelection.length === 1) {\n      forEach(newSelection, bind(self.addResizer, self));\n    }\n  });\n\n  eventBus.on('shape.changed', function(e) {\n    var shape = e.element;\n\n    if (selection.isSelected(shape)) {\n      self.removeResizers();\n\n      self.addResizer(shape);\n    }\n  });\n}\n\n\nResizeHandles.prototype.makeDraggable = function(element, gfx, direction) {\n  var resize = this._resize;\n\n  function startResize(event) {\n\n    // only trigger on left mouse button\n    if (isPrimaryButton(event)) {\n      resize.activate(event, element, direction);\n    }\n  }\n\n  domEvent.bind(gfx, 'mousedown', startResize);\n  domEvent.bind(gfx, 'touchstart', startResize);\n};\n\n\nResizeHandles.prototype._createResizer = function(element, x, y, direction) {\n  var resizersParent = this._getResizersParent();\n\n  var offset = getHandleOffset(direction);\n\n  var group = svgCreate('g');\n\n  svgClasses(group).add(CLS_RESIZER);\n  svgClasses(group).add(CLS_RESIZER + '-' + element.id);\n  svgClasses(group).add(CLS_RESIZER + '-' + direction);\n\n  svgAppend(resizersParent, group);\n\n  var visual = svgCreate('rect');\n\n  svgAttr(visual, {\n    x: -HANDLE_SIZE / 2 + offset.x,\n    y: -HANDLE_SIZE / 2 + offset.y,\n    width: HANDLE_SIZE,\n    height: HANDLE_SIZE\n  });\n\n  svgClasses(visual).add(CLS_RESIZER + '-visual');\n\n  svgAppend(group, visual);\n\n  var hit = svgCreate('rect');\n\n  svgAttr(hit, {\n    x: -HANDLE_HIT_SIZE / 2 + offset.x,\n    y: -HANDLE_HIT_SIZE / 2 + offset.y,\n    width: HANDLE_HIT_SIZE,\n    height: HANDLE_HIT_SIZE\n  });\n\n  svgClasses(hit).add(CLS_RESIZER + '-hit');\n\n  svgAppend(group, hit);\n\n  transform(group, x, y);\n\n  return group;\n};\n\nResizeHandles.prototype.createResizer = function(element, direction) {\n  var point = getReferencePoint(element, direction);\n\n  var resizer = this._createResizer(element, point.x, point.y, direction);\n\n  this.makeDraggable(element, resizer, direction);\n};\n\n// resize handles implementation ///////////////////////////////\n\n/**\n * Add resizers for a given element.\n *\n * @param {djs.model.Shape} shape\n */\nResizeHandles.prototype.addResizer = function(shape) {\n  var self = this;\n\n  var resize = this._resize;\n\n  if (!resize.canResize({ shape: shape })) {\n    return;\n  }\n\n  forEach(directions, function(direction) {\n    self.createResizer(shape, direction);\n  });\n};\n\n/**\n * Remove all resizers\n */\nResizeHandles.prototype.removeResizers = function() {\n  var resizersParent = this._getResizersParent();\n\n  svgClear(resizersParent);\n};\n\nResizeHandles.prototype._getResizersParent = function() {\n  return this._canvas.getLayer('resizers');\n};\n\nResizeHandles.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'resize'\n];\n\n// helpers //////////\n\nfunction getHandleOffset(direction) {\n  var offset = {\n    x: 0,\n    y: 0\n  };\n\n  if (direction.indexOf('e') !== -1) {\n    offset.x = -HANDLE_OFFSET;\n  } else if (direction.indexOf('w') !== -1) {\n    offset.x = HANDLE_OFFSET;\n  }\n\n  if (direction.indexOf('s') !== -1) {\n    offset.y = -HANDLE_OFFSET;\n  } else if (direction.indexOf('n') !== -1) {\n    offset.y = HANDLE_OFFSET;\n  }\n\n  return offset;\n}","import RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\n\nimport Resize from './Resize';\nimport ResizePreview from './ResizePreview';\nimport ResizeHandles from './ResizeHandles';\n\nexport default {\n  __depends__: [\n    RulesModule,\n    DraggingModule,\n    PreviewSupportModule\n  ],\n  __init__: [\n    'resize',\n    'resizePreview',\n    'resizeHandles'\n  ],\n  resize: [ 'type', Resize ],\n  resizePreview: [ 'type', ResizePreview ],\n  resizeHandles: [ 'type', ResizeHandles ]\n};\n","import {\n  assign,\n  bind,\n  pick\n} from 'min-dash';\n\nimport {\n  domify,\n  query as domQuery,\n  event as domEvent,\n  remove as domRemove\n} from 'min-dom';\n\nvar min = Math.min,\n    max = Math.max;\n\nfunction preventDefault(e) {\n  e.preventDefault();\n}\n\nfunction stopPropagation(e) {\n  e.stopPropagation();\n}\n\nfunction isTextNode(node) {\n  return node.nodeType === Node.TEXT_NODE;\n}\n\nfunction toArray(nodeList) {\n  return [].slice.call(nodeList);\n}\n\n/**\n * Initializes a container for a content editable div.\n *\n * Structure:\n *\n * container\n *   parent\n *     content\n *     resize-handle\n *\n * @param {object} options\n * @param {DOMElement} options.container The DOM element to append the contentContainer to\n * @param {Function} options.keyHandler Handler for key events\n * @param {Function} options.resizeHandler Handler for resize events\n */\nexport default function TextBox(options) {\n  this.container = options.container;\n\n  this.parent = domify(\n    '<div class=\"djs-direct-editing-parent\">' +\n      '<div class=\"djs-direct-editing-content\" contenteditable=\"true\"></div>' +\n    '</div>'\n  );\n\n  this.content = domQuery('[contenteditable]', this.parent);\n\n  this.keyHandler = options.keyHandler || function() {};\n  this.resizeHandler = options.resizeHandler || function() {};\n\n  this.autoResize = bind(this.autoResize, this);\n  this.handlePaste = bind(this.handlePaste, this);\n}\n\n\n/**\n * Create a text box with the given position, size, style and text content\n *\n * @param {Object} bounds\n * @param {Number} bounds.x absolute x position\n * @param {Number} bounds.y absolute y position\n * @param {Number} [bounds.width] fixed width value\n * @param {Number} [bounds.height] fixed height value\n * @param {Number} [bounds.maxWidth] maximum width value\n * @param {Number} [bounds.maxHeight] maximum height value\n * @param {Number} [bounds.minWidth] minimum width value\n * @param {Number} [bounds.minHeight] minimum height value\n * @param {Object} [style]\n * @param {String} value text content\n *\n * @return {DOMElement} The created content DOM element\n */\nTextBox.prototype.create = function(bounds, style, value, options) {\n  var self = this;\n\n  var parent = this.parent,\n      content = this.content,\n      container = this.container;\n\n  options = this.options = options || {};\n\n  style = this.style = style || {};\n\n  var parentStyle = pick(style, [\n    'width',\n    'height',\n    'maxWidth',\n    'maxHeight',\n    'minWidth',\n    'minHeight',\n    'left',\n    'top',\n    'backgroundColor',\n    'position',\n    'overflow',\n    'border',\n    'wordWrap',\n    'textAlign',\n    'outline',\n    'transform'\n  ]);\n\n  assign(parent.style, {\n    width: bounds.width + 'px',\n    height: bounds.height + 'px',\n    maxWidth: bounds.maxWidth + 'px',\n    maxHeight: bounds.maxHeight + 'px',\n    minWidth: bounds.minWidth + 'px',\n    minHeight: bounds.minHeight + 'px',\n    left: bounds.x + 'px',\n    top: bounds.y + 'px',\n    backgroundColor: '#ffffff',\n    position: 'absolute',\n    overflow: 'visible',\n    border: '1px solid #ccc',\n    boxSizing: 'border-box',\n    wordWrap: 'normal',\n    textAlign: 'center',\n    outline: 'none'\n  }, parentStyle);\n\n  var contentStyle = pick(style, [\n    'fontFamily',\n    'fontSize',\n    'fontWeight',\n    'lineHeight',\n    'padding',\n    'paddingTop',\n    'paddingRight',\n    'paddingBottom',\n    'paddingLeft'\n  ]);\n\n  assign(content.style, {\n    boxSizing: 'border-box',\n    width: '100%',\n    outline: 'none',\n    wordWrap: 'break-word'\n  }, contentStyle);\n\n  if (options.centerVertically) {\n    assign(content.style, {\n      position: 'absolute',\n      top: '50%',\n      transform: 'translate(0, -50%)'\n    }, contentStyle);\n  }\n\n  content.innerText = value;\n\n  domEvent.bind(content, 'keydown', this.keyHandler);\n  domEvent.bind(content, 'mousedown', stopPropagation);\n  domEvent.bind(content, 'paste', self.handlePaste);\n\n  if (options.autoResize) {\n    domEvent.bind(content, 'input', this.autoResize);\n  }\n\n  if (options.resizable) {\n    this.resizable(style);\n  }\n\n  container.appendChild(parent);\n\n  // set selection to end of text\n  this.setSelection(content.lastChild, content.lastChild && content.lastChild.length);\n\n  return parent;\n};\n\n/**\n * Intercept paste events to remove formatting from pasted text.\n */\nTextBox.prototype.handlePaste = function(e) {\n  var options = this.options,\n      style = this.style;\n\n  e.preventDefault();\n\n  var text;\n\n  if (e.clipboardData) {\n\n    // Chrome, Firefox, Safari\n    text = e.clipboardData.getData('text/plain');\n  } else {\n\n    // Internet Explorer\n    text = window.clipboardData.getData('Text');\n  }\n\n  this.insertText(text);\n\n  if (options.autoResize) {\n    var hasResized = this.autoResize(style);\n\n    if (hasResized) {\n      this.resizeHandler(hasResized);\n    }\n  }\n};\n\nTextBox.prototype.insertText = function(text) {\n\n  // insertText command not supported by Internet Explorer\n  var success = document.execCommand('insertText', false, text);\n\n  if (success) {\n    return;\n  }\n\n  this._insertTextIE(text);\n};\n\nTextBox.prototype._insertTextIE = function(text) {\n\n  // Internet Explorer\n  var range = this.getSelection(),\n      startContainer = range.startContainer,\n      endContainer = range.endContainer,\n      startOffset = range.startOffset,\n      endOffset = range.endOffset,\n      commonAncestorContainer = range.commonAncestorContainer;\n\n  var childNodesArray = toArray(commonAncestorContainer.childNodes);\n\n  var container,\n      offset;\n\n  if (isTextNode(commonAncestorContainer)) {\n    var containerTextContent = startContainer.textContent;\n\n    startContainer.textContent =\n      containerTextContent.substring(0, startOffset)\n      + text\n      + containerTextContent.substring(endOffset);\n\n    container = startContainer;\n    offset = startOffset + text.length;\n\n  } else if (startContainer === this.content && endContainer === this.content) {\n    var textNode = document.createTextNode(text);\n\n    this.content.insertBefore(textNode, childNodesArray[startOffset]);\n\n    container = textNode;\n    offset = textNode.textContent.length;\n  } else {\n    var startContainerChildIndex = childNodesArray.indexOf(startContainer),\n        endContainerChildIndex = childNodesArray.indexOf(endContainer);\n\n    childNodesArray.forEach(function(childNode, index) {\n\n      if (index === startContainerChildIndex) {\n        childNode.textContent =\n          startContainer.textContent.substring(0, startOffset) +\n          text +\n          endContainer.textContent.substring(endOffset);\n      } else if (index > startContainerChildIndex && index <= endContainerChildIndex) {\n        domRemove(childNode);\n      }\n    });\n\n    container = startContainer;\n    offset = startOffset + text.length;\n  }\n\n  if (container && offset !== undefined) {\n\n    // is necessary in Internet Explorer\n    setTimeout(function() {\n      self.setSelection(container, offset);\n    });\n  }\n};\n\n/**\n * Automatically resize element vertically to fit its content.\n */\nTextBox.prototype.autoResize = function() {\n  var parent = this.parent,\n      content = this.content;\n\n  var fontSize = parseInt(this.style.fontSize) || 12;\n\n  if (content.scrollHeight > parent.offsetHeight ||\n      content.scrollHeight < parent.offsetHeight - fontSize) {\n    var bounds = parent.getBoundingClientRect();\n\n    var height = content.scrollHeight;\n    parent.style.height = height + 'px';\n\n    this.resizeHandler({\n      width: bounds.width,\n      height: bounds.height,\n      dx: 0,\n      dy: height - bounds.height\n    });\n  }\n};\n\n/**\n * Make an element resizable by adding a resize handle.\n */\nTextBox.prototype.resizable = function() {\n  var self = this;\n\n  var parent = this.parent,\n      resizeHandle = this.resizeHandle;\n\n  var minWidth = parseInt(this.style.minWidth) || 0,\n      minHeight = parseInt(this.style.minHeight) || 0,\n      maxWidth = parseInt(this.style.maxWidth) || Infinity,\n      maxHeight = parseInt(this.style.maxHeight) || Infinity;\n\n  if (!resizeHandle) {\n    resizeHandle = this.resizeHandle = domify(\n      '<div class=\"djs-direct-editing-resize-handle\"></div>'\n    );\n\n    var startX, startY, startWidth, startHeight;\n\n    var onMouseDown = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      startX = e.clientX;\n      startY = e.clientY;\n\n      var bounds = parent.getBoundingClientRect();\n\n      startWidth = bounds.width;\n      startHeight = bounds.height;\n\n      domEvent.bind(document, 'mousemove', onMouseMove);\n      domEvent.bind(document, 'mouseup', onMouseUp);\n    };\n\n    var onMouseMove = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      var newWidth = min(max(startWidth + e.clientX - startX, minWidth), maxWidth);\n      var newHeight = min(max(startHeight + e.clientY - startY, minHeight), maxHeight);\n\n      parent.style.width = newWidth + 'px';\n      parent.style.height = newHeight + 'px';\n\n      self.resizeHandler({\n        width: startWidth,\n        height: startHeight,\n        dx: e.clientX - startX,\n        dy: e.clientY - startY\n      });\n    };\n\n    var onMouseUp = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      domEvent.unbind(document,'mousemove', onMouseMove, false);\n      domEvent.unbind(document, 'mouseup', onMouseUp, false);\n    };\n\n    domEvent.bind(resizeHandle, 'mousedown', onMouseDown);\n  }\n\n  assign(resizeHandle.style, {\n    position: 'absolute',\n    bottom: '0px',\n    right: '0px',\n    cursor: 'nwse-resize',\n    width: '0',\n    height: '0',\n    borderTop: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid transparent',\n    borderRight: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid #ccc',\n    borderBottom: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid #ccc',\n    borderLeft: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid transparent'\n  });\n\n  parent.appendChild(resizeHandle);\n};\n\n\n/**\n * Clear content and style of the textbox, unbind listeners and\n * reset CSS style.\n */\nTextBox.prototype.destroy = function() {\n  var parent = this.parent,\n      content = this.content,\n      resizeHandle = this.resizeHandle;\n\n  // clear content\n  content.innerText = '';\n\n  // clear styles\n  parent.removeAttribute('style');\n  content.removeAttribute('style');\n\n  domEvent.unbind(content, 'keydown', this.keyHandler);\n  domEvent.unbind(content, 'mousedown', stopPropagation);\n  domEvent.unbind(content, 'input', this.autoResize);\n  domEvent.unbind(content, 'paste', this.handlePaste);\n\n  if (resizeHandle) {\n    resizeHandle.removeAttribute('style');\n\n    domRemove(resizeHandle);\n  }\n\n  domRemove(parent);\n};\n\n\nTextBox.prototype.getValue = function() {\n  return this.content.innerText.trim();\n};\n\n\nTextBox.prototype.getSelection = function() {\n  var selection = window.getSelection(),\n      range = selection.getRangeAt(0);\n\n  return range;\n};\n\n\nTextBox.prototype.setSelection = function(container, offset) {\n  var range = document.createRange();\n\n  if (container === null) {\n    range.selectNodeContents(this.content);\n  } else {\n    range.setStart(container, offset);\n    range.setEnd(container, offset);\n  }\n\n  var selection = window.getSelection();\n\n  selection.removeAllRanges();\n  selection.addRange(range);\n};\n","import {\n  bind,\n  find\n} from 'min-dash';\n\nimport TextBox from './TextBox';\n\n\n/**\n * A direct editing component that allows users\n * to edit an elements text directly in the diagram\n *\n * @param {EventBus} eventBus the event bus\n */\nexport default function DirectEditing(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n\n  this._providers = [];\n  this._textbox = new TextBox({\n    container: canvas.getContainer(),\n    keyHandler: bind(this._handleKey, this),\n    resizeHandler: bind(this._handleResize, this)\n  });\n}\n\nDirectEditing.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Register a direct editing provider\n\n * @param {Object} provider the provider, must expose an #activate(element) method that returns\n *                          an activation context ({ bounds: {x, y, width, height }, text }) if\n *                          direct editing is available for the given element.\n *                          Additionally the provider must expose a #update(element, value) method\n *                          to receive direct editing updates.\n */\nDirectEditing.prototype.registerProvider = function(provider) {\n  this._providers.push(provider);\n};\n\n\n/**\n * Returns true if direct editing is currently active\n *\n * @return {Boolean}\n */\nDirectEditing.prototype.isActive = function() {\n  return !!this._active;\n};\n\n\n/**\n * Cancel direct editing, if it is currently active\n */\nDirectEditing.prototype.cancel = function() {\n  if (!this._active) {\n    return;\n  }\n\n  this._fire('cancel');\n  this.close();\n};\n\n\nDirectEditing.prototype._fire = function(event, context) {\n  this._eventBus.fire('directEditing.' + event, context || { active: this._active });\n};\n\nDirectEditing.prototype.close = function() {\n  this._textbox.destroy();\n\n  this._fire('deactivate');\n\n  this._active = null;\n\n  this.resizable = undefined;\n};\n\n\nDirectEditing.prototype.complete = function() {\n\n  var active = this._active;\n\n  if (!active) {\n    return;\n  }\n\n  var containerBounds,\n      previousBounds = active.context.bounds,\n      newBounds = this.$textbox.getBoundingClientRect(),\n      newText = this.getValue(),\n      previousText = active.context.text;\n\n  if (\n    newText !== previousText ||\n    newBounds.height !== previousBounds.height ||\n    newBounds.width !== previousBounds.width\n  ) {\n    containerBounds = this._textbox.container.getBoundingClientRect();\n\n    active.provider.update(active.element, newText, active.context.text, {\n      x: newBounds.left - containerBounds.left,\n      y: newBounds.top - containerBounds.top,\n      width: newBounds.width,\n      height: newBounds.height\n    });\n  }\n\n  this._fire('complete');\n\n  this.close();\n};\n\n\nDirectEditing.prototype.getValue = function() {\n  return this._textbox.getValue();\n};\n\n\nDirectEditing.prototype._handleKey = function(e) {\n\n  // stop bubble\n  e.stopPropagation();\n\n  var key = e.keyCode || e.charCode;\n\n  // ESC\n  if (key === 27) {\n    e.preventDefault();\n    return this.cancel();\n  }\n\n  // Enter\n  if (key === 13 && !e.shiftKey) {\n    e.preventDefault();\n    return this.complete();\n  }\n};\n\n\nDirectEditing.prototype._handleResize = function(event) {\n  this._fire('resize', event);\n};\n\n\n/**\n * Activate direct editing on the given element\n *\n * @param {Object} ElementDescriptor the descriptor for a shape or connection\n * @return {Boolean} true if the activation was possible\n */\nDirectEditing.prototype.activate = function(element) {\n  if (this.isActive()) {\n    this.cancel();\n  }\n\n  // the direct editing context\n  var context;\n\n  var provider = find(this._providers, function(p) {\n    return (context = p.activate(element)) ? p : null;\n  });\n\n  // check if activation took place\n  if (context) {\n    this.$textbox = this._textbox.create(\n      context.bounds,\n      context.style,\n      context.text,\n      context.options\n    );\n\n    this._active = {\n      element: element,\n      context: context,\n      provider: provider\n    };\n\n    if (context.options && context.options.resizable) {\n      this.resizable = true;\n    }\n\n    this._fire('activate');\n  }\n\n  return !!context;\n};\n","import InteractionEventsModule from 'diagram-js/lib/features/interaction-events';\n\nimport DirectEditing from './lib/DirectEditing';\n\nexport default {\n  __depends__: [\n    InteractionEventsModule\n  ],\n  __init__: [ 'directEditing' ],\n  directEditing: [ 'type', DirectEditing ]\n};","import {\n  assign\n} from 'min-dash';\nimport {\n  getLabel,\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel\n} from './labelUtil';\nimport { isAny } from '@util/util';\n\nexport default function LabelEditingProvider(\n    eventBus, canvas, directEditing,\n    modeling, resizeHandles, textRenderer) {\n\n  this._canvas = canvas;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n\n  directEditing.registerProvider(this);\n\n  // listen to dblclick on non-root elements\n  eventBus.on('element.dblclick', function(event) {\n    activateDirectEdit(event.element, true);\n  });\n\n  // complete on followup canvas operation\n  eventBus.on([\n    'autoPlace.start',\n    'canvas.viewbox.changing',\n    'drag.init',\n    'element.mousedown',\n    'popupMenu.open'\n  ], function() {\n\n    if (directEditing.isActive()) {\n      directEditing.complete();\n    }\n  });\n\n  // cancel on command stack changes\n  eventBus.on([ 'commandStack.changed' ], function() {\n    if (directEditing.isActive()) {\n      directEditing.cancel();\n    }\n  });\n\n\n  eventBus.on('directEditing.activate', function() {\n    resizeHandles.removeResizers();\n  });\n\n  eventBus.on('create.end', 500, function(event) {\n\n    var context = event.context,\n        element = context.shape,\n        canExecute = event.context.canExecute,\n        isTouch = event.isTouch;\n\n    // TODO(nikku): we need to find a way to support the\n    // direct editing on mobile devices; right now this will\n    // break for desworkflowediting on mobile devices\n    // as it breaks the user interaction workflow\n\n    // TODO(nre): we should temporarily focus the edited element\n    // here and release the focused viewport after the direct edit\n    // operation is finished\n    if (isTouch) {\n      return;\n    }\n\n    if (!canExecute) {\n      return;\n    }\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    activateDirectEdit(element);\n  });\n\n  eventBus.on('autoPlace.end', 500, function(event) {\n    activateDirectEdit(event.shape);\n  });\n\n\n  function activateDirectEdit(element, force) {\n    if (force || isAny(element, [ 'userTask', 'scriptTask','subprocess' ]) || element.isDirectEdit) {\n      directEditing.activate(element);\n    }\n  }\n\n}\n\nLabelEditingProvider.$inject = [\n  'eventBus',\n  'canvas',\n  'directEditing',\n  'modeling',\n  'resizeHandles',\n  'textRenderer'\n];\n\n\n/**\n * Activate direct editing for activities and text annotations.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object with properties bounds (position and size), text and options\n */\nLabelEditingProvider.prototype.activate = function(element) {\n  // text\n  var text = getLabel(element);\n  if (text === undefined) {\n    return;\n  }\n\n  var context = {\n    text: text\n  };\n\n  // bounds\n  var bounds = this.getEditingBBox(element);\n\n  assign(context, bounds);\n\n  var options = {};\n\n  // tasks\n  if (\n    isAny(element, [\n      'userTask', 'scriptTask','subprocess'\n    ]) || element.isDirectEdit\n  ) {\n    assign(options, {\n      centerVertically: true\n    });\n  }\n\n  // external labels\n  if (isLabelExternal(element)) {\n    assign(options, {\n      autoResize: true\n    });\n  }\n\n  assign(context, {\n    options: options\n  });\n\n  return context;\n};\n\n\n/**\n * Get the editing bounding box based on the element's size and position\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object containing information about position\n *                  and size (fixed or minimum and/or maximum)\n */\nLabelEditingProvider.prototype.getEditingBBox = function(element) {\n  var canvas = this._canvas;\n\n  var target = element.label || element;\n\n  var bbox = canvas.getAbsoluteBBox(target);\n\n  var mid = {\n    x: bbox.x + bbox.width / 2,\n    y: bbox.y + bbox.height / 2\n  };\n\n  // default position\n  var bounds = { x: bbox.x, y: bbox.y };\n\n  var zoom = canvas.zoom();\n\n  var defaultStyle = this._textRenderer.getDefaultStyle(),\n      externalStyle = this._textRenderer.getExternalStyle();\n\n  // take zoom into account\n  var externalFontSize = externalStyle.fontSize * zoom,\n      externalLineHeight = externalStyle.lineHeight,\n      defaultFontSize = defaultStyle.fontSize * zoom,\n      defaultLineHeight = defaultStyle.lineHeight;\n\n  var style = {\n    fontFamily: this._textRenderer.getDefaultStyle().fontFamily,\n    fontWeight: this._textRenderer.getDefaultStyle().fontWeight\n  };\n\n\n  if (isAny(element, ['userTask', 'scriptTask','subprocess'])|| element.isDirectEdit) {\n\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px'\n    });\n  }\n\n  var width = 90 * zoom,\n      paddingTop = 7 * zoom,\n      paddingBottom = 4 * zoom;\n\n  // external labels for events, data elements, gateways, groups and connections\n  if (target.labelTarget) {\n    assign(bounds, {\n      width: width,\n      height: bbox.height + paddingTop + paddingBottom,\n      x: mid.x - width / 2,\n      y: bbox.y - paddingTop\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  }\n\n  // external label not yet created\n  if (isLabelExternal(target)\n      && !hasExternalLabel(target)\n      && !isLabel(target)) {\n\n    var externalLabelMid = getExternalLabelMid(element);\n\n    var absoluteBBox = canvas.getAbsoluteBBox({\n      x: externalLabelMid.x,\n      y: externalLabelMid.y,\n      width: 0,\n      height: 0\n    });\n\n    var height = externalFontSize + paddingTop + paddingBottom;\n\n    assign(bounds, {\n      width: width,\n      height: height,\n      x: absoluteBBox.x - width / 2,\n      y: absoluteBBox.y - height / 2\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  }\n\n  return { bounds: bounds, style: style };\n};\n\n\nLabelEditingProvider.prototype.update = function(\n    element, newLabel) {\n\n  var newBounds;\n  \n  if (isEmptyText(newLabel)) {\n    newLabel = null;\n  }\n\n  this._modeling.updateLabel(element, newLabel, newBounds);\n};\n\n// helpers //////////////////////\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}","import ChangeSupportModule from 'diagram-js/lib/features/change-support';\nimport ResizeModule from 'diagram-js/lib/features/resize';\nimport DirectEditingModule from 'diagram-js-direct-editing';\n\nimport labelEditingProvider from './labelEditingProvider';\n\n\n\nexport default {\n  __depends__: [\n    ChangeSupportModule,\n    ResizeModule,\n    DirectEditingModule\n  ],\n  __init__: [\n    'labelEditingProvider'\n  ],\n  labelEditingProvider: [ 'type', labelEditingProvider ]\n};\n","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  snapTo\n} from './SnapUtil';\n\n\n/**\n * A snap context, containing the (possibly incomplete)\n * mappings of drop targets (to identify the snapping)\n * to computed snap points.\n */\nexport default function SnapContext() {\n\n  /**\n   * Map<String, SnapPoints> mapping drop targets to\n   * a list of possible snappings.\n   *\n   * @type {Object}\n   */\n  this._targets = {};\n\n  /**\n   * Map<String, Point> initial positioning of element\n   * regarding various snap directions.\n   *\n   * @type {Object}\n   */\n  this._snapOrigins = {};\n\n  /**\n   * List of snap locations\n   *\n   * @type {Array<string>}\n   */\n  this._snapLocations = [];\n\n  /**\n   * Map<String, Array<Point>> of default snapping locations\n   *\n   * @type {Object}\n   */\n  this._defaultSnaps = {};\n}\n\n\nSnapContext.prototype.getSnapOrigin = function(snapLocation) {\n  return this._snapOrigins[snapLocation];\n};\n\n\nSnapContext.prototype.setSnapOrigin = function(snapLocation, initialValue) {\n  this._snapOrigins[snapLocation] = initialValue;\n\n  if (this._snapLocations.indexOf(snapLocation) === -1) {\n    this._snapLocations.push(snapLocation);\n  }\n};\n\n\nSnapContext.prototype.addDefaultSnap = function(type, point) {\n\n  var snapValues = this._defaultSnaps[type];\n\n  if (!snapValues) {\n    snapValues = this._defaultSnaps[type] = [];\n  }\n\n  snapValues.push(point);\n};\n\n/**\n * Return a number of initialized snaps, i.e. snap locations such as\n * top-left, mid, bottom-right and so forth.\n *\n * @return {Array<string>} snapLocations\n */\nSnapContext.prototype.getSnapLocations = function() {\n  return this._snapLocations;\n};\n\n/**\n * Set the snap locations for this context.\n *\n * The order of locations determines precedence.\n *\n * @param {Array<string>} snapLocations\n */\nSnapContext.prototype.setSnapLocations = function(snapLocations) {\n  this._snapLocations = snapLocations;\n};\n\n/**\n * Get snap points for a given target\n *\n * @param {Element|string} target\n */\nSnapContext.prototype.pointsForTarget = function(target) {\n\n  var targetId = target.id || target;\n\n  var snapPoints = this._targets[targetId];\n\n  if (!snapPoints) {\n    snapPoints = this._targets[targetId] = new SnapPoints();\n    snapPoints.initDefaults(this._defaultSnaps);\n  }\n\n  return snapPoints;\n};\n\n\n/**\n * Creates the snap points and initializes them with the\n * given default values.\n *\n * @param {Object<string, Array<Point>>} [defaultPoints]\n */\nexport function SnapPoints(defaultSnaps) {\n\n  /**\n   * Map<String, Map<(x|y), Array<number>>> mapping snap locations,\n   * i.e. top-left, bottom-right, center to actual snap values.\n   *\n   * @type {Object}\n   */\n  this._snapValues = {};\n}\n\nSnapPoints.prototype.add = function(snapLocation, point) {\n\n  var snapValues = this._snapValues[snapLocation];\n\n  if (!snapValues) {\n    snapValues = this._snapValues[snapLocation] = { x: [], y: [] };\n  }\n\n  if (snapValues.x.indexOf(point.x) === -1) {\n    snapValues.x.push(point.x);\n  }\n\n  if (snapValues.y.indexOf(point.y) === -1) {\n    snapValues.y.push(point.y);\n  }\n};\n\n\nSnapPoints.prototype.snap = function(point, snapLocation, axis, tolerance) {\n  var snappingValues = this._snapValues[snapLocation];\n\n  return snappingValues && snapTo(point[axis], snappingValues[axis], tolerance);\n};\n\n/**\n * Initialize a number of default snapping points.\n *\n * @param  {Object} defaultSnaps\n */\nSnapPoints.prototype.initDefaults = function(defaultSnaps) {\n\n  var self = this;\n\n  forEach(defaultSnaps || {}, function(snapPoints, snapLocation) {\n    forEach(snapPoints, function(point) {\n      self.add(snapLocation, point);\n    });\n  });\n};","import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  getChildren,\r\n  isSnapped,\r\n  mid\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  forEach,\r\n  isNumber\r\n} from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during create and move.\r\n *\r\n * @param {EventBus} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function CreateMoveSnapping(elementRegistry, eventBus, snapping) {\r\n  var self = this;\r\n\r\n  this._elementRegistry = elementRegistry;\r\n\r\n  eventBus.on([\r\n    'create.start',\r\n    'shape.move.start'\r\n  ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.move',\r\n    'create.end',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        snapContext = context.snapContext,\r\n        target = context.target;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event) || !target) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(target);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, target);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.cleanup',\r\n    'shape.move.cleanup'\r\n  ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nCreateMoveSnapping.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nCreateMoveSnapping.prototype.initSnap = function(event) {\r\n  var elementRegistry = this._elementRegistry;\r\n\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var shapeMid;\r\n\r\n  if (elementRegistry.get(shape.id)) {\r\n\r\n    // move\r\n    shapeMid = mid(shape, event);\r\n  } else {\r\n\r\n    // create\r\n    shapeMid = {\r\n      x: event.x + mid(shape).x,\r\n      y: event.y + mid(shape).y\r\n    };\r\n  }\r\n\r\n  var shapeTopLeft = {\r\n        x: shapeMid.x - shape.width / 2,\r\n        y: shapeMid.y - shape.height / 2\r\n      },\r\n      shapeBottomRight = {\r\n        x: shapeMid.x + shape.width / 2,\r\n        y: shapeMid.y + shape.height / 2\r\n      };\r\n\r\n  snapContext.setSnapOrigin('mid', {\r\n    x: shapeMid.x - event.x,\r\n    y: shapeMid.y - event.y\r\n  });\r\n\r\n  // snap labels to mid only\r\n  if (isLabel(shape)) {\r\n    return snapContext;\r\n  }\r\n\r\n  snapContext.setSnapOrigin('top-left', {\r\n    x: shapeTopLeft.x - event.x,\r\n    y: shapeTopLeft.y - event.y\r\n  });\r\n\r\n  snapContext.setSnapOrigin('bottom-right', {\r\n    x: shapeBottomRight.x - event.x,\r\n    y: shapeBottomRight.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nCreateMoveSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n\r\n    // handle labels\r\n    if (isLabel(snapTarget)) {\r\n\r\n      if (isLabel(shape)) {\r\n        snapPoints.add('mid', mid(snapTarget));\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    // handle connections\r\n    if (isConnection(snapTarget)) {\r\n\r\n      // ignore single segment connections\r\n      if (snapTarget.waypoints.length < 3) {\r\n        return;\r\n      }\r\n\r\n      // ignore first and last waypoint\r\n      var waypoints = snapTarget.waypoints.slice(1, -1);\r\n\r\n      forEach(waypoints, function(waypoint) {\r\n        snapPoints.add('mid', waypoint);\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    // handle shapes\r\n    snapPoints.add('mid', mid(snapTarget));\r\n  });\r\n\r\n  if (!isNumber(shape.x) || !isNumber(shape.y)) {\r\n    return snapPoints;\r\n  }\r\n\r\n  // snap to original position when moving\r\n  if (this._elementRegistry.get(shape.id)) {\r\n    snapPoints.add('mid', mid(shape));\r\n  }\r\n\r\n  return snapPoints;\r\n};\r\n\r\nCreateMoveSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isHidden(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isLabel(element) {\r\n  return !!element.labelTarget;\r\n}","import inherits from 'inherits';\n\nimport CreateMoveSnapping from 'diagram-js/lib/features/snapping/CreateMoveSnapping';\n\n/**\n * Snap during create and move.\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function MyCreateMoveSnapping(injector) {\n  injector.invoke(CreateMoveSnapping, this);\n}\n\ninherits(MyCreateMoveSnapping, CreateMoveSnapping);\n\nMyCreateMoveSnapping.$inject = [\n  'injector'\n];\n\nMyCreateMoveSnapping.prototype.initSnap = function(event) {\n  return CreateMoveSnapping.prototype.initSnap.call(this, event);\n};\n\nMyCreateMoveSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target) {\n  return CreateMoveSnapping.prototype.addSnapTargetPoints.call(this, snapPoints, shape, target);\n};\n\nMyCreateMoveSnapping.prototype.getSnapTargets = function(shape, target) {\n  return CreateMoveSnapping.prototype.getSnapTargets.call(this, shape, target);\n};\n","import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  bottomRight,\r\n  getChildren,\r\n  isSnapped,\r\n  setSnapped,\r\n  topLeft,\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  asTRBL,\r\n  getMid\r\n} from '../../layout/LayoutUtil';\r\n\r\nimport { forEach } from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during resize.\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function ResizeSnapping(eventBus, snapping) {\r\n  var self = this;\r\n\r\n  eventBus.on([ 'resize.start' ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'resize.move',\r\n    'resize.end',\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        parent = shape.parent,\r\n        direction = context.direction,\r\n        snapContext = context.snapContext;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event)) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(parent);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, parent, direction);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    if (isHorizontal(direction)) {\r\n      setSnapped(event, 'x', event.x);\r\n    }\r\n\r\n    if (isVertical(direction)) {\r\n      setSnapped(event, 'y', event.y);\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([ 'resize.cleanup' ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nResizeSnapping.prototype.initSnap = function(event) {\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      direction = context.direction,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var snapOrigin = getSnapOrigin(shape, direction);\r\n\r\n  snapContext.setSnapOrigin('corner', {\r\n    x: snapOrigin.x - event.x,\r\n    y: snapOrigin.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nResizeSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target, direction) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n    snapPoints.add('corner', bottomRight(snapTarget));\r\n    snapPoints.add('corner', topLeft(snapTarget));\r\n  });\r\n\r\n  snapPoints.add('corner', getSnapOrigin(shape, direction));\r\n\r\n  return snapPoints;\r\n};\r\n\r\nResizeSnapping.$inject = [\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nResizeSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isAttached(child, shape)\r\n      && !isConnection(child)\r\n      && !isHidden(child)\r\n      && !isLabel(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction getSnapOrigin(shape, direction) {\r\n  var mid = getMid(shape),\r\n      trbl = asTRBL(shape);\r\n\r\n  var snapOrigin = {\r\n    x: mid.x,\r\n    y: mid.y\r\n  };\r\n\r\n  if (direction.indexOf('n') !== -1) {\r\n    snapOrigin.y = trbl.top;\r\n  } else if (direction.indexOf('s') !== -1) {\r\n    snapOrigin.y = trbl.bottom;\r\n  }\r\n\r\n  if (direction.indexOf('e') !== -1) {\r\n    snapOrigin.x = trbl.right;\r\n  } else if (direction.indexOf('w') !== -1) {\r\n    snapOrigin.x = trbl.left;\r\n  }\r\n\r\n  return snapOrigin;\r\n}\r\n\r\nfunction isAttached(element, host) {\r\n  return element.host === host;\r\n}\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isLabel(element) {\r\n  return !!element.labelTarget;\r\n}\r\n\r\nfunction isHorizontal(direction) {\r\n  return direction === 'n' || direction === 's';\r\n}\r\n\r\nfunction isVertical(direction) {\r\n  return direction === 'e' || direction === 'w';\r\n}","import {\n  bind,\n  debounce,\n  forEach,\n  isNumber,\n  isObject\n} from 'min-dash';\n\nimport {\n  isSnapped,\n  setSnapped\n} from './SnapUtil';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate\n} from 'tiny-svg';\n\nvar SNAP_TOLERANCE = 7;\n\nexport var SNAP_LINE_HIDE_DELAY = 1000;\n\n\n/**\n * Generic snapping feature.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function Snapping(canvas) {\n  this._canvas = canvas;\n\n  // delay hide by 1000 seconds since last snap\n  this._asyncHide = debounce(bind(this.hide, this), SNAP_LINE_HIDE_DELAY);\n}\n\nSnapping.$inject = [ 'canvas' ];\n\n/**\n * Snap an event to given snap points.\n *\n * @param {Event} event\n * @param {SnapPoints} snapPoints\n */\nSnapping.prototype.snap = function(event, snapPoints) {\n  var context = event.context,\n      snapContext = context.snapContext,\n      snapLocations = snapContext.getSnapLocations();\n\n  var snapping = {\n    x: isSnapped(event, 'x'),\n    y: isSnapped(event, 'y')\n  };\n\n  forEach(snapLocations, function(location) {\n    var snapOrigin = snapContext.getSnapOrigin(location);\n\n    var snapCurrent = {\n      x: event.x + snapOrigin.x,\n      y: event.y + snapOrigin.y\n    };\n\n    // snap both axis if not snapped already\n    forEach([ 'x', 'y' ], function(axis) {\n      var locationSnapping;\n\n      if (!snapping[axis]) {\n        locationSnapping = snapPoints.snap(snapCurrent, location, axis, SNAP_TOLERANCE);\n\n        if (locationSnapping !== undefined) {\n          snapping[axis] = {\n            value: locationSnapping,\n            originValue: locationSnapping - snapOrigin[axis]\n          };\n        }\n      }\n    });\n\n    // no need to continue snapping\n    if (snapping.x && snapping.y) {\n      return false;\n    }\n  });\n\n  // show snap lines\n  this.showSnapLine('vertical', snapping.x && snapping.x.value);\n  this.showSnapLine('horizontal', snapping.y && snapping.y.value);\n\n  // snap event\n  forEach([ 'x', 'y' ], function(axis) {\n    var axisSnapping = snapping[axis];\n\n    if (isObject(axisSnapping)) {\n      setSnapped(event, axis, axisSnapping.originValue);\n    }\n  });\n};\n\nSnapping.prototype._createLine = function(orientation) {\n  var root = this._canvas.getLayer('snap');\n\n  var line = svgCreate('path');\n\n  svgAttr(line, { d: 'M0,0 L0,0' });\n\n  svgClasses(line).add('djs-snap-line');\n\n  svgAppend(root, line);\n\n  return {\n    update: function(position) {\n\n      if (!isNumber(position)) {\n        svgAttr(line, { display: 'none' });\n      } else {\n        if (orientation === 'horizontal') {\n          svgAttr(line, {\n            d: 'M-100000,' + position + ' L+100000,' + position,\n            display: ''\n          });\n        } else {\n          svgAttr(line, {\n            d: 'M ' + position + ',-100000 L ' + position + ', +100000',\n            display: ''\n          });\n        }\n      }\n    }\n  };\n};\n\nSnapping.prototype._createSnapLines = function() {\n  this._snapLines = {\n    horizontal: this._createLine('horizontal'),\n    vertical: this._createLine('vertical')\n  };\n};\n\nSnapping.prototype.showSnapLine = function(orientation, position) {\n\n  var line = this.getSnapLine(orientation);\n\n  if (line) {\n    line.update(position);\n  }\n\n  this._asyncHide();\n};\n\nSnapping.prototype.getSnapLine = function(orientation) {\n  if (!this._snapLines) {\n    this._createSnapLines();\n  }\n\n  return this._snapLines[orientation];\n};\n\nSnapping.prototype.hide = function() {\n  forEach(this._snapLines, function(snapLine) {\n    snapLine.update();\n  });\n};\n","import CreateMoveSnapping from './CreateMoveSnapping';\nimport ResizeSnapping from './ResizeSnapping';\nimport Snapping from './Snapping';\n\nexport default {\n  __init__: [\n    'createMoveSnapping',\n    'resizeSnapping',\n    'snapping'\n  ],\n  createMoveSnapping: [ 'type', CreateMoveSnapping ],\n  resizeSnapping: [ 'type', ResizeSnapping ],\n  snapping: [ 'type', Snapping ]\n};","\nimport myCreateMoveSnapping from './myCreateMoveSnapping';\nimport SnappingModule from 'diagram-js/lib/features/snapping';\n\nexport default {\n  __depends__: [ SnappingModule ],\n  __init__: [\n    'createMoveSnapping'\n  ],\n  createMoveSnapping: [ 'type', myCreateMoveSnapping ]\n};","import inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n/**\n * A basic provider that may be extended to implement modeling rules.\n *\n * Extensions should implement the init method to actually add their custom\n * modeling checks. Checks may be added via the #addRule(action, fn) method.\n *\n * @param {EventBus} eventBus\n */\nexport default function RuleProvider(eventBus) {\n  CommandInterceptor.call(this, eventBus);\n\n  this.init();\n}\n\nRuleProvider.$inject = [ 'eventBus' ];\n\ninherits(RuleProvider, CommandInterceptor);\n\n\n/**\n * Adds a modeling rule for the given action, implemented through\n * a callback function.\n *\n * The function will receive the modeling specific action context\n * to perform its check. It must return `false` to disallow the\n * action from happening or `true` to allow the action.\n *\n * A rule provider may pass over the evaluation to lower priority\n * rules by returning return nothing (or <code>undefined</code>).\n *\n * @example\n *\n * ResizableRules.prototype.init = function() {\n *\n *   \\/**\n *    * Return `true`, `false` or nothing to denote\n *    * _allowed_, _not allowed_ and _continue evaluating_.\n *    *\\/\n *   this.addRule('shape.resize', function(context) {\n *\n *     var shape = context.shape;\n *\n *     if (!context.newBounds) {\n *       // check general resizability\n *       if (!shape.resizable) {\n *         return false;\n *       }\n *\n *       // not returning anything (read: undefined)\n *       // will continue the evaluation of other rules\n *       // (with lower priority)\n *       return;\n *     } else {\n *       // element must have minimum size of 10*10 points\n *       return context.newBounds.width > 10 && context.newBounds.height > 10;\n *     }\n *   });\n * };\n *\n * @param {string|Array<string>} actions the identifier for the modeling action to check\n * @param {number} [priority] the priority at which this rule is being applied\n * @param {Function} fn the callback function that performs the actual check\n */\nRuleProvider.prototype.addRule = function(actions, priority, fn) {\n\n  var self = this;\n\n  if (typeof actions === 'string') {\n    actions = [ actions ];\n  }\n\n  actions.forEach(function(action) {\n\n    self.canExecute(action, priority, function(context, action, event) {\n      return fn(context);\n    }, true);\n  });\n};\n\n/**\n * Implement this method to add new rules during provider initialization.\n */\nRuleProvider.prototype.init = function() {};","/* eslint-disable */\nimport inherits from 'inherits';\nimport RuleProvider from 'diagram-js/lib/features/rules/RuleProvider';\n\nimport { isFrameElement } from 'diagram-js/lib/util/Elements';\n\nexport default function myRuleProvider(eventBus) {\n\n  RuleProvider.call(this, eventBus);\n  \n}\n\nmyRuleProvider.$inject = [ 'eventBus' ];\n\ninherits(myRuleProvider, RuleProvider);\n\n\nmyRuleProvider.prototype.init = function() {\n\n  this.addRule('connection.start', function(context) {\n    var source = context.source;\n    if(source && source.type != '' && source.type != undefined && source.type != null){\n      return true;\n    }\n    return false;\n  });\n\n  this.addRule('connection.create', function(context) {\n    var source = context.source,\n        target = context.target,\n        hints = context.hints || {},\n        targetParent = hints.targetParent,\n        targetAttach = hints.targetAttach;\n\n    // don't allow incoming connections on\n    // newly created boundary events\n    // to boundary events\n    if (targetAttach) {\n      return false;\n    }\n\n    // temporarily set target parent for scoping\n    // checks to work\n    if (targetParent) {\n      target.parent = targetParent;\n    }\n\n    try {\n      return canConnect(source, target);\n    } finally {\n\n      // unset temporary target parent\n      if (targetParent) {\n        target.parent = null;\n      }\n    }\n  });\n\n  this.addRule('connection.reconnect', function(context) {\n    var connection = context.connection,\n        source = context.source,\n        target = context.target;\n    return canConnect(source, target, connection);\n  });\n\n  this.addRule('connection.updateWaypoints', function(context) {\n    return {\n      type: context.connection.type\n    };\n  });\n\n\n  this.addRule('shape.create', function(context) {\n    var target = context.target,\n        shape = context.shape;\n    if(target.parent){\n      target = parent;\n    }\n\n    if(shape.type == 'startEvent' && (!target.children || target.children.find(t => t.type == shape.type) != null)){\n      return false;\n    }\n    return true;\n  });\n\n  this.addRule('shape.resize', function(context) {\n    var shape = context.shape;\n\n    return isFrameElement(shape);\n  });\n};\n\nmyRuleProvider.prototype.canConnect = canConnect;\n\n\nfunction canConnect(source, target, connection) {\n\n  /*if(['startEvent','endEvent','gatewayAnd','gatewayXor','gatewayInclusive','gatewayInclusive','userTask','scriptTask','subprocess','setp'].includes(target.type)\n    && ['startEvent','gatewayAnd','gatewayXor','gatewayInclusive','gatewayInclusive','userTask','scriptTask','subprocess','setp'].includes(source.type)\n  ){*/\n  //console.log(target,target.type,'canConnect')\n\n  if(target.type && source.type && 'endEvent' != source.type){\n    if(source.id == target.id){\n      return false;\n    }\n    return { type: 'myline' };\n  }\n\n  return false;\n}","import myRuleProvider from './myRuleProvider'\n\nexport default  {\n    __init__: [\n      'myRuleProvider'\n    ],\n    myRuleProvider: [ 'type', myRuleProvider ]\n};\n","import {\n    assign\n} from 'min-dash';\n\nexport default function ExamplePaletteProvider(create, elementFactory,handTool, lassoTool, globalConnect, palette,myOptions) {\n    this._create = create;\n    this._elementFactory = elementFactory;\n    this._handTool = handTool;\n    this._lassoTool = lassoTool;\n    this._globalConnect = globalConnect;\n    this._palette = palette;\n    this._myOptions = myOptions;\n  \n    palette.registerProvider(this);\n  }\n  \n  ExamplePaletteProvider.$inject = [\n    'create',\n    'elementFactory',\n    'handTool',\n    'lassoTool',\n    'globalConnect',\n    'palette',\n\n    'myOptions'\n\n  ];\n  \n  \n  ExamplePaletteProvider.prototype.getPaletteEntries = function() {\n    var create = this._create,\n        elementFactory = this._elementFactory,\n        handTool = this._handTool,\n        lassoTool = this._lassoTool,\n        globalConnect = this._globalConnect,\n        myOptions = this._myOptions;\n        \n    function createAction(type, group, className, title, options) {\n\n        function createListener(event) {\n            var shape = elementFactory.createShape(assign({ type: type }, options));\n            create.start(event, shape);\n        }\n        \n        return {\n            group: group,\n            className: className,\n            title: title,\n            action: {\n                dragstart: createListener,\n                click: createListener\n            }\n        };\n    }\n    \n    console.log(myOptions);\n  \n    let tools = {\n        'hand-tool': {\n            group: 'tools',\n            className: 'icon-hand-tool',\n            title: '',\n            action: {\n              click: function(event) {\n                handTool.activateHand(event);\n              }\n            }\n        },\n        'lasso-tool': {\n            group: 'tools',\n            className: 'icon-lasso-tool',\n            title: '',\n            action: {\n                click: function(event) {\n                    lassoTool.activateSelection(event);\n                }\n            }\n        },\n        'global-connect-tool': {\n            group: 'tools',\n            className: 'icon-line-tool',\n            title: '',\n            action: {\n              click: function(event) {\n                globalConnect.toggle(event);\n              }\n            }\n        },\n        'tool-separator': {\n            group: 'tools',\n            separator: true\n        }\n    };\n    for(let key in myOptions.palette){\n        var item = myOptions.palette[key];\n        tools[key] = createAction(item.type, item.group, item.className, item.title, item.options);\n    }\n    \n    //console.log(tools,'tools');\n    return tools;\n    \n  };","import PaletteProvider from './paletteProvider'\n\nexport default {\n    __init__: [\n      'paletteProvider'\n    ],\n    paletteProvider: [ 'type', PaletteProvider ]\n};","import {\n  asTRBL,\n  getOrientation,\n  getMid\n} from '../../layout/LayoutUtil';\n\nimport {\n  find,\n  reduce\n} from 'min-dash';\n\n// padding to detect element placement\nvar PLACEMENT_DETECTION_PAD = 10;\n\nexport var DEFAULT_DISTANCE = 50;\n\nvar DEFAULT_MAX_DISTANCE = 250;\n\n\n/**\n * Get free position starting from given position.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape} element\n * @param {Point} position\n * @param {Function} getNextPosition\n *\n * @return {Point}\n */\nexport function findFreePosition(source, element, position, getNextPosition) {\n  var connectedAtPosition;\n\n  while ((connectedAtPosition = getConnectedAtPosition(source, position, element))) {\n    position = getNextPosition(element, position, connectedAtPosition);\n  }\n\n  return position;\n}\n\n/**\n * Returns function that returns next position.\n *\n * @param {Object} nextPositionDirection\n * @param {Object} [nextPositionDirection.x]\n * @param {Object} [nextPositionDirection.y]\n *\n * @returns {Function}\n */\nexport function generateGetNextPosition(nextPositionDirection) {\n  return function(element, previousPosition, connectedAtPosition) {\n    var nextPosition = {\n      x: previousPosition.x,\n      y: previousPosition.y\n    };\n\n    [ 'x', 'y' ].forEach(function(axis) {\n\n      var nextPositionDirectionForAxis = nextPositionDirection[ axis ];\n\n      if (!nextPositionDirectionForAxis) {\n        return;\n      }\n\n      var dimension = axis === 'x' ? 'width' : 'height';\n\n      var margin = nextPositionDirectionForAxis.margin,\n          minDistance = nextPositionDirectionForAxis.minDistance;\n\n      if (margin < 0) {\n        nextPosition[ axis ] = Math.min(\n          connectedAtPosition[ axis ] + margin - element[ dimension ] / 2,\n          previousPosition[ axis ] - minDistance + margin\n        );\n      } else {\n        nextPosition[ axis ] = Math.max(\n          connectedAtPosition[ axis ] + connectedAtPosition[ dimension ] + margin + element[ dimension ] / 2,\n          previousPosition[ axis ] + minDistance + margin\n        );\n      }\n    });\n\n    return nextPosition;\n  };\n}\n\n/**\n * Return target at given position, if defined.\n *\n * This takes connected elements from host and attachers\n * into account, too.\n */\nexport function getConnectedAtPosition(source, position, element) {\n\n  var bounds = {\n    x: position.x - (element.width / 2),\n    y: position.y - (element.height / 2),\n    width: element.width,\n    height: element.height\n  };\n\n  var closure = getAutoPlaceClosure(source, element);\n\n  return find(closure, function(target) {\n\n    if (target === element) {\n      return false;\n    }\n\n    var orientation = getOrientation(target, bounds, PLACEMENT_DETECTION_PAD);\n\n    return orientation === 'intersect';\n  });\n}\n\n/**\n* Compute optimal distance between source and target based on existing connections to and from source.\n* Assumes left-to-right and top-to-down modeling.\n*\n* @param {djs.model.Shape} source\n* @param {Object} [hints]\n* @param {number} [hints.defaultDistance]\n* @param {string} [hints.direction]\n* @param {Function} [hints.filter]\n* @param {Function} [hints.getWeight]\n* @param {number} [hints.maxDistance]\n* @param {string} [hints.reference]\n*\n* @return {number}\n*/\nexport function getConnectedDistance(source, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  // targets > sources by default\n  function getDefaultWeight(connection) {\n    return connection.source === source ? 1 : -1;\n  }\n\n  var defaultDistance = hints.defaultDistance || DEFAULT_DISTANCE,\n      direction = hints.direction || 'e',\n      filter = hints.filter,\n      getWeight = hints.getWeight || getDefaultWeight,\n      maxDistance = hints.maxDistance || DEFAULT_MAX_DISTANCE,\n      reference = hints.reference || 'start';\n\n  if (!filter) {\n    filter = noneFilter;\n  }\n\n  function getDistance(a, b) {\n    if (direction === 'n') {\n      if (reference === 'start') {\n        return asTRBL(a).top - asTRBL(b).bottom;\n      } else if (reference === 'center') {\n        return asTRBL(a).top - getMid(b).y;\n      } else {\n        return asTRBL(a).top - asTRBL(b).top;\n      }\n    } else if (direction === 'w') {\n      if (reference === 'start') {\n        return asTRBL(a).left - asTRBL(b).right;\n      } else if (reference === 'center') {\n        return asTRBL(a).left - getMid(b).x;\n      } else {\n        return asTRBL(a).left - asTRBL(b).left;\n      }\n    } else if (direction === 's') {\n      if (reference === 'start') {\n        return asTRBL(b).top - asTRBL(a).bottom;\n      } else if (reference === 'center') {\n        return getMid(b).y - asTRBL(a).bottom;\n      } else {\n        return asTRBL(b).bottom - asTRBL(a).bottom;\n      }\n    } else {\n      if (reference === 'start') {\n        return asTRBL(b).left - asTRBL(a).right;\n      } else if (reference === 'center') {\n        return getMid(b).x - asTRBL(a).right;\n      } else {\n        return asTRBL(b).right - asTRBL(a).right;\n      }\n    }\n  }\n\n  var sourcesDistances = source.incoming\n    .filter(filter)\n    .map(function(connection) {\n      var weight = getWeight(connection);\n\n      var distance = weight < 0\n        ? getDistance(connection.source, source)\n        : getDistance(source, connection.source);\n\n      return {\n        id: connection.source.id,\n        distance: distance,\n        weight: weight\n      };\n    });\n\n  var targetsDistances = source.outgoing\n    .filter(filter)\n    .map(function(connection) {\n      var weight = getWeight(connection);\n\n      var distance = weight > 0\n        ? getDistance(source, connection.target)\n        : getDistance(connection.target, source);\n\n      return {\n        id: connection.target.id,\n        distance: distance,\n        weight: weight\n      };\n    });\n\n  var distances = sourcesDistances.concat(targetsDistances).reduce(function(accumulator, currentValue) {\n    accumulator[ currentValue.id + '__weight_' + currentValue.weight ] = currentValue;\n\n    return accumulator;\n  }, {});\n\n  var distancesGrouped = reduce(distances, function(accumulator, currentValue) {\n    var distance = currentValue.distance,\n        weight = currentValue.weight;\n\n    if (distance < 0 || distance > maxDistance) {\n      return accumulator;\n    }\n\n    if (!accumulator[ String(distance) ]) {\n      accumulator[ String(distance) ] = 0;\n    }\n\n    accumulator[ String(distance) ] += 1 * weight;\n\n    if (!accumulator.distance || accumulator[ accumulator.distance ] < accumulator[ String(distance) ]) {\n      accumulator.distance = distance;\n    }\n\n    return accumulator;\n  }, {});\n\n  return distancesGrouped.distance || defaultDistance;\n}\n\n/**\n * Returns all connected elements around the given source.\n *\n * This includes:\n *\n *   - connected elements\n *   - host connected elements\n *   - attachers connected elements\n *\n * @param  {djs.model.Shape} source\n *\n * @return {Array<djs.model.Shape>}\n */\nfunction getAutoPlaceClosure(source) {\n\n  var allConnected = getConnected(source);\n\n  if (source.host) {\n    allConnected = allConnected.concat(getConnected(source.host));\n  }\n\n  if (source.attachers) {\n    allConnected = allConnected.concat(source.attachers.reduce(function(shapes, attacher) {\n      return shapes.concat(getConnected(attacher));\n    }, []));\n  }\n\n  return allConnected;\n}\n\nfunction getConnected(element) {\n  return getTargets(element).concat(getSources(element));\n}\n\nfunction getSources(shape) {\n  return shape.incoming.map(function(connection) {\n    return connection.source;\n  });\n}\n\nfunction getTargets(shape) {\n  return shape.outgoing.map(function(connection) {\n    return connection.target;\n  });\n}\n\nfunction noneFilter() {\n  return true;\n}\n","import {\n  asTRBL,\n  getMid\n} from '../../layout/LayoutUtil';\n\nimport { DEFAULT_DISTANCE } from './AutoPlaceUtil';\n\nvar LOW_PRIORITY = 100;\n\n\n/**\n * A service that places elements connected to existing ones\n * to an appropriate position in an _automated_ fashion.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function AutoPlace(eventBus, modeling) {\n\n  eventBus.on('autoPlace', LOW_PRIORITY, function(context) {\n    var shape = context.shape,\n        source = context.source;\n\n    return getNewShapePosition(source, shape);\n  });\n\n  /**\n   * Append shape to source at appropriate position.\n   *\n   * @param {djs.model.Shape} source\n   * @param {djs.model.Shape} shape\n   *\n   * @return {djs.model.Shape} appended shape\n   */\n  this.append = function(source, shape, hints) {\n\n    eventBus.fire('autoPlace.start', {\n      source: source,\n      shape: shape\n    });\n\n    // allow others to provide the position\n    var position = eventBus.fire('autoPlace', {\n      source: source,\n      shape: shape\n    });\n\n    var newShape = modeling.appendShape(source, shape, position, source.parent, hints);\n\n    eventBus.fire('autoPlace.end', {\n      source: source,\n      shape: newShape\n    });\n\n    return newShape;\n  };\n\n}\n\nAutoPlace.$inject = [\n  'eventBus',\n  'modeling'\n];\n\n// helpers //////////\n\n/**\n * Find the new position for the target element to\n * connect to source.\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n * @param  {Object} [hints]\n * @param  {Object} [hints.defaultDistance]\n *\n * @returns {Point}\n */\nfunction getNewShapePosition(source, element, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  var distance = hints.defaultDistance || DEFAULT_DISTANCE;\n\n  var sourceMid = getMid(source),\n      sourceTrbl = asTRBL(source);\n\n  // simply put element right next to source\n  return {\n    x: sourceTrbl.right + distance + element.width / 2,\n    y: sourceMid.y\n  };\n}","/**\n * Select element after auto placement.\n *\n * @param {EventBus} eventBus\n * @param {Selection} selection\n */\nexport default function AutoPlaceSelectionBehavior(eventBus, selection) {\n\n  eventBus.on('autoPlace.end', 500, function(e) {\n    selection.select(e.shape);\n  });\n\n}\n\nAutoPlaceSelectionBehavior.$inject = [\n  'eventBus',\n  'selection'\n];","import AutoPlace from './AutoPlace';\nimport AutoPlaceSelectionBehavior from './AutoPlaceSelectionBehavior';\n\nexport default {\n  __init__: [ 'autoPlaceSelectionBehavior' ],\n  autoPlace: [ 'type', AutoPlace ],\n  autoPlaceSelectionBehavior: [ 'type', AutoPlaceSelectionBehavior ]\n};","import { is } from '@util/util';\n\nimport {\n  getMid,\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  findFreePosition,\n  generateGetNextPosition,\n  getConnectedDistance\n} from 'diagram-js/lib/features/auto-place/AutoPlaceUtil';\n\n\nexport function getNewShapePosition(source, element) {\n    return getFlowNodePosition(source, element);\n}\n\nexport function getFlowNodePosition(source, element) {\n  var sourceTrbl = asTRBL(source);\n  var sourceMid = getMid(source);\n\n  var horizontalDistance = getConnectedDistance(source, {\n    filter: function(connection) {\n      return is(connection, 'myline');\n    }\n  });\n\n  var margin = 30,\n      minDistance = 80,\n      orientation = 'left';\n\n  var position = {\n    x: sourceTrbl.right + horizontalDistance + element.width / 2,\n    y: sourceMid.y + getVerticalDistance(orientation, minDistance)\n  };\n\n  var nextPositionDirection = {\n    y: {\n      margin: margin,\n      minDistance: minDistance\n    }\n  };\n\n  return findFreePosition(source, element, position, generateGetNextPosition(nextPositionDirection));\n}\n\nfunction getVerticalDistance(orientation, minDistance) {\n  if (orientation.indexOf('top') != -1) {\n    return -1 * minDistance;\n  } else if (orientation.indexOf('bottom') != -1) {\n    return minDistance;\n  } else {\n    return 0;\n  }\n}\n","import { getNewShapePosition } from './myAutoPlaceUtil';\n\nexport default function MyAutoPlace(eventBus) {\n  eventBus.on('autoPlace', function(context) {\n    var shape = context.shape,\n        source = context.source;\n    return getNewShapePosition(source, shape);\n  });\n}\n\nMyAutoPlace.$inject = [ 'eventBus' ];","import AutoPlaceModule from 'diagram-js/lib/features/auto-place';\n\nimport MyAutoPlace from './myAutoPlace';\n\nexport default {\n  __depends__: [ AutoPlaceModule ],\n  __init__: [ 'myAutoPlace' ],\n  myAutoPlace: [ 'type', MyAutoPlace ]\n};","import {\n  assign\n} from 'min-dash';\n\nexport default function contextPadProvider(connect, contextPad, modeling,elementFactory,autoPlace,create,myOptions) {\n  this._connect = connect;\n  this._modeling = modeling;\n  this._elementFactory = elementFactory;\n  this._autoPlace = autoPlace;\n  this._create = create;\n  this._myOptions = myOptions;\n\n  contextPad.registerProvider(this);\n}\n  \ncontextPadProvider.$inject = [\n  'connect',\n  'contextPad',\n  'modeling',\n  'elementFactory',\n  'autoPlace',\n  'create',\n\n  'myOptions'\n];\n  \ncontextPadProvider.prototype.getContextPadEntries = function(element) {\n  var connect = this._connect,\n      modeling = this._modeling,\n      elementFactory = this._elementFactory,\n      autoPlace = this._autoPlace,\n      create = this._create,\n      myOptions = this._myOptions;\n\n  function removeElement() {\n    modeling.removeElements([ element ]);\n  }\n\n  function startConnect(event, element, autoActivate) {\n    connect.start(event, element, autoActivate);\n  }\n\n  function appendAction(type, className, title, options) {\n\n    if (typeof title !== 'string') {\n      options = title;\n      //title = title;\n    }\n\n    function appendStart(event, element) {\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n      create.start(event, shape, {\n        source: element\n      });\n    }\n\n    function append(event, element) {\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n      autoPlace.append(element, shape);\n    }\n\n    return {\n      group: 'model',\n      className: className,\n      title: title,\n      action: {\n        dragstart: appendStart,\n        click: append\n      }\n    };\n  }\n\n  if(element.type == 'label'){\n    return false;\n  }\n\n  \n\n  if(element.type == 'myline' || element.type == 'endEvent'){\n    return {\n      'delete': {\n        group: 'edit',\n        className: 'icon-delete',\n        title: '',\n        action: {\n          click: removeElement,\n          dragstart: removeElement\n        }\n      },\n    };\n  }\n\n  var tools =  {\n  };\n\n  for(let key in myOptions.palette){\n    if(key != 'create.start-event'){\n      var item = myOptions.palette[key];\n      tools[key] = appendAction(item.type,item.className, item.title,item.options);\n    }\n   \n  }\n\n\n  tools['connect'] = {\n    group: 'edit',\n    className: 'icon-line-tool',\n    title: '',\n    action: {\n      click: startConnect,\n      dragstart: startConnect\n    }\n  }\n\n  tools['delete'] = {\n    group: 'edit',\n    className: 'icon-delete',\n    title: '',\n    action: {\n      click: removeElement,\n      dragstart: removeElement\n    }\n  }\n\n  return tools;\n\n};\n","import ContextPadProvider from './contextPadProvider'\nexport default {\n    __init__: [\n      'ContextPadProvider',\n    ],\n    ContextPadProvider: [ 'type', ContextPadProvider ]\n};","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getMid\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport { translate} from '@util/translate.js';\n\nfunction elementData(semantic, attrs) {\n  return assign({\n    id: semantic.id,\n    type: semantic.type,\n    businessObject: semantic\n  }, attrs);\n}\n\nfunction getWaypoints(node, source, target) {\n\n  var waypoints = node.waypoint;\n  if (!waypoints || waypoints.length < 2) {\n    return [ getMid(source), getMid(target) ];\n  }\n  return waypoints.map(function(p) {\n    return { x: p.x, y: p.y };\n  });\n}\n\n\nexport default function MyImporter(\n    eventBus, canvas, elementFactory,\n    elementRegistry, textRenderer) {\n    this._eventBus = eventBus;\n    this._canvas = canvas;\n    this._elementFactory = elementFactory;\n    this._elementRegistry = elementRegistry;\n    this._translate = translate;\n    this._textRenderer = textRenderer;\n}\n\nMyImporter.$inject = [\n  'eventBus',\n  'canvas',\n  'elementFactory',\n  'elementRegistry',\n  'textRenderer'\n];\n\nMyImporter.prototype.add = function(node) {\n  //let translate = this._translate;\n  let element;\n  let label = node.label;\n  if(label){\n    label.id = node.id;\n    label.name = node.name;\n    delete node.label;\n  }\n\n  // \n  if(node.type == 'myline'){\n    var source = this._getSource(node),\n    target = this._getTarget(node);\n    element = this._elementFactory.createConnection(elementData(node, {\n      source: source,\n      target: target,\n      waypoints: getWaypoints(node, source, target)\n    }));\n\n    this._canvas.addConnection(element);\n  }\n  // \n  else  {\n    let wh = this._elementFactory._getDefaultSize(node.type);\n    element = this._elementFactory.createShape(elementData(node, {\n      x: Math.round(node.x),\n      y: Math.round(node.y),\n      width: wh.width,\n      height:wh.height,\n      isFrame: false\n    }));\n    this._canvas.addShape(element);\n  }\n\n  if(label && element){\n    // \n    this.addLabel(label,element);\n  }\n\n  return element;\n};\n\n\nMyImporter.prototype.addLabel = function(semantic, element) {\n  let label = this._elementFactory.createLabel({\n    id: semantic.id +'_label',\n    labelTarget: element,\n    type: 'label',\n    x: Math.round(semantic.x),\n    y: Math.round(semantic.y),\n    width: Math.round(semantic.width),\n    height: Math.round(semantic.height),\n    businessObject:semantic\n  });\n\n  return this._canvas.addShape(label, element.parent);\n};\n\nMyImporter.prototype.update = function(id,data){\n  let element = this._elementRegistry.get(id);\n  element.businessObject = assign(element.businessObject,data);\n\n  if(data.type == 'myline'){\n    this._canvas.removeConnection(element);\n    this._canvas.addConnection(element, element.parent);\n  }\n  else {\n    this._canvas.removeShape(element);\n    this._canvas.addShape(element, element.parent);\n  }\n  \n  let label = this._elementRegistry.get(id + '_label');\n  if(label){\n    label.businessObject = element.businessObject;\n    \n    this._canvas.removeShape(label);\n    this._canvas.addShape(label, element.parent);\n  }\n}\n\n\nMyImporter.prototype._getSource = function(semantic) {\n  return this._getElement(semantic.from);\n};\n\nMyImporter.prototype._getTarget = function(semantic) {\n  return this._getElement(semantic.to);\n};\n\nMyImporter.prototype._getElement = function(id) {\n  return this._elementRegistry.get(id);\n};\n\n","\nimport MyImporter from './myImporter';\nexport default {\n  myImporter: [ 'type', MyImporter ]\n};","// \nexport const nodeToJson = (nodes) =>{\n    const res = []\n\n    nodes.forEach(node => {\n        if(node.type != undefined){\n            let point = node.businessObject\n            if(node.type == 'myline')\n            {\n                if(node.source && node.target){\n                    point.from = node.source.id;\n                    point.to = node.target.id;\n                    point.waypoint = node.waypoints.map(function(p) {\n                        return { x: p.x, y: p.y };\n                    })\n                    res.push(point)\n                }\n            }\n            else if(node.type != 'label'){\n                point.x = node.x\n                point.y = node.y\n\n                res.push(point)\n            }\n            else{\n                let mynode = res.find(t=>t.id == point.id)\n                mynode.name =point.name ||''\n                mynode.label = {\n                    x:node.x,\n                    y:node.y,\n                    height:node.height,\n                    width:node.width\n                }\n            }\n        }\n    })\n\n\n    return res\n}\n\n// \nexport const importData = (data,diagram)=>{\n    const myImporter = diagram.get('myImporter')\n\n    const nodes = data.filter(t=>t.type != 'myline')\n    const lines = data.filter(t=>t.type == 'myline')\n\n    nodes.forEach(item => {\n        myImporter.add(item)\n    })\n    lines.forEach(item => {\n        myImporter.add(item)\n    })\n}","<template>\n  <div ref=\"container\" class=\"b-flow\"></div>\n</template>\n<script>\n/* eslint-disable */\nimport \"diagram-js/assets/diagram-js.css\";\n\nimport Diagram from \"diagram-js\";\n\nimport AlignElementsModule from \"diagram-js/lib/features/align-elements\";\nimport BendpointsModule from \"diagram-js/lib/features/bendpoints\";\nimport ConnectModule from \"diagram-js/lib/features/connect\";\nimport ConnectionPreviewModule from \"diagram-js/lib/features/connection-preview\";\nimport ContextPadModule from \"diagram-js/lib/features/context-pad\";\nimport CreateModule from \"diagram-js/lib/features/create\";\nimport HandToolModule from \"diagram-js/lib/features/hand-tool\";\nimport LassoToolModule from \"diagram-js/lib/features/lasso-tool\";\nimport GlobalConnectModule from \"diagram-js/lib/features/global-connect\";\nimport MoveCanvasModule from \"diagram-js/lib/navigation/movecanvas\";\nimport MoveModule from \"diagram-js/lib/features/move\";\nimport OutlineModule from \"diagram-js/lib/features/outline\";\nimport PaletteModule from \"diagram-js/lib/features/palette\";\nimport ZoomScrollModule from \"diagram-js/lib/navigation/zoomscroll\";\n\n/** */\nimport myModelingModule from \"./modules/modeling\";\nimport myDraw from \"./modules/draw\";\nimport myLabelEditing from \"./modules/labelEditing\";\nimport mySnapping from \"./modules/snapping\";\nimport myRulesModule from \"./modules/rules\";\nimport myPalette from \"./modules/palette\";\nimport myAutoPlace from \"./modules/autoPlace\";\nimport myContextPad from \"./modules/contextPad\";\n\nimport myImport from \"./modules/import\";\n\nimport { nodeToJson, importData } from \"./myflow\";\n\nexport default {\n  name: \"b-wflow\",\n  props: {\n    paletteOptions: Object,\n    lineStroke:String,\n  },\n  data() {\n    return {\n      scale: 1,\n      diagram: null,\n      palette: {\n        \"create.start-event\": {\n          className: \"icon-start-event\",\n          type:'startEvent',\n          group:\"event\",\n          title:'',\n        },\n        \"create.end-event\": {\n          className: \"icon-end-event\",\n          type:'endEvent',\n          group:\"event\",\n          title:'',\n        },\n        \"create.and-gateway\": {\n          className: \"icon-gateway1\",\n          type:'gatewayAnd',\n          group:\"gateway\",\n          title:'',\n        },\n        \"create.xor-gateway\": {\n          className: \"icon-gateway2\",\n          type:'gatewayXor',\n          group:\"gateway\",\n          title:'',\n        },\n        \"create.inclusive-gateway\": {\n          className: \"icon-gateway3\",\n          type:'gatewayInclusive',\n          group:\"gateway\",\n          title:'',\n        },\n        \"create.task\": {\n          className: \"icon-gateway4\",\n          type:'userTask',\n          group:'activity',\n          title:'',\n        },\n        \"create.script\": {\n          className: \"icon-gateway5\",\n          type:'scriptTask',\n          group:\"activity\",\n          title:'',\n        },\n        \"create.subprocess\": {\n          className: \"icon-subprocess\",\n          type:'subprocess',\n          group:\"activity\",\n          title:'',\n        },\n      },\n    };\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.init();\n    });\n  },\n  computed: {},\n  methods: {\n    init() {\n      let myOptions = {\n        __init__: [\"myOptions\"],\n        myOptions: [\n          \"type\",\n          () => {\n            return {\n              palette: this.paletteOptions || this.palette,\n              lineStroke:this.lineStroke\n            };\n          },\n        ],\n      };\n\n      var container = this.$refs.container;\n      this.diagram = new Diagram({\n        canvas: {\n          container: container,\n        },\n        modules: [\n          BendpointsModule,\n          ConnectModule,\n          ConnectionPreviewModule,\n          ContextPadModule,\n          CreateModule,\n\n          AlignElementsModule,\n          HandToolModule,\n          LassoToolModule,\n          GlobalConnectModule,\n          myModelingModule,\n          MoveCanvasModule,\n          MoveModule,\n          OutlineModule,\n          PaletteModule,\n          ZoomScrollModule,\n\n          myOptions,\n\n          myAutoPlace,\n          myDraw,\n          myLabelEditing,\n          myContextPad,\n          myPalette,\n          myRulesModule,\n          mySnapping,\n          myImport,\n        ],\n      });\n      var canvas = this.diagram.get(\"canvas\"),\n        elementFactory = this.diagram.get(\"elementFactory\");\n\n      // add root\n      this.reset();\n      var root = elementFactory.createRoot();\n      canvas.setRootElement(root);\n      this.initEvent();\n    },\n    // \n    initEvent() {\n      const eventBus = this.diagram.get(\"eventBus\");\n      // \n      eventBus.on(\"element.dblclick\", (e) => {\n        this.$emit(\"elementDblclick\", e.element.businessObject);\n      });\n      // \n      eventBus.on(\"element.click\", (e) => {\n        this.$emit(\"elementClick\", e.element.businessObject);\n      });\n      eventBus.on(\"create.end\", (e) => {\n        this.$emit(\"elementCreate\", e.elements[0].businessObject);\n      });\n      eventBus.on(\"autoPlace.end\", (e) => {\n        this.$emit(\"elementCreate\", e.shape.businessObject);\n      });\n    },\n    reset() {\n      this.scale = 1;\n      this.diagram.get(\"canvas\").zoom(\"fit-viewport\");\n    },\n    handlerZoom(radio) {\n      const newScale = !radio ? 1.0 : this.scale + radio;\n      this.diagram.get(\"canvas\").zoom(newScale);\n      this.scale = newScale;\n    },\n    handlerRedo() {\n      // \n      this.diagram.get(\"commandStack\").redo();\n    },\n    handlerUndo() {\n      // \n      this.diagram.get(\"commandStack\").undo();\n    },\n    getData() {\n      this.diagram.get(\"canvas\").zoom(1);\n      const all = this.diagram.get(\"elementRegistry\").getAll();\n      var res = nodeToJson(all);\n      return res;\n    },\n    setData(data) {\n      this.diagram.clear();\n      this.reset();\n      importData(data, this.diagram);\n    },\n    updateElemet(data) {\n      let myImporter = this.diagram.get(\"myImporter\");\n      myImporter.update(data.id, data);\n    },\n  },\n};\n</script>\n<style lang=\"less\">\n@import \"./index.less\";\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./bWflow.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./bWflow.vue?vue&type=script&lang=js&\"","/* globals __VUE_SSR_CONTEXT__ */\n\n// IMPORTANT: Do NOT use ES2015 features in this file (except for modules).\n// This module is a runtime utility for cleaner component module output and will\n// be included in the final webpack user bundle.\n\nexport default function normalizeComponent(\n  scriptExports,\n  render,\n  staticRenderFns,\n  functionalTemplate,\n  injectStyles,\n  scopeId,\n  moduleIdentifier /* server only */,\n  shadowMode /* vue-cli only */\n) {\n  // Vue.extend constructor export interop\n  var options =\n    typeof scriptExports === 'function' ? scriptExports.options : scriptExports\n\n  // render functions\n  if (render) {\n    options.render = render\n    options.staticRenderFns = staticRenderFns\n    options._compiled = true\n  }\n\n  // functional template\n  if (functionalTemplate) {\n    options.functional = true\n  }\n\n  // scopedId\n  if (scopeId) {\n    options._scopeId = 'data-v-' + scopeId\n  }\n\n  var hook\n  if (moduleIdentifier) {\n    // server build\n    hook = function (context) {\n      // 2.3 injection\n      context =\n        context || // cached call\n        (this.$vnode && this.$vnode.ssrContext) || // stateful\n        (this.parent && this.parent.$vnode && this.parent.$vnode.ssrContext) // functional\n      // 2.2 with runInNewContext: true\n      if (!context && typeof __VUE_SSR_CONTEXT__ !== 'undefined') {\n        context = __VUE_SSR_CONTEXT__\n      }\n      // inject component styles\n      if (injectStyles) {\n        injectStyles.call(this, context)\n      }\n      // register component module identifier for async chunk inferrence\n      if (context && context._registeredComponents) {\n        context._registeredComponents.add(moduleIdentifier)\n      }\n    }\n    // used by ssr in case component is cached and beforeCreate\n    // never gets called\n    options._ssrRegister = hook\n  } else if (injectStyles) {\n    hook = shadowMode\n      ? function () {\n          injectStyles.call(\n            this,\n            (options.functional ? this.parent : this).$root.$options.shadowRoot\n          )\n        }\n      : injectStyles\n  }\n\n  if (hook) {\n    if (options.functional) {\n      // for template-only hot-reload because in that case the render fn doesn't\n      // go through the normalizer\n      options._injectStyles = hook\n      // register for functional component in vue file\n      var originalRender = options.render\n      options.render = function renderWithStyleInjection(h, context) {\n        hook.call(context)\n        return originalRender(h, context)\n      }\n    } else {\n      // inject component registration as beforeCreate hook\n      var existing = options.beforeCreate\n      options.beforeCreate = existing ? [].concat(existing, hook) : [hook]\n    }\n  }\n\n  return {\n    exports: scriptExports,\n    options: options\n  }\n}\n","import { render, staticRenderFns } from \"./bWflow.vue?vue&type=template&id=6ce1dcb1&\"\nimport script from \"./bWflow.vue?vue&type=script&lang=js&\"\nexport * from \"./bWflow.vue?vue&type=script&lang=js&\"\nimport style0 from \"./bWflow.vue?vue&type=style&index=0&id=6ce1dcb1&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{ref:\"container\",staticClass:\"b-flow\",style:({ height: _vm.height })})\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div ref=\"container\" class=\"b-flow\" :style=\"{ height: height }\"></div>\n</template>\n<script>\n/* eslint-disable */\nimport \"diagram-js/assets/diagram-js.css\";\n\nimport Diagram from \"diagram-js\";\n\nimport ConnectModule from \"diagram-js/lib/features/connect\";\nimport CreateModule from \"diagram-js/lib/features/create\";\n\nimport MoveCanvasModule from \"diagram-js/lib/navigation/movecanvas\";\n\nimport ZoomScrollModule from \"diagram-js/lib/navigation/zoomscroll\";\n\n/** */\nimport myModelingModule from \"./modules/modeling\";\nimport myDraw from \"./modules/draw\";\n\nimport myImport from \"./modules/import\";\n\nimport { nodeToJson, importData } from \"./myflow\";\n\nexport default {\n  name: \"b-wflow-viewer\",\n  props: {\n    isSimple: Boolean,\n    isAutoHeight: {\n      type: Boolean,\n      default: true,\n    },\n\n    paletteOptions: Object,\n    lineStroke:String,\n  },\n  data() {\n    return {\n      scale: 1,\n      diagram: null,\n      viewHeight: 100,\n\n      nodeMap: {},\n      minX: 1000,\n      minY: 1000,\n\n      palette: {\n        \"create.start-event\": {\n          className: \"icon-start-event\",\n          type:'startEvent',\n          group:\"event\",\n          title:'',\n        },\n        \"create.end-event\": {\n          className: \"icon-end-event\",\n          type:'endEvent',\n          group:\"event\",\n          title:'',\n        },\n        \"create.and-gateway\": {\n          className: \"icon-gateway1\",\n          type:'gatewayAnd',\n          group:\"gateway\",\n          title:'',\n        },\n        \"create.xor-gateway\": {\n          className: \"icon-gateway2\",\n          type:'gatewayXor',\n          group:\"gateway\",\n          title:'',\n        },\n        \"create.inclusive-gateway\": {\n          className: \"icon-gateway3\",\n          type:'gatewayInclusive',\n          group:\"gateway\",\n          title:'',\n        },\n        \"create.task\": {\n          className: \"icon-gateway4\",\n          type:'userTask',\n          group:'activity',\n          title:'',\n        },\n        \"create.script\": {\n          className: \"icon-gateway5\",\n          type:'scriptTask',\n          group:\"activity\",\n          title:'',\n        },\n        \"create.subprocess\": {\n          className: \"icon-subprocess\",\n          type:'subprocess',\n          group:\"activity\",\n          title:'',\n        },\n      },\n    };\n  },\n  mounted() {\n    this.$nextTick(() => {\n      this.init();\n    });\n  },\n  computed: {\n    height() {\n      if (this.isAutoHeight) {\n        return \"100%\";\n      } else {\n        return `${this.viewHeight}px`;\n      }\n    },\n  },\n  methods: {\n    init() {\n      var container = this.$refs.container;\n      let myOptions = {\n        __init__: [\"myOptions\"],\n        myOptions: [\n          \"type\",\n          () => {\n            return {\n              palette: this.paletteOptions || this.palette,\n              lineStroke:this.lineStroke\n            };\n          },\n        ],\n      };\n\n      this.diagram = new Diagram({\n        canvas: {\n          container: container,\n        },\n        modules: [\n          ConnectModule,\n          CreateModule,\n          myModelingModule,\n          MoveCanvasModule,\n          ZoomScrollModule,\n\n          myOptions,\n          myDraw,\n          myImport,\n        ],\n      });\n      var canvas = this.diagram.get(\"canvas\"),\n        elementFactory = this.diagram.get(\"elementFactory\");\n\n      // add root\n      this.reset();\n      var root = elementFactory.createRoot();\n      canvas.setRootElement(root);\n\n      this.initEvent();\n\n      this.$emit(\"init\");\n    },\n    // \n    initEvent() {\n      const eventBus = this.diagram.get(\"eventBus\");\n\n      // \n      eventBus.on(\"element.dblclick\", (e) => {\n        this.$emit(\"elementDblclick\", e.element.businessObject);\n      });\n      // \n      eventBus.on(\"element.click\", (e) => {\n        this.$emit(\"elementClick\", e.element.businessObject);\n      });\n    },\n    reset() {\n      this.scale = 1;\n      this.diagram.get(\"canvas\").zoom(\"fit-viewport\");\n    },\n    handlerZoom(radio) {\n      const newScale = !radio ? 1.0 : this.scale + radio;\n      this.diagram.get(\"canvas\").zoom(newScale);\n      this.scale = newScale;\n    },\n    getData() {\n      const all = this.diagram.get(\"elementRegistry\").getAll();\n      var res = nodeToJson(all);\n      return res;\n    },\n    setData(data, radio) {\n      // \n      this.nodeMap = {};\n      data.forEach((node) => {\n        this.nodeMap[node.id] = node;\n        if (node.type != \"myline\") {\n          if (this.minX > node.x) {\n            this.minX = node.x;\n          }\n          if (this.minY > node.y) {\n            this.minY = node.y;\n          }\n        } else {\n          node.waypoint.forEach((line) => {\n            if (this.minX > line.x) {\n              this.minX = line.x;\n            }\n            if (this.minY > line.y) {\n              this.minY = line.y;\n            }\n          });\n          if (node.label) {\n            if (this.minX > node.label.x) {\n              this.minX = node.label.x;\n            }\n            if (this.minY > node.label.y) {\n              this.minY = node.label.y;\n            }\n          }\n        }\n      });\n\n      if (this.isSimple) {\n        data = this.makeSimple(data, radio);\n      }\n      if (!this.isAutoHeight) {\n        this.setVeiwHeight(data, radio);\n      }\n\n      this.$nextTick(() => {\n        this.diagram.clear();\n        this.reset();\n        importData(data, this.diagram);\n\n        setTimeout(() => {\n          if (radio != undefined) {\n            this.handlerZoom(radio);\n          }\n        }, 100);\n      });\n    },\n    updateElemet(data) {\n      let myImporter = this.diagram.get(\"myImporter\");\n      myImporter.update(data.id, data);\n    },\n\n    setVeiwHeight(data, radio) {\n      let maxY = 0;\n      data.forEach((node) => {\n        let y = 0;\n        switch (node.type) {\n          case \"userTask\":\n          case \"subprocess\":\n          case \"scriptTask\":\n            y = node.y + 77 * (1 + radio);\n            break;\n          case \"myline\":\n            y = node.y;\n            break;\n          default:\n            y = node.y + 77 * (1 + radio);\n            break;\n        }\n        if (maxY < y) {\n          maxY = y;\n        }\n      });\n      this.viewHeight = maxY + 16;\n    },\n    // \n    makeSimple(data, radio) {\n      const wfData = [];\n      // \n      radio = radio || 0;\n      const dX = this.minX - 16 - (51.8 * 10 * radio) / (1 + radio);\n      const dY = this.minY - 16 + (3 - 3 * 10 * radio) / (1 + radio);\n      console.log(data);\n      data.forEach((node) => {\n        if (node.label) {\n          node.label.x = node.label.x - dX;\n          node.label.y = node.label.y - dY;\n        }\n        if (node.type != \"myline\") {\n          if (node.type != \"scriptTask\") {\n            node.x = node.x - dX;\n            node.y = node.y - dY;\n            wfData.push(node);\n          }\n        } else {\n          node.waypoint.forEach((line) => {\n            line.x = line.x - dX;\n            line.y = line.y - dY;\n          });\n          if (\n            this.nodeMap[node.from].type != \"scriptTask\" &&\n            this.nodeMap[node.to].type != \"scriptTask\"\n          ) {\n            wfData.push(node);\n          }\n        }\n      });\n      return wfData;\n    },\n  },\n};\n</script>\n<style lang=\"less\">\n@import \"./index.less\";\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./bWflowViewer.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./bWflowViewer.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./bWflowViewer.vue?vue&type=template&id=7cdb0dd0&\"\nimport script from \"./bWflowViewer.vue?vue&type=script&lang=js&\"\nexport * from \"./bWflowViewer.vue?vue&type=script&lang=js&\"\nimport style0 from \"./bWflowViewer.vue?vue&type=style&index=0&id=7cdb0dd0&prod&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","import bWflow from './_src/bWflow.vue'\nimport bWflowViewer from './_src/bWflowViewer.vue'\nbWflow.install = function(Vue) {\n  Vue.component(bWflow.name, bWflow)\n  Vue.component(bWflowViewer.name, bWflowViewer)\n}\n\nexport default bWflow","import './styles/index.less'\nimport bWflow from './bWflow'\nconst prototypes = {\n}\n\nconst components = {\n  bWflow\n}\n\nconst install = function (Vue) {\n  if (install.installed) {\n    return\n  }\n\n  Object.values(components).map(component => {\n    Vue.use(component)\n  })\n\n  Object.keys(prototypes).forEach((key) => {\n    Vue.prototype['$' + key] = prototypes[key];\n  });\n}\n\n//  \nif (typeof window !== 'undefined' && window.Vue) {\n  install(window.Vue)\n}\n\nexport default {\n  install,\n  ...components\n}\n\nexport {\n  components\n}\n","import './setPublicPath'\nimport mod from '~entry'\nexport default mod\nexport * from '~entry'\n","module.exports = '\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003' +\n  '\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n"],"sourceRoot":""}