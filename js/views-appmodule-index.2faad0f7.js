(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views-appmodule-index"],{"193f":function(e,t,n){},"6de1":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("l-layout",{directives:[{name:"loading",rawName:"v-loading",value:e.moduleLoading,expression:"moduleLoading"}],staticClass:"l-tab-page",attrs:{left:544},scopedSlots:e._u([{key:"left",fn:function(){return[n("l-panel",{staticStyle:{"padding-right":"0px"}},[n("div",{staticClass:"l-auto-window",staticStyle:{padding:"0 8px"}},[n("el-tabs",{attrs:{"before-leave":e.handleRoleToUser},model:{value:e.tabsActiveName,callback:function(t){e.tabsActiveName=t},expression:"tabsActiveName"}},[n("el-tab-pane",{attrs:{label:e.$t("角色"),name:"tabRole"}},[n("l-layout",{attrs:{bottom:40},scopedSlots:e._u([{key:"bottom",fn:function(){return[n("el-input",{attrs:{placeholder:e.$t("请输入编号/名称"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearchRole.apply(null,arguments)}},model:{value:e.searchRoleWord,callback:function(t){e.searchRoleWord=t},expression:"searchRoleWord"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearchRole},slot:"append"})],1)]},proxy:!0}])},[n("div",{staticClass:"l-rblock",staticStyle:{"padding-top":"8px"}},[n("l-table",{attrs:{highlightCurrentRow:!0,columns:e.roleColumns,dataSource:e.searchRoleData},on:{rowClick:e.handleRowClick}})],1)])],1),n("el-tab-pane",{attrs:{label:e.$t("人员"),name:"tabUser"}},[n("l-layout",{attrs:{bottom:40},scopedSlots:e._u([{key:"bottom",fn:function(){return[n("el-input",{attrs:{placeholder:e.$t("请输入帐号/名称"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearchUser.apply(null,arguments)}},model:{value:e.searchUserWord,callback:function(t){e.searchUserWord=t},expression:"searchUserWord"}},[n("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearchUser},slot:"append"})],1)]},proxy:!0}])},[n("div",{staticClass:"l-rblock",staticStyle:{"padding-top":"8px"}},[n("l-table",{attrs:{highlightCurrentRow:!0,columns:e.userColumns,dataSource:e.userData,"row-key":"f_UserId",isPage:!0,pageTotal:e.userTotal,tablePage:e.userCurrentPage},on:{rowClick:e.handleRowClick,"update:tablePage":function(t){e.userCurrentPage=t},"update:table-page":function(t){e.userCurrentPage=t},loadPageData:e.turnUserPage},scopedSlots:e._u([{key:"f_CompanyId",fn:function(t){return[e._v(" "+e._s((e.lr_companyList.find((function(e){return e.f_CompanyId==t.row.f_CompanyId}))||{}).f_FullName||"")+" ")]}},{key:"f_DepartmentId",fn:function(t){return[e._v(" "+e._s(e.lr_departmentName(e.lr_departments[t.row.f_CompanyId]||[],t.row.f_DepartmentId))+" ")]}}])})],1)])],1)],1)],1)])]},proxy:!0}])},[n("l-panel",{staticStyle:{"padding-left":"0px"},attrs:{title:e.type+(e.name?"-":"")+e.name}},[n("div",{staticClass:"l-auto-window",staticStyle:{padding:"0 8px"}},[n("el-tabs",{attrs:{"before-leave":e.handleTabLeave},model:{value:e.tabsActiveName2,callback:function(t){e.tabsActiveName2=t},expression:"tabsActiveName2"}},[n("el-tab-pane",{attrs:{label:e.$t("功能"),name:"tabModule"}},[e.isSelectOne?n("l-layout",{attrs:{bottom:40},scopedSlots:e._u([{key:"bottom",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{disabled:!e.isSaveApp,size:"mini"},on:{click:e.handleAppCancel}},[e._v(e._s(e.$t("取消")))]),n("el-button",{attrs:{disabled:!e.isSaveApp,size:"mini",type:"primary"},on:{click:e.handleAppSave}},[e._v(e._s(e.$t("保存")))])],1)]},proxy:!0}])},[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto"}},[n("el-tree",{ref:"appTree",attrs:{data:e.appTree,"show-checkbox":"","default-expand-all":"","node-key":"f_Id"},on:{check:e.handleAppCheck},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(a.label))+" ")])}}])})],1)]):n("div",{staticClass:"empty-text"},[e._v(e._s(e.emptyText))])],1),n("el-tab-pane",{attrs:{label:e.$t("按钮"),name:"tabButton"}},[e.isSelectOne?n("l-layout",{attrs:{left:240,bottom:40},scopedSlots:e._u([{key:"left",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto","border-right":"1px solid #E4E7ED"}},[n("el-tree",{attrs:{data:e.myAppTree,"default-expand-all":"","node-key":"f_Id"},on:{"node-click":e.handleModuleClick},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(a.label))+" ")])}}])})],1)]},proxy:!0},{key:"bottom",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{disabled:!e.isSaveButton,size:"mini"},on:{click:e.handleButtonCancel}},[e._v(e._s(e.$t("取消")))]),n("el-button",{attrs:{disabled:!e.isSaveButton,size:"mini",type:"primary"},on:{click:e.handleButtonSave}},[e._v(e._s(e.$t("保存")))])],1)]},proxy:!0}])},[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto"}},[n("el-tree",{ref:"buttonTree",attrs:{data:e.buttonTree,"show-checkbox":"","default-expand-all":"","node-key":"f_Code"},on:{check:e.handleButtonCheck},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(a.label))+" ")])}}])})],1)]):n("div",{staticClass:"empty-text"},[e._v(e._s(e.emptyText))])],1),n("el-tab-pane",{attrs:{label:e.$t("列表"),name:"tabCol"}},[e.isSelectOne?n("l-layout",{attrs:{left:240,bottom:40},scopedSlots:e._u([{key:"left",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto","border-right":"1px solid #E4E7ED"}},[n("el-tree",{attrs:{data:e.myAppTree,"default-expand-all":"","node-key":"f_Id"},on:{"node-click":e.handleColModuleClick},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(a.label))+" ")])}}])})],1)]},proxy:!0},{key:"bottom",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{disabled:!e.isSaveColumn,size:"mini"},on:{click:e.handleColumnCancel}},[e._v(e._s(e.$t("取消")))]),n("el-button",{attrs:{disabled:!e.isSaveColumn,size:"mini",type:"primary"},on:{click:e.handleColumnSave}},[e._v(e._s(e.$t("保存")))])],1)]},proxy:!0}])},[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto"}},[n("el-tree",{ref:"columnTree",attrs:{data:e.columnTree,"show-checkbox":"","default-expand-all":"","node-key":"f_Code"},on:{check:e.handleColumnCheck},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(a.label))+" ")])}}])})],1)]):n("div",{staticClass:"empty-text"},[e._v(e._s(e.emptyText))])],1),n("el-tab-pane",{attrs:{label:e.$t("表单"),name:"tabForm"}},[e.isSelectOne?n("l-layout",{attrs:{left:240,bottom:40},scopedSlots:e._u([{key:"left",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto","border-right":"1px solid #E4E7ED"}},[n("el-tree",{attrs:{data:e.myAppTree,"default-expand-all":"","node-key":"f_Id"},on:{"node-click":e.handleFormModuleClick},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(a.label))+" ")])}}])})],1)]},proxy:!0},{key:"bottom",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{disabled:!e.isSaveForm,size:"mini"},on:{click:e.handleFormCancel}},[e._v(e._s(e.$t("取消")))]),n("el-button",{attrs:{disabled:!e.isSaveForm,size:"mini",type:"primary"},on:{click:e.handleFormSave}},[e._v(e._s(e.$t("保存")))])],1)]},proxy:!0}])},[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto"}},[n("l-table",{attrs:{columns:e.formColumns,dataSource:e.formTableData},scopedSlots:e._u([{key:"isEdit",fn:function(t){return[t.row.noEdit?e._e():n("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(n){return e.handleFormCheck(t.row,!1)}},model:{value:t.row.isEdit,callback:function(n){e.$set(t.row,"isEdit",n)},expression:"scope.row.isEdit"}})]}},{key:"isLook",fn:function(t){return[n("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(n){return e.handleFormCheck(t.row,!0)}},model:{value:t.row.isLook,callback:function(n){e.$set(t.row,"isLook",n)},expression:"scope.row.isLook"}})]}}])})],1)]):n("div",{staticClass:"empty-text"},[e._v(e._s(e.emptyText))])],1)],1)],1)])],1)},r=[],o=(n("99af"),n("4de4"),n("7db0"),n("c740"),n("d81d"),n("a434"),n("b0c0"),n("d3b7"),n("ac1f"),n("3ca3"),n("1276"),n("159b"),n("ddb0"),n("2909")),s=(n("96cf"),n("1da1")),i=window.$api.permission.module,u=window.$api.organization.role,c=window.$api.organization.user,l=window.$api.mapp.module,d={data:function(){return{lr_isPage:!0,lr_isAuth:!1,tabsActiveName:"tabRole",tabsActiveName2:"tabModule",name:"",id:"",searchRoleWord:"",searchRoleData:[],roleData:[],roleColumns:[{label:"编号",prop:"f_EnCode",minWidth:"110"},{label:"名称",prop:"f_FullName",minWidth:"120"}],searchUserWord:"",userData:[],userColumns:[{label:"姓名",prop:"f_RealName",width:"88"},{label:"账号",prop:"f_Account",width:"88"},{label:"公司",prop:"f_CompanyId",minWidth:"100"},{label:"部门",prop:"f_DepartmentId",minWidth:"100"}],userTotal:0,userPageSize:50,userCurrentPage:1,isSelectOne:!1,moduleLoading:!1,apps:[],myapps:[],appOldChecked:[],appChecked:[],notAuthList:[],moduleId:"",buttons:[],mybuttons:[],buttonList:[],buttonChecked:[],notAuthButtonList:[],columns:[],mycolumns:[],columnList:[],columnChecked:[],notAuthColumnList:[],forms:[],myforms:[],formList:[],formChecked:[],notAuthFormList:[],formColumns:[{label:"名称",prop:"f_Name",minWidth:"100"},{label:"编辑",prop:"isEdit",width:"64",align:"center"},{label:"查看",prop:"isLook",width:"64",align:"center"}],formTableData:[]}},mounted:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.moduleLoading=!0,t.next=3,Promise.all([e.loadRoleData(),e.lr_loadCompanys(),e.loadUserData(),e.loadAppList()]);case 3:e.moduleLoading=!1;case 4:case"end":return t.stop()}}),t)})))()},computed:{type:function(){return"tabRole"==this.tabsActiveName?this.$t("角色"):this.$t("人员")},emptyText:function(){return"tabRole"==this.tabsActiveName?this.$t("请选择一个角色查看"):this.$t("请选择一个人员查看")},myButtons:function(){var e=this,t=this.appList.find((function(t){return t.f_Id==e.moduleId}));return t&&t.f_CreateUserId==this.loginInfo.f_UserId?this.buttons:this.buttons.filter((function(t){return-1!=e.mybuttons.indexOf(t.f_Code)}))},buttonTree:function(){var e=this.buttons;this.lr_IsAdmin||(e=this.myButtons);var t=this.$toTree(e,"f_Id","f_ParentId","f_Code","f_Name");return t},isSaveButton:function(){return!this.equalsArr(this.buttonList,this.buttonChecked)},myColumns:function(){var e=this,t=this.appList.find((function(t){return t.f_Id==e.moduleId}));return t&&t.f_CreateUserId==this.loginInfo.f_UserId?this.columns:this.columns.filter((function(t){return-1!=e.mycolumns.indexOf(t.f_Code)}))},columnTree:function(){var e=this.columns;this.lr_IsAdmin||(e=this.myColumns);var t=this.$toTree(e,"f_Id","f_ParentId","f_Code","f_Name");return t},isSaveColumn:function(){return!this.equalsArr(this.columnList,this.columnChecked)},isSaveForm:function(){return!this.equalsArr(this.formList,this.formChecked)},isSaveApp:function(){return!this.equalsArr(this.appOldChecked,this.appChecked)},myApps:function(){var e=this;return this.lr_IsAdmin?this.apps:this.apps.filter((function(t){return-1!=e.myapps.indexOf(t.f_Id)||t.f_CreateUserId==e.loginInfo.f_UserId}))},appList:function(){return this.myApps},appTree:function(){return this.getAppTree(this.appList)},myAppTree:function(){var e=this,t=this.appList.filter((function(t){return 3!=t.f_IsSystem&&4!=t.f_IsSystem&&e.appChecked.indexOf(t.f_Id)>-1}));return this.getAppTree(t)}},methods:{equalsArr:function(e,t){var n=!0;return e.length!==t.length?n=!1:e.forEach((function(e){-1===t.indexOf(e)&&(n=!1)})),n},getAppTree:function(e){var t={},n=[],a=this.lr_dataItem["function"];return a.forEach((function(e){var a={label:e.f_ItemName,value:e.f_ItemValue,children:[]};t[e.f_ItemValue]=a.children,n.push(a)})),e.forEach((function(e){if(e.label=e.f_Name,e.value=e.f_Id,!t[e.f_Type]){var a={label:e.f_Type,value:e.f_Type,children:[]};t[e.f_Type]=a.children,n.push(a)}t[e.f_Type].push(e)})),n.filter((function(e){return e.children.length>0}))},handleRoleToUser:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.leave();case 2:e.name="",e.id="",e.isSelectOne=!1;case 5:case"end":return t.stop()}}),t)})))()},hanleSearchRole:function(){var e=this;this.searchRoleWord?this.searchRoleData=this.roleData.filter((function(t){return t.f_FullName.indexOf(e.searchRoleWord)>-1||t.f_EnCode.indexOf(e.searchRoleWord)>-1})):this.searchRoleData=this.roleData},loadRoleData:function(){var e=this;u.getList().then((function(t){e.searchRoleWord="",e.roleData=t.data.data.filter((function(e){return 1==e.f_EnabledMark})),e.searchRoleData=e.roleData}))},loadUserData:function(e){var t=this;e||(this.userCurrentPage=1);var n={rows:this.userPageSize,page:this.userCurrentPage,sidx:"F_CreateDate DESC",keyword:this.searchUserWord};c.getPage(n).then((function(e){var n=t.$deepClone(e.data.data);n.rows.forEach((function(e){t.lr_loadDepartments(e.f_CompanyId)})),t.userData=n.rows,t.userTotal=n.records})).catch((function(){t.userData=[]}))},turnUserPage:function(e){var t=e.rows;this.tablePageSize=t,this.loadUserData(!0)},hanleSearchUser:function(){this.loadUserData()},handleRowClick:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a=e.row,n.next=3,t.leave();case 3:"tabRole"==t.tabsActiveName?(t.name=a.f_FullName,t.id=a.f_RoleId):(t.name=a.f_RealName,t.id=a.f_UserId),t.isSelectOne=!0,t.moduleChecked=[],t.moduleList=[],t.loadApps();case 8:case"end":return n.stop()}}),n)})))()},leave:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.t0=e.tabsActiveName2,t.next="tabModule"===t.t0?3:"tabButton"===t.t0?6:"tabCol"===t.t0?9:"tabForm"===t.t0?12:15;break;case 3:return t.next=5,e.leaveModule();case 5:return t.abrupt("break",15);case 6:return t.next=8,e.leaveButton();case 8:return t.abrupt("break",15);case 9:return t.next=11,e.leaveColumn();case 11:return t.abrupt("break",15);case 12:return t.next=14,e.leaveForm();case 14:return t.abrupt("break",15);case 15:case"end":return t.stop()}}),t)})))()},handleTabLeave:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.t0=e.tabsActiveName2,t.next="tabModule"===t.t0?3:"tabButton"===t.t0?6:"tabCol"===t.t0?9:"tabForm"===t.t0?12:"tabApp"===t.t0?15:18;break;case 3:return t.next=5,e.leaveModule2();case 5:return t.abrupt("break",18);case 6:return t.next=8,e.leaveButton();case 8:return t.abrupt("break",18);case 9:return t.next=11,e.leaveColumn();case 11:return t.abrupt("break",18);case 12:return t.next=14,e.leaveForm();case 14:return t.abrupt("break",18);case 15:return t.next=17,e.leaveApp2();case 17:return t.abrupt("break",18);case 18:case"end":return t.stop()}}),t)})))()},loadAppList:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.lr_loadDataItem("function");case 2:return t.next=4,e.$awaitWraper(l.getList());case 4:e.apps=t.sent;case 5:case"end":return t.stop()}}),t)})))()},loadApps:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$awaitWraper(i.getList(e.id,5,"0"));case 2:n=t.sent,e.myapps=n.myList||[],e.appOldChecked=n.settingList.map((function(e){return e.f_ItemId})),e.$refs.appTree.setCheckedKeys(e.appOldChecked),a=n.settingList.filter((function(t){return e.apps.findIndex((function(e){return e.f_Id==t.f_ItemId}))>-1&&-1==e.myApps.findIndex((function(e){return e.f_Id==t.f_ItemId}))})),e.notAuthList=a.map((function(e){return e.f_ItemId})),e.$nextTick((function(){var t=e.$refs.appTree.getCheckedKeys(),n=e.$refs.appTree.getHalfCheckedKeys();e.appChecked=t.concat(n).filter((function(e){return void 0!=e}))}));case 9:case"end":return t.stop()}}),t)})))()},handleAppCheck:function(e,t){this.appChecked=t.checkedKeys.concat(t.halfCheckedKeys).filter((function(e){return void 0!=e}))},handleAppCancel:function(){this.appChecked=this.$deepClone(this.appOldChecked),this.$refs.formTree.setCheckedKeys(this.appChecked)},handleAppSave:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.moduleLoading=!0,n=[],n.push.apply(n,Object(o["a"])(e.notAuthList)),n.push.apply(n,Object(o["a"])(e.appChecked)),a={ids:n,objectType:"tabRole"==e.tabsActiveName?1:2,itemType:5,parentId:"0"},t.next=7,e.$awaitWraper(i.save(e.id,a));case 7:r=t.sent,r&&(e.$message({type:"success",message:e.$t("保存成功!")}),e.appOldChecked=e.$deepClone(e.appChecked)),e.moduleLoading=!1;case 10:case"end":return t.stop()}}),t)})))()},leaveModule:function(){var e=this;return new Promise((function(t){e.isSaveApp?e.$confirm(e.$t("离开前,是否保存设置数据?"),e.$t("提示"),{confirmButtonText:e.$t("确定"),cancelButtonText:e.$t("取消"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.handleAppSave();case 2:e.appOldChecked=[],e.appChecked=[],e.myapps=[],t();case 6:case"end":return n.stop()}}),n)})))).catch((function(){e.appOldChecked=[],e.appChecked=[],e.myapps=[],t()})):(e.appOldChecked=[],e.appChecked=[],e.myapps=[],t())}))},leaveModule2:function(){var e=this;return new Promise((function(t){e.isSaveApp?e.$confirm(e.$t("离开前,是否保存设置数据?"),e.$t("提示"),{confirmButtonText:e.$t("确定"),cancelButtonText:e.$t("取消"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.handleAppSave();case 2:t();case 3:case"end":return n.stop()}}),n)})))):t()}))},handleModuleClick:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.moduleId!=e.value){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.leaveButton();case 4:if(t.moduleId=e.value,!e.children){n.next=12;break}t.buttons=[],t.mybuttons=[],t.buttonList=[],t.buttonChecked=[],n.next=26;break;case 12:return t.moduleLoading=!0,a={f_Id:"0",f_ParentId:"01",f_Code:"0",f_Name:e.f_Name},n.next=16,t.$awaitWraper(l.getChildren(e.value,1));case 16:return r=n.sent,r.forEach((function(e){return e.f_ParentId="0"})),r.push(a),n.next=21,t.loadButtons(e.value);case 21:t.buttons=r,t.$refs.buttonTree.setCheckedKeys(t.buttonList),t.notAuthButtonList=t.buttonList.filter((function(e){return t.buttons.findIndex((function(t){return t.f_Code==e}))>-1&&-1==t.myButtons.findIndex((function(t){return t.f_Code==e}))})),t.$nextTick((function(){var e=t.$refs.buttonTree.getCheckedKeys(),n=t.$refs.buttonTree.getHalfCheckedKeys();t.buttonChecked=e.concat(n).filter((function(e){return"0"!=e}))})),t.moduleLoading=!1;case 26:case"end":return n.stop()}}),n)})))()},loadButtons:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$awaitWraper(i.getList(t.id,6,e));case 2:a=n.sent,t.mybuttons=a.myList||[],t.buttonList=a.settingList.map((function(e){return e.f_ItemId}));case 5:case"end":return n.stop()}}),n)})))()},handleButtonCheck:function(e,t){this.buttonChecked=t.checkedKeys.concat(t.halfCheckedKeys).filter((function(e){return"0"!=e}))},handleButtonCancel:function(){this.buttonChecked=this.$deepClone(this.buttonList),this.$refs.buttonTree.setCheckedKeys(this.buttonChecked)},handleButtonSave:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.moduleLoading=!0,n=[],n.push.apply(n,Object(o["a"])(e.notAuthButtonList)),n.push.apply(n,Object(o["a"])(e.buttonChecked)),a={ids:n,objectType:"tabRole"==e.tabsActiveName?1:2,itemType:6,parentId:e.moduleId},t.next=7,e.$awaitWraper(i.save(e.id,a));case 7:r=t.sent,r&&(e.$message({type:"success",message:e.$t("保存成功!")}),e.buttonList=e.$deepClone(e.buttonChecked)),e.moduleLoading=!1;case 10:case"end":return t.stop()}}),t)})))()},leaveButton:function(){var e=this;return new Promise((function(t){e.isSaveButton?e.$confirm(e.$t("离开前,是否保存设置数据?"),e.$t("提示"),{confirmButtonText:e.$t("确定"),cancelButtonText:e.$t("取消"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.handleButtonSave();case 2:e.buttonList=[],e.buttonChecked=[],e.mybuttons=[],e.buttons=[],e.moduleId="",t();case 8:case"end":return n.stop()}}),n)})))).catch((function(){e.buttonList=[],e.buttonChecked=[],e.mybuttons=[],e.buttons=[],e.moduleId="",t()})):(e.buttonList=[],e.buttonChecked=[],e.mybuttons=[],e.buttons=[],e.moduleId="",t())}))},handleColModuleClick:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a,r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.moduleId!=e.value){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.leaveColumn();case 4:if(t.moduleId=e.value,!e.children){n.next=12;break}t.columns=[],t.mycolumns=[],t.columnList=[],t.columnChecked=[],n.next=26;break;case 12:return t.moduleLoading=!0,a={f_Id:"0",f_ParentId:"01",f_Code:"0",f_Name:e.f_Name},n.next=16,t.$awaitWraper(l.getChildren(e.value,2));case 16:return r=n.sent,r.forEach((function(e){return e.f_ParentId="0"})),r.push(a),n.next=21,t.loadColumns(e.value);case 21:t.columns=r,t.$refs.columnTree.setCheckedKeys(t.columnList),t.notAuthColumnList=t.columnList.filter((function(e){return t.columns.findIndex((function(t){return t.f_Code==e}))>-1&&-1==t.myColumns.findIndex((function(t){return t.f_Code==e}))})),t.$nextTick((function(){var e=t.$refs.columnTree.getCheckedKeys(),n=t.$refs.columnTree.getHalfCheckedKeys();t.columnChecked=e.concat(n).filter((function(e){return"0"!=e}))})),t.moduleLoading=!1;case 26:case"end":return n.stop()}}),n)})))()},loadColumns:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$awaitWraper(i.getList(t.id,7,e));case 2:a=n.sent,t.mycolumns=a.myList||[],t.columnList=a.settingList.map((function(e){return e.f_ItemId}));case 5:case"end":return n.stop()}}),n)})))()},handleColumnCheck:function(e,t){this.columnChecked=t.checkedKeys.concat(t.halfCheckedKeys).filter((function(e){return"0"!=e}))},handleColumnCancel:function(){this.columnChecked=this.$deepClone(this.columnList),this.$refs.columnTree.setCheckedKeys(this.columnChecked)},handleColumnSave:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.moduleLoading=!0,n=[],n.push.apply(n,Object(o["a"])(e.notAuthColumnList)),n.push.apply(n,Object(o["a"])(e.columnChecked)),a={ids:n,objectType:"tabRole"==e.tabsActiveName?1:2,itemType:7,parentId:e.moduleId},t.next=7,e.$awaitWraper(i.save(e.id,a));case 7:r=t.sent,r&&(e.$message({type:"success",message:e.$t("保存成功!")}),e.columnList=e.$deepClone(e.columnChecked)),e.moduleLoading=!1;case 10:case"end":return t.stop()}}),t)})))()},leaveColumn:function(){var e=this;return new Promise((function(t){e.isSaveColumn?e.$confirm(e.$t("离开前,是否保存设置数据?"),e.$t("提示"),{confirmButtonText:e.$t("确定"),cancelButtonText:e.$t("取消"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.handleColumnSave();case 2:e.columnList=[],e.columnChecked=[],e.mycolumns=[],e.columns=[],e.moduleId="",t();case 8:case"end":return n.stop()}}),n)})))).catch((function(){e.columnList=[],e.columnChecked=[],e.mycolumns=[],e.columns=[],e.moduleId="",t()})):(e.columnList=[],e.columnChecked=[],e.mycolumns=[],e.columns=[],e.moduleId="",t())}))},handleFormModuleClick:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.moduleId!=e.value){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.leaveForm();case 4:if(t.moduleId=e.value,"expand"!=e.f_Target){n.next=12;break}t.forms=[],t.myforms=[],t.formList=[],t.formChecked=[],n.next=21;break;case 12:return t.moduleLoading=!0,n.next=15,t.$awaitWraper(l.getChildren(e.value,3));case 15:return a=n.sent,n.next=18,t.loadForms(e.value);case 18:t.forms=a,t.setFormTableData(),t.moduleLoading=!1;case 21:case"end":return n.stop()}}),n)})))()},loadForms:function(e){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function n(){var a;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$awaitWraper(i.getList(t.id,8,e));case 2:a=n.sent,t.myforms=a.myList||[],t.formList=a.settingList.map((function(e){return"".concat(e.f_ItemId,",").concat(e.f_Type||2)}));case 5:case"end":return n.stop()}}),n)})))()},setFormTableData:function(){var e=this,t=[];this.notAuthFormList=[];var n=this.appList.find((function(t){return t.f_Id==e.moduleId}));if(this.lr_IsAdmin||n.f_CreateUserId==this.loginInfo.f_UserId)this.forms.forEach((function(e){t.push({f_Name:e.f_Name,f_Code:e.f_Code,isEdit:0,isLook:0})}));else{var a={};this.myforms.forEach((function(e){var t=e.split(",");a[t[0].toLowerCase()]=t[1]})),this.forms.forEach((function(n){if(a[n.f_Code.toLowerCase()])1==a[n.f_Code.toLowerCase()]?t.push({f_Name:n.f_Name,f_Code:n.f_Code,noEdit:!0,isEdit:0,isLook:0}):t.push({f_Name:n.f_Name,f_Code:n.f_Code,isEdit:0,isLook:0});else{var r=e.formList.find((function(e){return e.indexOf(n.f_Code.toLowerCase()+",")>-1}));r&&e.notAuthFormList.push(r)}}))}var r={};this.formList.forEach((function(e){var t=e.split(",");r[t[0].toLowerCase()]=t[1]}));var o=[];t.forEach((function(e){r[e.f_Code.toLowerCase()]&&(e.isLook=1,1!=r[e.f_Code.toLowerCase()]&&(e.isEdit=1),o.push("".concat(e.f_Code,",").concat(r[e.f_Code.toLowerCase()])))})),this.formChecked=o,this.formTableData=t},handleFormCheck:function(e,t){var n=this.formChecked.findIndex((function(t){return t.split(",")[0].toLowerCase()==e.f_Code.toLowerCase()})),a=0;1==e.isLook?a=1:t&&(e.isEdit=0),1==e.isEdit&&(a=2,t||(e.isLook=1)),-1==n&&0!=a?this.formChecked.push("".concat(e.f_Code,",").concat(a)):(this.formChecked.splice(n,1),0!=a&&this.formChecked.push("".concat(e.f_Code,",").concat(a)))},handleFormCancel:function(){this.formChecked=this.$deepClone(this.formList),this.setFormTableData()},handleFormSave:function(){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function t(){var n,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.moduleLoading=!0,n={ids:e.formChecked,objectType:"tabRole"==e.tabsActiveName?1:2,itemType:8,parentId:e.moduleId},t.next=4,e.$awaitWraper(i.save(e.id,n));case 4:a=t.sent,a&&(e.$message({type:"success",message:e.$t("保存成功!")}),e.formList=e.$deepClone(e.formChecked)),e.moduleLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},leaveForm:function(){var e=this;return new Promise((function(t){e.isSaveForm?e.$confirm(e.$t("离开前,是否保存设置数据?"),e.$t("提示"),{confirmButtonText:e.$t("确定"),cancelButtonText:e.$t("取消"),type:"warning"}).then(Object(s["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.handleFormSave();case 2:e.formList=[],e.formChecked=[],e.myforms=[],e.forms=[],e.formTableData=[],e.moduleId="",t();case 9:case"end":return n.stop()}}),n)})))).catch((function(){e.formList=[],e.formChecked=[],e.myforms=[],e.forms=[],e.formTableData=[],e.moduleId="",t()})):(e.formList=[],e.formChecked=[],e.myforms=[],e.forms=[],e.formTableData=[],e.moduleId="",t())}))}}},f=d,m=(n("db6c"),n("2877")),p=Object(m["a"])(f,a,r,!1,null,"1631d9fa",null);t["default"]=p.exports},db6c:function(e,t,n){"use strict";n("193f")}}]);