(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["customer"],{"1e3b":function(e,t,a){"use strict";a("dc5d")},dc5d:function(e,t,a){},f134:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("l-layout",{directives:[{name:"show",rawName:"v-show",value:!e.lr_loadPage,expression:"!lr_loadPage"}],staticClass:"l-tab-page erpCase custmer"},[e.showDetails?e._e():a("l-panel",{scopedSlots:e._u([{key:"title",fn:function(){return[a("div",[e._v(e._s(e.$t("客户列表")))]),a("div",{staticStyle:{width:"560px"}},[a("div",{staticClass:"ml-8",staticStyle:{float:"right"}},[a("l-tool-btns",{attrs:{hasRefresh:!1},on:{setting:e.lr_handleSettingTable,click:function(t){return e.handleAdd()}}},[a("el-button-group",[e.lr_hasPageAuth("AddOpens","buttons")?a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleAddOpens}},[e._v(e._s(e.$t("加入公海")))]):e._e()],1),a("l-excel-btns")],1)],1)])]},proxy:!0},{key:"toolLeft",fn:function(){return[a("l-query2",{attrs:{items:e.queryItems,formData:e.queryData,loading:e.tableLoading},on:{search:e.handleSearch},scopedSlots:e._u([{key:"f_Type",fn:function(){return[a("l-select",{attrs:{options:e.f_TypeOptions},model:{value:e.queryData.f_Type,callback:function(t){e.$set(e.queryData,"f_Type",t)},expression:"queryData.f_Type"}})]},proxy:!0},{key:"f_Source",fn:function(){return[a("l-select",{attrs:{options:e.f_SourceOptions},model:{value:e.queryData.f_Source,callback:function(t){e.$set(e.queryData,"f_Source",t)},expression:"queryData.f_Source"}})]},proxy:!0},{key:"f_CreateDate",fn:function(){return[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.queryData.f_CreateDate,callback:function(t){e.$set(e.queryData,"f_CreateDate",t)},expression:"queryData.f_CreateDate"}})]},proxy:!0},{key:"f_Name",fn:function(){return[a("el-input",{attrs:{placeholder:e.$t("请输入关键词")},model:{value:e.queryData.f_Name,callback:function(t){e.$set(e.queryData,"f_Name",t)},expression:"queryData.f_Name"}})]},proxy:!0}],null,!1,711555689)})]},proxy:!0}],null,!1,1237941084)},[a("l-table",{ref:"mainTable",attrs:{isMultiSelect:"",loading:e.tableLoading,columns:e.lr_getPageColumns(e.columns),"row-key":"f_Id",dataSource:e.tableData,isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage}},[a("l-table-btns",{attrs:{btns:e.tableBtns,btnNum:5},on:{click:e.lr_handleTableBtnClick}})],1)],1),a("transition",{attrs:{name:"el-zoom-in-center"}},[e.showDetails?a("l-panel",{scopedSlots:e._u([{key:"title",fn:function(){return[a("el-page-header",{attrs:{content:e.$t(e.show_name)},on:{back:function(t){e.showDetails=!1}}})]},proxy:!0}],null,!1,3435940979)},[a("DetailForm",{ref:"detailForm"})],1):e._e()],1),a("l-dialog",{attrs:{title:e.$t(e.formTitle),visible:e.formVisible,height:600,width:800},on:{"update:visible":function(t){e.formVisible=t},ok:e.handleSave,close:e.handleCloseForm,opened:e.handleOpenedForm}},["客户跟进"==e.formTitle?a("follow-up-form",{ref:"followForm"}):a("my-form",{ref:"form",attrs:{f_State:"0"}})],1),a("l-dialog",{attrs:{title:e.$t(e.formTitle),visible:e.transferVisible,height:100,width:300},on:{"update:visible":function(t){e.transferVisible=t},ok:e.transferSave,close:e.transferCloseForm}},[a("div",{staticClass:"form_flex_center"},[a("l-user-select",{staticStyle:{width:"200px","margin-left":"50px","margin-top":"20px"},attrs:{clearable:!1},model:{value:e.transferList.caseErpCustomerEntity.f_SaleId,callback:function(t){e.$set(e.transferList.caseErpCustomerEntity,"f_SaleId",t)},expression:"transferList.caseErpCustomerEntity.f_SaleId"}})],1)])],1)},n=[],l=(a("a15b"),a("d81d"),a("a434"),a("96cf"),a("1da1")),o=a("4656"),s=a("9c9b"),i=a("aac0"),u=window.$api.erpcase.customer,f={components:{MyForm:o["default"],FollowUpForm:s["default"],DetailForm:i["default"]},data:function(){return{lr_isPage:!0,moduleCode:"ERP_Customers",queryData:{f_Type:"",f_Source:"",f_Name:""},queryItems:[{label:"客户类型",prop:"f_Type"},{label:"来源",prop:"f_Source"},{label:"客户名称",prop:"f_Name"},{label:"创建日期",prop:"f_CreateDate"}],tableLoading:!1,tableData:[],tableTotal:0,tableCurrentPage:1,tablePageSize:50,columns:[{label:"客户名称",prop:"f_Name",align:"left",dataType:"input",width:200,isNotAutoWrap:!0},{label:"客户类型",prop:"f_Type",align:"left",dataType:"mydata",options:[{value:" 普通客户",label:" 普通客户"},{value:"重要客户",label:"重要客户"},{value:"SVIP客户",label:"SVIP客户"}]},{label:"联系人",prop:"f_DefaultName",align:"left",dataType:"input"},{label:"手机号码",prop:"f_DefaultPhone",align:"left",dataType:"input",width:120},{label:"所在行业",prop:"f_Industry",align:"left",dataType:"input"},{label:"来源",prop:"f_Source",align:"left",dataType:"mydata",options:[{value:"电话销售",label:"电话销售"},{value:"主动来电 ",label:"主动来电"},{value:"客户介绍",label:"客户介绍"},{label:"访问官网",value:"访问官网"},{label:"其他途径",value:"其他途径"}]},{label:"归属",prop:"f_SaleId",align:"left",dataType:"user",width:120},{label:"创建日期",prop:"f_CreateDate",align:"left",dataType:"datetime",format:"yyyy-MM-dd",width:120},{label:"创建人",prop:"f_CreateUserName",align:"left",dataType:"input",width:120}],tableBtns:[{prop:"FollowUp",label:"跟进"},{prop:"Details",label:"详情查看",width:80},{prop:"Edit",label:"编辑"},{prop:"Transfer",label:"转移"},{prop:"Delete",label:"删除"}],formVisible:!1,formTitle:"",formEditRow:null,formEdit:!1,showDetails:!1,show_name:"",detailForm:{},transferList:{caseErpCustomerEntity:{f_SaleId:""}},transferVisible:!1}},computed:{f_TypeOptions:function(){return[{value:"",label:"全部"},{value:" 普通客户",label:" 普通客户"},{value:"重要客户",label:"重要客户"},{value:"SVIP客户",label:"SVIP客户"}]},f_SourceOptions:function(){return[{value:"",label:"全部"},{value:"电话销售",label:"电话销售"},{value:"主动来电 ",label:"主动来电"},{value:"客户介绍",label:"客户介绍"},{label:"访问官网",value:"访问官网"},{label:"其他途径",value:"其他途径"}]}},mounted:function(){this.init()},methods:{init:function(){this.loadTableData()},handleSearch:function(){this.loadTableData()},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTableData(!0)},loadTableData:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var r,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(t.tableCurrentPage=1),t.tableLoading=!0,r=t.$deepClone(t.queryData),r.rows=t.tablePageSize,r.page=t.tableCurrentPage,r.sidx="F_Id",r.f_State=0,a.next=9,t.$awaitWraper(u.getPage(r));case 9:n=a.sent,null!=n?(t.tableData=n.rows,t.tableTotal=n.records):t.tableData=[],t.tableLoading=!1;case 12:case"end":return a.stop()}}),a)})))()},handleAdd:function(){this.formEdit=!1,this.handleShowForm("新增客户")},handleFollowUp:function(e,t){this.formEdit=!1,this.formEditRow=t,this.handleShowForm("客户跟进")},handleEdit:function(e,t){this.formEdit=!0,this.formEditRow=t,this.handleShowForm("编辑")},handleDelete:function(e,t){var a=this;this.$confirm(this.$t("此操作将永久删除该数据, 是否继续?"),this.$t("提示"),{confirmButtonText:this.$t("确定"),cancelButtonText:this.$t("取消"),type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.tableData.splice(e,1),a.tableTotal--,r.next=4,u.remove(t.f_Id);case 4:a.$message({type:"success",message:a.$t("删除成功!")});case 5:case"end":return r.stop()}}),r)})))).catch((function(){a.$message({type:"info",message:a.$t("已取消删除!")})}))},handleDetails:function(e,t){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a.showDetails=!0,a.show_name="客户详情查看",e.next=4,a.$awaitWraper(u.get(t.f_Id));case 4:a.detailForm=e.sent,a.$refs.detailForm.setForm(a.detailForm);case 6:case"end":return e.stop()}}),e)})))()},handleTransfer:function(e,t){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.$awaitWraper(u.get(t.f_Id));case 2:a.transferList=e.sent,console.log(a.transferList),a.formTitle="客户转移",a.transferVisible=!0;case 6:case"end":return e.stop()}}),e)})))()},handleSave:function(e,t){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function r(){var n,l,o,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e("保存数据中..."),"客户跟进"==a.formTitle){r.next=11;break}return r.next=4,a.$refs.form.validateForm();case 4:if(!r.sent){r.next=9;break}return r.next=7,a.$refs.form.saveForm({keyValue:a.formEdit?a.formEditRow.f_Id:"",isEdit:a.formEdit});case 7:n=r.sent,n&&(l=a.formEdit?"更新成功!":"新增成功!",a.$message({type:"success",message:a.$t(l)}),a.loadTableData(),a.formVisible=!1);case 9:r.next=19;break;case 11:if("客户跟进"!=a.formTitle){r.next=19;break}return r.next=14,a.$refs.followForm.validateForm();case 14:if(!r.sent){r.next=19;break}return r.next=17,a.$refs.followForm.saveForm({isEdit:a.formEdit});case 17:o=r.sent,o&&(s=a.formEdit?"更新成功!":"新增成功!",a.$message({type:"success",message:a.$t(s)}),a.loadTableData(),a.formVisible=!1);case 19:t();case 20:case"end":return r.stop()}}),r)})))()},handleAddOpens:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e.$refs.mainTable.getSelected(),r=a.map((function(e){return e.f_Id})),!(r.length>0)){t.next=5;break}return t.next=5,e.transfer(r);case 5:case"end":return t.stop()}}),t)})))()},transfer:function(e){var t=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:t.$confirm(t.$t("此操作会将选中的用户移至客户公海,点击确定操作成功"),t.$t("提示"),{confirmButtonText:t.$t("确定"),cancelButtonText:t.$t("取消"),type:"warning"}).then(Object(l["a"])(regeneratorRuntime.mark((function a(){var r,n,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:for(n in r=e.join(","),t.tableData)for(l in console.log("this.tableData",t.tableData[n].f_Id),e)t.tableData[n].f_Id==e[l]&&t.tableData.splice(n,1);return a.next=4,t.$awaitWraper(u.transferpublic(r));case 4:t.$message({type:"success",message:"操作成功!"});case 5:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:"操作取消!"})}));case 1:case"end":return a.stop()}}),a)})))()},handleShowForm:function(e){this.formTitle=e,this.formVisible=!0},handleOpenedForm:function(e,t){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if("客户跟进"!=a.formTitle){r.next=5;break}return e("加载数据中..."),r.next=4,a.$refs.followForm.loadFormData({keyValue:a.formEditRow.f_Id});case 4:t();case 5:if(!a.formEdit){r.next=10;break}return e("加载数据中..."),r.next=9,a.$refs.form.loadFormData({keyValue:a.formEditRow.f_Id});case 9:t();case 10:case"end":return r.stop()}}),r)})))()},handleCloseForm:function(){"客户跟进"==this.formTitle?this.$refs.followForm.resetForm():this.$refs.form.resetForm()},transferCloseForm:function(){this.transferVisible=!1},transferSave:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$awaitWraper(u.update(e.transferList.caseErpCustomerEntity.f_Id,e.transferList));case 2:a=t.sent,e.$message({type:"success",message:a}),e.loadTableData(),e.transferVisible=!1;case 6:case"end":return t.stop()}}),t)})))()}}},c=f,d=(a("1e3b"),a("2877")),p=Object(d["a"])(c,r,n,!1,null,null,null);t["default"]=p.exports}}]);