(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views-dbtable-index","views-dblink-index"],{"4c62":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.lr_loadPage?e._e():a("l-layout",{staticClass:"l-tab-page"},[a("l-panel",{scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入关键字查询"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{refreshClick:e.refreshClick},on:{click:function(t){return e.handleAdd()}}},[a("l-excel-btns")],1)]},proxy:!0}],null,!1,1842997105)},[a("l-table",{attrs:{loading:e.tableLoading,columns:e.lr_getPageColumns(e.columns),dataSource:e.tableData,"row-key":"f_Id"}},[a("l-table-btns",{attrs:{filterBtns:e.filterBtns,btns:e.tableBtns},on:{click:e.lr_handleTableBtnClick}})],1)],1),a("l-dialog",{ref:"formDialog",attrs:{title:e.formTitle,visible:e.formVisible,height:576},on:{"update:visible":function(t){e.formVisible=t},opened:e.handleOpenedForm,closed:e.handleCloseForm,ok:e.handleSave},scopedSlots:e._u([{key:"btn",fn:function(){return[a("el-button",{staticStyle:{position:"absolute",left:"0",top:"9px"},attrs:{size:"mini",type:"info",plain:"",loading:e.testLoading},on:{click:e.handleTest}},[e._v(e._s(e.$t("测试连接")))])]},proxy:!0}],null,!1,3840553884)},[a("my-form",{ref:"form",attrs:{activeName:e.activeName},on:{"update:activeName":function(t){e.activeName=t},"update:active-name":function(t){e.activeName=t}}})],1)],1)},l=[],r=(a("4de4"),a("96cf"),a("1da1")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-from-body learun-el-form-left",staticStyle:{"padding-left":"16px"}},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,size:"mini",labelPosition:"left","label-width":"80px"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("编码"),prop:"f_DBName"}},[a("el-input",{model:{value:e.formData.f_DBName,callback:function(t){e.$set(e.formData,"f_DBName",t)},expression:"formData.f_DBName"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("名称"),prop:"f_DBAlias"}},[a("el-input",{model:{value:e.formData.f_DBAlias,callback:function(t){e.$set(e.formData,"f_DBAlias",t)},expression:"formData.f_DBAlias"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("类型"),prop:"f_DbType"}},[a("l-select",{attrs:{clearable:!1,options:e.options},on:{change:e.handleTypeChange},model:{value:e.formData.f_DbType,callback:function(t){e.$set(e.formData,"f_DbType",t)},expression:"formData.f_DbType"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-tabs",{attrs:{type:"card"},model:{value:e.midActiveName,callback:function(t){e.midActiveName=t},expression:"midActiveName"}},[a("el-tab-pane",{attrs:{label:e.$t("常规"),name:"first"}},["first"==e.midActiveName?[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("主机"),prop:"f_Server"}},[a("el-input",{model:{value:e.formData.f_Server,callback:function(t){e.$set(e.formData,"f_Server",t)},expression:"formData.f_Server"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("端口"),prop:"f_Port"}},[a("el-input",{model:{value:e.formData.f_Port,callback:function(t){e.$set(e.formData,"f_Port",t)},expression:"formData.f_Port"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("用户名"),prop:"f_UserId"}},[a("el-input",{model:{value:e.formData.f_UserId,callback:function(t){e.$set(e.formData,"f_UserId",t)},expression:"formData.f_UserId"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("密码"),prop:"f_Password"}},[a("el-input",{attrs:{type:"password"},model:{value:e.formData.f_Password,callback:function(t){e.$set(e.formData,"f_Password",t)},expression:"formData.f_Password"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("数据库"),prop:"f_DataBase"}},[a("el-input",{model:{value:e.formData.f_DataBase,callback:function(t){e.$set(e.formData,"f_DataBase",t)},expression:"formData.f_DataBase"}})],1)],1)]:e._e()],2),a("el-tab-pane",{attrs:{label:e.$t("高级"),name:"second"}},["first"!=e.midActiveName?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("连接串"),prop:"f_DbConnection"}},[a("el-input",{model:{value:e.formData.f_DbConnection,callback:function(t){e.$set(e.formData,"f_DbConnection",t)},expression:"formData.f_DbConnection"}})],1)],1):e._e()],1)],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("说明"),prop:"f_Description"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.formData.f_Description,callback:function(t){e.$set(e.formData,"f_Description",t)},expression:"formData.f_Description"}})],1)],1)],1)],1)},s=[],i=(a("9911f"),{props:{activeName:{type:String,default:function(){return"first"}}},data:function(){var e=this;return{formData:{f_DBName:"",f_DBAlias:"",f_DbType:"MySql",f_DbConnection:"server=localhost;Database=xxx;Uid=root;Pwd=haosql;SslMode=none;",f_Description:"",f_Server:"",f_Port:"3306",f_UserId:"",f_Password:"",f_DataBase:"",f_Type:0},rules:{f_DBName:[{required:!0,message:"请输入编码"},{validator:this.lr_existDbFiled,keyValue:function(){return e.formData.f_Id},tableName:"lr_base_databaselink",keyName:"f_Id",trigger:"null"}],f_DBAlias:[{required:!0,message:"请输入"}],f_DbType:[{required:!0,message:"请选择"}],f_Server:[{required:!0,message:"请输入"}],f_Port:[{required:!0,message:"请输入"}],f_UserId:[{required:!0,message:"请输入"}],f_Password:[{required:!0,message:"请输入"}],f_DataBase:[{required:!0,message:"请输入"}],f_DbConnection:[{required:!0,message:"请输入"}]},options:[{value:"MySql",label:"MySql"},{value:"SqlServer",label:"SqlServer"},{value:"Oracle",label:"Oracle"},{value:"PostgreSQL",label:"PostgreSQL"},{value:"Dameng",label:"达梦"},{value:"Kdbndp",label:"人大金仓"},{value:"HG",label:"瀚高"},{value:"Oscar",label:"神通"},{value:"OpenGauss",label:"华为OpenGauss"},{value:"OceanBase",label:"OceanBase"},{value:"Tidb",label:"Tidb"},{value:"GBase",label:"南大通用GBase"},{value:"TDengine",label:"TDengine"},{value:"ClickHouse",label:"ClickHouse"},{value:"QuestDB",label:"QuestDB"}],link:{MySql:"server=localhost;Database=xxx;Uid=root;Pwd=haosql;SslMode=none;",SqlServer:"server=.;uid=sa;pwd=haosql;database=xxx",Oracle:"Data Source=localhost/orcl;User ID=system;Password=haha;",PostgreSQL:"PORT=5432;DATABASE=xxx;HOST=localhost;PASSWORD=haosql;USER ID=postgres",Dameng:"Server=localhost; User Id=SYSDBA; PWD=SYSDBA;DATABASE=xxx",Kdbndp:"Server=127.0.0.1;Port=54321;UID=SYSTEM;PWD=system;database=xxx",HG:"Server=127.0.0.1;Port=5866;UId=design;Password=000;Database=design;searchpath=design",Oscar:"PORT=2003;DATABASE=osrdb;HOST=localhost;PASSWORD=szoscar55;USER ID=SYSDBA",OpenGauss:"PORT=5432;DATABASE=SqlSugar4xTest;HOST=localhost;PASSWORD=haosql;USER ID=postgres;No Reset On Close=true",OceanBase:"server=localhost;Database=SqlSugar4xTest;Uid=root;Pwd=haosql;",Tidb:"server=localhost;Database=SqlSugar4xTest;Uid=root;Pwd=haosql;",GBase:"Driver={GBase ODBC DRIVER (64-Bit)};Host=localhost;Service=19088;Server=gbase01;Database=testdb;Protocol=onsoctcp;Uid=gbasedbt;Pwd=GBase123;Db_locale=zh_CN.utf8;Client_locale=zh_CN.utf8",TDengine:"Host=localhost;Port=6030;Username=root;Password=taosdata;Database=power",ClickHouse:"Database=SqlSugarTest2;Username=default;Password=;Host=localhost;Port=8123;Compression=False;UseSession=False;Timeout=120;",QuestDB:"host=localhost;port=8812;username=admin;password=quest;database=qdb;ServerCompatibilityMode=NoTypeLoading;"},port:{MySql:"3306",SqlServer:"1433",Oracle:"1521",PostgreSQL:"5432",Dameng:"5236",Kdbndp:"54321",HG:"5866",Oscar:"2003",OpenGauss:"5432",OceanBase:"26257",Tidb:"4000",GBase:"19088",TDengine:"6030",ClickHouse:"8123",QuestDB:"8812"}}},computed:{midActiveName:{get:function(){return this.activeName},set:function(e){this.$emit("update:activeName",e)}}},created:function(){},methods:{resetForm:function(){this.$formClear(this.$refs.form),this.formData.f_Id=""},validateForm:function(e){var t=this;this.$refs.form.validate((function(a){a&&"lrsystemdb"==t.formData.f_DBName&&(t.$message({type:"warning",message:t.$t("编码不可与系统数据库相同!")}),a=!1),e(a)}))},setForm:function(e){var t=this.$deepClone(e);1==t.f_DESEncrypt&&(0==t.f_Type?t.f_Password=this.lr_AESDecrypt(t.f_Password,"learun_db"):t.f_DbConnection=this.lr_AESDecrypt(t.f_DbConnection,"learun_db")),this.formData=t},getForm:function(){var e=this.$deepClone(this.formData);return e.f_DESEncrypt=1,"first"==this.activeName?(e.f_Type=0,e.f_Password=this.lr_AESEncrypt(e.f_Password,"learun_db"),e.f_DbConnection=""):(e.f_Type=1,e.f_DbConnection=this.lr_AESEncrypt(e.f_DbConnection,"learun_db"),e.f_Password=""),e},handleTypeChange:function(){this.formData.f_Port=this.port[this.formData.f_DbType],this.formData.f_DbConnection=this.link[this.formData.f_DbType]}}}),c=i,d=a("2877"),u=Object(d["a"])(c,o,s,!1,null,null,null),f=u.exports,m=window.$api.data.dblink,b={components:{MyForm:f},data:function(){return{lr_isPage:!0,columns:[{label:"名称",prop:"f_DBAlias",minWidth:"150"},{label:"编码",prop:"f_DBName",minWidth:"150"},{label:"类型",prop:"f_DbType",width:"80",align:"center"},{label:"数据库地址",prop:"f_ServerAddress",width:"200"}],tableBtns:[{prop:"Edit",label:"编辑",width:40},{prop:"Delete",label:"删除",width:40}],tableLoading:!1,searchWord:"",searchTableData:null,formVisible:!1,formTitle:"",formEditRow:null,formEdit:!1,testLoading:!1,activeName:"first"}},mounted:function(){this.init()},computed:{tableData:function(){return this.searchTableData||this.lr_dblinkList}},methods:{refreshClick:function(){this.searchWord="",this.init()},init:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.next=3,e.lr_loadDblink(!1);case 3:e.tableLoading=!1;case 4:case"end":return t.stop()}}),t)})))()},hanleSearch:function(){var e=this;this.searchWord?this.searchTableData=this.lr_dblinkList.filter((function(t){return t.f_DBAlias.indexOf(e.searchWord)>-1||t.f_DBName.indexOf(e.searchWord)>-1||t.f_ServerAddress&&t.f_ServerAddress.indexOf(e.searchWord)>-1})):this.searchTableData=null},handleAdd:function(){this.$refs.form&&this.$refs.form.resetForm(),this.activeName="first",this.formEdit=!1,this.showForm("新增")},handleEdit:function(e,t){this.formEdit=!0,this.formEditRow=t,this.activeName=0==t.f_Type?"first":"second",this.showForm("编辑【".concat(t.f_DBName,"】"))},handleDelete:function(e,t){var a=this;this.$confirm(this.$t("此操作将永久删除该数据, 是否继续?"),this.$t("提示"),{confirmButtonText:this.$t("确定"),cancelButtonText:this.$t("取消"),type:"warning"}).then((function(){m.remove(t.f_Id).then((function(){a.$message({type:"success",message:a.$t("删除成功!")}),a.init()}))})).catch((function(){a.$message({type:"info",message:a.$t("已取消删除")})}))},handleSave:function(e,t){var a=this;e(),console.log("test handleSave"),this.$refs.form.validateForm((function(e){if(e){var n=a.$refs.form.getForm();console.log("test handleSave1"),a.formEdit?m.update(n.f_Id,a.$deepClone(n)).then((function(){t(),a.formVisible=!1,a.$message({type:"success",message:a.$t("更新成功!")}),a.init()})).catch((function(){t()})):m.add(a.$deepClone(n)).then((function(){t(),a.formVisible=!1,a.$message({type:"success",message:a.$t("添加成功!")}),a.init()})).catch((function(){t()}))}else t()}))},handleOpenedForm:function(){this.formEdit&&this.$refs.form.setForm(this.formEditRow)},handleCloseForm:function(){this.$refs.form.resetForm()},showForm:function(e){this.formTitle=e,this.formVisible=!0},filterBtns:function(e,t){return"lrsystemdb"!=e.f_DBName&&0!=e.f_IsEdit?t:[]},handleTest:function(){var e=this,t=this.$refs.form.getForm();(0==t.f_Type||t.f_DbConnection)&&(0!=t.f_Type||t.f_Server&&t.f_Port&&t.f_UserId&&t.f_Password)?(this.testLoading=!0,m.test(t).then((function(t){t.data.data?e.$message({type:"success",message:e.$t("测试成功!")}):e.$message({type:"error",message:t.data.info}),e.testLoading=!1})).catch((function(){e.testLoading=!1}))):this.$message({type:"error",message:this.$t("请将数据库信息补充完整!")})}}},p=b,h=Object(d["a"])(p,n,l,!1,null,null,null);t["default"]=h.exports},"857a":function(e,t,a){var n=a("1d80"),l=a("577e"),r=/"/g;e.exports=function(e,t,a,o){var s=l(n(e)),i="<"+t;return""!==a&&(i+=" "+a+'="'+l(o).replace(r,"&quot;")+'"'),i+">"+s+"</"+t+">"}},"9911f":function(e,t,a){"use strict";var n=a("23e7"),l=a("857a"),r=a("af03");n({target:"String",proto:!0,forced:r("link")},{link:function(e){return l(this,"a","href",e)}})},af03:function(e,t,a){var n=a("d039");e.exports=function(e){return n((function(){var t=""[e]('"');return t!==t.toLowerCase()||t.split('"').length>3}))}},b56a:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.lr_loadPage?e._e():a("l-layout",{staticClass:"l-tab-page",attrs:{left:208},scopedSlots:e._u([{key:"left",fn:function(){return[a("l-panel",{staticClass:"l-panel-overflow",staticStyle:{"padding-right":"0"},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" "+e._s(e.$t("数据库"))+" "),a("div",{staticClass:"tree-setting-btn"},[a("el-tooltip",{attrs:{effect:"dark",content:e.$t("数据库管理"),placement:"top"}},[a("el-button",{attrs:{type:"text",icon:"el-icon-setting"},on:{click:e.handleSettingClick}})],1)],1)]},proxy:!0}],null,!1,94460555)},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],staticClass:"learun-tree",attrs:{data:e.lr_dblinkTree,"default-expand-all":!0},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,l=t.data;return a("span",{staticClass:"lr-tree-node"},[l.icon?a("i",{class:l.icon}):e._e(),e._v(" "+e._s(e.$t(n.label))+" ")])}}],null,!1,1995507822)})],1)]},proxy:!0}],null,!1,735732714)},[a("l-panel",{staticStyle:{"padding-left":"0"},scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入要查询关键字"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{hasAdd:!1}},[a("l-excel-btns")],1)]},proxy:!0}],null,!1,3417115806)},[a("l-table",{attrs:{"row-key":"name",isExpand:!0,columns:e.lr_getPageColumns(e.columns),dataSource:e.searchTableData||e.tableData,loading:e.tableLoading,isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{expandChange:e.expandChange,"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage},scopedSlots:e._u([{key:"table_expand",fn:function(t){return[a("l-table",{attrs:{loading:t.row.loading,isChild:!0,columns:e.childColumns,dataSource:t.row.columns},scopedSlots:e._u([{key:"isPrimarykey",fn:function(t){return[a("el-switch",{attrs:{disabled:""},model:{value:t.row.isPrimarykey,callback:function(a){e.$set(t.row,"isPrimarykey",a)},expression:"scope.row.isPrimarykey"}})]}},{key:"isIdentity",fn:function(t){return[a("el-switch",{attrs:{disabled:""},model:{value:t.row.isIdentity,callback:function(a){e.$set(t.row,"isIdentity",a)},expression:"scope.row.isIdentity"}})]}},{key:"isNullable",fn:function(t){return[a("el-switch",{attrs:{disabled:""},model:{value:t.row.isNullable,callback:function(a){e.$set(t.row,"isNullable",a)},expression:"scope.row.isNullable"}})]}}],null,!0)})]}}],null,!1,389735038)},[a("l-table-btns",{attrs:{btns:e.tableBtns,isFixed:!1},on:{click:e.lr_handleTableBtnClick}})],1)],1),a("l-drawer",{attrs:{title:e.$t("数据库管理"),visible:e.dbManagerVisible,showOk:!1,showClose:!1,size:"800px"},on:{"update:visible":function(t){e.dbManagerVisible=t}}},[a("dblink-index")],1),a("l-drawer",{attrs:{title:e.$t("查看表数据")+"-"+e.tableName,visible:e.formVisible,showOk:!1,showClose:!1,width:800},on:{"update:visible":function(t){e.formVisible=t},close:e.handleCloseForm,opened:e.handleOpenedForm}},[a("my-form",{ref:"form",attrs:{dbcode:e.dbCode,tableName:e.tableName}})],1)],1)},l=[],r=(a("4de4"),a("b0c0"),a("96cf"),a("1da1")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.ready?a("l-layout",{staticClass:"l-tab-page"},[a("l-panel",{staticStyle:{padding:"0"},scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("l-select",{attrs:{size:"mini",options:e.columns,valueKey:"dbColumnName",labelKey:"dbColumnName"},model:{value:e.field,callback:function(t){e.field=t},expression:"field"}})],1),a("div",{staticClass:"l-panel--item"},[a("l-select",{attrs:{size:"mini",options:e.options},model:{value:e.logic,callback:function(t){e.logic=t},expression:"logic"}})],1),a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.keyword,callback:function(t){e.keyword=t},expression:"keyword"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0}],null,!1,894746825)},[a("div",{staticClass:"l-rblock"},[a("l-table",{attrs:{columns:e.columns2,dataSource:e.tableData,loading:e.tableLoading,isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage}})],1)])],1):e._e()},s=[],i=(a("159b"),window.$api.data.dbTable),c={props:{tableName:String,dbcode:String},data:function(){return{options:[{label:"等于",value:"Equal"},{label:"不等于",value:"NotEqual"},{label:"大于",value:"Greater"},{label:"大于等于",value:"GreaterThan"},{label:"小于",value:"Less"},{label:"小于等于",value:"LessThan"},{label:"为空",value:"Null"},{label:"不为空",value:"NotNull"},{label:"包含",value:"Like"}],field:"",logic:"",keyword:"",tableLoading:!1,tableData:[],tableTotal:0,tablePageSize:50,tableCurrentPage:1,columns:[],ready:!1}},created:function(){},mounted:function(){},computed:{columns2:function(){var e=[];return this.columns.forEach((function(t){e.push({label:t.dbColumnName,prop:t.dbColumnName.toLowerCase(),minWidth:"160"})})),e}},methods:{init:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.ready=!1,e.tableLoading=!0,t.next=4,e.fetchColums();case 4:return t.next=6,e.loadTableData();case 6:e.ready=!0;case 7:case"end":return t.stop()}}),t)})))()},fetchColums:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$awaitWraper(i.getColumns(e.dbcode,e.tableName));case 2:e.columns=t.sent;case 3:case"end":return t.stop()}}),t)})))()},loadTableData:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(t.tableCurrentPage=1),t.tableLoading=!0,n={rows:t.tablePageSize,page:t.tableCurrentPage,keyword:t.keyword,field:t.field,logic:t.logic,code:t.dbcode,tableName:t.tableName},a.next=5,t.$awaitWraper(i.getDataPage(n));case 5:l=a.sent,t.tableData=l.rows,t.tableTotal=l.records,t.tableLoading=!1;case 9:case"end":return a.stop()}}),a)})))()},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTableData(!0)},hanleSearch:function(){this.loadTableData()},resetForm:function(){this.tableCurrentPage=1,this.columns=[],this.tableData=[],this.tableTotal=0}}},d=c,u=a("2877"),f=Object(u["a"])(d,o,s,!1,null,null,null),m=f.exports,b=a("4c62"),p=window.$api.data.dbTable,h={components:{MyForm:m,DblinkIndex:b["default"]},data:function(){return{lr_isPage:!0,treeLoading:!1,searchWord:"",searchTableData:null,tableLoading:!1,tableData:[],columns:[{label:"表名",prop:"name",minWidth:"200"},{label:"说明",prop:"description",minWidth:"200"}],childColumns:[{label:"字段名",prop:"dbColumnName",minWidth:"100"},{label:"类型",prop:"dataType",width:"100"},{label:"长度",prop:"length",width:"64",align:"center"},{label:"主键",prop:"isPrimarykey",width:"64",align:"center"},{label:"允许为空",prop:"isNullable",width:"80",align:"center"},{label:"自增",prop:"isIdentity",width:"64",align:"center"},{label:"说明",prop:"columnDescription",minWidth:"100"}],tableBtns:[{prop:"LookData",label:"查看",width:60}],tableTotal:0,tablePageSize:50,tableCurrentPage:1,dbCode:"0",formVisible:!1,tableName:"",dbManagerVisible:!1}},mounted:function(){this.initDbLink()},computed:{},methods:{initDbLink:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.treeLoading=!0,t.next=3,e.lr_loadDblink(!1);case 3:e.treeLoading=!1;case 4:case"end":return t.stop()}}),t)})))()},handleSettingClick:function(){this.dbManagerVisible=!0},hanleSearch:function(){this.tableCurrentPage=1,this.loadTablePageData()},handleNodeClick:function(e){e.children||(this.dbCode=e.id,this.searchWord="",this.loadTableData())},loadTableData:function(){var e=this;this.tableLoading=!0,this.tableCurrentPage=1,p.getList(this.dbCode).then((function(t){e.tableData=t.data.data||[],e.searchTableData=e.$pagination(e.tableCurrentPage,e.tablePageSize,e.tableData),e.tableTotal=e.tableData.length,e.tableLoading=!1})).catch((function(){e.tableData=[],e.tableTotal=0,e.tableLoading=!1}))},loadTablePageData:function(){var e=this,t=[];t=this.searchWord?this.tableData.filter((function(t){return t.name.indexOf(e.searchWord)>-1||t.coment&&t.coment.indexOf(e.searchWord)>-1})):this.tableData,this.tableTotal=t.length,this.searchTableData=this.$pagination(this.tableCurrentPage,this.tablePageSize,t)},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTablePageData()},handleLookData:function(e,t){this.formVisible=!0,this.tableName=t.name},handleOpenedForm:function(e,t){var a=this;return Object(r["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e("加载数据中..."),n.next=3,a.$refs.form.init();case 3:t();case 4:case"end":return n.stop()}}),n)})))()},handleCloseForm:function(){this.$refs.form.resetForm()},expandChange:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n,l,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(n=e.row,l=e.expanded,!l||n.columns||n.loading){a.next=8;break}return t.$set(n,"loading",!0),a.next=5,t.$awaitWraper(p.getColumns(t.dbCode,n.name));case 5:r=a.sent,t.$set(n,"columns",r),t.$set(n,"loading",!1);case 8:case"end":return a.stop()}}),a)})))()}}},g=h,D=Object(u["a"])(g,n,l,!1,null,null,null);t["default"]=D.exports}}]);