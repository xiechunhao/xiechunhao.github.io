(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views-dingmanage-index"],{e025:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.lr_loadPage?e._e():a("l-layout",{staticClass:"l-tab-page"},[a("l-panel",{scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入关键字"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{hasAdd:!1}},[a("l-excel-btns")],1)]},proxy:!0}],null,!1,1164935768)},[a("l-table",{ref:"mainTable",attrs:{columns:e.lr_getPageColumns(e.columns),dataSource:e.tableShowData,loading:e.loading,"row-key":"f_CompanyId","default-expand-all":""},scopedSlots:e._u([{key:"f_FoundedTime",fn:function(t){return[e._v(" "+e._s(e.lr_dateFormat(t.row.f_FoundedTime,"yyyy-MM-dd"))+" ")]}},{key:"f_Nature",fn:function(t){return[e._v(" "+e._s(e.lr_dataItemName(e.lr_dataItem["CompanyNature"],t.row.f_Nature))+" ")]}}],null,!1,579792e3)},[a("l-table-btns",{attrs:{btns:e.tableBtns},on:{click:e.lr_handleTableBtnClick}})],1)],1),a("l-dialog",{attrs:{height:480,title:e.formTitle,visible:e.formVisible},on:{"update:visible":function(t){e.formVisible=t},ok:e.handleSave,close:e.handleCloseForm,opened:e.handleOpenedForm}},[a("my-form",{ref:"form"})],1)],1)},n=[],o=(a("4de4"),a("96cf"),a("1da1")),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-from-body"},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,size:"mini","label-width":"120px"}},[e.lr_hasPageAuth("f_FullName")?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("名称"),prop:"f_FullName"}},[a("el-input",{attrs:{readonly:!0},model:{value:e.formData.f_FullName,callback:function(t){e.$set(e.formData,"f_FullName",t)},expression:"formData.f_FullName"}})],1)],1):e._e(),e.lr_hasPageAuth("f_ShortName")?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("简称"),prop:"f_ShortName"}},[a("el-input",{attrs:{readonly:!0},model:{value:e.formData.f_ShortName,callback:function(t){e.$set(e.formData,"f_ShortName",t)},expression:"formData.f_ShortName"}})],1)],1):e._e(),e.lr_hasPageAuth("f_EnCode")?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("编码"),prop:"f_EnCode"}},[a("el-input",{attrs:{readonly:!0},model:{value:e.formData.f_EnCode,callback:function(t){e.$set(e.formData,"f_EnCode",t)},expression:"formData.f_EnCode"}})],1)],1):e._e(),e.lr_hasPageAuth("f_DingAppKey")?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"DingAppKey",prop:"f_DingAppKey"}},[a("el-input",{attrs:{placeholder:e.$t("请输入应用的唯一标识key")},model:{value:e.formData.f_DingAppKey,callback:function(t){e.$set(e.formData,"f_DingAppKey",t)},expression:"formData.f_DingAppKey"}})],1)],1):e._e(),e.lr_hasPageAuth("f_DingAppSecret")?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"DingAppSecret",prop:"f_DingAppSecret"}},[a("el-input",{attrs:{placeholder:e.$t("请输入应用的密钥")},model:{value:e.formData.f_DingAppSecret,callback:function(t){e.$set(e.formData,"f_DingAppSecret",t)},expression:"formData.f_DingAppSecret"}})],1)],1):e._e(),e.lr_hasPageAuth("f_DingAgentId")?a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:"DingAgentId",prop:"f_DingAgentId"}},[a("el-input",{attrs:{placeholder:e.$t("请输入钉钉应用ID")},model:{value:e.formData.f_DingAgentId,callback:function(t){e.$set(e.formData,"f_DingAgentId",t)},expression:"formData.f_DingAgentId"}})],1)],1):e._e()],1)],1)},i=[],s={data:function(){return{formData:{f_DingAppKey:"",f_DingAppSecret:"",f_DingAgentId:""},rules:{f_DingAppKey:[{required:!0,message:"请输入DingAppKey",trigger:"null"}],f_DingAppSecret:[{required:!0,message:"请输入DingAppSecret",trigger:"null"}],f_DingAgentId:[{required:!0,message:"请输入DingAgentId",trigger:"null"}]}}},created:function(){this.lr_loadDataItem("CompanyNature")},computed:{companyTree:function(){return this.$toTree(this.lr_companyList,"f_CompanyId","f_ParentId","f_CompanyId","f_FullName",[this.formData.f_CompanyId])}},methods:{resetForm:function(){this.$refs.form&&this.$refs.form.resetFields()},validateForm:function(e){this.$refs.form.validate((function(t){t&&e()}))},setForm:function(e){var t=this.$deepClone(e);this.formData=t},getForm:function(){return this.$deepClone(this.formData)}}},f=s,m=a("2877"),c=Object(m["a"])(f,l,i,!1,null,null,null),d=c.exports,u=window.$api.organization.company,p={components:{MyForm:d},data:function(){return{lr_isPage:!0,searchWord:"",searchTableData:null,loading:!1,columns:[{label:"名称",prop:"f_FullName",minWidth:"260"},{label:"编码",prop:"f_EnCode",width:"150"},{label:"简称",prop:"f_ShortName",width:"150"}],tableBtns:[{prop:"Edit",label:"设置",width:60}],tableData:[],formVisible:!1,formTitle:"",formEditRow:null,formEdit:!1}},mounted:function(){this.lr_loadDataItem("CompanyNature"),this.loadTable()},computed:{tableShowData:function(){return this.searchTableData?this.$toTree(this.searchTableData,"f_CompanyId","f_ParentId","f_CompanyId","f_FullName"):this.lr_companyTree}},methods:{loadTable:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.searchWord="",e.searchTableData=null,t.next=5,e.lr_loadCompanys(!1);case 5:e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},hanleSearch:function(){var e=this;this.searchWord?this.searchTableData=this.lr_companyList.filter((function(t){return t.f_FullName.indexOf(e.searchWord)>-1||t.f_EnCode.indexOf(e.searchWord)>-1})):this.searchTableData=null},handleEdit:function(e,t){this.formEdit=!0,this.formEditRow=t,this.showForm("编辑配置")},handleSave:function(e,t){var a=this;this.$refs.form.validateForm((function(){e();var r=a.$refs.form.getForm();a.formEdit?u.update(r.f_CompanyId,r).then((function(){t(),a.formVisible=!1,a.$message({type:"success",message:a.$t("更新成功!")}),a.loadTable()})).catch((function(){t()})):u.add(r).then((function(){t(),a.formVisible=!1,a.$message({type:"success",message:a.$t("添加成功!")}),a.loadTable()})).catch((function(){t()}))}))},handleOpenedForm:function(){this.formEdit&&this.$refs.form.setForm(this.formEditRow)},handleCloseForm:function(){this.$refs.form.resetForm()},showForm:function(e){this.formTitle=e,this.formVisible=!0}}},h=p,_=Object(m["a"])(h,r,n,!1,null,null,null);t["default"]=_.exports}}]);