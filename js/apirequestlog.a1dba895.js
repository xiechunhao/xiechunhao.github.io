(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["apirequestlog"],{"6f3b":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("l-layout",[a("l-panel",{scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-radio-group",{attrs:{disabled:e.tableLoading,size:"mini"},on:{change:e.handleCaregoryChange},model:{value:e.categoryId,callback:function(t){e.categoryId=t},expression:"categoryId"}},[a("el-radio-button",{attrs:{label:"GET"}},[e._v("GET")]),a("el-radio-button",{attrs:{label:"POST"}},[e._v("POST")]),a("el-radio-button",{attrs:{label:"PUT"}},[e._v("PUT")]),a("el-radio-button",{attrs:{label:"DELETE"}},[e._v("DELETE")])],1)],1),a("div",{staticClass:"l-panel--item",staticStyle:{width:"366px"}},[a("el-date-picker",{attrs:{size:"mini",type:"daterange",align:"right","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:e.handleDateChange},model:{value:e.operateTime,callback:function(t){e.operateTime=t},expression:"operateTime"}})],1),a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入IP/接口名称"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{hasAdd:!1}},[a("l-excel-btns"),e.lr_hasPageAuth("Clear","buttons")?a("el-button-group",[a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:function(t){return e.handleOpenForm()}}},[e._v("清空")])],1):e._e()],1)]},proxy:!0}])},[a("l-table",{attrs:{loading:e.tableLoading,columns:e.lr_getPageColumns(e.columns),dataSource:e.tableData,"row-key":"f_Id",isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage},scopedSlots:e._u([{key:"f_OperateTime",fn:function(t){return[e._v(" "+e._s(e.lr_dateFormat(t.row.f_OperateTime))+" ")]}},{key:"f_Category",fn:function(t){return[e._v(" "+e._s(e.lr_dataItemDetailsName("FormSort",t.row.f_Category))+" ")]}},{key:"f_ExecuteResult",fn:function(t){return[0==t.row.f_ExecuteResult?a("el-tag",{attrs:{size:"mini",type:"success"}},[e._v("成功")]):a("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v("失败")])]}}])})],1),a("l-dialog",{attrs:{title:e.$t("清空"),visible:e.formVisible,width:"400px",height:160},on:{"update:visible":function(t){e.formVisible=t},ok:e.handleDelete}},[a("div",{staticClass:"l-from-body"},[a("el-form",{ref:"form",attrs:{size:"mini","label-width":"80px"}},[a("el-form-item",{attrs:{label:"时间"}},[a("l-select",{attrs:{placeholder:"请选择保留时间",size:"mini",options:e.optionsDate},model:{value:e.keepTime,callback:function(t){e.keepTime=t},expression:"keepTime"}})],1)],1)],1)])],1)},n=[],i=(a("96cf"),a("1da1")),o=window.$api.apimanage.apirequestlog,r={data:function(){return{lr_isPage:!0,categoryId:"GET",operateTime:null,pickerOptions:{shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},columns:[{label:"时间",prop:"f_OperateTime",width:"160"},{label:"用户",prop:"f_OperateAccount",width:"80",align:"center"},{label:"IP",prop:"f_IPAddress",width:"100"},{label:"接口名称",prop:"f_Module",width:"200"},{label:"结果",prop:"f_ExecuteResult",width:"64",align:"center"},{label:"描述",prop:"f_ExecuteResultJson",minWidth:"150"}],tableLoading:!1,tableTotal:0,tablePageSize:50,tableCurrentPage:1,tableData:[],keyWord:"",optionsDate:[{value:"7",label:"保留近一周"},{value:"1",label:"保留近一个月"},{value:"3",label:"保留近三个月"},{value:"0",label:"不保留，全部删除"}],formVisible:!1,keepTime:"7"}},computed:{},mounted:function(){this.loadTablePageData()},methods:{loadTablePageData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var l,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(t.tableCurrentPage=1),t.tableLoading=!0,l={rows:t.tablePageSize,page:t.tableCurrentPage,sidx:"F_OperateTime DESC",categoryId:t.categoryId,keyword:t.keyWord,startTime:t.operateTime?t.operateTime[0]:null,endTime:t.operateTime?t.operateTime[1]:null},a.next=5,t.$awaitWraper(o.getPage(l));case 5:n=a.sent,n?(t.tableData=n.rows,t.tableTotal=n.records):(t.tableData=[],t.tableTotal=0),t.tableLoading=!1;case 8:case"end":return a.stop()}}),a)})))()},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTablePageData(!0)},handleCaregoryChange:function(){this.loadTablePageData()},handleDateChange:function(){this.loadTablePageData()},hanleSearch:function(){this.loadTablePageData()},handleOpenForm:function(){this.formVisible=!0},handleDelete:function(e,t){var a=this;e("清空日志数据中..."),o.remove(this.categoryId,this.keepTime||"0").then((function(){a.$message({type:"success",message:"清空成功!"}),a.formVisible=!1,a.loadTablePageData(),t()})).catch((function(){a.formVisible=!1,t()}))},handleCloseForm:function(){this.keepTime="7"}}},s=r,c=a("2877"),u=Object(c["a"])(s,l,n,!1,null,null,null);t["default"]=u.exports}}]);