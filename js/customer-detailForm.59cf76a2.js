(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["customer-detailForm","customer-followUpForm","customer-form","material-operationRecords"],{4656:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-rblock l-form-viewer erpCase",staticStyle:{padding:"8px"}},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,size:"mini",labelPosition:"right",labelWidth:"80px"}},[a("div",{staticClass:"l-auto-window only-tabs"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("主表信息"),name:"tab0"}},[a("el-row",{attrs:{gutter:16}},[e.setBlock?a("div",{staticClass:"right_right header_name"},[e._v(" "+e._s(e.$t("基本信息"))+" ")]):e._e(),a("div",{staticClass:"l-rblock"},[e.setBlock?a("div",{staticClass:"form_top_upload"},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("客户名称"),prop:"case_erp_customer_f_Name"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_customer_f_Name,callback:function(t){e.$set(e.formData,"case_erp_customer_f_Name",t)},expression:"formData.case_erp_customer_f_Name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("客户类型"),prop:"case_erp_customer_f_Type"}},[a("l-select",{attrs:{options:e.case_erp_customer_f_TypeOptions},model:{value:e.formData.case_erp_customer_f_Type,callback:function(t){e.$set(e.formData,"case_erp_customer_f_Type",t)},expression:"formData.case_erp_customer_f_Type"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("所在行业"),prop:"case_erp_customer_f_Industry"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_customer_f_Industry,callback:function(t){e.$set(e.formData,"case_erp_customer_f_Industry",t)},expression:"formData.case_erp_customer_f_Industry"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("来源"),prop:"case_erp_customer_f_Source"}},[a("l-select",{attrs:{options:e.case_erp_customer_f_SourceOptions},model:{value:e.formData.case_erp_customer_f_Source,callback:function(t){e.$set(e.formData,"case_erp_customer_f_Source",t)},expression:"formData.case_erp_customer_f_Source"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("规模"),prop:"case_erp_customer_f_Scale"}},[a("l-select",{attrs:{options:e.case_erp_customer_f_ScaleOptions},model:{value:e.formData.case_erp_customer_f_Scale,callback:function(t){e.$set(e.formData,"case_erp_customer_f_Scale",t)},expression:"formData.case_erp_customer_f_Scale"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("公司性质"),prop:"case_erp_customer_f_ComNature"}},[a("l-select",{attrs:{options:e.case_erp_customer_f_ComNatureOptions},model:{value:e.formData.case_erp_customer_f_ComNature,callback:function(t){e.$set(e.formData,"case_erp_customer_f_ComNature",t)},expression:"formData.case_erp_customer_f_ComNature"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("地址"),prop:"case_erp_customer_f_Address"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_customer_f_Address,callback:function(t){e.$set(e.formData,"case_erp_customer_f_Address",t)},expression:"formData.case_erp_customer_f_Address"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("图片上传"),prop:"case_erp_customer_f_File"}},[a("l-upload",{attrs:{maxSize:"2",sizeType:"MB",limit:9,listType:"picture-card",placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_customer_f_File,callback:function(t){e.$set(e.formData,"case_erp_customer_f_File",t)},expression:"formData.case_erp_customer_f_File"}})],1)],1)],1):e._e(),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"form_flex"},[a("div",{staticClass:"l-title form_name"},[e._v(e._s(e.$t("联系人")))]),a("el-button",{attrs:{type:"text",icon:"el-icon-plus"},on:{click:e.handleCase_erp_customercontactsAddRow}},[e._v(e._s(e.$t("增加")))])],1),e._l(e.case_erp_customercontacts_data,(function(t,r){return a("div",{key:r},[a("div",{staticClass:"form_flex",staticStyle:{"padding-left":"8px"}},[a("div",{staticClass:"form_subtitle"},[e._v(" "+e._s(e.$t("联系人"+(r+1)))+" ")]),a("el-radio",{attrs:{label:r},model:{value:e.index_f_IsDefault,callback:function(t){e.index_f_IsDefault=t},expression:"index_f_IsDefault"}},[e._v(" "+e._s(e.$t("默认"))+" ")])],1),a("div",{staticClass:"mt-16"},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("姓名"),labelWidth:"60px",rules:{required:!0,message:"姓名不能为空"}}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:t.f_Name,callback:function(a){e.$set(t,"f_Name",a)},expression:"item.f_Name"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("电话"),labelWidth:"60px"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:t.f_Phone,callback:function(a){e.$set(t,"f_Phone",a)},expression:"item.f_Phone"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("职业"),labelWidth:"60px"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:t.f_Post,callback:function(a){e.$set(t,"f_Post",a)},expression:"item.f_Post"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("部门"),labelWidth:"60px"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:t.f_Dep,callback:function(a){e.$set(t,"f_Dep",a)},expression:"item.f_Dep"}})],1)],1)],1)])}))],2)],1)])],1)],1)],1)])],1)},s=[],o=(a("a434"),a("96cf"),a("1da1")),c=window.$api.erpcase.customer,l={props:{setBlock:{type:Boolean,default:!0},f_State:{}},data:function(){return{index_f_IsDefault:0,moduleCode:"ERP_Customers",activeName:"tab0",formData:{case_erp_customer_f_Name:"",case_erp_customer_f_Type:"",case_erp_customer_f_Industry:"",case_erp_customer_f_Source:"",case_erp_customer_f_Scale:"",case_erp_customer_f_ComNature:"",case_erp_customer_f_Address:"",case_erp_customer_f_File:"",case_erp_customer_f_DefaultName:"",case_erp_customer_f_DefaultPhone:"",case_erp_customer_f_DefaultPost:"",case_erp_customer_f_DefaultDep:""},rules:{case_erp_customer_f_Name:[{required:!0,message:"请输入客户名称"}],case_erp_customer_f_Type:[{required:!0,message:"请选择客户类型"}],case_erp_customer_f_Industry:[{required:!0,message:"请输入客户所在行业"}],case_erp_customer_f_Source:[{required:!0,message:"请选择来源"}]},case_erp_customercontacts_columns:[{id:"case_erp_customercontacts_F_Name",prop:"f_Name",label:"姓名",required:!0},{id:"case_erp_customercontacts_F_Phone",prop:"f_Phone",label:"电话",patterns:[{msg:"请输入电话号",reg:/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/}]},{id:"case_erp_customercontacts_F_Post",prop:"f_Post",label:"职位"},{id:"case_erp_customercontacts_F_Dep",prop:"f_Dep",label:"部门"},{id:"case_erp_customercontacts_F_IsDefault",prop:"f_IsDefault",label:""}],case_erp_customercontacts_data:[]}},computed:{case_erp_customer_f_TypeOptions:function(){return[{value:" 普通客户",label:" 普通客户"},{value:"重要客户",label:"重要客户"},{value:"SVIP客户",label:"SVIP客户"}]},case_erp_customer_f_SourceOptions:function(){return[{value:"电话销售",label:"电话销售"},{value:"主动来电 ",label:"主动来电"},{value:"客户介绍",label:"客户介绍"},{label:"访问官网",value:"访问官网"},{label:"其他途径",value:"其他途径"}]},case_erp_customer_f_ScaleOptions:function(){return[{value:"20人以下",label:"20人以下"},{value:"20~50人",label:"20~50人"},{value:"50~100人",label:"50~100人"},{label:"100~500人",value:"100~500人"},{label:"500人以上",value:"500人以上"}]},case_erp_customer_f_ComNatureOptions:function(){return this.lr_loadDataItem("CompanyNature"),this.lr_dataItemOptions(this.lr_dataItem["CompanyNature"])}},methods:{defaults:function(){this.formData.case_erp_customer_f_DefaultName=this.case_erp_customercontacts_data[this.index_f_IsDefault].f_Name,this.formData.case_erp_customer_f_DefaultPhone=this.case_erp_customercontacts_data[this.index_f_IsDefault].f_Phone,this.formData.case_erp_customer_f_DefaultPost=this.case_erp_customercontacts_data[this.index_f_IsDefault].f_Post,this.formData.case_erp_customer_f_DefaultDep=this.case_erp_customercontacts_data[this.index_f_IsDefault].f_Dep;var e=0;for(e in this.case_erp_customercontacts_data)e==this.index_f_IsDefault?this.case_erp_customercontacts_data[e].f_IsDefault="0":this.case_erp_customercontacts_data[e].f_IsDefault="1"},handleCase_erp_customercontactsAddRow:function(){var e={f_Name:"",f_Phone:"",f_Post:"",f_Dep:"",f_IsDefault:""};this.case_erp_customercontacts_data.push(e)},handleCase_erp_customercontactsDeleteRow:function(e){this.case_erp_customercontacts_data.splice(e.index,1)},resetForm:function(){this.$formClear(this.$refs.form),this.activeName="tab0",this.case_erp_customercontacts_data=[]},validateForm:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$formValidateWraper(e.$refs.form);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",!1);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))()},setForm:function(e){if(this.$setFormData(this.formData,e.caseErpCustomerEntity,"case_erp_customer"),this.case_erp_customercontacts_data=e.caseErpCustomercontactsList,e.caseErpCustomercontactsList.length>0)for(var t in e.caseErpCustomercontactsList)"0"==e.caseErpCustomercontactsList[t].f_IsDefault&&(this.index_f_IsDefault=t-0)},getForm:function(){var e={};return e.caseErpCustomerEntity=this.$getFormData(this.formData,"case_erp_customer"),e.caseErpCustomercontactsList=this.case_erp_customercontacts_data,e},loadFormData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.keyValue,a.next=3,t.$awaitWraper(c.get(r));case 3:if(s=a.sent,!s){a.next=9;break}return t.setForm(s),a.abrupt("return",!0);case 9:return a.abrupt("return",!1);case 10:case"end":return a.stop()}}),a)})))()},saveForm:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,s,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=e.keyValue,s=e.isEdit,t.case_erp_customercontacts_data.length>0&&t.defaults(),o=t.getForm(),o.caseErpCustomerEntity.f_State=t.f_State,!s){a.next=10;break}return a.next=7,t.$awaitWraper(c.update(r,o));case 7:return a.abrupt("return",a.sent);case 10:return o.caseErpCustomerEntity.f_Id=r,a.next=13,t.$awaitWraper(c.add(o));case 13:return a.abrupt("return",a.sent);case 14:case"end":return a.stop()}}),a)})))()}}},n=l,i=a("2877"),_=Object(i["a"])(n,r,s,!1,null,null,null);t["default"]=_.exports},"9c9b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-rblock l-form-viewer erpCase",staticStyle:{padding:"8px"}},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,size:"mini",labelPosition:"right",labelWidth:"80px"}},[a("div",{staticClass:"l-auto-window only-tabs"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("主表信息"),name:"tab0"}},[a("el-row",{attrs:{gutter:16}},[a("div",{staticClass:"l-rblock"},[a("div",{staticClass:"form_name right_right"},[e._v(e._s(e.$t("基本信息")))]),a("div",{staticClass:"form_information form_back form_top_upload"},[a("div",{staticClass:"font_size_14"},[e._v(" "+e._s(e.$t("客户名称："+e.formData.case_erp_customer_f_Name))+" ")]),a("div",{staticClass:"form_left_32"},[e._v(" "+e._s(e.$t("客户类型："+e.formData.case_erp_customer_f_Type))+" ")]),a("div",{staticClass:"form_left_32"},[e._v(" "+e._s(e.$t("所在行业："+e.formData.case_erp_customer_f_Industry))+" ")]),a("div",{staticClass:"form_left_32"},[e._v(" "+e._s(e.$t("来源："+e.formData.case_erp_customer_f_Source))+" ")])]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"form_name form_top_upload"},[e._v(" "+e._s(e.$t("客户跟进"))+" ")]),a("div",{staticClass:"form_top_upload"},[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("跟进方式"),prop:"case_erp_customerfollow_f_Type"}},[a("l-select",{attrs:{options:e.case_erp_customerfollow_f_TypeOptions},model:{value:e.formData.case_erp_customerfollow_f_Type,callback:function(t){e.$set(e.formData,"case_erp_customerfollow_f_Type",t)},expression:"formData.case_erp_customerfollow_f_Type"}})],1)],1),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:e.$t("跟进时间"),prop:"case_erp_customerfollow_f_VisitTime"}},[a("l-date",{attrs:{readonly:!1,format:"yyyy-MM-dd",dateType:"date",clearable:!0,placeholder:e.$t("请选择")},model:{value:e.formData.case_erp_customerfollow_f_VisitTime,callback:function(t){e.$set(e.formData,"case_erp_customerfollow_f_VisitTime",t)},expression:"formData.case_erp_customerfollow_f_VisitTime"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("下次跟进"),prop:"case_erp_customerfollow_f_NextVisitTime"}},[a("l-date",{attrs:{readonly:!1,format:"yyyy-MM-dd",dateType:"date",clearable:!0,placeholder:e.$t("请选择")},model:{value:e.formData.case_erp_customerfollow_f_NextVisitTime,callback:function(t){e.$set(e.formData,"case_erp_customerfollow_f_NextVisitTime",t)},expression:"\n                          formData.case_erp_customerfollow_f_NextVisitTime\n                        "}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("说明"),prop:"case_erp_customerfollow_f_Content"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_customerfollow_f_Content,callback:function(t){e.$set(e.formData,"case_erp_customerfollow_f_Content",t)},expression:"formData.case_erp_customerfollow_f_Content"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("图片上传"),prop:"case_erp_customerfollow_f_File"}},[a("l-upload",{attrs:{maxSize:"2",sizeType:"MB",limit:9,listType:"picture-card",placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_customerfollow_f_File,callback:function(t){e.$set(e.formData,"case_erp_customerfollow_f_File",t)},expression:"formData.case_erp_customerfollow_f_File"}})],1)],1)],1)])],1)])],1)],1)],1)])],1)},s=[],o=(a("96cf"),a("1da1")),c=window.$api.erpcase.customer,l={data:function(){return{moduleCode:"ERP_Customers",activeName:"tab0",formData:{case_erp_customer_f_Name:"",case_erp_customer_f_Type:"",case_erp_customer_f_Industry:"",case_erp_customer_f_Source:"",case_erp_customerfollow_f_Type:"",case_erp_customerfollow_f_VisitTime:"",case_erp_customerfollow_f_NextVisitTime:"",case_erp_customerfollow_f_Content:"",case_erp_customerfollow_f_File:""},rules:{case_erp_customerfollow_f_Type:[{required:!0,message:"请选择跟进方式"}],case_erp_customerfollow_f_VisitTime:[{required:!0,message:"请选择跟进时间"}]}}},computed:{case_erp_customerfollow_f_TypeOptions:function(){return this.lr_loadDataItem("FollowType"),this.lr_dataItemOptions(this.lr_dataItem["FollowType"])}},methods:{resetForm:function(){this.$formClear(this.$refs.form),this.activeName="tab0"},validateForm:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$formValidateWraper(e.$refs.form);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",!1);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))()},setForm:function(e){this.$setFormData(this.formData,e.caseErpCustomerEntity,"case_erp_customer"),this.$setFormData(this.formData,e.caseErpCustomerfollowEntity,"case_erp_customerfollow")},getForm:function(){var e={};return e.caseErpCustomerEntity=this.$getFormData(this.formData,"case_erp_customer"),e.caseErpCustomerfollowEntity=this.$getFormData(this.formData,"case_erp_customerfollow"),e},loadFormData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,s,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.keyValue,s=e.customerId,a.next=3,t.$awaitWraper(c.get(r));case 3:if(o=a.sent,null==s){a.next=8;break}return a.next=7,t.$awaitWraper(c.oneCustomerfollow(s));case 7:o.caseErpCustomerfollowEntity=a.sent;case 8:if(!o){a.next=13;break}return t.setForm(o),a.abrupt("return",!0);case 13:return a.abrupt("return",!1);case 14:case"end":return a.stop()}}),a)})))()},saveForm:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=e.isEdit,s=t.getForm(),console.log("编辑",t.formData),!r){a.next=9;break}return a.next=6,t.$awaitWraper(c.exitCustomerfollow(t.formData.case_erp_customerfollow_f_Id,s.caseErpCustomerfollowEntity));case 6:return a.abrupt("return",a.sent);case 9:return s.caseErpCustomerfollowEntity.f_CustomerId=t.formData.case_erp_customer_f_Id,a.next=12,t.$awaitWraper(c.customerfollow(s.caseErpCustomerfollowEntity));case 12:return a.abrupt("return",a.sent);case 13:case"end":return a.stop()}}),a)})))()},resetFormData:function(){this.formData={case_erp_customer_f_Name:"",case_erp_customer_f_Type:"",case_erp_customer_f_Industry:"",case_erp_customer_f_Source:"",case_erp_customerfollow_f_Type:"",case_erp_customerfollow_f_VisitTime:"",case_erp_customerfollow_f_NextVisitTime:"",case_erp_customerfollow_f_Content:"",case_erp_customerfollow_f_File:""}}}},n=l,i=a("2877"),_=Object(i["a"])(n,r,s,!1,null,null,null);t["default"]=_.exports},aac0:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("l-layout",{attrs:{top:149,topMove:!1},scopedSlots:e._u([{key:"top",fn:function(){return[a("div",{staticClass:"erpCase"},[a("div",{staticClass:"form_div_back"},[a("div",{staticClass:"panel_name_size_18"},[e._v(" "+e._s(e.$t(e.formData.case_erp_customer_f_Name))+" ")]),a("div",{staticClass:"form_information panel_margin_top_25"},[a("div",[e._v(e._s(e.$t("客户类型:"+e.formData.case_erp_customer_f_Type)))]),a("div",{staticClass:"panel_margin_left_50"},[e._v(" "+e._s(e.$t("所在行业:"+e.formData.case_erp_customer_f_Industry))+" ")]),a("div",{staticClass:"panel_margin_left_50"},[e._v(" "+e._s(e.$t("来源:"+e.formData.case_erp_customer_f_Source))+" ")]),a("div",{staticClass:"panel_margin_left_50"},[e._v(" "+e._s(e.$t("规模:"+e.formData.case_erp_customer_f_Scale))+" ")]),a("div",{staticClass:"panel_margin_left_50"},[e._v(" "+e._s(e.$t("公司性质:"+e.formData.case_erp_customer_f_ComNature))+" ")]),a("div",{staticClass:"panel_margin_left_50"},[e._v(" "+e._s(e.$t("地址:"+e.formData.case_erp_customer_f_Address))+" ")]),a("div",{staticClass:"panel_margin_left_50"},[e._v(" "+e._s(e.$t("归属:"+e.formData.case_erp_customer_f_ModifyUserName))+" ")])])])])]},proxy:!0}])},[a("div",{staticClass:"l-auto-window h48",staticStyle:{padding:"0 16px"}},[a("el-button",{directives:[{name:"show",rawName:"v-show",value:"tab2"==e.activeName,expression:"activeName == 'tab2'"}],staticClass:"addBtn",staticStyle:{"margin-bottom":"16px"},attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.addContact.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("新增联系人")))]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:"tab0"==e.activeName,expression:"activeName == 'tab0'"}],staticClass:"addBtn",staticStyle:{"margin-bottom":"16px"},attrs:{size:"mini",type:"primary"},nativeOn:{click:function(t){return e.addFollowUp.apply(null,arguments)}}},[e._v(" "+e._s(e.$t("新增跟进")))]),a("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("跟进记录"),name:"tab0"}},[a("l-table",{key:Math.random(),ref:"mainTable",attrs:{loading:e.followTableLoading,columns:e.case_erp_customerfollow_columns,dataSource:e.case_erp_customerfollow_data,isPage:!0,pageTotal:e.followTableTotal,tablePage:e.followTableCurrentPage},on:{"update:tablePage":function(t){e.followTableCurrentPage=t},"update:table-page":function(t){e.followTableCurrentPage=t}}},[a("l-table-btns",{attrs:{filterBtns:e.filterBtns,isAuth:!1,btns:e.followTableBtns},on:{click:e.lr_handleTableBtnClick}})],1)],1),a("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("客户信息"),name:"tab1"}},[a("div",{staticClass:"l-rblock"},[a("div",{staticClass:"form_name form_top_upload"},[e._v(e._s(e.$t("客户信息")))]),a("div",{staticClass:"form_back form_top_upload lookImg form_information"},[a("div",[e._v(e._s(e.$t("图片资料：")))]),a("l-upload",{attrs:{maxSize:"2",sizeType:"MB",limit:9,disabled:!e.isReadOnly,listType:"picture-card",placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_customer_f_File,callback:function(t){e.$set(e.formData,"case_erp_customer_f_File",t)},expression:"formData.case_erp_customer_f_File"}})],1),a("div",{staticClass:"form_back form_information form_top_upload"},[a("div",[e._v(" "+e._s(e.$t("创建日期："+e.formData.case_erp_customer_f_CreateDate))+" ")]),a("div",{staticClass:"panel_margin_left_50"},[e._v(" "+e._s(e.$t("创建人"+e.formData.case_erp_customer_f_CreateUserName))+" ")])])])]),a("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("联系人"),name:"tab2"}},[a("l-table",{ref:"case_erp_customercontacts_table",attrs:{dataSource:e.case_erp_customercontacts_data,columns:e.case_erp_customercontacts_columns}},[a("l-table-btns",{attrs:{btns:e.contactBtn},on:{click:e.lr_handleTableBtnClick}})],1)],1),a("el-tab-pane",{staticClass:"l-tabs-container record_table",attrs:{label:e.$t("操作记录"),name:"tab3"}},[a("operationRecords",{attrs:{materialId:e.formData.case_erp_customer_f_Id}})],1)],1),a("l-dialog",{attrs:{title:e.$t(e.formTitle),visible:e.formVisible,height:600,width:800},on:{"update:visible":function(t){e.formVisible=t},opened:e.handleOpenedForm,ok:e.handleSave,close:e.handleCloseForm}},["新增联系人"==this.formTitle?a("my-form",{ref:"form",attrs:{setBlock:!1}}):"联系人编辑"==this.formTitle?a("div",{staticStyle:{padding:"8px"}},[a("el-form",{attrs:{size:"mini",labelPosition:"right",labelWidth:"80px"}},[a("el-row",{attrs:{gutter:16}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("姓名"),labelWidth:"60px"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.contactList.caseErpCustomercontactsList[e.contactIndex].f_Name,callback:function(t){e.$set(e.contactList.caseErpCustomercontactsList[e.contactIndex],"f_Name",t)},expression:"\n                    contactList.caseErpCustomercontactsList[contactIndex]\n                      .f_Name\n                  "}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("电话"),labelWidth:"60px"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.contactList.caseErpCustomercontactsList[e.contactIndex].f_Phone,callback:function(t){e.$set(e.contactList.caseErpCustomercontactsList[e.contactIndex],"f_Phone",t)},expression:"\n                    contactList.caseErpCustomercontactsList[contactIndex]\n                      .f_Phone\n                  "}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("职业"),labelWidth:"60px"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.contactList.caseErpCustomercontactsList[e.contactIndex].f_Post,callback:function(t){e.$set(e.contactList.caseErpCustomercontactsList[e.contactIndex],"f_Post",t)},expression:"\n                    contactList.caseErpCustomercontactsList[contactIndex]\n                      .f_Post\n                  "}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("部门"),labelWidth:"60px"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.contactList.caseErpCustomercontactsList[e.contactIndex].f_Dep,callback:function(t){e.$set(e.contactList.caseErpCustomercontactsList[e.contactIndex],"f_Dep",t)},expression:"\n                    contactList.caseErpCustomercontactsList[contactIndex]\n                      .f_Dep\n                  "}})],1)],1)],1)],1)],1):"图片查看"==this.formTitle?a("div",{staticClass:"erpCase flex_img"},[a("l-upload",{staticStyle:{margin:"16px"},attrs:{disabled:!0,limit:2,listType:"picture-card"},model:{value:e.fileSrc,callback:function(t){e.fileSrc=t},expression:"fileSrc"}})],1):a("follow-up-form",{ref:"followUpForm",attrs:{isReadOnly:e.formDetails}})],1)],1)])},s=[],o=(a("a434"),a("ac1f"),a("1276"),a("96cf"),a("1da1")),c=a("9c9b"),l=a("fece"),n=a("4656"),i=window.$api.erpcase.customer,_={props:{isReadOnly:{type:Boolean,default:!1}},components:{FollowUpForm:c["default"],MyForm:n["default"],OperationRecords:l["default"]},data:function(){return{moduleCode:"erpCase_customerfollow",activeName:"tab0",fileSrc:"",formData:{case_erp_customer_f_Name:"",case_erp_customer_f_Type:"",case_erp_customer_f_Industry:"",case_erp_customer_f_Source:"",case_erp_customer_f_Scale:"",case_erp_customer_f_ComNature:"",case_erp_customer_f_Address:"",case_erp_customer_f_ModifyUserName:"",case_erp_customer_f_File:""},rules:{},followQueryData:{},followTableLoading:!1,followTablePageSize:50,followTableTotal:0,followTableCurrentPage:1,case_erp_customerfollow_columns:[{label:"跟进方式",prop:"f_Type",align:"left",dataType:"input"},{label:"跟进时间",prop:"f_VisitTime",align:"left",dataType:"datetime",format:"yyyy-MM-dd"},{label:"下次跟进时间",prop:"f_NextVisitTime",align:"left",dataType:"datetime",format:"yyyy-MM-dd"},{label:"说明",prop:"f_Content",align:"left",dataType:"input"},{label:"跟进人",prop:"f_CreateUserName",align:"left",dataType:"input"}],case_erp_customerfollow_data:[],case_erp_log_columns:[{label:"操作人",prop:"f_CreateUserName",align:"left",dataType:"input"},{label:"操作时间",prop:"f_OperateTime",align:"left",dataType:"input"},{label:"操作",prop:"f_Description",align:"left",dataType:"input"}],followTableBtns:[{prop:"Edit",label:"编辑",width:100},{prop:"Details",label:"图片查看",disabled:!1},{prop:"Delete",label:"删除"}],case_erp_customercontacts_columns:[{id:"case_erp_customercontacts_F_Name",prop:"f_Name",label:"联系人"},{id:"case_erp_customercontacts_F_Phone",prop:"f_Phone",label:"电话"},{id:"case_erp_customercontacts_F_Post",prop:"f_Post",label:"职位"},{id:"case_erp_customercontacts_F_Dep",prop:"f_Dep",label:"部门"},{id:"case_erp_customercontacts_F_CreateDate",prop:"f_CreateDate",dataType:"datetime",format:"yyyy-MM-dd",label:"创建时间"},{id:"case_erp_customercontacts_F_CreateUserName",prop:"f_CreateUserName",label:"创建人"},{id:"case_erp_customercontacts_F_IsDefault",prop:"f_IsDefault",dataType:"mydata",label:"是否默认",options:[{value:0,label:"是"},{value:1,label:"否"}]}],case_erp_customercontacts_data:[],contactBtn:[{prop:"ContactEdit",label:"编辑"},{prop:"ContactDelete",label:"删除"}],formVisible:!1,formTitle:"",formEditRow:null,formEdit:!1,formDetails:!1,index:0,contactList:[],contactIndex:0}},computed:{},mounted:function(){this.init()},methods:{filterBtns:function(e,t){return""==e.f_File&&(t[1].disabled=!0),t},handleContactEdit:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$awaitWraper(i.get(t.formData.case_erp_customer_f_Id));case 2:t.contactList=a.sent,t.contactIndex=e,t.handleShowForm("联系人编辑");case 5:case"end":return a.stop()}}),a)})))()},handleContactDelete:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$awaitWraper(i.get(t.formData.case_erp_customer_f_Id));case 2:r=a.sent,t.$confirm(t.$t("此操作将永久删除该数据, 是否继续?"),t.$t("提示"),{confirmButtonText:t.$t("确定"),cancelButtonText:t.$t("取消"),type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.case_erp_customercontacts_data.splice(e,1),r.caseErpCustomercontactsList.splice(e,1),a.next=4,t.$awaitWraper(i.update(t.formData.case_erp_customer_f_Id,r));case 4:t.$message({type:"success",message:t.$t("删除成功!")});case 5:case"end":return a.stop()}}),a)})))).catch((function(){t.$message({type:"info",message:t.$t("已取消删除!")})}));case 4:case"end":return a.stop()}}),a)})))()},handleEdit:function(e,t){this.formEdit=!0,this.formDetails=!1,this.formEditRow=t,this.handleShowForm("编辑")},addFollowUp:function(){this.formEdit=!0,this.formDetails=!1,this.handleShowForm("新增用户跟进")},addContact:function(){this.formEdit=!0,this.formDetails=!1,this.handleShowForm("新增联系人")},handleDelete:function(e,t){var a=this;this.$confirm(this.$t("此操作将永久删除该数据, 是否继续?"),this.$t("提示"),{confirmButtonText:this.$t("确定"),cancelButtonText:this.$t("取消"),type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.case_erp_customerfollow_data.splice(e,1),a.followTableTotal--,r.next=4,a.$awaitWraper(i.deleteCustomerfollow(t.f_Id));case 4:a.$message({type:"success",message:a.$t("删除成功!")});case 5:case"end":return r.stop()}}),r)})))).catch((function(){a.$message({type:"info",message:a.$t("已取消删除!")})}))},handleDetails:function(e,t){console.log("详情",e,t),""==t.f_File?this.$message({type:"info",message:this.$t("未上传图片!")}):(this.formTitle="图片查看",this.fileSrc=t.f_File,this.formVisible=!0)},handleShowForm:function(e){this.formTitle=e,this.formVisible=!0},handleOpenedForm:function(e,t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!a.formEdit){r.next=16;break}if(e("加载数据中..."),"编辑"!=a.formTitle){r.next=7;break}return r.next=5,a.$refs.followUpForm.loadFormData({keyValue:a.formData.case_erp_customer_f_Id,customerId:a.formEditRow.f_Id});case 5:r.next=15;break;case 7:if("新增联系人"!=a.formTitle){r.next=12;break}return r.next=10,a.$refs.form.loadFormData({keyValue:a.formData.case_erp_customer_f_Id});case 10:r.next=15;break;case 12:if("新增用户跟进"!=a.formTitle){r.next=15;break}return r.next=15,a.$refs.followUpForm.loadFormData({keyValue:a.formData.case_erp_customer_f_Id});case 15:t();case 16:case"end":return r.stop()}}),r)})))()},handleCloseForm:function(){this.$refs.followUpForm&&this.$refs.followUpForm.resetFormData()},init:function(){},handleCase_erp_customerfollowAddRow:function(){var e={f_VisitTime:"",f_NextVisitTime:"",f_Type:"",f_Content:"",f_CreateUserName:""};this.case_erp_customerfollow_data.push(e)},handleCase_erp_customerfollowDeleteRow:function(e){this.case_erp_customerfollow_data.splice(e.index,1)},handleCase_erp_customercontactsAddRow:function(){var e={f_Name:"",f_Phone:"",f_Post:"",f_CreateDate:"",f_CreateUserName:"",f_IsDefault:"1"};this.case_erp_customercontacts_data.push(e)},handleCase_erp_customercontactsDeleteRow:function(e){this.case_erp_customercontacts_data.splice(e.index,1)},resetForm:function(){this.$formClear(this.$refs.form),this.activeName="tab0",this.case_erp_customerfollow_data=[],this.case_erp_customercontacts_data=[]},validateForm:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$formValidateWraper(e.$refs.form);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",!1);case 4:if(e.$refs.case_erp_customerfollow_table.validate()){t.next=6;break}return t.abrupt("return",!1);case 6:if(e.$refs.case_erp_customercontacts_table.validate()){t.next=8;break}return t.abrupt("return",!1);case 8:return t.abrupt("return",!0);case 9:case"end":return t.stop()}}),t)})))()},setForm:function(e){this.case_erp_customercontacts_data=[],this.$setFormData(this.formData,e.caseErpCustomerEntity,"case_erp_customer"),this.case_erp_customercontacts_data=e.caseErpCustomercontactsList,""!=this.formData.case_erp_customer_f_CreateDate&&(this.formData.case_erp_customer_f_CreateDate=this.formData.case_erp_customer_f_CreateDate.split("T")[0]),this.init(),this.followLoadTableData()},getForm:function(){var e={};return e.caseErpCustomerEntity=this.$getFormData(this.formData,"case_erp_customer"),e.caseErpCustomerfollowList=this.case_erp_customerfollow_data,e.caseErpCustomercontactsList=this.case_erp_customercontacts_data,e},saveForm:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,s,o;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=e.keyValue,s=e.isEdit,o=t.getForm(),!s){a.next=8;break}return a.next=5,t.$awaitWraper(i.update(r,o));case 5:return a.abrupt("return",a.sent);case 8:return o.caseErpCustomerEntity.f_Id=r,a.next=11,t.$awaitWraper(i.add(o));case 11:return a.abrupt("return",a.sent);case 12:case"end":return a.stop()}}),a)})))()},followLoadTableData:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var a,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.followTableLoading=!0,a=e.$deepClone(e.followQueryData),a.rows=e.followTablePageSize,a.page=e.followTableCurrentPage,a.sidx="F_Id",a.f_customerId=e.formData.case_erp_customer_f_Id,t.next=8,e.$awaitWraper(i.customerfollows(a));case 8:r=t.sent,null!=r?(e.case_erp_customerfollow_data=r.rows,e.followTableTotal=r.records):e.case_erp_customerfollow_data=[],e.followTableLoading=!1;case 11:case"end":return t.stop()}}),t)})))()},handleSave:function(e,t){var a=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var s,o,c,l,n,_,u,m,f;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e("保存数据中..."),"新增联系人"!=a.formTitle){r.next=18;break}return r.next=4,a.$refs.form.validateForm();case 4:if(!r.sent){r.next=16;break}return r.next=7,a.$refs.form.saveForm({keyValue:a.formEdit?a.formData.case_erp_customer_f_Id:"",isEdit:a.formEdit});case 7:if(s=r.sent,!s){r.next=16;break}return o="更新成功!",a.$message({type:"success",message:a.$t(o)}),r.next=13,a.$awaitWraper(i.get(a.formData.case_erp_customer_f_Id));case 13:c=r.sent,a.setForm(c),a.formVisible=!1;case 16:r.next=37;break;case 18:if("联系人编辑"!=a.formTitle){r.next=25;break}return r.next=21,a.$awaitWraper(i.update(a.formData.case_erp_customer_f_Id,a.contactList));case 21:l=r.sent,l&&(n="更新成功!",a.$message({type:"success",message:a.$t(n)}),a.formVisible=!1,a.case_erp_customercontacts_data=a.contactList.caseErpCustomercontactsList),r.next=37;break;case 25:if("新增用户跟进"!=a.formTitle){r.next=33;break}return r.next=28,a.$refs.followUpForm.saveForm({keyValue:a.formData.case_erp_customer_f_Id});case 28:_=r.sent,a.$refs.followUpForm.resetForm(),_&&(u="新增成功!",a.$message({type:"success",message:a.$t(u)}),a.formVisible=!1,a.followLoadTableData()),r.next=37;break;case 33:return r.next=35,a.$refs.followUpForm.saveForm({keyValue:a.formEdit?a.formData.case_erp_customer_f_Id:"",isEdit:a.formEdit});case 35:m=r.sent,m&&(f=a.formEdit?"更新成功!":"新增成功!",a.$message({type:"success",message:a.$t(f)}),a.formVisible=!1,a.followLoadTableData());case 37:t();case 38:case"end":return r.stop()}}),r)})))()}}},u=_,m=(a("e56b"),a("2877")),f=Object(m["a"])(u,r,s,!1,null,null,null);t["default"]=f.exports},e56b:function(e,t,a){"use strict";a("fbed")},fbed:function(e,t,a){},fece:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("l-panel",{staticStyle:{padding:"0px"},scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入关键字"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleSearch.apply(null,arguments)}},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.handleSearch},slot:"append"})],1)],1)]},proxy:!0}])},[a("l-table",{ref:"mainTable",attrs:{loading:e.tableLoading,columns:e.columns,dataSource:e.tableData,isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage}})],1)},s=[],o=(a("96cf"),a("1da1")),c=window.$api.erpcase.log,l={props:{materialId:String},data:function(){return{searchWord:"",tableLoading:!1,tableData:[],tableTotal:0,tableCurrentPage:1,tablePageSize:50,columns:[{label:"操作人",prop:"f_OperateUserId",width:120,align:"left",dataType:"user"},{label:"操作时间",prop:"f_OperateTime",width:160,dataType:"datetime",format:"yyyy-MM-dd HH:mm:ss"},{label:"操作内容",prop:"f_Description",minWidth:200}]}},watch:{materialId:{handler:function(){this.init()},immediate:!0}},methods:{init:function(){this.loadTableData()},handleSearch:function(){this.loadTableData()},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTableData(!0)},loadTableData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(t.tableCurrentPage=1),t.tableLoading=!0,r={},r.f_Description=t.searchWord,r.f_KeyId=t.materialId,r.rows=t.tablePageSize,r.page=t.tableCurrentPage,r.sidx="f_OperateTime DESC",a.next=10,t.$awaitWraper(c.getPage(r));case 10:s=a.sent,null!=s?(t.tableData=s.rows,t.tableTotal=s.records):t.tableData=[],t.tableLoading=!1;case 13:case"end":return a.stop()}}),a)})))()}}},n=l,i=a("2877"),_=Object(i["a"])(n,r,s,!1,null,null,null);t["default"]=_.exports}}]);