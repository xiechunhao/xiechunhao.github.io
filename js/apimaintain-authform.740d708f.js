(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["apimaintain-authform"],{"5c4c":function(e,a,t){"use strict";t.r(a);var r=function(){var e=this,a=e.$createElement,t=e._self._c||a;return t("div",{staticClass:"l-rblock l-form-viewer",staticStyle:{padding:"8px"}},[t("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,size:"mini",labelPosition:"right",labelWidth:"120px"}},[t("div",{staticClass:"l-auto-window "},[t("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(a){e.activeName=a},expression:"activeName"}},[t("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("基础权限"),name:"tab0"}},[t("el-row",{attrs:{gutter:0}},[t("div",{staticClass:"l-rblock"},[e.lr_formLookAuth("api_authmanage_f_IsTimeAuth")?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("限制访问时间"),prop:"api_authmanage_f_IsTimeAuth"}},[t("el-switch",{attrs:{disabled:!e.lr_formEditAuth("api_authmanage_f_IsTimeAuth",e.isReadOnly),activeValue:0,inactiveValue:1,"active-text":"是","inactive-text":"否","active-color":"rgba(144, 238, 144, 1)","inactive-color":"#C0CCDA"},model:{value:e.formData.api_authmanage_f_IsTimeAuth,callback:function(a){e.$set(e.formData,"api_authmanage_f_IsTimeAuth",a)},expression:"formData.api_authmanage_f_IsTimeAuth"}})],1)],1):e._e(),e.lr_formLookAuth("api_authmanage_f_BeginTime")&&0==e.formData.api_authmanage_f_IsTimeAuth?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("开始时间"),prop:"api_authmanage_f_BeginTime"}},[t("l-time",{attrs:{disabled:!e.lr_formEditAuth("api_authmanage_f_BeginTime",e.isReadOnly),readonly:!1,format:"HH:mm:ss",clearable:!0,placeholder:e.$t("请选择")},model:{value:e.formData.api_authmanage_f_BeginTime,callback:function(a){e.$set(e.formData,"api_authmanage_f_BeginTime",a)},expression:"formData.api_authmanage_f_BeginTime"}})],1)],1):e._e(),e.lr_formLookAuth("api_authmanage_f_EndTime")&&0==e.formData.api_authmanage_f_IsTimeAuth?t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("结束时间"),prop:"api_authmanage_f_EndTime"}},[t("l-time",{attrs:{disabled:!e.lr_formEditAuth("api_authmanage_f_EndTime",e.isReadOnly),readonly:!1,format:"HH:mm:ss",clearable:!0,placeholder:e.$t("请选择")},model:{value:e.formData.api_authmanage_f_EndTime,callback:function(a){e.$set(e.formData,"api_authmanage_f_EndTime",a)},expression:"formData.api_authmanage_f_EndTime"}})],1)],1):e._e(),e.lr_formLookAuth("api_authmanage_f_IsIpAuth")?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("限制IP访问"),prop:"api_authmanage_f_IsIpAuth"}},[t("el-switch",{attrs:{disabled:!e.lr_formEditAuth("api_authmanage_f_IsIpAuth",e.isReadOnly),activeValue:0,inactiveValue:1,"active-text":"是","inactive-text":"否","active-color":"rgba(255, 140, 0, 1)","inactive-color":"#C0CCDA"},model:{value:e.formData.api_authmanage_f_IsIpAuth,callback:function(a){e.$set(e.formData,"api_authmanage_f_IsIpAuth",a)},expression:"formData.api_authmanage_f_IsIpAuth"}})],1)],1):e._e(),e.lr_formLookAuth("api_authmanage_f_IpAuthType")&&0==e.formData.api_authmanage_f_IsIpAuth?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("IP 类型"),prop:"api_authmanage_f_IpAuthType"}},[t("el-radio-group",{attrs:{size:"mini",disabled:!e.lr_formEditAuth("api_authmanage_f_IpAuthType",e.isReadOnly)},model:{value:e.formData.api_authmanage_f_IpAuthType,callback:function(a){e.$set(e.formData,"api_authmanage_f_IpAuthType",a)},expression:"formData.api_authmanage_f_IpAuthType"}},[t("el-radio",{attrs:{label:1,border:""}},[e._v("黑名单")]),t("el-radio",{attrs:{label:0,border:""}},[e._v("白名单")])],1)],1)],1):e._e(),e.lr_formLookAuth("api_authmanage_f_IpAuth")&&0==e.formData.api_authmanage_f_IsIpAuth?t("el-col",{attrs:{span:24}},[t("el-form-item",{attrs:{label:e.$t("配置IP"),prop:"api_authmanage_f_IpAuth"}},[t("el-input",{attrs:{type:"textarea",disabled:!e.lr_formEditAuth("api_authmanage_f_IpAuth",e.isReadOnly),rows:9,placeholder:e.$t("多个ip地址请用‘，’隔开")},model:{value:e.formData.api_authmanage_f_IpAuth,callback:function(a){e.$set(e.formData,"api_authmanage_f_IpAuth",a)},expression:"formData.api_authmanage_f_IpAuth"}})],1)],1):e._e()],1)])],1),t("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("用户权限"),name:"tab1"}},[t("el-row",{attrs:{gutter:0}},[t("div",{staticClass:"l-rblock"},[t("l-edit-table",{attrs:{addBtnText:"添加用户",dataSource:e.formUsers},on:{addRow:e.handleUserClick,deleteRow:e.handleTableBtnClick}},[t("el-table-column",{attrs:{label:"姓名",minWidth:"110"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s(a.row.name)+" ")]}}])}),t("el-table-column",{attrs:{label:"公司",minWidth:"150"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s(e.getUserCompany(a.row.companyid))+" ")]}}])}),t("el-table-column",{attrs:{label:"部门",minWidth:"110"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s(e.getUserDept(a.row.deptid))+" ")]}}])})],1)],1)])],1),t("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("角色权限"),name:"tab2"}},[t("el-row",{attrs:{gutter:0}},[t("div",{staticClass:"l-rblock"},[t("l-edit-table",{attrs:{addBtnText:"添加角色",dataSource:e.formRoles},on:{addRow:e.handleAddRole,deleteRow:e.handleDeleteRole}},[t("el-table-column",{attrs:{label:"编号",width:"110"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s(e.getRoleCode(a.row.f_ObjectId))+" ")]}}])}),t("el-table-column",{attrs:{prop:"f_ObjectId",label:"名称",minWidth:"100"},scopedSlots:e._u([{key:"default",fn:function(a){return[e._v(" "+e._s(e.getRoleName(a.row.f_ObjectId))+" ")]}}])})],1)],1)])],1)],1)],1)]),t("l-dialog",{attrs:{title:e.$t("添加角色"),visible:e.selectRoleVisible,height:480,width:"800px"},on:{"update:visible":function(a){e.selectRoleVisible=a},ok:e.handleRoleSelectOk,closed:e.handleRoleSelectClosed}},[t("l-role-select-panel",{ref:"roleSelectPanel"})],1),t("l-dialog",{attrs:{title:e.$t("添加用户"),visible:e.selectUserVisible,height:480,width:"1024px"},on:{"update:visible":function(a){e.selectUserVisible=a},ok:e.handleUserSelectOk,closed:e.handleUserSelectClosed}},[t("l-user-select-panel",{ref:"userSelectPanel"})],1)],1)},n=[],i=(t("99af"),t("4de4"),t("7db0"),t("c740"),t("d81d"),t("a434"),t("ac1f"),t("1276"),t("159b"),t("2909")),l=(t("96cf"),t("1da1")),o=window.$api.apimanage.apimaintain,s={props:{isReadOnly:{type:Boolean,default:!1},authFormEditRow:{f_Id:""}},data:function(){return{moduleCode:"apiManage_authmanage",activeName:"tab0",formData:{api_authmanage_f_Id:"",api_authmanage_f_MaintainId:"",api_authmanage_f_IsTimeAuth:0,api_authmanage_f_BeginTime:"",api_authmanage_f_EndTime:"",api_authmanage_f_IsIpAuth:0,api_authmanage_f_IpAuthType:NaN,api_authmanage_f_IpAuth:"",api_authmanage_f_RoleAuth:"",api_authmanage_f_UserAuth:""},rules:{api_authmanage_f_IsTimeAuth:[{required:!0,message:"请选择限制访问时间"}],api_authmanage_f_IsIpAuth:[{required:!0,message:"请选择限制IP访问"}]},formRoles:[],selectRoleVisible:!1,formUsers:[],selectUserVisible:!1}},computed:{},methods:{resetForm:function(){this.formRoles=[],this.formUsers=[],this.$formClear(this.$refs.form),this.activeName="tab0"},validateForm:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$formValidateWraper(e.$refs.form);case 2:if(a.sent){a.next=4;break}return a.abrupt("return",!1);case 4:if(!(e.formData.api_authmanage_f_BeginTime>=e.formData.api_authmanage_f_EndTime)){a.next=7;break}return e.$message({type:"warning",message:"开始时间需要小于结束时间！"}),a.abrupt("return");case 7:return a.abrupt("return",!0);case 8:case"end":return a.stop()}}),a)})))()},setForm:function(e){this.$setFormData(this.formData,e,"api_authmanage")},getForm:function(){return this.$getFormData(this.formData,"api_authmanage")},loadFormData:function(e){var a=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.maintainid,a.formData.api_authmanage_f_MaintainId=a.authFormEditRow.f_Id,t.next=4,a.$awaitWraper(o.getauthmanage(r));case 4:if(n=t.sent,!n){t.next=12;break}return a.getFormUsers(n.f_UserAuth),a.getFormRoles(n.f_RoleAuth),a.setForm(n),t.abrupt("return",!0);case 12:return t.abrupt("return",!1);case 13:case"end":return t.stop()}}),t)})))()},saveForm:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var t;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t=e.getForm(),!e.formData.api_authmanage_f_Id){a.next=7;break}return a.next=4,e.$awaitWraper(o.updateauthmanage(e.formData.api_authmanage_f_Id,t));case 4:return a.abrupt("return",a.sent);case 7:return a.next=9,e.$awaitWraper(o.addauthmanage(t));case 9:return a.abrupt("return",a.sent);case 10:case"end":return a.stop()}}),a)})))()},getRoleName:function(e){return this.lr_loadRole(e),(this.lr_role[e]||{}).f_FullName||""},getRoleCode:function(e){return this.lr_loadRole(e),(this.lr_role[e]||{}).f_EnCode||""},handleAddRole:function(){this.selectRoleVisible=!0},handleRoleSelectClosed:function(){this.$refs.roleSelectPanel.resetForm()},handleRoleSelectOk:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var t,r,n,l;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$refs.roleSelectPanel.getForm();case 2:r=a.sent,n=r.map((function(e){return{f_Category:1,f_ObjectId:e.f_RoleId}})),l=n.filter((function(a){return-1==e.formRoles.findIndex((function(e){return e.f_ObjectId==a.f_ObjectId}))})),(t=e.formRoles).push.apply(t,Object(i["a"])(l)),e.formData.api_authmanage_f_RoleAuth=String(e.formRoles.map((function(e){return e.f_ObjectId}))),e.selectRoleVisible=!1;case 8:case"end":return a.stop()}}),a)})))()},handleDeleteRole:function(e){this.formRoles.splice(e.index,1)},getFormRoles:function(e){var a=this;if(e){var t=e.split(",");t.forEach((function(e){var t=a.lr_role[e];t&&a.formRoles.push({f_Category:1,f_ObjectId:t.f_RoleId})}))}},handleUserClick:function(){this.selectUserVisible=!0},handleUserSelectOk:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function a(){var t,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,e.$refs.userSelectPanel.getForm();case 2:t=a.sent,r=t.map((function(e){return{id:e.f_UserId,name:e.f_RealName,companyid:e.f_CompanyId,deptid:e.f_DepartmentId}})),e.addTableData(r),e.formData.api_authmanage_f_UserAuth=String(e.formUsers.map((function(e){return e.id}))),e.selectUserVisible=!1;case 7:case"end":return a.stop()}}),a)})))()},handleUserSelectClosed:function(){this.$refs.userSelectPanel.resetForm()},handleTableBtnClick:function(e){var a=e.index;this.formUsers.splice(a,1)},addTableData:function(e){var a=this,t=e.filter((function(e){return-1==a.formUsers.findIndex((function(a){return a.id==e.id}))}));this.formUsers=this.formUsers.concat(t)},getUserCompany:function(e){return this.lr_loadCompanyName(e),(this.lr_companyList.find((function(a){return a.f_CompanyId==e}))||{}).f_FullName||""},getUserDept:function(e){return this.lr_loadDepartment(e),(this.lr_department[e]||{}).f_FullName||""},getFormUsers:function(e){var a=this;if(e){var t=e.split(",");t.forEach((function(e){var t=a.lr_users[e];t&&a.formUsers.push({id:t.f_UserId,name:t.f_RealName,companyid:t.f_CompanyId,deptid:t.f_DepartmentId})}))}}}},u=s,m=t("2877"),f=Object(m["a"])(u,r,n,!1,null,null,null);a["default"]=f.exports}}]);