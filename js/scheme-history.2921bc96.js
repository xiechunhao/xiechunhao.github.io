(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["scheme-history","scheme-preview"],{"4f9c":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("l-layout",{staticClass:"l-tab-page",attrs:{right:500},scopedSlots:e._u([{key:"right",fn:function(){return[a("l-panel",{staticStyle:{"padding-left":"0"}},[a("div",{staticClass:"l-auto-window"},[a("el-tabs",{attrs:{stretch:!0},model:{value:e.configActiveName,callback:function(t){e.configActiveName=t},expression:"configActiveName"}},[void 0!=e.currentWfNode?a("el-tab-pane",{attrs:{label:e.$t(e.wfNodeName[e.currentWfNode.type]),name:"tab01"}},[a(e.currentWfNode.type+"Option",{ref:"wfcongfig",tag:"component",attrs:{disabled:!0}})],1):e._e(),a("el-tab-pane",{attrs:{label:e.$t("流程属性"),name:"tab02"}},[a("shcemeinfo-config",{ref:"shcemeinfo",attrs:{disabled:!0}})],1)],1)],1)])]},proxy:!0}])},[a("l-panel",{staticStyle:{"padding-right":"0"},scopedSlots:e._u([{key:"title",fn:function(){return[a("el-button-group",[a("el-tooltip",{attrs:{effect:"dark",content:e.$t("复原"),placement:"bottom"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-aim"},on:{click:e.resetZoom}})],1),a("el-tooltip",{attrs:{effect:"dark",content:e.$t("放大"),placement:"bottom"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-zoom-in"},on:{click:function(t){return e.handlerZoom(.1)}}})],1),a("el-tooltip",{attrs:{effect:"dark",content:e.$t("缩小"),placement:"bottom"}},[a("el-button",{attrs:{size:"mini",icon:"el-icon-zoom-out"},on:{click:function(t){return e.handlerZoom(-.1)}}})],1)],1)]},proxy:!0}])},[a("b-wflow-viewer",{ref:"bflow",on:{elementClick:e.elementClick}})],1)],1)},o=[],i=a("57ef"),r=a("f75f"),l=a("db94"),s=a("2edb"),c=a("60f8"),d=a("6ff0"),f=a("a926"),u=a("df4f"),p=a("2061"),b=a("825f"),h={provide:function(){return{wfdesign:this}},components:{shcemeinfoConfig:i["default"],startEventOption:r["default"],endEventOption:l["default"],gatewayAndOption:s["default"],gatewayInclusiveOption:c["default"],gatewayXorOption:d["default"],scriptTaskOption:f["default"],subprocessOption:u["default"],userTaskOption:p["default"],mylineOption:b["default"]},data:function(){return{configActiveName:"tab02",currentWfNode:void 0,wfNodeName:{startEvent:"开始节点",endEvent:"结束节点",gatewayAnd:"并行网关",gatewayInclusive:"包含网关",gatewayXor:"排他网关",scriptTask:"脚本节点",userTask:"审核节点",subprocess:"子流程",myline:"线条"}}},computed:{},created:function(){},methods:{resetZoom:function(){this.$refs.bflow.reset()},handlerZoom:function(e){this.$refs.bflow.handlerZoom(e)},elementClick:function(e){var t=this;this.currentWfNode=e,void 0==e?this.configActiveName="tab02":("myline"==e.type&&this.$nextTick((function(){t.$refs.wfcongfig&&t.$refs.wfcongfig.getConditions()})),this.configActiveName="tab01")},handleGetWFData:function(){return this.$deepClone(this.$refs.bflow.getData())},resetForm:function(){},setForm:function(e){var t=e.f_Content,a=JSON.parse(t),n={undoType:a.undoType,undoDbCode:a.undoDbCode,undoDbSQL:a.undoDbSQL,undoIOCName:a.undoIOCName,undoUrl:a.undoUrl,deleteType:a.deleteType,deleteDbCode:a.deleteDbCode,deleteDbSQL:a.deleteDbSQL,deleteIOCName:a.deleteIOCName,deleteUrl:a.deleteUrl,deleteDraftType:a.deleteDraftType,deleteDraftDbCode:a.deleteDraftDbCode,deleteDraftDbSQL:a.deleteDraftDbSQL,deleteDraftIOCName:a.deleteDraftIOCName,deleteDraftUrl:a.deleteDraftUrl};this.$refs.shcemeinfo.setForm(n),this.$refs.bflow.setData(a.wfData)}}},m=h,g=a("2877"),w=Object(g["a"])(m,n,o,!1,null,null,null);t["default"]=w.exports},"5ebe":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("l-layout",{staticClass:"l-tab-page"},[a("l-panel",{staticStyle:{padding:"0"},scopedSlots:e._u([{key:"toolRight",fn:function(){return[a("el-button-group",[a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh-left"},on:{click:e.handleRefresh}})],1)]},proxy:!0}])},[a("div",{staticClass:"l-rblock"},[a("l-table",{attrs:{loading:e.tableLoading,columns:e.columns,dataSource:e.tableData,"row-key":"f_Id",isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage},scopedSlots:e._u([{key:"f_CreateDate",fn:function(t){return[e._v(" "+e._s(e.lr_dateFormat(t.row.f_CreateDate))+" ")]}},{key:"f_Type",fn:function(t){return[1!=t.row.f_Type?a("el-tag",{attrs:{size:"mini",type:"info"}},[e._v(e._s(e.$t("草稿")))]):a("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(e._s(e.$t("正式")))])]}},{key:"f_IsVerison",fn:function(t){return[a("el-switch",{attrs:{disabled:t.row.f_IsVerison},on:{change:function(a){return e.handleEnableChange(t.row)}},model:{value:t.row.f_IsVerison,callback:function(a){e.$set(t.row,"f_IsVerison",a)},expression:"scope.row.f_IsVerison"}})]}}])},[a("l-table-btns",{attrs:{btns:e.tableBtns},on:{click:e.lr_handleTableBtnClick}})],1)],1)]),a("l-fullscreen-dialog",{attrs:{title:e.$t("流程模版预览")+"-"+e.previewTitle,visible:e.previewVisible,showOk:!1},on:{"update:visible":function(t){e.previewVisible=t},closed:e.handlePreviewClosed,opened:e.handlePreviewOpened}},[a("preview",{ref:"preview"})],1)],1)},o=[],i=(a("d81d"),a("159b"),a("96cf"),a("1da1")),r=a("5530"),l=a("4f9c"),s=window.$api.workflow.scheme,c={components:{preview:l["default"]},props:{schemeInfoId:String,schemeId:String,updateSchemeId:Function},data:function(){return{noAuth:!0,columns:[{label:"创建人",prop:"f_CreateUserName",minWidth:"160"},{label:"创建时间",prop:"f_CreateDate",minWidth:"160"},{label:"状态",prop:"f_Type",width:"64",align:"center"},{label:"当前版本",prop:"f_IsVerison",width:"80",align:"center"}],tableBtns:[{prop:"Preview",label:"预览"}],tableLoading:!1,tableTotal:0,tablePageSize:50,tableCurrentPage:1,tableData:[],previewVisible:!1,previewTitle:"",previewLoading:!1,formEditRow:null}},computed:{},watch:{schemeInfoId:function(){this.loadTablePageData()}},created:function(){this.loadTablePageData()},methods:{handleRefresh:function(){this.loadTablePageData()},loadTablePageData:function(e){var t=this;e||(this.tableCurrentPage=1),this.tableLoading=!0;var a={rows:this.tablePageSize,page:this.tableCurrentPage,sidx:"F_CreateDate DESC"};s.getHistoryPage(this.schemeInfoId,a).then((function(e){var a=t.$deepClone(e.data.data);t.tableData=a.rows.map((function(e){return Object(r["a"])(Object(r["a"])({},e),{},{f_IsVerison:e.f_Id==t.schemeId})})),t.tableTotal=a.records,t.tableLoading=!1})).catch((function(){t.tableData=[],t.tableLoading=!1}))},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTablePageData(!0)},handleEnableChange:function(e){var t=this;this.updateSchemeId(e.f_Id),this.tableData.forEach((function(t){t.f_Id!=e.f_Id&&(t.f_IsVerison=!1)})),s.updateHistory(this.schemeInfoId,e.f_Id).then((function(){t.$message({type:"success",message:t.$t("更新成功!")})}))},handlePreview:function(e,t){this.formEditRow=t,this.previewTitle=this.lr_dateFormat(t.f_CreateDate),this.previewVisible=!0},handlePreviewOpened:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var o;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e(),n.next=3,a.$awaitWraper(s.getHistory(a.formEditRow.f_Id));case 3:o=n.sent,a.$refs.preview.setForm(o),t();case 6:case"end":return n.stop()}}),n)})))()},handlePreviewClosed:function(){this.$refs.preview.resetForm()},handleClosePreview:function(){this.previewVisible=!1}}},d=c,f=a("2877"),u=Object(f["a"])(d,n,o,!1,null,null,null);t["default"]=u.exports}}]);