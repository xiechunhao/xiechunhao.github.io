(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views-organize-index"],{"5b91":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.lr_loadPage?e._e():a("l-layout",{directives:[{name:"loading",rawName:"v-loading",value:e.loading2,expression:"loading2"}],staticClass:"l-tab-page",attrs:{"element-loading-text":e.$t("拼命同步中")}},[a("l-panel",{scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入要查询关键字"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{btnText:e.$t("同步")},on:{click:function(t){return e.handleAdd()}}},[a("l-excel-btns")],1)]},proxy:!0}],null,!1,850496941)},[a("l-table",{attrs:{columns:e.columns,dataSource:e.tableShowData,loading:e.loading,"row-key":"id","default-expand-all":""},scopedSlots:e._u([{key:"isSyn",fn:function(t){return[1==t.row.isSyn?a("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(e._s(e.$t("已同步")))]):a("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v(e._s(e.$t("未同步")))])]}}],null,!1,3842053862)})],1)],1)},r=[],l=(a("96cf"),a("1da1")),i=window.$api.wechat.organize,o={data:function(){return{lr_isPage:!0,searchWord:"",loading:!1,loading2:!1,columns:[{label:"名称",prop:"name",minWidth:"260"},{label:"编号",prop:"code",width:"150"},{label:"同步状态",prop:"isSyn",width:"100",align:"center"}],tableData:[]}},mounted:function(){this.loadTable()},computed:{tableShowData:function(){return this.$toTree(this.tableData,"id","parentid","id","name")}},methods:{loadTable:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,e.$awaitWraper(i.getList({keyword:e.searchWord}));case 3:e.tableData=t.sent,e.loading=!1;case 5:case"end":return t.stop()}}),t)})))()},hanleSearch:function(){this.loadTable()},handleAdd:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading2=!0,t.next=3,e.$awaitWraper(i.syncData());case 3:a=t.sent,a&&e.$message({type:"success",message:e.$t("同步成功!")}),e.loadTable(),e.loading2=!1;case 7:case"end":return t.stop()}}),t)})))()}}},s=o,c=a("2877"),d=Object(c["a"])(s,n,r,!1,null,null,null);t["default"]=d.exports},b31e:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.lr_loadPage?e._e():a("l-layout",{staticClass:"l-tab-page",attrs:{left:240},scopedSlots:e._u([{key:"left",fn:function(){return[a("l-panel",{staticStyle:{"padding-right":"0"},attrs:{title:e.$t("公司信息")}},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.treeLoading,expression:"treeLoading"}],ref:"mytree",staticClass:"learun-tree",attrs:{"node-key":"value",data:e.lr_companyTree,"default-expand-all":"","expand-on-click-node":!1,"current-node-key":e.companyId},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node;return a("span",{staticClass:"lr-tree-node"},[a("i",{staticClass:"learun-icon-co"}),e._v(" "+e._s(e.$t(n.label))+" ")])}}],null,!1,2650579699)})],1)]},proxy:!0}],null,!1,221647670)},[a("l-panel",{staticStyle:{"padding-left":"0"},scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("l-tree-select",{attrs:{placeholder:e.$t("请选择部门"),options:e.lr_departmentTree(e.lr_departments[e.companyId]),size:"mini"},on:{change:e.handleChangeDept},model:{value:e.departmentId,callback:function(t){e.departmentId=t},expression:"departmentId"}})],1),a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入关键字"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{hasAdd:!1}},[a("l-excel-btns"),a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-refresh"},on:{click:function(t){return e.handleSync()}}},[e._v("同步")])],1)]},proxy:!0}],null,!1,2068571028)},[a("l-table",{attrs:{columns:e.lr_getPageColumns(e.columns),dataSource:e.tableData,loading:e.loading,"row-key":"f_DepartmentId","default-expand-all":""},scopedSlots:e._u([{key:"f_EnabledMark",fn:function(t){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(a){return e.handleEnableChange(t.row)}},model:{value:t.row.f_EnabledMark,callback:function(a){e.$set(t.row,"f_EnabledMark",a)},expression:"scope.row.f_EnabledMark"}})]}},{key:"isSyn",fn:function(t){return[1==t.row.isSyn?a("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(e._s(e.$t("已同步")))]):a("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v(e._s(e.$t("未同步")))])]}}],null,!1,2420040731)})],1)],1)},r=[];a("4de4"),a("fb6a"),a("dca8");function l(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}a("96cf");var i=a("1da1");function o(){var e=l([""]);return o=function(){return e},e}var s=window.$api.ding.organize,c={components:{},data:function(){return{lr_isPage:!0,searchWord:"",searchTableData:null,loading:!1,columns:[{label:"名称",prop:"f_FullName",minWidth:"150"},{label:"编码",prop:"f_EnCode",width:"100"},{label:"钉钉部门Id",prop:"f_DingDepId",width:"200"},{label:"同步状态",prop:"isSyn",width:"100",align:"center"}],treeLoading:!1,companyId:"",departmentId:"",departmentList:[]}},computed:{list:function(){return this.lr_departments[this.companyId]||[]},tableData:function(){return this.loading?[]:this.searchTableData?this.lr_departmentTree(this.searchTableData):this.lr_departmentTree(this.departmentList)}},mounted:function(){this.init()},methods:{init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.lr_loadDataItem("DepartmentNature"),e.companyId="53298b7a-404c-4337-aa7f-80b2a4ca6681",e.loadTableData()(o()),e.treeLoading=!0,t.next=6,e.lr_loadCompanys();case 6:e.$refs["mytree"].setCurrentKey("53298b7a-404c-4337-aa7f-80b2a4ca6681"),e.treeLoading=!1;case 8:case"end":return t.stop()}}),t)})))()},loadTableData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a={keyword:e.searchWord,parentid:e.departmentId},e.loading=!0,t.next=4,e.$awaitWraper(s.getList(e.companyId,a));case 4:e.departmentList=t.sent,e.searchWord="",e.searchTableData=null,e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},handleChangeDept:function(){this.loadTableData()},hanleSearch:function(){var e=this;this.searchWord?this.searchTableData=this.departmentList.filter((function(t){return t.f_FullName.indexOf(e.searchWord)>-1||t.f_EnCode.indexOf(e.searchWord)>-1})):this.searchTableData=null},handleNodeClick:function(e){this.loading=!0,this.companyId=e.f_CompanyId,this.departmentId="",this.lr_loadDepartments(this.companyId),this.loadTableData()},handleSync:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,a={keyword:e.searchWord,parentid:e.departmentId},t.next=4,e.$awaitWraper(s.syncData(e.companyId,a));case 4:n=t.sent,n&&e.$message({type:"success",message:e.$t("同步成功!")}),e.loadTableData(),e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()}}},d=c,u=a("2877"),p=Object(u["a"])(d,n,r,!1,null,null,null);t["default"]=p.exports},dca8:function(e,t,a){var n=a("23e7"),r=a("bb2f"),l=a("d039"),i=a("861d"),o=a("f183").onFreeze,s=Object.freeze,c=l((function(){s(1)}));n({target:"Object",stat:!0,forced:c,sham:!r},{freeze:function(e){return s&&i(e)?s(o(e)):e}})}}]);