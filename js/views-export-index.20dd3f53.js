(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views-export-index"],{d213:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.lr_loadPage?e._e():a("l-layout",{staticClass:"l-tab-page",scopedSlots:e._u([{key:"left",fn:function(){return[a("l-panel",{staticStyle:{"padding-right":"0"},attrs:{title:e.$t("功能目录")}},[a("el-tree",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"learun-tree",attrs:{data:e.modulesTree,"expand-on-click-node":!1},on:{"node-click":e.handleNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node,o=t.data;return a("span",{staticClass:"lr-tree-node"},[a("i",{class:o.f_Icon}),e._v(" "+e._s(e.$t(n.label))+" ")])}}],null,!1,3242355677)})],1)]},proxy:!0}],null,!1,1797140464)},[a("l-panel",{staticStyle:{"padding-left":"0"},scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入名称"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{on:{click:function(t){return e.handleAdd()}}},[a("l-excel-btns")],1)]},proxy:!0}],null,!1,1397456779)},[a("l-table",{attrs:{columns:e.columns,dataSource:e.tableData,loading:e.tableLoading,"row-key":"f_Id",isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t}},scopedSlots:e._u([{key:"f_CreateDate",fn:function(t){return[e._v(" "+e._s(e.lr_dateFormat(t.row.f_CreateDate,"yyyy-MM-dd hh:mm:ss"))+" ")]}},{key:"f_ModuleId",fn:function(t){return[e._v(" "+e._s(e.lr_formatValue(t.row.f_ModuleId,e.modules,"f_EnCode","f_FullName"))+" ")]}},{key:"f_EnabledMark",fn:function(t){return[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},on:{change:function(a){return e.handleEnableChange(t.row)}},model:{value:t.row.f_EnabledMark,callback:function(a){e.$set(t.row,"f_EnabledMark",a)},expression:"scope.row.f_EnabledMark"}})]}}],null,!1,1084513200)},[a("l-table-btns",{attrs:{btns:e.tableBtns},on:{click:e.lr_handleTableBtnClick}})],1)],1),a("l-dialog",{attrs:{title:e.formTitle,visible:e.formVisible,width:440,height:320},on:{"update:visible":function(t){e.formVisible=t},ok:e.handleSave,close:e.handleCloseForm,opened:e.handleOpenedForm}},[a("my-form",{ref:"form",attrs:{moduleId:e.currentModuleId,moduleCode:e.currentModuleCode}})],1)],1)},o=[],r=(a("4de4"),a("7db0"),a("96cf"),a("1da1")),l=a("5530"),i=a("5880"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-from-body"},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,size:"mini","label-width":"96px"}},[a("el-form-item",{attrs:{label:e.$t("名称"),prop:"f_Name"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.f_Name,callback:function(t){e.$set(e.formData,"f_Name",t)},expression:"formData.f_Name"}})],1),a("el-form-item",{attrs:{label:e.$t("绑定按钮"),prop:"f_ModuleBtnId"}},[a("l-select",{attrs:{options:e.btnOptions,placeholder:e.$t("请选择")},model:{value:e.formData.f_ModuleBtnId,callback:function(t){e.$set(e.formData,"f_ModuleBtnId",t)},expression:"formData.f_ModuleBtnId"}})],1),a("el-form-item",{attrs:{label:e.$t("表格ID"),prop:"f_GridId"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.f_GridId,callback:function(t){e.$set(e.formData,"f_GridId",t)},expression:"formData.f_GridId"}})],1),a("el-form-item",{attrs:{label:e.$t("导出勾选"),prop:"f_IsCheck"}},[a("el-switch",{attrs:{"active-value":1,"inactive-value":0},model:{value:e.formData.f_IsCheck,callback:function(t){e.$set(e.formData,"f_IsCheck",t)},expression:"formData.f_IsCheck"}})],1),1!=e.formData.f_IsCheck?a("el-form-item",{attrs:{label:e.$t("接口地址"),prop:"f_Url"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.f_Url,callback:function(t){e.$set(e.formData,"f_Url",t)},expression:"formData.f_Url"}})],1):e._e()],1)],1)},d=[],u=(a("caad"),a("d81d"),a("2532"),window.$api.system.module),f={props:{moduleId:String,moduleCode:String},data:function(){return{btnOptions:[],formData:{f_Name:"",f_ModuleBtnId:"",f_GridId:"mainTable",f_Url:"",f_IsCheck:0},rules:{f_Name:[{required:!0,message:"请输入名称"}],f_ModuleBtnId:[{required:!0,message:"请选择按钮"}],f_GridId:[{required:!0,message:"请输入表格ID"}]}}},watch:{moduleId:{handler:function(e){this.LoadButtons(e)},immediate:!0}},created:function(){},methods:{LoadButtons:function(e){var t=this;return Object(r["a"])(regeneratorRuntime.mark((function a(){var n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,t.$awaitWraper(u.getButtons(e));case 2:n=a.sent,t.btnOptions=n.filter((function(e){return![t.$t("新增"),t.$t("编辑"),t.$t("删除"),t.$t("详情"),t.$t("导入")].includes(e.f_FullName)})).map((function(e){return{label:e.f_FullName,value:e.f_EnCode}}));case 4:case"end":return a.stop()}}),a)})))()},resetForm:function(){this.formData.f_Id="",this.$refs.form&&this.$refs.form.resetFields()},validateForm:function(e){this.$refs.form.validate((function(t){t&&e()}))},setForm:function(e){this.formData=this.$deepClone(e)},getForm:function(){var e=this.$deepClone(this.formData);return e.f_ModuleId=this.moduleCode,e.F_BtnName=this.btnOptions.find((function(t){return t.value==e.f_ModuleBtnId})).label,e}}},c=f,m=a("2877"),h=Object(m["a"])(c,s,d,!1,null,null,null),p=h.exports,b=window.$api.excel.export,_={components:{MyForm:p},data:function(){return{lr_isPage:!0,loading:!1,tableLoading:!1,searchWord:"",columns:[{label:"名称",prop:"f_Name",minWidth:"160"},{label:"绑定功能",prop:"f_ModuleId",minWidth:"160"},{label:"绑定按钮",prop:"f_BtnName",width:"110"},{label:"状态",prop:"f_EnabledMark",width:"64",align:"center"},{label:"创建人",prop:"f_CreateUserName",width:"140"},{label:"创建时间",prop:"f_CreateDate",width:"160"}],tableBtns:[{prop:"Edit",label:"编辑",width:40},{prop:"Delete",label:"删除",width:40}],tableData:[],tableTotal:0,tablePageSize:50,tableCurrentPage:1,currentModuleId:"",currentModuleCode:"",formVisible:!1,formTitle:"",formEditRow:null,isEdit:!1}},computed:Object(l["a"])(Object(l["a"])({},Object(i["mapGetters"])(["modules"])),{},{myModules:function(){return this.modules.filter((function(e){return 1==e.f_EnabledMark}))},modulesTree:function(){var e=this.$toTree(this.myModules,"f_ModuleId","f_ParentId","f_ModuleId","f_FullName");return e.filter((function(e){return"0"==e.f_ParentId}))}}),mounted:function(){this.loadTableData()},methods:{loadTableData:function(e){var t=this;e||(this.tableCurrentPage=1),this.tableLoading=!0;var a={rows:this.tablePageSize,page:this.tableCurrentPage,sidx:"F_ModifyDate DESC,F_CreateDate DESC",keyword:this.searchWord,moduleId:this.currentModuleCode};b.getPage(a).then((function(e){var a=t.$deepClone(e.data.data);t.tableData=a.rows,t.tableTotal=a.records,t.tableLoading=!1})).catch((function(){t.tableData=[],t.tableLoading=!1}))},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTableData(!0)},hanleSearch:function(){this.loadTableData()},handleNodeClick:function(e){this.currentModuleCode=e.f_EnCode,this.currentModuleId=e.value,this.loadTableData()},handleEnableChange:function(e){var t=this;b.update(e.f_Id,e).then((function(){t.$message({type:"success",message:t.$t("更新成功!")})}))},handleAdd:function(){this.currentModuleId?(this.isEdit=!1,this.showForm("添加快速导出")):this.$message({type:"error",message:this.$t("请选择功能!")})},handleEdit:function(e,t){this.isEdit=!0;var a=this.modules.find((function(e){return e.f_EnCode==t.f_ModuleId}));a?(this.currentModuleId=a.f_ModuleId,this.currentModuleCode=a.f_EnCode,this.formEditRow=t,this.showForm("编辑快速导出")):this.$message({type:"warning",message:this.$t("绑定功能已经被删除,请删除重现配置！")})},handleDelete:function(e,t){var a=this;this.$confirm(this.$t("此操作将永久删除该数据, 是否继续?"),this.$t("提示"),{confirmButtonText:this.$t("确定"),cancelButtonText:this.$t("取消"),type:"warning"}).then((function(){b.remove(t.f_Id).then((function(){a.$message({type:"success",message:a.$t("删除成功!")}),a.loadTableData()}))})).catch((function(){a.$message({type:"info",message:a.$t("已取消删除")})}))},handleSave:function(e,t){var a=this;this.$refs.form.validateForm((function(){var n=a.$refs.form.getForm();e(),a.isEdit?b.update(a.formEditRow.f_Id,n).then((function(){t(),a.formVisible=!1,a.$message({type:"success",message:a.$t("更新成功!")}),a.loadTableData()})).catch((function(){t()})):b.add(n).then((function(){t(),a.formVisible=!1,a.$message({type:"success",message:a.$t("添加成功!")}),a.loadTableData()})).catch((function(){t()}))}))},handleOpenedForm:function(){var e=this;return Object(r["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.isEdit&&e.$refs.form.setForm(e.formEditRow);case 1:case"end":return t.stop()}}),t)})))()},handleCloseForm:function(){this.$refs.form.resetForm()},showForm:function(e){this.formTitle=e,this.formVisible=!0}}},g=_,$=Object(m["a"])(g,n,o,!1,null,null,null);t["default"]=$.exports}}]);