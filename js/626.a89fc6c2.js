"use strict";(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[626,3901],{26868:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var l=function(){var e=this,t=e._self._c;return t("ele-modal",{attrs:{width:"520px",title:"导入用户",visible:e.visible},on:{"update:visible":e.updateVisible}},[t("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"ele-block",attrs:{drag:"",action:"",accept:".xls,.xlsx","show-file-list":!1,"before-upload":e.doUpload}},[t("i",{staticClass:"el-icon-upload"}),t("div",{staticClass:"el-upload__text"},[e._v("将文件拖到此处, 或 "),t("em",[e._v("点击上传")])]),t("div",{staticClass:"el-upload__tip ele-text-center",attrs:{slot:"tip"},slot:"tip"},[t("span",[e._v("只能上传xls、xlsx文件, ")]),t("el-link",{staticStyle:{"vertical-align":"baseline"},attrs:{download:"",href:e.url,type:"primary",underline:!1}},[e._v(" 下载模板 ")])],1)])],1)},o=[],a=s(40968),i={name:"UserImport",props:{visible:Boolean},data(){return{loading:!1,url:"https://cdn.eleadmin.com/20200610/用户导入模板.xlsx"}},methods:{doUpload(e){return this.loading=!0,(0,a.y6)(e).then((e=>{this.loading=!1,this.$message.success(e),this.updateVisible(!1),this.$emit("done")})).catch((e=>{this.loading=!1,this.$message.error(e.message)})),!1},updateVisible(e){this.$emit("update:visible",e)}}},r=i,n=s(64008),c=(0,n.A)(r,l,o,!1,null,"77f0da30",null),u=c.exports},33901:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});s(80772);var l=function(){var e=this,t=e._self._c;return t("el-form",{staticClass:"ele-form-search",attrs:{"label-width":"77px"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.search.apply(null,arguments)},submit:function(e){e.preventDefault()}}},[t("el-row",{attrs:{gutter:15}},[t("el-col",{attrs:{lg:6,md:12}},[t("el-form-item",{attrs:{label:"用户账号:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.where.username,callback:function(t){e.$set(e.where,"username",t)},expression:"where.username"}})],1)],1),t("el-col",{attrs:{lg:6,md:12}},[t("el-form-item",{attrs:{label:"用户名:"}},[t("el-input",{attrs:{clearable:"",placeholder:"请输入"},model:{value:e.where.nickname,callback:function(t){e.$set(e.where,"nickname",t)},expression:"where.nickname"}})],1)],1),t("el-col",{attrs:{lg:6,md:12}},[t("el-form-item",{attrs:{label:"性别:"}},[t("el-select",{staticClass:"ele-fluid",attrs:{clearable:"",placeholder:"请选择"},model:{value:e.where.sex,callback:function(t){e.$set(e.where,"sex",t)},expression:"where.sex"}},[t("el-option",{attrs:{label:"男",value:1}}),t("el-option",{attrs:{label:"女",value:2}})],1)],1)],1),t("el-col",{attrs:{lg:6,md:12}},[t("div",{staticClass:"ele-form-actions"},[t("el-button",{staticClass:"ele-btn-icon",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.search}},[e._v(" 查询 ")]),t("el-button",{on:{click:e.reset}},[e._v("重置")])],1)])],1)],1)},o=[];const a={username:"",nickname:"",sex:void 0};var i={name:"UserSearch",data(){return{where:{...a}}},methods:{search(){this.$emit("search",this.where)},reset(){this.where={...a},this.search()}}},r=i,n=s(64008),c=(0,n.A)(r,l,o,!1,null,null,null),u=c.exports},60626:function(e,t,s){s.r(t),s.d(t,{default:function(){return m}});var l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ele-body"},[t("el-card",{attrs:{shadow:"never"}},[t("user-search",{on:{search:e.reload}}),t("ele-pro-table",{ref:"table",attrs:{columns:e.columns,datasource:e.datasource,selection:e.selection},on:{"update:selection":function(t){e.selection=t}},scopedSlots:e._u([{key:"nickname",fn:function({row:s}){return[t("router-link",{attrs:{to:"/system/user-info?id="+s.userId}},[e._v(" "+e._s(s.nickname)+" ")])]}},{key:"roles",fn:function({row:s}){return e._l(s.roles,(function(s){return t("el-tag",{key:s.roleId,attrs:{size:"mini",type:"primary","disable-transitions":!0}},[e._v(" "+e._s(s.roleName)+" ")])}))}},{key:"status",fn:function({row:s}){return[t("el-switch",{attrs:{"active-value":0,"inactive-value":1},on:{change:function(t){return e.editStatus(s)}},model:{value:s.status,callback:function(t){e.$set(s,"status",t)},expression:"row.status"}})]}},{key:"action",fn:function({row:s}){return[t("el-link",{attrs:{type:"primary",underline:!1,icon:"el-icon-edit"},on:{click:function(t){return e.openEdit(s)}}},[e._v(" 修改 ")]),t("el-link",{attrs:{type:"primary",underline:!1,icon:"el-icon-key"},on:{click:function(t){return e.resetPsw(s)}}},[e._v(" 重置密码 ")]),t("el-popconfirm",{staticClass:"ele-action",attrs:{title:"确定要删除此用户吗？"},on:{confirm:function(t){return e.remove(s)}}},[t("el-link",{attrs:{slot:"reference",type:"danger",underline:!1,icon:"el-icon-delete"},slot:"reference"},[e._v(" 删除 ")])],1)]}}])},[t("template",{slot:"toolbar"},[t("el-button",{staticClass:"ele-btn-icon",attrs:{size:"small",type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.openEdit()}}},[e._v(" 新建 ")]),t("el-button",{staticClass:"ele-btn-icon",attrs:{size:"small",type:"danger",icon:"el-icon-delete"},on:{click:e.removeBatch}},[e._v(" 删除 ")]),t("el-button",{staticClass:"ele-btn-icon",attrs:{size:"small",icon:"el-icon-upload2"},on:{click:e.openImport}},[e._v(" 导入 ")])],1)],2)],1),t("user-edit",{attrs:{visible:e.showEdit,data:e.current},on:{"update:visible":function(t){e.showEdit=t},done:e.reload}}),t("user-import",{attrs:{visible:e.showImport},on:{"update:visible":function(t){e.showImport=t},done:e.reload}})],1)},o=[],a=(s(58607),s(33901)),i=s(3967),r=s(26868),n=s(40968),c={name:"SystemUser",components:{UserSearch:a["default"],UserEdit:i["default"],UserImport:r["default"]},data(){return{columns:[{columnKey:"selection",type:"selection",width:45,align:"center",fixed:"left"},{columnKey:"index",type:"index",width:45,align:"center",showOverflowTooltip:!0,fixed:"left"},{prop:"username",label:"用户账号",sortable:"custom",showOverflowTooltip:!0,minWidth:110},{prop:"nickname",label:"用户名",sortable:"custom",showOverflowTooltip:!0,minWidth:110,slot:"nickname"},{prop:"sexName",label:"性别",sortable:"custom",showOverflowTooltip:!0,minWidth:80},{prop:"phone",label:"手机号",sortable:"custom",showOverflowTooltip:!0,minWidth:110},{columnKey:"roles",label:"角色",showOverflowTooltip:!0,minWidth:110,slot:"roles"},{prop:"createTime",label:"创建时间",sortable:"custom",showOverflowTooltip:!0,minWidth:110,formatter:(e,t,s)=>this.$util.toDateString(s)},{prop:"status",label:"状态",align:"center",sortable:"custom",width:80,resizable:!1,slot:"status",showOverflowTooltip:!0},{columnKey:"action",label:"操作",width:220,align:"center",resizable:!1,slot:"action",hideInSetting:!0,showOverflowTooltip:!0}],selection:[],current:null,showEdit:!1,showImport:!1}},methods:{datasource({page:e,limit:t,where:s,order:l}){return(0,n.SL)({...s,...l,page:e,limit:t})},reload(e){this.$refs.table.reload({page:1,where:e})},openEdit(e){this.current=e,this.showEdit=!0},openImport(){this.showImport=!0},remove(e){const t=this.$loading({lock:!0});(0,n.a1)(e.userId).then((e=>{t.close(),this.$message.success(e),this.reload()})).catch((e=>{t.close(),this.$message.error(e.message)}))},removeBatch(){this.selection.length?this.$confirm("确定要删除选中的用户吗?","提示",{type:"warning"}).then((()=>{const e=this.$loading({lock:!0});(0,n.XG)(this.selection.map((e=>e.userId))).then((t=>{e.close(),this.$message.success(t),this.reload()})).catch((t=>{e.close(),this.$message.error(t.message)}))})).catch((()=>{})):this.$message.error("请至少选择一条数据")},resetPsw(e){this.$confirm('确定要重置此用户的密码为"123456"吗?',"提示",{type:"warning"}).then((()=>{const t=this.$loading({lock:!0});(0,n.ej)(e.userId).then((e=>{t.close(),this.$message.success(e)})).catch((e=>{t.close(),this.$message.error(e.message)}))})).catch((()=>{}))},editStatus(e){const t=this.$loading({lock:!0});(0,n.pU)(e.userId,e.status).then((e=>{t.close(),this.$message.success(e)})).catch((s=>{t.close(),e.status=e.status?0:1,this.$message.error(s.message)}))}}},u=c,d=s(64008),h=(0,d.A)(u,l,o,!1,null,null,null),m=h.exports}}]);