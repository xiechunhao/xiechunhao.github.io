(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pagelogin"],{"15ce":function(e,t,s){},"65bc":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login-page"},[s("bgbubbles"),s("lang"),s("div",{staticClass:"login-body"},[s("div",{staticClass:"login-logo"},[s("img",{staticClass:"login-logo__img",attrs:{src:e.rootUrl+"img/login/learuninfo.svg"}})]),s("div",{staticClass:"login-sub-title"},[e._v(" "+e._s(e.$t("力软开发框架让开发变的如此简单快速"))+" ")]),s("div",{staticClass:"login-form"},[s("userLogin",{directives:[{name:"show",rawName:"v-show",value:!e.isca,expression:"!isca"}]}),s("calogin",{directives:[{name:"show",rawName:"v-show",value:e.isca,expression:"isca"}]})],1)]),s("div",{staticClass:"login-footer"},[e._v("Copyright © 2021-present 力软信息技术（苏州）有限公司出品")])],1)},a=[],o=s("fdca"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{"status-icon":"",rules:e.loginRules,model:e.loginForm,"label-width":"0"}},[s("el-form-item",{attrs:{prop:"account"}},[s("el-input",{ref:"account",attrs:{size:"small","auto-complete":"off",placeholder:e.appConfig.isTenant?e.$t("请输入租户号@账号"):e.$t("请输入账号"),disabled:e.disabled},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.account,callback:function(t){e.$set(e.loginForm,"account",t)},expression:"loginForm.account"}},[s("i",{staticClass:"el-icon-user",attrs:{slot:"prefix"},slot:"prefix"})])],1),s("el-form-item",{attrs:{prop:"password"}},[s("el-input",{ref:"password",attrs:{size:"small",type:e.passwordType,"auto-complete":"off",placeholder:e.$t("请输入密码"),disabled:e.disabled},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}},[s("i",{staticClass:"el-icon-view el-input__icon",attrs:{slot:"suffix"},on:{click:e.showPassword},slot:"suffix"}),s("i",{staticClass:"el-icon-lock",attrs:{slot:"prefix"},slot:"prefix"})])],1),s("el-form-item",[s("el-button",{staticClass:"login-submit",attrs:{type:"primary",loading:e.isLoading},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[e._v(e._s(e.submitName))])],1)],1)},r=[],l=(s("96cf"),s("1da1")),c=s("5530"),u=s("5880"),d={name:"userlogin",data:function(){return{loginForm:{account:"",password:""},loginRules:{account:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},passwordType:"password",isLoading:!1,disabled:!1,submitName:this.$t("登录")}},created:function(){},mounted:function(){},computed:Object(c["a"])({},Object(u["mapGetters"])(["tagWel","appConfig"])),props:[],methods:{showPassword:function(){""==this.passwordType?this.passwordType="password":this.passwordType=""},loading:function(e){e?(this.submitName=this.$t("登录中..."),this.isLoading=!0,this.disabled=!0):(this.submitName=this.$t("登录"),this.isLoading=!1,this.disabled=!1)},handleLogin:function(){var e=this;this.$refs.loginForm.validate((function(t,s){if(t)e.loading(!0),e.$store.dispatch("organization/user/login",e.loginForm).then(Object(l["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$store.commit("app/SET_ISFIRSTLOAD",!0),e.$router.push({path:e.tagWel.value});case 2:case"end":return t.stop()}}),t)})))).catch((function(){e.loading(!1)}));else{var i=s.password?"password":"account";e.$refs[i].focus()}}))}}},p=d,g=s("2877"),m=Object(g["a"])(p,n,r,!1,null,null,null),f=m.exports,h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{"status-icon":"",rules:e.loginRules,model:e.loginForm,"label-width":"0"}},[s("el-form-item",{attrs:{prop:"pincode"}},[s("el-input",{ref:"pincode",attrs:{size:"small",type:e.pincodeType,"auto-complete":"off",placeholder:e.$t("请输入pin码"),disabled:e.disabled},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleLogin.apply(null,arguments)}},model:{value:e.loginForm.pincode,callback:function(t){e.$set(e.loginForm,"pincode",t)},expression:"loginForm.pincode"}},[s("i",{staticClass:"el-icon-view el-input__icon",attrs:{slot:"suffix"},on:{click:e.showpincode},slot:"suffix"}),s("i",{staticClass:"el-icon-lock",attrs:{slot:"prefix"},slot:"prefix"})])],1),s("el-form-item",[s("el-button",{staticClass:"login-submit",attrs:{type:"primary",loading:e.isLoading},nativeOn:{click:function(t){return t.preventDefault(),e.handleLogin.apply(null,arguments)}}},[e._v(e._s(e.submitName))])],1)],1)},w=[],b=(s("99af"),s("ac1f"),s("466d"),{name:"userlogin",data:function(){return{pincode:"",debug:!0,caserverip:"",strrandom:"463971389",userconfirm:"",loginrtn:null,loginForm:{caUserSign:"",caCer:"",caRandom:""},loginRules:{pincode:[{required:!0,message:this.$t("请输入pin码"),trigger:"blur"}]},pincodeType:"password",isLoading:!1,disabled:!1,submitName:this.$t("登录")}},created:function(){},mounted:function(){},computed:Object(c["a"])({},Object(u["mapGetters"])(["tagWel","appConfig"])),props:[],methods:{showpincode:function(){""==this.pincodeType?this.pincodeType="password":this.pincodeType=""},loading:function(e){e?(this.submitName=this.$t("登录中..."),this.isLoading=!0,this.disabled=!0):(this.submitName=this.$t("登录"),this.isLoading=!1,this.disabled=!1)},getCer:function(){var e=window.usb_ocx.readCert("3","1");""==e?this.$message({type:"danger",message:this.$t("得到的UsbKey的证书错误!")}):this.loginForm.caCer=e},getSignUser:function(e,t){var s=window.usb_ocx.concat(e,"",""),i=window.usb_ocx.concat(t,s,""),a=window.usb_ocx.dataSignCertEx(i,"1","0");this.loginForm.caUserSign=a,this.loginForm.caRandom=t},handleLogin:function(){try{this.loginrtn=window.usb_ocx.VgetnameFirst(this.caserverip,"1")}catch(t){this.$message({type:"danger",message:this.$t("进行usbkey的口令验证错误!")}),this.$message.error(t),this.loading(!1)}if(this.loginrtn&&(this.$message({type:"danger",message:this.$t("验证证书内容为空!")}),this.loading(!1)),this.loginrtn.match("#."))if("#2"==this.loginrtn){this.loading(!0);var e=window.usb_ocx.Vgetname(this.pincode,this.caserverip,"1");e.match("#.")?"#8"==e?this.$message({type:"danger",message:this.$t("Pin码输入错误!")}):(this.$message({type:"danger",message:this.$t("没有插入key或者key错误!")}),this.$refs.pincode.focus()):this.loginToken(),this.loading(!1)}else this.loginToken();else this.loginToken()},loginToken:function(){var e=this;return Object(l["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.getCer(),e.getSignUser(),t.next=4,e.$awaitWraper(e.api.calogin(e.loginForm));case 4:s=t.sent,s?(e.$store.dispatch("organization/user/loginToken",{token:s.token}),e.$store.commit("app/SET_ISFIRSTLOAD",!0),e.$router.push({path:e.tagWel.value})):e.$router.push({path:"/login",replace:!0});case 6:case"end":return t.stop()}}),t)})))()}}}),v=b,$=Object(g["a"])(v,h,w,!1,null,null,null),y=$.exports,x=s("56f1"),_={name:"login",components:{userLogin:f,Lang:x["a"],bgbubbles:o["a"],calogin:y},data:function(){return{isca:!1}},created:function(){},mounted:function(){},computed:{},props:[],methods:{toggleLogin:function(){this.isca=!this.isca}}},k=_,C=(s("e5f6"),Object(g["a"])(k,i,a,!1,null,null,null));t["default"]=C.exports},"6df6":function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"login-page"},[s("bgbubbles"),s("lang"),s("div",{staticClass:"login-body"},[s("div",{staticClass:"login-logo"},[s("img",{staticClass:"login-logo__img",attrs:{src:e.rootUrl+"img/login/learuninfo.svg"}})]),s("div",{staticClass:"login-sub-title",staticStyle:{"margin-bottom":"40px"}},[e._v(" "+e._s(e.$t("力软开发框架让开发变的如此简单快速"))+" ")]),s("div",{staticClass:"reset_title"},[e._v(" "+e._s(e.$t("密码已过有效期，请修改密码后登录")))]),s("div",{staticClass:"login-form",staticStyle:{width:"420px"}},[s("resetPassword")],1)]),s("div",{staticClass:"login-footer"},[e._v("Copyright © 2021-present 力软信息技术（苏州）有限公司出品")])],1)},a=[],o=s("fdca"),n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,"label-position":"left",size:"mini","label-width":"0"}},[s("el-form-item",{attrs:{prop:"oldPassword","label-width":"100px"}},[s("template",{slot:"label"},[s("span",{staticStyle:{"line-height":"40px"}},[e._v("旧密码")])]),s("el-input",{attrs:{size:"small","show-password":""},model:{value:e.formData.oldPassword,callback:function(t){e.$set(e.formData,"oldPassword",t)},expression:"formData.oldPassword"}})],2),s("el-form-item",{attrs:{prop:"password","label-width":"100px"}},[s("template",{slot:"label"},[s("span",{staticStyle:{"line-height":"40px"}},[e._v("新密码")])]),s("el-input",{attrs:{size:"small","show-password":""},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}})],2),s("el-form-item",{attrs:{prop:"password2","label-width":"100px"}},[s("template",{slot:"label"},[s("span",{staticStyle:{"line-height":"40px"}},[e._v("重复新密码")])]),s("el-input",{attrs:{size:"small","show-password":""},model:{value:e.formData.password2,callback:function(t){e.$set(e.formData,"password2",t)},expression:"formData.password2"}})],2),s("el-form-item",[s("el-button",{staticClass:"login-submit",staticStyle:{height:"38px"},attrs:{type:"primary",loading:e.loading},on:{click:e.onSubmit}},[e._v("提交")])],1)],1)},r=[],l=(s("96cf"),s("1da1")),c=window.$api.organization.user,u={name:"resetpassword",data:function(){var e=this;return{loading:!1,formData:{oldPassword:"",password:"",password2:""},rules:{oldPassword:[{required:!0,message:"请输入旧密码"},{validator:this.validatorPassword,trigger:"blur"}],password:[{required:!0,message:"请输入新密码"},{validator:this.getRule,trigger:"blur"}],password2:[{required:!0,message:"请再输入新密码"},{validator:function(t,s,i){e.formData.password2!=e.formData.password?i(new Error("两次密码输入不一致")):i()},trigger:"blur"}]},passwordType:"password"}},computed:{},created:function(){},methods:{getRule:function(e,t,s){var i=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a,o,n,r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.$awaitWraper(c.GetRuleByRole());case 2:a=e.sent,o=a.f_Complexity,n=a.f_Length,n>t.length?s(new Error("密码不符合规范")):(-1!==o.indexOf(1)?(r=/^(?=.*[A-Z]).*$/,r.test(t)||s(new Error("密码不符合规范"))):(r=/^(?=.*[A-Z]).*$/,r.test(t)&&s(new Error("密码不符合规范"))),-1!==o.indexOf(2)?(r=/^(?=.*[a-z]).*$/,r.test(t)||s(new Error("密码不符合规范"))):(r=/^(?=.*[a-z]).*$/,r.test(t)&&s(new Error("密码不符合规范"))),-1!==o.indexOf(3)?(r=/^(?=.*\d).*$/,r.test(t)||s(new Error("密码不符合规范"))):(r=/^(?=.*\d).*$/,r.test(t)&&s(new Error("密码不符合规范"))),-1!==o.indexOf(4)?(r=/^(?=.*[*?!&￥$%^#,./@";:><\\[\]}{\-=+_\\|》《。，、？’‘“”~ `]).*$/,r.test(t)||s(new Error("密码不符合规范"))):(r=/^(?=.*[*?!&￥$%^#,./@";:><\\[\]}{\-=+_\\|》《。，、？’‘“”~ `]).*$/,r.test(t)&&s(new Error("密码不符合规范"))),s());case 6:case"end":return e.stop()}}),e)})))()},showPassword:function(){""==this.passwordType?this.passwordType="password":this.passwordType=""},validatorPassword:function(e,t,s){var i=this;return Object(l["a"])(regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i.$awaitWraper(c.validatorPassword(i.$md5(t)));case 2:a=e.sent,a?s():s(new Error("密码错误"));case 4:case"end":return e.stop()}}),e)})))()},onSubmit:function(){var e=this;this.$refs.form.validate(function(){var t=Object(l["a"])(regeneratorRuntime.mark((function t(s){var i,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!s){t.next=7;break}return e.loading=!0,i={password:e.$md5(e.formData.password),oldPassword:e.$md5(e.formData.oldPassword)},t.next=5,e.$awaitWraper(c.updatePassword(i));case 5:a=t.sent,a&&(e.$message({type:"success",message:"修改成功!"}),setTimeout((function(){e.$store.dispatch("organization/user/fedLogOut").then((function(){e.$router.push({path:"/login"})}))}),500));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}}},d=u,p=s("2877"),g=Object(p["a"])(d,n,r,!1,null,null,null),m=g.exports,f=s("56f1"),h={name:"login",components:{resetPassword:m,Lang:f["a"],bgbubbles:o["a"]},data:function(){return{}},created:function(){},mounted:function(){},computed:{},props:[],methods:{}},w=h,b=(s("7849"),Object(p["a"])(w,i,a,!1,null,null,null));t["default"]=b.exports},"6f31":function(e,t,s){"use strict";s("c090")},7849:function(e,t,s){"use strict";s("15ce")},c090:function(e,t,s){},e13f:function(e,t,s){},e5f6:function(e,t,s){"use strict";s("e13f")},fdca:function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ul",{staticClass:"bg-bubbles",style:{background:"url("+e.rootUrl+"img/login/bg.jpg)"}},[s("li"),s("li"),s("li"),s("li"),s("li"),s("li"),s("li"),s("li"),s("li"),s("li"),s("li"),s("li"),s("li"),s("li")])},a=[],o={name:"bgbubbles"},n=o,r=(s("6f31"),s("2877")),l=Object(r["a"])(n,i,a,!1,null,"c79ffa02",null);t["a"]=l.exports}}]);