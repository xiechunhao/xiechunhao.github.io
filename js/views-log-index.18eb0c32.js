(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views-log-index","log"],{"4d57":function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("l-layout",[a("l-panel",{scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-radio-group",{attrs:{size:"mini"},on:{change:e.handleCaregoryChange},model:{value:e.categoryId,callback:function(t){e.categoryId=t},expression:"categoryId"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v(e._s(e.$t("成功")))]),a("el-radio-button",{attrs:{label:"2"}},[e._v(e._s(e.$t("失败")))])],1)],1),a("div",{staticClass:"l-panel--item",staticStyle:{width:"264px"}},[a("el-date-picker",{attrs:{size:"mini",type:"daterange",align:"right","unlink-panels":"","start-placeholder":e.$t("开始日期"),"end-placeholder":e.$t("结束日期"),"picker-options":e.pickerOptions},on:{change:e.handleDateChange},model:{value:e.operateTime,callback:function(t){e.operateTime=t},expression:"operateTime"}})],1),a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("任务名称"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{hasAdd:!1}},[a("l-excel-btns")],1)]},proxy:!0}])},[a("l-table",{attrs:{loading:e.tableLoading,columns:e.columns,dataSource:e.tableData,"row-key":"f_Id",isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage},scopedSlots:e._u([{key:"f_CreateDate",fn:function(t){return[e._v(" "+e._s(e.lr_dateFormat(t.row.f_CreateDate))+" ")]}},{key:"f_ExecuteResult",fn:function(t){return[1==t.row.f_ExecuteResult?a("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(e._s(e.$t("成功")))]):a("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v(e._s(e.$t("失败")))])]}}])})],1)],1)},n=[],i=window.$api.quartz.log,o={data:function(){return{lr_isPage:!0,categoryId:"1",operateTime:null,pickerOptions:{shortcuts:[{text:this.$t("最近一周"),onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:this.$t("最近一个月"),onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:this.$t("最近三个月"),onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}}]},columns:[{label:"名称",prop:"f_Name",width:"200"},{label:"时间",prop:"f_CreateDate",width:"160"},{label:"结果",prop:"f_ExecuteResult",width:"64",align:"center"},{label:"内容",prop:"f_Des",minWidth:"200"}],tableLoading:!1,tableTotal:0,tablePageSize:50,tableCurrentPage:1,tableData:[],keyWord:"",optionsDate:[{value:"7",label:this.$t("保留近一周")},{value:"1",label:this.$t("保留近一个月")},{value:"3",label:this.$t("保留近三个月")},{value:"0",label:this.$t("不保留，全部删除")}],formVisible:!1,keepTime:"7"}},computed:{},mounted:function(){this.loadTablePageData()},methods:{loadTablePageData:function(e){var t=this;e||(this.tableCurrentPage=1),this.tableLoading=!0;var a={rows:this.tablePageSize,page:this.tableCurrentPage,sidx:"f_CreateDate DESC",f_ExecuteResult:this.categoryId,f_Name:this.keyWord,f_CreateDate:this.operateTime?this.operateTime[0]:null,endDate:this.operateTime?this.operateTime[1]:null};i.getPage(a).then((function(e){var a=t.$deepClone(e.data.data);t.tableData=a.rows,t.tableTotal=a.records,t.tableLoading=!1})).catch((function(){t.tableData=[],t.tableLoading=!1}))},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTablePageData(!0)},handleCaregoryChange:function(){this.loadTablePageData()},handleDateChange:function(){this.loadTablePageData()},hanleSearch:function(){this.loadTablePageData()}}},r=o,s=a("2877"),c=Object(s["a"])(r,l,n,!1,null,null,null);t["default"]=c.exports},f114:function(e,t,a){"use strict";a.r(t);var l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("l-layout",[a("l-panel",{scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-radio-group",{attrs:{disabled:e.tableLoading,size:"mini"},on:{change:e.handleCaregoryChange},model:{value:e.categoryId,callback:function(t){e.categoryId=t},expression:"categoryId"}},[a("el-radio-button",{attrs:{label:"1"}},[e._v(e._s(e.$t("登录")))]),a("el-radio-button",{attrs:{label:"2"}},[e._v(e._s(e.$t("访问")))]),a("el-radio-button",{attrs:{label:"3"}},[e._v(e._s(e.$t("操作")))]),a("el-radio-button",{attrs:{label:"4"}},[e._v(e._s(e.$t("异常")))])],1)],1),a("div",{staticClass:"l-panel--item",staticStyle:{width:"344px"}},[a("el-date-picker",{attrs:{size:"mini",type:"daterange",align:"right","unlink-panels":"","range-separator":e.$t("至"),"start-placeholder":e.$t("开始日期"),"end-placeholder":e.$t("结束日期"),"picker-options":e.pickerOptions},on:{change:e.handleDateChange},model:{value:e.operateTime,callback:function(t){e.operateTime=t},expression:"operateTime"}})],1),a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入IP/功能/类型"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.keyWord,callback:function(t){e.keyWord=t},expression:"keyWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{hasAdd:!1}},[a("l-excel-btns")],1)]},proxy:!0}])},[a("l-table",{attrs:{loading:e.tableLoading,columns:e.lr_getPageColumns(e.columns),dataSource:e.tableData,"row-key":"f_Id",isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage},scopedSlots:e._u([{key:"f_OperateTime",fn:function(t){return[e._v(" "+e._s(e.lr_dateFormat(t.row.f_OperateTime))+" ")]}},{key:"f_Category",fn:function(t){return[e._v(" "+e._s(e.lr_dataItemDetailsName("FormSort",t.row.f_Category))+" ")]}},{key:"f_ExecuteResult",fn:function(t){return[1==t.row.f_ExecuteResult?a("el-tag",{attrs:{size:"mini",type:"success"}},[e._v(e._s(e.$t("成功")))]):a("el-tag",{attrs:{size:"mini",type:"danger"}},[e._v(e._s(e.$t("失败")))])]}}])})],1),a("l-dialog",{attrs:{title:e.$t("清空"),visible:e.formVisible,width:"400px",height:160},on:{"update:visible":function(t){e.formVisible=t},ok:e.handleDelete}},[a("div",{staticClass:"l-from-body"},[a("el-form",{ref:"form",attrs:{size:"mini","label-width":"80px"}},[a("el-form-item",{attrs:{label:e.$t("时间")}},[a("l-select",{attrs:{placeholder:e.$t("请选择保留时间"),size:"mini",options:e.optionsDate},model:{value:e.keepTime,callback:function(t){e.keepTime=t},expression:"keepTime"}})],1)],1)],1)])],1)},n=[],i=(a("96cf"),a("1da1")),o=window.$api.system.log,r={data:function(){return{lr_isPage:!0,categoryId:"1",operateTime:null,pickerOptions:{},columns:[{label:"时间",prop:"f_OperateTime",width:"160"},{label:"用户",prop:"f_OperateAccount",width:"120",align:"center"},{label:"姓名",prop:"f_OperateUserId",width:"120",align:"center",dataType:"user"},{label:"IP",prop:"f_IPAddress",width:"120"},{label:"功能",prop:"f_Module",width:"200"},{label:"类型",prop:"f_OperateType",width:"64",align:"center"},{label:"结果",prop:"f_ExecuteResult",width:"64",align:"center"},{label:"描述",prop:"f_ExecuteResultJson",minWidth:"150"}],tableLoading:!1,tableTotal:0,tablePageSize:50,tableCurrentPage:1,tableData:[],keyWord:"",optionsDate:[{value:"7",label:this.$t("保留近一周")},{value:"1",label:this.$t("保留近一个月")},{value:"3",label:this.$t("保留近三个月")},{value:"0",label:this.$t("不保留，全部删除")}],formVisible:!1,keepTime:"7"}},computed:{},mounted:function(){this.loadTablePageData()},methods:{loadTablePageData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var l,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(t.tableCurrentPage=1),t.tableLoading=!0,l={rows:t.tablePageSize,page:t.tableCurrentPage,sidx:"F_OperateTime DESC,F_SourceObjectId DESC",categoryId:t.categoryId,keyword:t.keyWord,startTime:t.operateTime?t.operateTime[0]:null,endTime:t.operateTime?t.operateTime[1]:null},a.next=5,t.$awaitWraper(o.getPage(l));case 5:n=a.sent,n?(t.tableData=n.rows,t.tableTotal=n.records):(t.tableData=[],t.tableTotal=0),t.tableLoading=!1;case 8:case"end":return a.stop()}}),a)})))()},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTablePageData(!0)},handleCaregoryChange:function(){this.loadTablePageData()},handleDateChange:function(){this.loadTablePageData()},hanleSearch:function(){this.loadTablePageData()},handleOpenForm:function(){this.formVisible=!0},handleDelete:function(e,t){var a=this;e(this.$t("清空日志数据中...")),o.remove(this.categoryId,this.keepTime||"0").then((function(){a.$message({type:"success",message:a.$t("清空成功!")}),a.formVisible=!1,a.loadTablePageData(),t()})).catch((function(){a.formVisible=!1,t()}))},handleCloseForm:function(){this.keepTime="7"}}},s=r,c=a("2877"),u=Object(c["a"])(s,l,n,!1,null,null,null);t["default"]=u.exports}}]);