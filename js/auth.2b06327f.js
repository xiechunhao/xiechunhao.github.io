(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["auth"],{3812:function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("l-layout",{directives:[{name:"loading",rawName:"v-loading",value:e.moduleLoading,expression:"moduleLoading"}],staticClass:"l-tab-page"},[n("l-panel",{scopedSlots:e._u([{key:"toolLeft",fn:function(){return[n("div",{staticClass:"l-panel--item"},[n("l-select",{attrs:{placeholder:e.$t("请选择"),options:[{value:"1",label:"PC功能"},{value:"2",label:"移动功能"}],size:"mini",clearable:!1},on:{change:e.handleChangeType},model:{value:e.appType,callback:function(t){e.appType=t},expression:"appType"}})],1)]},proxy:!0}])},[n("div",{staticClass:"l-auto-window",staticStyle:{padding:"0 8px"}},[n("el-tabs",{attrs:{"before-leave":e.handleTabLeave},model:{value:e.tabsActiveName,callback:function(t){e.tabsActiveName=t},expression:"tabsActiveName"}},[n("el-tab-pane",{attrs:{label:e.$t("功能"),name:"tabModule"}},[n("l-layout",{attrs:{bottom:40},scopedSlots:e._u([{key:"bottom",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{disabled:!e.isSaveModule,size:"mini"},on:{click:e.handleModuleCancel}},[e._v("取消")]),n("el-button",{attrs:{disabled:!e.isSaveModule,size:"mini",type:"primary"},on:{click:e.handleModuleSave}},[e._v(e._s(e.$t("保存")))])],1)]},proxy:!0}])},[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto"}},[n("el-tree",{ref:"modulesTree",attrs:{data:e.modulesTree,"show-checkbox":"","default-expand-all":"","node-key":"value"},on:{check:e.handleModuleCheck},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(r.label))+" ")])}}])})],1)])],1),n("el-tab-pane",{attrs:{label:e.$t("按钮"),name:"tabButton"}},[n("l-layout",{attrs:{left:240,bottom:40},scopedSlots:e._u([{key:"left",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto","border-right":"1px solid #e4e7ed"}},[n("el-tree",{attrs:{data:e.myModulesTree,"default-expand-all":"","node-key":"value"},on:{"node-click":e.handleModuleClick},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(r.label))+" ")])}}])})],1)]},proxy:!0},{key:"bottom",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{disabled:!e.isSaveButton,size:"mini"},on:{click:e.handleButtonCancel}},[e._v(e._s(e.$t("取消")))]),n("el-button",{attrs:{disabled:!e.isSaveButton,size:"mini",type:"primary"},on:{click:e.handleButtonSave}},[e._v(e._s(e.$t("保存")))])],1)]},proxy:!0}])},[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto"}},[n("el-tree",{ref:"buttonTree",attrs:{data:e.buttonTree,"show-checkbox":"","default-expand-all":"","node-key":"value"},on:{check:e.handleButtonCheck},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(r.label))+" ")])}}])})],1)])],1),n("el-tab-pane",{attrs:{label:e.$t("列表"),name:"tabCol"}},[n("l-layout",{attrs:{left:240,bottom:40},scopedSlots:e._u([{key:"left",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto","border-right":"1px solid #e4e7ed"}},[n("el-tree",{attrs:{data:e.myModulesTree,"default-expand-all":"","node-key":"value"},on:{"node-click":e.handleColModuleClick},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(r.label))+" ")])}}])})],1)]},proxy:!0},{key:"bottom",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{disabled:!e.isSaveColumn,size:"mini"},on:{click:e.handleColumnCancel}},[e._v(e._s(e.$t("取消")))]),n("el-button",{attrs:{disabled:!e.isSaveColumn,size:"mini",type:"primary"},on:{click:e.handleColumnSave}},[e._v(e._s(e.$t("保存")))])],1)]},proxy:!0}])},[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto"}},[n("el-tree",{ref:"columnTree",attrs:{data:e.columnTree,"show-checkbox":"","default-expand-all":"","node-key":"value"},on:{check:e.handleColumnCheck},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(r.label))+" ")])}}])})],1)])],1),n("el-tab-pane",{attrs:{label:e.$t("表单"),name:"tabForm"}},[n("l-layout",{attrs:{left:240,bottom:40},scopedSlots:e._u([{key:"left",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto","border-right":"1px solid #e4e7ed"}},[n("el-tree",{attrs:{data:e.myModulesTree,"default-expand-all":"","node-key":"value"},on:{"node-click":e.handleFormModuleClick},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(r.label))+" ")])}}])})],1)]},proxy:!0},{key:"bottom",fn:function(){return[n("div",{staticClass:"l-rblock",staticStyle:{"text-align":"right"}},[n("el-button",{attrs:{disabled:!e.isSaveForm,size:"mini"},on:{click:e.handleFormCancel}},[e._v(e._s(e.$t("取消")))]),n("el-button",{attrs:{disabled:!e.isSaveForm,size:"mini",type:"primary"},on:{click:e.handleFormSave}},[e._v(e._s(e.$t("保存")))])],1)]},proxy:!0}])},[n("div",{staticClass:"l-rblock",staticStyle:{overflow:"auto"}},[n("el-tree",{ref:"formTree",attrs:{data:e.formTree,"show-checkbox":"","default-expand-all":"","node-key":"value"},on:{check:e.handleFormCheck},scopedSlots:e._u([{key:"default",fn:function(t){var r=t.data;return n("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(r.label))+" ")])}}])})],1)])],1)],1)],1)])],1)},a=[],o=(n("99af"),n("4de4"),n("7db0"),n("c740"),n("d81d"),n("d3b7"),n("159b"),n("96cf"),n("1da1")),u=n("5530"),s=n("5880"),c=window.$api.sass.auth,i=window.$api.system.module,l=window.$api.mapp.module,d={data:function(){return{tabsActiveName:"tabModule",id:"",appType:"1",moduleLoading:!1,moduleAuthList:[],moduleChecked:[],moduleId:"",apps:[],buttons:[],buttonList:[],buttonChecked:[],columns:[],columnList:[],columnChecked:[],forms:[],formList:[],formChecked:[]}},computed:Object(u["a"])(Object(u["a"])({},Object(s["mapGetters"])(["modules"])),{},{myModules:function(){return this.modules.filter((function(e){return 1==e.f_EnabledMark&&0!=e.f_EnCode.indexOf("sass_")}))},modulesTree:function(){if("1"==this.appType){var e=this.$toTree(this.myModules,"f_ModuleId","f_ParentId","f_ModuleId","f_FullName");return e.filter((function(e){return"0"==e.f_ParentId}))}return this.getAppTree(this.apps)},myModulesTree:function(){var e=this;if("1"==this.appType){var t=this.myModules.filter((function(t){return e.moduleAuthList.indexOf(t.f_ModuleId)>-1}));return this.$toTree(t,"f_ModuleId","f_ParentId","f_ModuleId","f_FullName")}var n=this.apps.filter((function(t){return 3!=t.f_IsSystem&&4!=t.f_IsSystem&&e.moduleAuthList.indexOf(t.f_Id)>-1}));return this.getAppTree(n)},isSaveModule:function(){return!this.equalsArr(this.moduleAuthList,this.moduleChecked)},buttonTree:function(){var e=this.buttons,t="1"==this.appType?this.$toTree(e,"f_Id","f_ParentId","f_EnCode","f_FullName"):this.$toTree(e,"f_Id","f_ParentId","f_Code","f_Name");return t},isSaveButton:function(){return!this.equalsArr(this.buttonList,this.buttonChecked)},columnTree:function(){var e=this.columns,t="1"==this.appType?this.$toTree(e,"f_Id","f_ParentId","f_EnCode","f_FullName"):this.$toTree(e,"f_Id","f_ParentId","f_Code","f_Name");return t},isSaveColumn:function(){return!this.equalsArr(this.columnList,this.columnChecked)},formTree:function(){var e=this.forms,t="1"==this.appType?this.$toTree(e,"f_Id","f_ParentId","f_EnCode","f_FullName"):this.$toTree(e,"f_Id","f_ParentId","f_Code","f_Name");return t},isSaveForm:function(){return!this.equalsArr(this.formList,this.formChecked)}}),methods:{equalsArr:function(e,t){var n=!0;return e.length!==t.length?n=!1:(e.forEach((function(e){-1===t.indexOf(e)&&(n=!1)})),t.forEach((function(t){-1===e.indexOf(t)&&(n=!1)}))),n},init:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.id=e,n.next=3,t.fetchModuleAuthData(e);case 3:case"end":return n.stop()}}),n)})))()},close:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.handleTabLeave();case 2:e.tabsActiveName="tabModule",e.appType="1";case 4:case"end":return t.stop()}}),t)})))()},handleTabLeave:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:t.t0=e.tabsActiveName,t.next="tabModule"===t.t0?3:"tabButton"===t.t0?6:"tabCol"===t.t0?9:"tabForm"===t.t0?12:15;break;case 3:return t.next=5,e.leaveModule();case 5:return t.abrupt("break",15);case 6:return t.next=8,e.leaveButton();case 8:return t.abrupt("break",15);case 9:return t.next=11,e.leaveColumn();case 11:return t.abrupt("break",15);case 12:return t.next=14,e.leaveForm();case 14:return t.abrupt("break",15);case 15:case"end":return t.stop()}}),t)})))()},fetchModuleAuthData:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.moduleChecked=[],t.moduleAuthList=[],"1"!=t.appType){n.next=10;break}return n.next=5,t.$awaitWraper(c.getList(e,1,"0"));case 5:t.moduleAuthList=n.sent.map((function(e){return e.f_ItemId})),r=t.moduleAuthList.find((function(e){return"87df6e42-fd64-4f46-bc06-74b26a8634bc"==e})),console.log(r,"test"),n.next=18;break;case 10:return n.next=12,t.lr_loadDataItem("function");case 12:return n.next=14,t.$awaitWraper(l.getList());case 14:return t.apps=n.sent,n.next=17,t.$awaitWraper(c.getList(e,5,"0"));case 17:t.moduleAuthList=n.sent.map((function(e){return e.f_ItemId}));case 18:t.$nextTick((function(){t.$refs.modulesTree.setCheckedKeys(t.moduleAuthList.filter((function(e){return-1==t.myModules.findIndex((function(t){return t.f_ParentId==e}))})));var e=t.$refs.modulesTree.getCheckedKeys(),n=t.$refs.modulesTree.getHalfCheckedKeys();t.moduleChecked=e.concat(n)}));case 19:case"end":return n.stop()}}),n)})))()},handleModuleCheck:function(e,t){this.moduleChecked=t.checkedKeys.concat(t.halfCheckedKeys)},handleModuleCancel:function(){this.moduleChecked=this.$deepClone(this.moduleAuthList),this.$refs.modulesTree.setCheckedKeys(this.moduleChecked)},handleModuleSave:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.moduleLoading=!0,n={ids:e.moduleChecked,itemType:"1"==e.appType?1:5,parentId:"0"},t.next=4,e.$awaitWraper(c.save(e.id,n));case 4:r=t.sent,r&&(e.$message({type:"success",message:e.$t("保存成功!")}),e.moduleAuthList=e.$deepClone(e.moduleChecked)),e.moduleLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},leaveModule:function(){var e=this;return new Promise((function(t){e.isSaveModule?e.$confirm(e.$t("离开前,是否保存设置数据?"),e.$t("提示"),{confirmButtonText:e.$t("确定"),cancelButtonText:e.$t("取消"),type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.handleModuleSave();case 2:t();case 3:case"end":return n.stop()}}),n)})))).catch((function(){e.$nextTick((function(){e.$refs.modulesTree.setCheckedKeys(e.moduleAuthList.filter((function(t){return-1==e.myModules.findIndex((function(e){return e.f_ParentId==t}))})));var n=e.$refs.modulesTree.getCheckedKeys(),r=e.$refs.modulesTree.getHalfCheckedKeys();e.moduleChecked=n.concat(r),t()}))})):t()}))},getAppTree:function(e){if(0==e.length)return[];var t={},n=[],r=this.lr_dataItem["function"]||[];return r.forEach((function(e){var r={label:e.f_ItemName,value:e.f_ItemValue,children:[]};t[e.f_ItemValue]=r.children,n.push(r)})),e.forEach((function(e){if(e.label=e.f_Name,e.value=e.f_Id,!t[e.f_Type]){var r={label:e.f_Type,value:e.f_Type,children:[]};t[e.f_Type]=r.children,n.push(r)}t[e.f_Type].push(e)})),n.filter((function(e){return e.children.length>0}))},handleModuleClick:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.moduleId!=e.value){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.leaveButton();case 4:if(t.moduleId=e.value,"expand"!=e.f_Target){n.next=11;break}t.buttons=[],t.buttonList=[],t.buttonChecked=[],n.next=20;break;case 11:if(t.moduleLoading=!0,"1"!=t.appType){n.next=17;break}return n.next=15,t.fetchButtons(t.moduleId,e.f_FullName);case 15:n.next=19;break;case 17:return n.next=19,t.fetchAppButtons(t.moduleId,e.f_Name);case 19:t.moduleLoading=!1;case 20:case"end":return n.stop()}}),n)})))()},fetchButtons:function(e,t){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a={f_Id:"0",f_ParentId:"01",f_EnCode:"0",f_FullName:t},"7ae94059-9aa5-48eb-8330-4e2a6565b193"!=e){r.next=6;break}return n.buttons=[],n.buttonList=[],n.$refs.buttonTree.setCheckedKeys(n.buttonList),r.abrupt("return");case 6:return r.next=8,n.$awaitWraper(i.getButtons(e));case 8:return o=r.sent,o.forEach((function(e){return e.f_ParentId="0"})),o.length>0&&o.push(a),r.next=13,n.fetchAuthButtons(e);case 13:n.buttons=o,n.$refs.buttonTree.setCheckedKeys(n.buttonList);case 15:case"end":return r.stop()}}),r)})))()},fetchAppButtons:function(e,t){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={f_Id:"0",f_ParentId:"01",f_Code:"0",f_Name:t},r.next=3,n.$awaitWraper(l.getChildren(e,1));case 3:return o=r.sent,o.forEach((function(e){return e.f_ParentId="0"})),o.length>0&&o.push(a),r.next=8,n.fetchAuthButtons(e);case 8:n.buttons=o,n.$refs.buttonTree.setCheckedKeys(n.buttonList);case 10:case"end":return r.stop()}}),r)})))()},fetchAuthButtons:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$awaitWraper(c.getList(t.id,"1"==t.appType?2:6,e));case 2:r=n.sent,t.buttonList=r.map((function(e){return e.f_ItemId})),t.buttonChecked=t.$deepClone(t.buttonList);case 5:case"end":return n.stop()}}),n)})))()},handleButtonCheck:function(e,t){this.buttonChecked=t.checkedKeys.concat(t.halfCheckedKeys).filter((function(e){return"0"!=e}))},handleButtonCancel:function(){this.buttonChecked=this.$deepClone(this.buttonList),this.$refs.buttonTree.setCheckedKeys(this.buttonChecked)},handleButtonSave:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.moduleLoading=!0,n={ids:e.buttonChecked,itemType:"1"==e.appType?2:6,parentId:e.moduleId},t.next=4,e.$awaitWraper(c.save(e.id,n));case 4:r=t.sent,r&&(e.$message({type:"success",message:e.$t("保存成功!")}),e.buttonList=e.$deepClone(e.buttonChecked)),e.moduleLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},leaveButton:function(){var e=this;return new Promise((function(t){e.isSaveButton?e.$confirm(e.$t("离开前,是否保存设置数据?"),e.$t("提示"),{confirmButtonText:e.$t("确定"),cancelButtonText:e.$t("取消"),type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.handleButtonSave();case 2:e.buttonList=[],e.buttonChecked=[],e.buttons=[],e.moduleId="",t();case 7:case"end":return n.stop()}}),n)})))).catch((function(){e.buttonList=[],e.buttonChecked=[],e.buttons=[],e.moduleId="",t()})):(e.buttonList=[],e.buttonChecked=[],e.buttons=[],e.moduleId="",t())}))},handleColModuleClick:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.moduleId!=e.value){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.leaveColumn();case 4:if(t.moduleId=e.value,"expand"!=e.f_Target){n.next=11;break}t.columns=[],t.columnList=[],t.columnChecked=[],n.next=20;break;case 11:if(t.moduleLoading=!0,"1"!=t.appType){n.next=17;break}return n.next=15,t.fetchColumns(t.moduleId,e.f_FullName);case 15:n.next=19;break;case 17:return n.next=19,t.fetchAppColumns(t.moduleId,e.f_Name);case 19:t.moduleLoading=!1;case 20:case"end":return n.stop()}}),n)})))()},fetchColumns:function(e,t){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a={f_Id:"0",f_ParentId:"01",f_EnCode:"0",f_FullName:t},"7ae94059-9aa5-48eb-8330-4e2a6565b193"!=e){r.next=6;break}return n.columns=[],n.columnList=[],n.$refs.columnTree.setCheckedKeys(n.columnList),r.abrupt("return");case 6:return r.next=8,n.$awaitWraper(i.getColumns(e));case 8:return o=r.sent,o.forEach((function(e){return e.f_ParentId="0"})),o.length>0&&o.push(a),r.next=13,n.fetchAuthColumns(e);case 13:n.columns=o,n.$refs.columnTree.setCheckedKeys(n.columnList);case 15:case"end":return r.stop()}}),r)})))()},fetchAppColumns:function(e,t){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={f_Id:"0",f_ParentId:"01",f_Code:"0",f_Name:t},r.next=3,n.$awaitWraper(l.getChildren(e,2));case 3:return o=r.sent,o.forEach((function(e){return e.f_ParentId="0"})),o.length>0&&o.push(a),r.next=8,n.fetchAuthColumns(e);case 8:n.columns=o,n.$refs.columnTree.setCheckedKeys(n.columnList);case 10:case"end":return r.stop()}}),r)})))()},fetchAuthColumns:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$awaitWraper(c.getList(t.id,"1"==t.appType?3:7,e));case 2:r=n.sent,t.columnList=r.map((function(e){return e.f_ItemId})),t.columnChecked=t.$deepClone(t.columnList);case 5:case"end":return n.stop()}}),n)})))()},handleColumnCheck:function(e,t){this.columnChecked=t.checkedKeys.concat(t.halfCheckedKeys).filter((function(e){return"0"!=e}))},handleColumnCancel:function(){this.columnChecked=this.$deepClone(this.columnList),this.$refs.columnTree.setCheckedKeys(this.columnChecked)},handleColumnSave:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.moduleLoading=!0,n={ids:e.columnChecked,itemType:"1"==e.appType?3:7,parentId:e.moduleId},t.next=4,e.$awaitWraper(c.save(e.id,n));case 4:r=t.sent,r&&(e.$message({type:"success",message:e.$t("保存成功!")}),e.columnList=e.$deepClone(e.columnChecked)),e.moduleLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},leaveColumn:function(){var e=this;return new Promise((function(t){e.isSaveColumn?e.$confirm(e.$t("离开前,是否保存设置数据?"),e.$t("提示"),{confirmButtonText:e.$t("确定"),cancelButtonText:e.$t("取消"),type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.handleColumnSave();case 2:e.columnList=[],e.columnChecked=[],e.columns=[],e.moduleId="",t();case 7:case"end":return n.stop()}}),n)})))).catch((function(){e.columnList=[],e.columnChecked=[],e.columns=[],e.moduleId="",t()})):(e.columnList=[],e.columnChecked=[],e.columns=[],e.moduleId="",t())}))},handleFormModuleClick:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(t.moduleId!=e.value){n.next=2;break}return n.abrupt("return");case 2:return n.next=4,t.leaveForm();case 4:if(t.moduleId=e.value,"expand"!=e.f_Target){n.next=11;break}t.forms=[],t.formList=[],t.formChecked=[],n.next=20;break;case 11:if(t.moduleLoading=!0,"1"!=t.appType){n.next=17;break}return n.next=15,t.fetchForms(t.moduleId,e.f_FullName);case 15:n.next=19;break;case 17:return n.next=19,t.fetchAppForms(t.moduleId,e.f_Name);case 19:t.moduleLoading=!1;case 20:case"end":return n.stop()}}),n)})))()},fetchForms:function(e,t){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={f_Id:"0",f_ParentId:"01",f_EnCode:"0",f_FullName:t},r.next=3,n.$awaitWraper(i.getForms(e));case 3:return o=r.sent,o.forEach((function(e){return e.f_ParentId="0"})),o.length>0&&o.push(a),r.next=8,n.fetchAuthForms(e);case 8:n.forms=o,n.$refs.formTree.setCheckedKeys(n.formList);case 10:case"end":return r.stop()}}),r)})))()},fetchAppForms:function(e,t){var n=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var a,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a={f_Id:"0",f_ParentId:"01",f_Code:"0",f_Name:t},r.next=3,n.$awaitWraper(l.getChildren(e,3));case 3:return o=r.sent,o.forEach((function(e){return e.f_ParentId="0"})),o.length>0&&o.push(a),r.next=8,n.fetchAuthForms(e);case 8:n.forms=o,n.$refs.formTree.setCheckedKeys(n.formList);case 10:case"end":return r.stop()}}),r)})))()},fetchAuthForms:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function n(){var r;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$awaitWraper(c.getList(t.id,"1"==t.appType?4:8,e));case 2:r=n.sent,t.formList=r.map((function(e){return e.f_ItemId})),t.formChecked=t.$deepClone(t.formList);case 5:case"end":return n.stop()}}),n)})))()},handleFormCheck:function(e,t){this.formChecked=t.checkedKeys.concat(t.halfCheckedKeys).filter((function(e){return"0"!=e}))},handleFormCancel:function(){this.formChecked=this.$deepClone(this.formList),this.$refs.formTree.setCheckedKeys(this.formChecked)},handleFormSave:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.moduleLoading=!0,n={ids:e.formChecked,itemType:"1"==e.appType?4:8,parentId:e.moduleId},t.next=4,e.$awaitWraper(c.save(e.id,n));case 4:r=t.sent,r&&(e.$message({type:"success",message:e.$t("保存成功!")}),e.formList=e.$deepClone(e.formChecked)),e.moduleLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},leaveForm:function(){var e=this;return new Promise((function(t){e.isSaveForm?e.$confirm(e.$t("离开前,是否保存设置数据?"),e.$t("提示"),{confirmButtonText:e.$t("确定"),cancelButtonText:e.$t("取消"),type:"warning"}).then(Object(o["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,e.handleFormSave();case 2:e.formList=[],e.formChecked=[],e.forms=[],e.moduleId="",t();case 7:case"end":return n.stop()}}),n)})))).catch((function(){e.formList=[],e.formChecked=[],e.forms=[],e.moduleId="",t()})):(e.formList=[],e.formChecked=[],e.forms=[],e.moduleId="",t())}))},handleChangeType:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.handleTabLeave();case 2:e.tabsActiveName="tabModule",e.fetchModuleAuthData(e.id);case 4:case"end":return t.stop()}}),t)})))()}}},f=d,m=n("2877"),h=Object(m["a"])(f,r,a,!1,null,null,null);t["default"]=h.exports}}]);