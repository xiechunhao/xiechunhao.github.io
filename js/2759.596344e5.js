"use strict";(self["webpackChunkele_admin_template"]=self["webpackChunkele_admin_template"]||[]).push([[2759,3055],{33055:function(e,t,o){o.r(t),o.d(t,{default:function(){return u}});var s=function(){var e=this,t=e._self._c;return t("el-card",{attrs:{shadow:"never",header:"导出excel"}},[t("ele-pro-table",{attrs:{datasource:e.users,columns:e.columns,selection:e.select,"need-page":!1,"tools-theme":"none",size:"mini","tool-class":"ele-toolbar-actions",toolkit:["size","columns","fullscreen"]},on:{"update:selection":function(t){e.select=t}}},[t("template",{slot:"toolbar"},[t("el-button",{attrs:{size:"small"},on:{click:e.exportBas}},[e._v("导出excel")]),t("el-button",{attrs:{size:"small"},on:{click:e.exportAdv}},[e._v(" 导出带单元格合并 ")]),t("el-button",{attrs:{size:"small"},on:{click:e.exportSel}},[e._v("导出选中")])],1)],2)],1)},n=[],l=(o(43027),o(98729),o(13810),o(78003)),r={name:"ExcelExport",data(){return{columns:[{columnKey:"selection",type:"selection",width:45,align:"center"},{columnKey:"index",type:"index",width:45,align:"center"},{prop:"username",label:"用户名",align:"center",showOverflowTooltip:!0},{prop:"addressGroup",label:"地址",align:"center",showOverflowTooltip:!0,children:[{prop:"province",label:"省",align:"center",showOverflowTooltip:!0},{prop:"city",label:"市",align:"center",showOverflowTooltip:!0},{prop:"zone",label:"区",align:"center",showOverflowTooltip:!0},{prop:"street",label:"街道",align:"center",showOverflowTooltip:!0},{prop:"address",label:"详细地址",align:"center",showOverflowTooltip:!0}]},{prop:"amount",label:"金额",align:"center",showOverflowTooltip:!0}],users:[{key:1,username:"张小三",amount:18,province:"浙江",city:"杭州",zone:"西湖区",street:"西溪街道",address:"西溪花园30栋1单元"},{key:2,username:"李小四",amount:39,province:"江苏",city:"苏州",zone:"姑苏区",street:"丝绸路",address:"天墅之城9幢2单元"},{key:3,username:"王小五",amount:8,province:"江西",city:"南昌",zone:"青山湖区",street:"艾溪湖办事处",address:"中兴和园1幢3单元"},{key:4,username:"赵小六",amount:16,province:"福建",city:"泉州",zone:"丰泽区",street:"南洋街道",address:"南洋村6幢1单元"},{key:5,username:"孙小七",amount:12,province:"湖北",city:"武汉",zone:"武昌区",street:"武昌大道",address:"两湖花园16幢2单元"},{key:6,username:"周小八",amount:11,province:"安徽",city:"黄山",zone:"黄山区",street:"汤口镇",address:"温泉村21号"}],select:[]}},methods:{exportBas(){const e=[["用户名","省","市","区","街道","详细地址","金额"]];this.users.forEach((t=>{e.push([t.username,t.province,t.city,t.zone,t.street,t.address,t.amount])}));const t="Sheet1",o={SheetNames:[t],Sheets:{}};o.Sheets[t]=l.Wp.aoa_to_sheet(e),(0,l._h)(o,"用户数据.xlsx")},exportAdv(){const e=[["用户名","地址",null,null,null,null,"金额"],[null,"省","市","区","街道","详细地址",null]];this.users.forEach((t=>{e.push([t.username,t.province,t.city,t.zone,t.street,t.address,t.amount])}));const t=l.Wp.aoa_to_sheet(e);t["!merges"]=[{s:{r:0,c:1},e:{r:0,c:5}},{s:{r:0,c:0},e:{r:1,c:0}},{s:{r:0,c:6},e:{r:1,c:6}}];const o="Sheet1",s={SheetNames:[o],Sheets:{}};s.Sheets[o]=t,(0,l._h)(s,"用户数据.xlsx")},exportSel(){if(0===this.select.length)return void this.$message.error("请至少选择一条数据");const e=[["用户名","省","市","区","街道","详细地址","金额"]];this.select.forEach((t=>{e.push([t.username,t.province,t.city,t.zone,t.street,t.address,t.amount])}));const t="Sheet1",o={SheetNames:[t],Sheets:{}};o.Sheets[t]=l.Wp.aoa_to_sheet(e),(0,l._h)(o,"用户数据.xlsx")}}},a=r,c=o(64008),i=(0,c.A)(a,s,n,!1,null,null,null),u=i.exports},12759:function(e,t,o){o.r(t),o.d(t,{default:function(){return p}});var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"ele-body"},[t("excel-export"),t("excel-import")],1)},n=[],l=o(33055),r=o(25560),a={name:"ExtensionExcel",components:{ExcelExport:l["default"],ExcelImport:r["default"]}},c=a,i=o(64008),u=(0,i.A)(c,s,n,!1,null,null,null),p=u.exports}}]);