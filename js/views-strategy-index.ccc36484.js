(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["views-strategy-index"],{"8d44":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.lr_loadPage?e._e():a("l-layout",{staticClass:"l-tab-page"},[a("l-panel",{scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:e.$t("请输入关键字查询"),size:"mini"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.hanleSearch.apply(null,arguments)}},model:{value:e.searchWord,callback:function(t){e.searchWord=t},expression:"searchWord"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.hanleSearch},slot:"append"})],1)],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{on:{click:function(t){return e.handleAdd()}}},[a("l-excel-btns")],1)]},proxy:!0}],null,!1,831781051)},[a("l-table",{attrs:{loading:e.tableLoading,columns:e.columns,dataSource:e.tableData,"row-key":"f_Id",isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t}},scopedSlots:e._u([{key:"f_MessageType",fn:function(t){return[e._v(" "+e._s(e.formatterType(t.row.f_MessageType))+" ")]}}],null,!1,2998944047)},[a("l-table-btns",{attrs:{btns:e.tableBtns},on:{click:e.lr_handleTableBtnClick}})],1)],1),a("l-dialog",{attrs:{title:e.$t(e.formTitle),visible:e.formVisible},on:{"update:visible":function(t){e.formVisible=t},ok:e.handleSave,close:e.handleCloseForm,opened:e.handleOpenedForm}},[a("my-form",{ref:"form"})],1)],1)},o=[],n=(a("ac1f"),a("1276"),a("159b"),a("96cf"),a("1da1")),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-from-body"},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,size:"mini","label-width":"80px"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("名称"),prop:"f_StrategyName"}},[a("el-input",{model:{value:e.formData.f_StrategyName,callback:function(t){e.$set(e.formData,"f_StrategyName",t)},expression:"formData.f_StrategyName"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("编码"),prop:"f_StrategyCode"}},[a("el-input",{model:{value:e.formData.f_StrategyCode,callback:function(t){e.$set(e.formData,"f_StrategyCode",t)},expression:"formData.f_StrategyCode"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("类型"),prop:"f_MessageType"}},[a("l-checkbox",{attrs:{options:e.options},model:{value:e.formData.f_MessageType,callback:function(t){e.$set(e.formData,"f_MessageType",t)},expression:"formData.f_MessageType"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("说明"),prop:"f_Description"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.formData.f_Description,callback:function(t){e.$set(e.formData,"f_Description",t)},expression:"formData.f_Description"}})],1)],1)],1)],1)},l=[],i={data:function(){return{formData:{f_StrategyName:"",f_StrategyCode:"",f_MessageType:"",f_Description:""},rules:{f_StrategyName:[{required:!0,message:this.$t("请输入名称")}],f_StrategyCode:[{required:!0,message:this.$t("请输入编码")},{validator:this.lr_existDbFiled,tableName:"lr_ms_strategyinfo",keyName:"f_Id",trigger:"null"}]},options:[{value:"1",label:this.$t("邮件")},{value:"2",label:this.$t("微信")},{value:"3",label:this.$t("短信")},{value:"4",label:this.$t("站内消息")}],testLoading:!1}},computed:{},created:function(){},methods:{resetForm:function(){this.formData.f_Id="",this.$refs.form&&this.$refs.form.resetFields()},validateForm:function(){return this.$formValidateWraper(this.$refs.form)},setForm:function(e){this.formData=this.$deepClone(e)},getForm:function(){return this.$deepClone(this.formData)}}},f=i,c=a("2877"),u=Object(c["a"])(f,s,l,!1,null,null,null),m=u.exports,d=window.$api.message.strategy,p={components:{MyForm:m},data:function(){return{lr_isPage:!0,columns:[{label:"名称",prop:"f_StrategyName",minWidth:"140"},{label:"编码",prop:"f_StrategyCode",minWidth:"110"},{label:"类型",prop:"f_MessageType",width:"150"},{label:"备注",prop:"f_Description",minWidth:"300"}],tableBtns:[{prop:"Edit",label:this.$t("编辑"),width:40},{prop:"Delete",label:this.$t("删除"),width:40}],tableLoading:!1,searchWord:"",tableTotal:0,tablePageSize:50,tableCurrentPage:1,tableData:[],formVisible:!1,formTitle:"",formEditRow:null,formEdit:!1}},mounted:function(){this.loadTablePageData()},computed:{},methods:{loadTablePageData:function(e){var t=this;e||(this.tableCurrentPage=1),this.tableLoading=!0;var a={rows:this.tablePageSize,page:this.tableCurrentPage,sidx:"f_CreateDate DESC",keyword:this.searchWord};d.getPage(a).then((function(e){var a=t.$deepClone(e.data.data);t.tableData=a.rows,t.tableTotal=a.records,t.tableLoading=!1})).catch((function(){t.tableData=[],t.tableLoading=!1}))},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTablePageData(!0)},hanleSearch:function(){this.loadTablePageData()},formatterType:function(e){var t=this;e=(e||"")+"";var a=e.split(","),r=[];return a.forEach((function(e){switch(e){case"1":r.push(t.$t("邮件"));break;case"2":r.push(t.$t("微信"));break;case"3":r.push(t.$t("短信"));break;case"4":r.push(t.$t("系统IM"));break}})),String(r)},handleAdd:function(){this.formEdit=!1,this.showForm("新增")},handleEdit:function(e,t){this.formEdit=!0,this.formEditRow=t,this.showForm("编辑")},handleDelete:function(e,t){var a=this;this.$confirm(this.$t("此操作将永久删除该数据, 是否继续?"),this.$t("提示"),{confirmButtonText:this.$t("确定"),cancelButtonText:this.$t("取消"),type:"warning"}).then((function(){d.remove(t.f_Id).then((function(){a.$message({type:"success",message:a.$t("删除成功!")}),a.loadTablePageData()}))})).catch((function(){a.$message({type:"info",message:a.$t("已取消删除")})}))},handleSave:function(e,t){var a=this;return Object(n["a"])(regeneratorRuntime.mark((function r(){var o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e(),r.next=3,a.$refs.form.validateForm();case 3:if(r.sent){r.next=6;break}return t(),r.abrupt("return");case 6:o=a.$refs.form.getForm(),a.formEdit?d.update(o.f_Id,o).then((function(){t(),a.formVisible=!1,a.$message({type:"success",message:a.$t("更新成功!")}),a.loadTablePageData()})).catch((function(){t()})):d.add(o).then((function(){t(),a.formVisible=!1,a.$message({type:"success",message:a.$t("添加成功!")}),a.loadTablePageData()})).catch((function(){t()}));case 8:case"end":return r.stop()}}),r)})))()},handleOpenedForm:function(){this.formEdit&&this.$refs.form.setForm(this.formEditRow)},handleCloseForm:function(){this.$refs.form.resetForm()},showForm:function(e){this.formTitle=e,this.formVisible=!0}}},h=p,b=Object(c["a"])(h,r,o,!1,null,null,null);t["default"]=b.exports}}]);