(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["formalSupplier","formalSupplier-SupplyList","formalSupplier-eliminatForm","formalSupplier-lookForm","formalSupplier-supplyListForm","supplier-assessForm","supplier-form"],{"48cb":function(e,t,a){},"4a6c":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("l-layout",{directives:[{name:"show",rawName:"v-show",value:!e.lr_loadPage,expression:"!lr_loadPage"}],staticClass:"l-tab-page erpCase"},[a("l-panel",{directives:[{name:"show",rawName:"v-show",value:!e.pageFormVisible,expression:"!pageFormVisible"}],attrs:{title:e.$t("正式供应商")},scopedSlots:e._u([{key:"toolLeft",fn:function(){return[a("l-query2",{attrs:{items:e.queryItems,formData:e.queryData,loading:e.tableLoading},on:{search:e.handleSearch},scopedSlots:e._u([{key:"f_FormalState",fn:function(){return[a("l-select",{attrs:{options:e.case_erp_supplier_f_FormalStateOptions},model:{value:e.queryData.f_FormalState,callback:function(t){e.$set(e.queryData,"f_FormalState",t)},expression:"queryData.f_FormalState"}})]},proxy:!0},{key:"f_Type",fn:function(){return[a("l-select",{attrs:{options:e.case_erp_supplier_f_TypeStateOptions},model:{value:e.queryData.f_Type,callback:function(t){e.$set(e.queryData,"f_Type",t)},expression:"queryData.f_Type"}})]},proxy:!0}])})]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{hasTableSetting:!0,hasAdd:!1},on:{setting:e.lr_handleSettingTable}})]},proxy:!0}])},[a("l-table",{key:e.tableData.index,ref:"mainTable",attrs:{loading:e.tableLoading,columns:e.lr_getPageColumns(e.columns),dataSource:e.tableData,isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage},scopedSlots:e._u([{key:"f_TypeList",fn:function(t){return[a("div",{staticClass:"form_information form_wrap"},e._l(t.row.f_TypeList,(function(t,r){return a("div",{key:r},[a("el-tag",{staticClass:"margin_5",attrs:{size:"mini",type:e.tagType[t]}},[e._v(e._s(t))])],1)})),0)]}}])},[a("l-table-btns",{attrs:{btns:e.tableBtns,btnNum:6,filterBtns:e.filterBtns,isAuth:!1},on:{click:e.lr_handleTableBtnClick}})],1)],1),a("transition",{attrs:{name:"el-zoom-in-center"}},[e.pageFormVisible?a("l-panel",{scopedSlots:e._u([{key:"title",fn:function(){return[a("el-page-header",{attrs:{content:e.$t(e.pageFormname)},on:{back:function(){e.pageFormVisible=!1}}})]},proxy:!0}],null,!1,296798479)},[["详情查看"].includes(e.pageFormname)?a("look-form",{ref:"lookForm",attrs:{id:e.formEditRow.f_Id,type:"0"}}):["供应商年审"].includes(e.pageFormname)?a("wf-create-form",{ref:"wfcreate",attrs:{code:"erp-supplier-year",wraperType:"page",wfSubmitText:"提交保存",params:{id:e.supplierId}},on:{refresh:e.wfSubmit}}):a("supply-list",{attrs:{supplierId:e.supplierId}})],1):e._e()],1),a("l-dialog",{attrs:{title:e.$t(e.formTitle),visible:e.formVisible,height:426,width:487},on:{"update:visible":function(t){e.formVisible=t},ok:e.handleSave,close:e.handleCloseForm,opened:e.handleOpenedForm}},["供应商淘汰设置"!=e.formTitle?a("my-form",{ref:"form"}):a("eliminat-form",{ref:"form"})],1),a("wf-audit-form",{ref:"form",attrs:{type:"auditAndlook",params:{loadProcessId:e.loadProcessId},isLoadFormData:!0,title:"供应商年审",visible:e.wfvisible},on:{"update:visible":function(t){e.wfvisible=t},refresh:function(t){return e.wfSubmit()}}})],1)},s=[],i=(a("a434"),a("ac1f"),a("1276"),a("96cf"),a("1da1")),l=a("9580"),p=a("56ff"),n=a("a275"),o=a("fd05"),u=window.$api.erpcase.supplier,_={components:{MyForm:l["default"],SupplyList:n["default"],EliminatForm:o["default"],lookForm:p["default"]},data:function(){return{lr_isPage:!0,moduleCode:"ERP_FormalSuppliers",queryData:{f_FormalState:"",f_Type:""},tagType:{"成品":"danger","半成品":"success","其他":"info","原料":""},queryItems:[{label:"当前年审",prop:"f_FormalState"},{label:"供应商类型",prop:"f_Type"}],tableLoading:!1,tableData:[],tableTotal:0,tableCurrentPage:1,tablePageSize:50,columns:[{label:"供应商编号",prop:"f_Number",align:"left",dataType:"guid",width:160,isNotAutoWrap:!0},{label:"供应商名称",prop:"f_Name",align:"left",dataType:"input",minWidth:160,isNotAutoWrap:!0},{label:"供应商负责人",prop:"f_Person",align:"left",width:100},{label:"手机号",prop:"f_Phone",align:"left",width:120},{label:"经营范围",prop:"f_Scope",align:"left",width:120},{label:"当前年审",prop:"f_FormalState",align:"left",dataType:"mydata",options:[{value:0,label:"未年审"},{value:1,label:"审批中"},{label:"不通过",value:2},{label:"通过",value:3},{label:"无需年审",value:4}]},{label:"供应商类型",prop:"f_TypeList",align:"left",dataType:"dataItem",dataCode:"供应商类型",width:220}],tableBtns:[{prop:"Edit",label:"编辑",width:120},{prop:"Details",label:"详情查看"},{prop:"Review",label:"企业年审"},{prop:"SupplyList",label:"供货清单"},{prop:"Eliminate",label:"淘汰"},{prop:"Delete",label:"删除"}],formVisible:!1,formTitle:"",formEditRow:null,formEdit:!1,pageFormname:"",pageFormVisible:!1,wfvisible:!1}},computed:{case_erp_supplier_f_FormalStateOptions:function(){return[{label:"全部",value:""},{label:"未年审",value:"0"},{label:"审批中",value:"1"},{label:"不通过",value:"2"},{label:"通过",value:"3"},{label:"无需年审",value:"4"}]},case_erp_supplier_f_TypeStateOptions:function(){return[{label:"全部",value:""},{value:"原料",label:"原料"},{value:"半成品",label:"半成品"},{label:"成品",value:"成品"},{label:"其他",value:"其他"}]},supplierId:function(){return this.formEditRow?this.formEditRow.f_Id:""}},mounted:function(){this.init()},methods:{init:function(){this.loadTableData()},wfSubmit:function(){this.pageFormVisible=!1,this.loadTableData()},loadProcessId:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$awaitWraper(u.getYearBySupplierId(e.supplierId));case 2:if(a=t.sent,!a){t.next=5;break}return t.abrupt("return",a.f_Id);case 5:return t.abrupt("return","");case 6:case"end":return t.stop()}}),t)})))()},filterBtns:function(e,t){return 2!=e.f_FormalState&&3!=e.f_FormalState||(t[2].label="年审查看"),4==e.f_FormalState&&(t[2].disabled=!0),t},handleSupplyList:function(e,t){this.formEditRow=t,this.pageFormname="供货清单（".concat(t.f_Name,"）"),this.pageFormVisible=!0},handleReview:function(e,t){this.formEditRow=t,0==t.f_FormalState?(this.pageFormname="供应商年审",this.pageFormVisible=!0):this.wfvisible=!0},handleSearch:function(){this.loadTableData()},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTableData(!0)},loadTableData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(t.tableCurrentPage=1),t.tableLoading=!0,r=t.$deepClone(t.queryData),r.rows=t.tablePageSize,r.page=t.tableCurrentPage,r.sidx="F_Id",r.f_State=1,a.next=9,t.$awaitWraper(u.getPage(r));case 9:if(s=a.sent,null!=s){for(i in t.tableData=s.rows,t.tableData)t.tableData[i].f_TypeList=t.tableData[i].f_Type.split(",");t.tableTotal=s.records}else t.tableData=[];t.tableLoading=!1;case 12:case"end":return a.stop()}}),a)})))()},handleEdit:function(e,t){this.formEdit=!0,this.formEditRow=t,this.handleShowForm("编辑")},handleDetails:function(e,t){this.pageFormname="详情查看",this.formEditRow=t,this.pageFormVisible=!0},handleEliminate:function(e,t){this.formEdit=!0,this.formEditRow=t,this.handleShowForm("供应商淘汰设置")},handleDelete:function(e,t){var a=this;this.$confirm(this.$t("此操作将永久删除该数据, 是否继续?"),this.$t("提示"),{confirmButtonText:this.$t("确定"),cancelButtonText:this.$t("取消"),type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.tableData.splice(e,1),a.tableTotal--,r.next=4,u.remove(t.f_Id);case 4:a.$message({type:"success",message:a.$t("删除成功!")});case 5:case"end":return r.stop()}}),r)})))).catch((function(){a.$message({type:"info",message:a.$t("已取消删除!")})}))},handleSave:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e("保存数据中..."),r.next=3,a.$refs.form.validateForm();case 3:if(!r.sent){r.next=8;break}return r.next=6,a.$refs.form.saveForm({keyValue:a.formEdit?a.formEditRow.f_Id:"",isEdit:a.formEdit});case 6:s=r.sent,s&&(i=a.formEdit?"更新成功!":"新增成功!",a.$message({type:"success",message:a.$t(i)}),a.loadTableData(),a.formVisible=!1);case 8:t();case 9:case"end":return r.stop()}}),r)})))()},handleShowForm:function(e){this.formTitle=e,this.formVisible=!0},handleOpenedForm:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!a.formEdit){r.next=5;break}return e("加载数据中..."),r.next=4,a.$refs.form.loadFormData({keyValue:a.formEditRow.f_Id});case 4:t();case 5:case"end":return r.stop()}}),r)})))()},handleCloseForm:function(){this.$refs.form.resetForm()}}},c=_,f=(a("71e56"),a("2877")),m=Object(f["a"])(c,r,s,!1,null,null,null);t["default"]=m.exports},"508e":function(e,t,a){"use strict";a("48cb")},"56ff":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"8px"}},[a("el-row",{attrs:{gutter:0}},[a("div",{staticClass:"l-rblock"},[a("div",{staticClass:"border pd-16"},[a("div",{staticClass:"ptitle"},[e._v(" "+e._s(e.$t("供应商评估报告"))+" ")]),a("div",{staticClass:"mt-16"},[a("div",[a("div",{staticClass:"learun-form-title"},[e._v(e._s(e.$t("基本信息")))]),a("div",{staticClass:"form_block flex flex-center flex-c-between"},[a("div",[e._v(" "+e._s(e.$t("供应商编号："+e.supplierInfo.f_Number))+" ")]),a("div",[e._v(" "+e._s(e.$t("供应商名称："+e.supplierInfo.f_Name))+" ")]),a("div",[e._v(" "+e._s(e.$t("供应商负责人："+e.supplierInfo.f_Person))+" ")]),a("div",[e._v(" "+e._s(e.$t("供应商类型："+e.supplierInfo.f_Type))+" ")]),a("div",[e._v(" "+e._s(e.$t("添加人："+e.supplierInfo.f_CreateUserName))+" ")]),a("div",[e._v(" "+e._s(e.$t("创建日期："+e.supplierInfo.f_CreateDate))+" ")]),a("div",[e._v(" "+e._s(e.$t("经营范围："+e.supplierInfo.f_Scope))+" ")]),a("div",[e._v(" "+e._s(e.$t("手机号："+e.supplierInfo.f_Phone))+" ")])]),e.supplier_form?a("assess-form",{attrs:{isReadOnly:!0,id:e.id,type:"0"}}):e._e(),a("div",{staticClass:"flex flex-c-center mt-16"},[a("el-button",{attrs:{plain:"",icon:e.supplier_form?"el-icon-arrow-up":"el-icon-arrow-down"},on:{click:e.showLookForm}},[e._v(e._s(e.$t(e.supplier_form?"收起报告":"展开报告")))])],1)],1)])]),a("div",{staticClass:"border pd-16 mt-8"},[a("div",{staticClass:"ptitle"},[e._v(" "+e._s(e.$t("供应商转正资料"))+" ")]),a("div",{staticClass:"learun-form-title mt-16"},[e._v(" "+e._s(e.$t("转正说明"))+" ")]),a("div",{staticClass:"form_block"},[e._v(" "+e._s(e.formData.f_Description)+" ")]),a("div",{staticClass:"learun-form-title mt-16"},[e._v(" "+e._s(e.$t("附件上传"))+" ")]),a("div",{staticClass:"form_block"},[a("l-upload",{attrs:{drag:"",maxSize:"10",sizeType:"MB",limit:3,showFileList:"uploadTheme1",disabled:""},model:{value:e.formData.f_File,callback:function(t){e.$set(e.formData,"f_File",t)},expression:"formData.f_File"}})],1),a("div",{staticClass:"learun-form-title mt-16 mb-16"},[e._v(" "+e._s(e.$t("流程审批"))+" ")]),e.loading?e._e():a("l-wf-audit-timeline",{attrs:{isLoadData:"",processId:e.formData.f_Id}})],1),a("div",{staticClass:"border pd-16 mt-8"},[a("div",{staticClass:"ptitle"},[e._v(" "+e._s(e.$t("供应商时间轴"))+" ")]),a("div",{staticClass:"erp-supplier-timeline"},[a("el-timeline",e._l(e.timeList,(function(t){return a("el-timeline-item",{key:t.f_Id,attrs:{type:"primary",timestamp:e.lr_dateFormat(t.f_CreateDate)}},[a("div",{staticClass:"title"},[e._v(" "+e._s(t.f_Title)+" ")]),a("div",{staticClass:"user"},[e._v(" "+e._s(t.f_ContentUser)+" ")]),t.f_ContentReason.indexOf("delete")>-1?[a("div",{staticClass:"user"},[e._v(" "+e._s(e.$t("淘汰原因"))+"："+e._s(e.outMap[t.f_ContentReason.replace("delete","")])+" ")]),a("div",{staticClass:"user"},[e._v(" "+e._s(e.$t("淘汰说明"))+"："+e._s(t.f_ContentExplain)+" ")])]:t.f_ContentReason.indexOf("recover")>-1?[a("div",{staticClass:"user"},[e._v(" "+e._s(e.$t("恢复说明"))+"："+e._s(t.f_ContentExplain)+" ")]),""!=t.f_ContentReason.replace("recover","")?a("l-upload",{staticClass:"mt-8",attrs:{drag:"",maxSize:"10",sizeType:"MB",limit:3,showFileList:"uploadTheme1",disabled:"",value:t.f_ContentReason.replace("recover","")}}):e._e()]:e._e(),"yearAssess"==t.f_ContentExplain?a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.lookYear(t.f_ContentReason)}}},[e._v(" "+e._s(e.$t("查看年审报告"))+" ")]):e._e()],2)})),1)],1)])])]),a("wf-audit-form",{ref:"form",attrs:{type:"auditAndlook",params:{processId:e.yearId},isLoadFormData:!0,title:"供应商年审报告",visible:e.wfvisible},on:{"update:visible":function(t){e.wfvisible=t}}})],1)},s=[],i=(a("96cf"),a("1da1")),l=a("6a12"),p=window.$api.erpcase.supplier,n={props:{id:String},components:{AssessForm:l["default"]},data:function(){return{supplierInfo:{f_Number:"",f_Name:"",f_Person:"",f_Phone:"",f_Scope:"",f_CreateDate:"",f_CreateUserName:"",f_Type:""},supplier_form:!1,formData:{f_Description:"",f_File:""},loading:!0,timeList:[],yearId:"",wfvisible:!1,outMap:{1:"年审不合格",2:"其他"}}},computed:{},mounted:function(){this.init()},methods:{init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.loadSupplierInfo(e.id);case 2:case"end":return t.stop()}}),t)})))()},loadSupplierInfo:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,a.next=3,t.$awaitWraper(p.get(e));case 3:return r=a.sent,r&&(r.f_CreateDate=t.$formatDate(r.f_CreateDate,"yyyy-MM-dd"),t.supplierInfo=r),a.next=7,t.$awaitWraper(p.getFormalBySupplier(e));case 7:return t.formData=a.sent,a.next=10,t.$awaitWraper(p.getTimeList(e));case 10:t.timeList=a.sent,t.loading=!1,console.log(t.timeList,"timeList");case 13:case"end":return a.stop()}}),a)})))()},lookYear:function(e){this.yearId=e,this.wfvisible=!0},resetForm:function(){this.$formClear(this.$refs.form)},showLookForm:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.supplier_form=!e.supplier_form;case 1:case"end":return t.stop()}}),t)})))()}}},o=n,u=(a("508e"),a("2877")),_=Object(u["a"])(o,r,s,!1,null,"327faae2",null);t["default"]=_.exports},"628f":function(e,t,a){"use strict";a("e9f3")},"6a12":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"form",staticClass:"learun-el-form-left",attrs:{model:e.formData,rules:e.isReadOnly?{}:e.rules,size:"mini",labelPosition:"left",labelWidth:"100px"}},[e.loading?e._e():a("el-row",{staticClass:"erp-supplier-assess"},[a("el-col",{attrs:{span:24}},[a("div",{staticClass:"learun-form-title mt-16"},[e._v(" "+e._s(e.$t("供货能力评估"))+" ")]),a("div",{staticClass:"form_block"},[e.isReadOnly?a("el-form-item",{attrs:{label:e.$t("等级："),prop:"case_erp_supplierrisk_f_CapacityLevel"}},["0"==e.formData.case_erp_supplierrisk_f_CapacityLevel?a("el-tag",[e._v(e._s(e.$t("优秀")))]):"1"==e.formData.case_erp_supplierrisk_f_CapacityLevel?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(e.$t("良好")))]):"2"==e.formData.case_erp_supplierrisk_f_CapacityLevel?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(e.$t("及格")))]):a("el-tag",{attrs:{type:"danger"}},[e._v(e._s(e.$t("不及格")))])],1):a("el-form-item",{attrs:{label:e.$t("等级选择："),prop:"case_erp_supplierrisk_f_CapacityLevel"}},[a("l-radio",{attrs:{options:e.case_erp_supplierrisk_f_CapacityLevelOptions},model:{value:e.formData.case_erp_supplierrisk_f_CapacityLevel,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_CapacityLevel",t)},expression:"formData.case_erp_supplierrisk_f_CapacityLevel"}})],1),a("el-form-item",{attrs:{label:e.$t("评估理由："),prop:"case_erp_supplierrisk_f_CapacityReason"}},[e.isReadOnly?a("div",[e._v(" "+e._s(e.formData.case_erp_supplierrisk_f_CapacityReason)+" ")]):a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",showWordLimit:!1,placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplierrisk_f_CapacityReason,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_CapacityReason",t)},expression:"formData.case_erp_supplierrisk_f_CapacityReason"}})],1),a("el-form-item",{attrs:{label:e.$t("附件上传："),prop:"case_erp_supplierrisk_f_CapacityFile"}},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"case_erp_supplierrisk_f_CapacityFile",labelWidth:"0"}},[a("l-upload",{attrs:{drag:"",maxSize:"10",sizeType:"MB",limit:3,showFileList:"uploadTheme1",disabled:e.isReadOnly},model:{value:e.formData.case_erp_supplierrisk_f_CapacityFile,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_CapacityFile",t)},expression:"formData.case_erp_supplierrisk_f_CapacityFile"}})],1)],1)],1)],1)]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"learun-form-title mt-16"},[e._v(" "+e._s(e.$t("供货质量评估"))+" ")]),a("div",{staticClass:"form_block"},[e.isReadOnly?a("el-form-item",{attrs:{label:e.$t("等级："),prop:"case_erp_supplierrisk_f_SupplierLevel"}},["0"==e.formData.case_erp_supplierrisk_f_SupplierLevel?a("el-tag",[e._v(e._s(e.$t("优秀")))]):"1"==e.formData.case_erp_supplierrisk_f_SupplierLevel?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(e.$t("良好")))]):"2"==e.formData.case_erp_supplierrisk_f_SupplierLevel?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(e.$t("及格")))]):a("el-tag",{attrs:{type:"danger"}},[e._v(e._s(e.$t("不及格")))])],1):a("el-form-item",{attrs:{label:e.$t("等级选择："),prop:"case_erp_supplierrisk_f_SupplierLevel"}},[a("l-radio",{attrs:{options:e.case_erp_supplierrisk_f_SupplierLevelOptions},model:{value:e.formData.case_erp_supplierrisk_f_SupplierLevel,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_SupplierLevel",t)},expression:"formData.case_erp_supplierrisk_f_SupplierLevel"}})],1),a("el-form-item",{attrs:{label:e.$t("评估理由："),prop:"case_erp_supplierrisk_f_SupplierReason"}},[e.isReadOnly?a("div",[e._v(" "+e._s(e.formData.case_erp_supplierrisk_f_SupplierReason)+" ")]):a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplierrisk_f_SupplierReason,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_SupplierReason",t)},expression:"formData.case_erp_supplierrisk_f_SupplierReason"}})],1),a("el-form-item",{attrs:{label:e.$t("附件上传："),prop:"case_erp_supplierrisk_f_SupplierFile"}},[a("l-upload",{attrs:{drag:"",maxSize:"10",sizeType:"MB",limit:3,showFileList:"uploadTheme1",disabled:e.isReadOnly,placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplierrisk_f_SupplierFile,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_SupplierFile",t)},expression:"formData.case_erp_supplierrisk_f_SupplierFile"}})],1)],1)]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"learun-form-title mt-16"},[e._v(" "+e._s(e.$t("环境与安全评估"))+" ")]),a("div",{staticClass:"form_block"},[e.isReadOnly?a("el-form-item",{attrs:{label:e.$t("等级："),prop:"case_erp_supplierrisk_f_SafetyLevel"}},["0"==e.formData.case_erp_supplierrisk_f_SafetyLevel?a("el-tag",[e._v(e._s(e.$t("优秀")))]):"1"==e.formData.case_erp_supplierrisk_f_SafetyLevel?a("el-tag",{attrs:{type:"success"}},[e._v(e._s(e.$t("良好")))]):"2"==e.formData.case_erp_supplierrisk_f_SafetyLevel?a("el-tag",{attrs:{type:"info"}},[e._v(e._s(e.$t("及格")))]):a("el-tag",{attrs:{type:"danger"}},[e._v(e._s(e.$t("不及格")))])],1):a("el-form-item",{attrs:{label:e.$t("等级选择："),prop:"case_erp_supplierrisk_f_SafetyLevel"}},[a("l-radio",{attrs:{options:e.case_erp_supplierrisk_f_SafetyLevelOptions},model:{value:e.formData.case_erp_supplierrisk_f_SafetyLevel,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_SafetyLevel",t)},expression:"formData.case_erp_supplierrisk_f_SafetyLevel"}})],1),a("el-form-item",{attrs:{label:e.$t("评估理由："),prop:"case_erp_supplierrisk_f_SafetyReason"}},[e.isReadOnly?a("div",[e._v(" "+e._s(e.formData.case_erp_supplierrisk_f_SafetyReason)+" ")]):a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplierrisk_f_SafetyReason,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_SafetyReason",t)},expression:"formData.case_erp_supplierrisk_f_SafetyReason"}})],1),a("el-form-item",{attrs:{label:e.$t("附件上传："),prop:"case_erp_supplierrisk_f_SafetyFile"}},[a("l-upload",{attrs:{drag:"",maxSize:"10",sizeType:"MB",limit:3,showFileList:"uploadTheme1",disabled:e.isReadOnly,placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplierrisk_f_SafetyFile,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_SafetyFile",t)},expression:"formData.case_erp_supplierrisk_f_SafetyFile"}})],1)],1)]),a("el-col",{attrs:{span:24}},[a("div",{staticClass:"learun-form-title mt-16"},[e._v(" "+e._s(e.$t("最终评估结果"))+" ")]),a("div",{staticClass:"form_block"},[e.isReadOnly?a("el-form-item",{attrs:{label:e.$t("等级："),prop:"case_erp_supplierrisk_f_FinalState"}},["0"==e.formData.case_erp_supplierrisk_f_FinalState?a("el-tag",[a("i",{staticClass:"el-icon-s-check margin_right_3"}),e._v(e._s(e.$t("优秀"))+" ")]):"1"==e.formData.case_erp_supplierrisk_f_FinalState?a("el-tag",{attrs:{type:"success"}},[a("i",{staticClass:"el-icon-s-check margin_right_3"}),e._v(" "+e._s(e.$t("良好"))+" ")]):"2"==e.formData.case_erp_supplierrisk_f_FinalState?a("el-tag",{attrs:{type:"info"}},[a("i",{staticClass:"el-icon-s-check margin_right_3"}),e._v(" "+e._s(e.$t("及格"))+" ")]):a("el-tag",{attrs:{type:"danger"}},[a("i",{staticClass:"el-icon-s-check margin_right_3"}),e._v(" "+e._s(e.$t("不及格"))+" ")])],1):a("el-form-item",{attrs:{label:e.$t("等级选择："),prop:"case_erp_supplierrisk_f_FinalState"}},[a("l-radio",{attrs:{options:e.case_erp_supplierrisk_f_FinalStateOptions},model:{value:e.formData.case_erp_supplierrisk_f_FinalState,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_FinalState",t)},expression:"formData.case_erp_supplierrisk_f_FinalState"}})],1),a("el-form-item",{attrs:{label:e.$t("评估理由："),prop:"case_erp_supplierrisk_f_FinalReason"}},[e.isReadOnly?a("div",[e._v(" "+e._s(e.formData.case_erp_supplierrisk_f_FinalReason)+" ")]):a("el-input",{staticStyle:{width:"500px"},attrs:{type:"textarea",placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplierrisk_f_FinalReason,callback:function(t){e.$set(e.formData,"case_erp_supplierrisk_f_FinalReason",t)},expression:"formData.case_erp_supplierrisk_f_FinalReason"}})],1)],1)])],1)],1)},s=[],i=(a("96cf"),a("1da1")),l=window.$api.erpcase.supplier,p={props:{isReadOnly:{type:Boolean,default:!1},id:{},type:{}},data:function(){return{moduleCode:"ERP_Suppliers",formData:{case_erp_supplierrisk_f_CapacityLevel:"",case_erp_supplierrisk_f_CapacityReason:"",case_erp_supplierrisk_f_CapacityFile:"",case_erp_supplierrisk_f_SupplierLevel:"",case_erp_supplierrisk_f_SupplierReason:"",case_erp_supplierrisk_f_SupplierFile:"",case_erp_supplierrisk_f_SafetyLevel:"",case_erp_supplierrisk_f_SafetyReason:"",case_erp_supplierrisk_f_SafetyFile:"",case_erp_supplierrisk_f_FinalState:"",case_erp_supplierrisk_f_FinalReason:""},rules:{case_erp_supplierrisk_f_CapacityLevel:[{required:!0,message:"请选择："}],case_erp_supplierrisk_f_CapacityReason:[{required:!0,message:"请输入："}],case_erp_supplierrisk_f_SupplierLevel:[{required:!0,message:"请选择："}],case_erp_supplierrisk_f_SupplierReason:[{required:!0,message:"请输入："}],case_erp_supplierrisk_f_SafetyLevel:[{required:!0,message:"请选择："}],case_erp_supplierrisk_f_SafetyReason:[{required:!0,message:"请输入："}],case_erp_supplierrisk_f_FinalState:[{required:!0,message:"请选择："}],case_erp_supplierrisk_f_FinalReason:[{required:!0,message:"请输入："}]},loading:!0}},computed:{case_erp_supplierrisk_f_CapacityLevelOptions:function(){return[{label:"优秀",value:"0"},{value:"1",label:"良好"},{value:"2",label:"及格"},{value:"3",label:"不及格"}]},case_erp_supplierrisk_f_SupplierLevelOptions:function(){return[{label:"优秀",value:"0"},{value:"1",label:"良好"},{value:"2",label:"及格"},{value:"3",label:"不及格"}]},case_erp_supplierrisk_f_SafetyLevelOptions:function(){return[{label:"优秀",value:"0"},{value:"1",label:"良好"},{value:"2",label:"及格"},{value:"3",label:"不及格"}]},case_erp_supplierrisk_f_FinalStateOptions:function(){return[{label:"优秀",value:"0"},{value:"1",label:"良好"},{value:"2",label:"及格"},{value:"3",label:"不及格"}]}},created:function(){this.isReadOnly?this.loadFormData(this.id):this.loading=!1},methods:{resetForm:function(){this.$formClear(this.$refs.form)},validateForm:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$formValidateWraper(e.$refs.form);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",!1);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))()},setForm:function(e){this.$setFormData(this.formData,e,"case_erp_supplierrisk")},getForm:function(){var e=this.$getFormData(this.formData,"case_erp_supplierrisk");return e.f_Type=this.type,e.f_SupplierId=this.id,e},loadFormData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t.loading=!0,a.next=3,t.$awaitWraper(l.getAssess(e,t.type));case 3:r=a.sent,r&&(t.setForm(r),t.loading=!1);case 5:case"end":return a.stop()}}),a)})))()}}},n=p,o=(a("628f"),a("2877")),u=Object(o["a"])(n,r,s,!1,null,"1c144dd3",null);t["default"]=u.exports},"71e56":function(e,t,a){"use strict";a("8d3b")},"8d3b":function(e,t,a){},9580:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-rblock l-form-viewer learun-el-form-left",staticStyle:{padding:"8px"}},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,size:"mini",labelPosition:"left",labelWidth:"100px"}},[a("div",{staticClass:"l-auto-window only-tabs"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("主表信息"),name:"tab0"}},[a("el-row",{attrs:{gutter:16}},[a("div",{staticClass:"l-rblock"},[a("el-col",{attrs:{span:18}},[a("el-form-item",{attrs:{label:e.$t("供应商编号"),prop:"case_erp_supplier_f_Number"}},["0"==e.formData.case_erp_supplier_f_IsSysNum?a("l-code",{attrs:{code:"erp_supplier_num",size:"mini"},model:{value:e.formData.case_erp_supplier_f_Number,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_Number",t)},expression:"formData.case_erp_supplier_f_Number"}}):a("el-input",{attrs:{size:"mini",maxlength:"15",disabled:e.isEdit,placeholder:e.$t("请输入16位数字编码")},model:{value:e.formData.case_erp_supplier_f_Number,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_Number",t)},expression:"formData.case_erp_supplier_f_Number"}})],1)],1),a("el-col",{attrs:{span:6}},[a("el-form-item",{attrs:{prop:"case_erp_supplier_f_IsSysNum",labelWidth:"10px"}},[a("l-checkbox",{attrs:{options:e.case_erp_supplier_f_IsSysNumOptions,disabled:e.isEdit},on:{change:e.checkChange},model:{value:e.formData.case_erp_supplier_f_IsSysNum,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_IsSysNum",t)},expression:"formData.case_erp_supplier_f_IsSysNum"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("供应商名称"),prop:"case_erp_supplier_f_Name"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplier_f_Name,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_Name",t)},expression:"formData.case_erp_supplier_f_Name"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("负责人"),prop:"case_erp_supplier_f_Person"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplier_f_Person,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_Person",t)},expression:"formData.case_erp_supplier_f_Person"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("手机号"),prop:"case_erp_supplier_f_Phone"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplier_f_Phone,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_Phone",t)},expression:"formData.case_erp_supplier_f_Phone"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("经营范围"),prop:"case_erp_supplier_f_Scope"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplier_f_Scope,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_Scope",t)},expression:"formData.case_erp_supplier_f_Scope"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("供应商类型"),prop:"case_erp_supplier_f_Type"}},[a("l-select",{attrs:{multiple:!0,options:e.case_erp_supplier_f_TypeOptions},model:{value:e.formData.case_erp_supplier_f_Type,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_Type",t)},expression:"formData.case_erp_supplier_f_Type"}})],1)],1)],1)])],1)],1)],1)])],1)},s=[],i=(a("96cf"),a("1da1")),l=window.$api.erpcase.supplier,p={data:function(){var e=this;return{moduleCode:"ERP_Suppliers",activeName:"tab0",formData:{case_erp_supplier_f_State:0,case_erp_supplier_f_Number:"",case_erp_supplier_f_IsSysNum:"0",case_erp_supplier_f_Name:"",case_erp_supplier_f_Person:"",case_erp_supplier_f_Phone:"",case_erp_supplier_f_Scope:"",case_erp_supplier_f_Type:""},rules:{case_erp_supplier_f_Number:[{required:!0,message:"请输入供应商编号"}],case_erp_supplier_f_Name:[{required:!0,message:"请输入供应商名称"},{validator:this.lr_existDbFiled,fieldName:"f_Name",keyValue:function(){return e.formData.case_erp_supplier_f_Id},tableName:"case_erp_supplier",keyName:"f_Id"}],case_erp_supplier_f_Phone:[{pattern:/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d{8}$/,message:"请输入电话/手机号"}],case_erp_supplier_f_Scope:[{required:!0,message:"请输入经营范围"}],case_erp_supplier_f_Type:[{required:!0,message:"请选择供应商类型"}]},isEdit:!1}},computed:{case_erp_supplier_f_IsSysNumOptions:function(){return[{value:"0",label:"用系统编码"}]},case_erp_supplier_f_TypeOptions:function(){return[{value:"其他",label:"其他"},{value:"半成品",label:"半成品"},{label:"成品",value:"成品"},{label:"原料",value:"原料"}]}},methods:{checkChange:function(){var e=this;this.formData.case_erp_supplier_f_Number="",0!=parseInt(this.formData.case_erp_supplier_f_IsSysNum)&&this.rules.case_erp_supplier_f_Number.push({validator:this.lr_existDbFiled,fieldName:"f_Number",keyValue:function(){return e.formData.case_erp_supplier_f_Id},tableName:"case_erp_supplier",keyName:"f_Id"})},resetForm:function(){this.$formClear(this.$refs.form),this.activeName="tab0",this.isEdit=!1},validateForm:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$formValidateWraper(e.$refs.form);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",!1);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))()},setForm:function(e){this.$setFormData(this.formData,e,"case_erp_supplier"),this.isEdit=!0},getForm:function(){return this.$getFormData(this.formData,"case_erp_supplier")},loadFormData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.keyValue,a.next=3,t.$awaitWraper(l.get(r));case 3:if(s=a.sent,!s){a.next=9;break}return t.setForm(s),a.abrupt("return",!0);case 9:return a.abrupt("return",!1);case 10:case"end":return a.stop()}}),a)})))()},saveForm:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=e.keyValue,s=e.isEdit,i=t.getForm(),!s){a.next=8;break}return a.next=5,t.$awaitWraper(l.update(r,i));case 5:return a.abrupt("return",a.sent);case 8:return i.f_Id=r,a.next=11,t.$awaitWraper(l.add(i));case 11:return a.abrupt("return",a.sent);case 12:case"end":return a.stop()}}),a)})))()}}},n=p,o=a("2877"),u=Object(o["a"])(n,r,s,!1,null,null,null);t["default"]=u.exports},a275:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("l-layout",{staticClass:"l-tab-page"},[a("l-panel",{scopedSlots:e._u([{key:"toolLeft",fn:function(){return[e.queryOpen?a("l-query2",{attrs:{items:e.queryItems,formData:e.queryData,loading:e.tableLoading},on:{search:e.handleSearch},scopedSlots:e._u([{key:"f_CreateDate",fn:function(){return[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:e.queryData.f_CreateDate,callback:function(t){e.$set(e.queryData,"f_CreateDate",t)},expression:"queryData.f_CreateDate"}})]},proxy:!0},{key:"f_State",fn:function(){return[a("l-select",{attrs:{options:e.erp_case_f_StateOptions},model:{value:e.queryData.f_State,callback:function(t){e.$set(e.queryData,"f_State",t)},expression:"queryData.f_State"}})]},proxy:!0},{key:"f_Name",fn:function(){return[a("el-input",{attrs:{placeholder:"请输入关键字"},model:{value:e.queryData.f_Name,callback:function(t){e.$set(e.queryData,"f_Name",t)},expression:"queryData.f_Name"}})]},proxy:!0}],null,!1,3794150642)}):e._e()]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{isAuth:!1,hasRefresh:!1},on:{setting:e.lr_handleSettingTable,click:function(t){return e.handleAdd()}}})]},proxy:!0}])},[a("l-table",{key:e.tableData.index,ref:"mainTable",attrs:{loading:e.tableLoading,columns:e.columns,dataSource:e.tableData,isPage:!0,pageTotal:e.tableTotal,tablePage:e.tableCurrentPage},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage}},[a("l-table-btns",{attrs:{isAuth:!1,btns:e.tableBtns},on:{click:e.lr_handleTableBtnClick}})],1)],1),a("l-dialog",{attrs:{title:e.$t(e.formTitle),visible:e.formVisible,height:465,width:487},on:{"update:visible":function(t){e.formVisible=t},ok:e.handleSave,close:e.handleCloseForm,opened:e.handleOpenedForm}},[a("supply-list-form",{ref:"form",attrs:{supplierId:e.supplierId,isReadOnly:e.formDetails}})],1),a("l-dialog",{attrs:{title:e.$t(e.formTitle),visible:e.priceVisible,height:465,width:487,hasBtns:!1},on:{"update:visible":function(t){e.priceVisible=t},close:e.priceCloseForm,opened:e.priceOpenedForm}},[e.priceLoaded?a("l-echarts",{ref:"echart",attrs:{option:e.priceOptions}}):e._e()],1)],1)},s=[],i=(a("a434"),a("96cf"),a("1da1")),l=a("fe5f"),p=window.$api.erpcase.supplier,n={components:{SupplyListForm:l["default"]},props:{isReadOnly:{type:Boolean,default:!1},supplierId:String},data:function(){return{moduleCode:"handle_supplyList",queryOpen:!1,priceVisible:!1,priceLoaded:!1,priceOptions:{tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:!1},grid:{top:"10%",bottom:"10%"},xAxis:{type:"category",data:[]},yAxis:{type:"value"},series:[{barMaxWidth:20,barMinWidth:5,name:"历史记录",type:"bar",emphasis:{focus:"series"},data:[],itemStyle:{color:"#5E95FF"}}]},queryData:{f_CreateDate:"",f_State:"",f_Name:""},queryItems:[{label:"添加时间",prop:"f_CreateDate"},{label:"状态",prop:"f_State"},{label:"搜索",prop:"f_Name"}],tableLoading:!1,tableData:[],tableTotal:0,tableCurrentPage:1,tablePageSize:50,columns:[{label:"物料编码",prop:"f_Number",align:"left"},{label:"物料名称",prop:"f_Name",align:"left",dataType:"input"},{label:"规格型号",prop:"f_Model",align:"left",dataType:"input"},{label:"当前采购单价",prop:"f_Price",align:"left",dataType:"input"},{label:"添加时间",prop:"f_CreateDate",dataType:"datetime",format:"yyyy-MM-dd"},{label:"状态",prop:"f_State",width:120,align:"left",dataType:"switch",setting:{width:40,activeIconClass:"",inactiveIconClass:"",activeText:"",inactiveText:"",valueType:"number",activeValue:"1",inactiveValue:"0",activeColor:"#409EFF",inactiveColor:"#C0CCDA",csType:"int",pid:"1670403938708_34398",ptype:"card"}},{label:"操作人",prop:"f_ModifyUserName"}],tableBtns:[{prop:"Edit",label:"编辑",width:80},{prop:"Price",label:"历史价格对比"},{prop:"Delete",label:"删除"}],formVisible:!1,formTitle:"",formEditRow:null,formEdit:!1,formDetails:!1}},computed:{erp_case_f_StateOptions:function(){return[{label:"全部",value:""},{label:"启用",value:1},{label:"未启用",value:0}]}},created:function(){var e=this;this.init(),setTimeout((function(){e.queryOpen=!0}),500)},methods:{init:function(){this.loadTableData()},handleSearch:function(){this.loadTableData()},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTableData(!0)},loadTableData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return e||(t.tableCurrentPage=1),t.tableLoading=!0,r=t.$deepClone(t.queryData),r.rows=t.tablePageSize,r.page=t.tableCurrentPage,r.sidx="F_CreateDate DESC",r.f_SupplierId=t.supplierId,a.next=9,t.$awaitWraper(p.supplymaterialpage(r));case 9:s=a.sent,null!=s?(t.tableData=s.rows,t.tableTotal=s.records):t.tableData=[],t.tableLoading=!1;case 12:case"end":return a.stop()}}),a)})))()},handleEdit:function(e,t){this.formEdit=!0,this.formDetails=!1,this.formEditRow=t,this.handleShowForm("编辑")},handleDelete:function(e,t){var a=this;this.$confirm(this.$t("此操作将永久删除该数据, 是否继续?"),this.$t("提示"),{confirmButtonText:this.$t("确定"),cancelButtonText:this.$t("取消"),type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a.tableData.splice(e,1),a.tableTotal--,r.next=4,p.removeMaterial(t.f_Id);case 4:a.$message({type:"success",message:a.$t("删除成功!")});case 5:case"end":return r.stop()}}),r)})))).catch((function(){a.$message({type:"info",message:a.$t("已取消删除!")})}))},handleAdd:function(){this.formEdit=!1,this.formDetails=!1,this.handleShowForm("新增")},handleSave:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e("保存数据中..."),r.next=3,a.$refs.form.validateForm();case 3:if(!r.sent){r.next=8;break}return r.next=6,a.$refs.form.saveForm({keyValue:a.formEditRow?a.formEditRow.f_Id:"",isEdit:a.formEdit});case 6:s=r.sent,s&&(i=a.formEdit?"更新成功!":"新增成功!",a.$message({type:"success",message:a.$t(i)}),a.loadTableData(),a.formVisible=!1);case 8:t();case 9:case"end":return r.stop()}}),r)})))()},handleShowForm:function(e){this.formTitle=e,this.formVisible=!0},handleOpenedForm:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(!a.formEdit){r.next=5;break}return e("加载数据中..."),r.next=4,a.$refs.form.loadFormData({keyValue:a.formEditRow.f_Id});case 4:t();case 5:case"end":return r.stop()}}),r)})))()},handleCloseForm:function(){"历史价格对比"!=this.formTitle&&this.$refs.form.resetForm()},handlePrice:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:a.formTitle="历史价格对比",a.formEditRow=t,a.priceVisible=!0;case 3:case"end":return e.stop()}}),e)})))()},priceOpenedForm:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e("加载数据"),a.priceLoaded=!1,r.next=4,a.$awaitWraper(p.supplypricelogs({f_SupplymaterialId:a.formEditRow.f_Id}));case 4:if(s=r.sent,a.priceOptions.series[0].data=[],a.priceOptions.xAxis.data=[],s)for(i in s)a.priceOptions.series[0].data.push(s[i].f_CurrentPrice),a.priceOptions.xAxis.data.push(a.lr_dateFormat(s[i].f_CreateDate));a.priceLoaded=!0,t();case 10:case"end":return r.stop()}}),r)})))()},priceCloseForm:function(){this.priceVisible=!1}}},o=n,u=a("2877"),_=Object(u["a"])(o,r,s,!1,null,null,null);t["default"]=_.exports},e9f3:function(e,t,a){},fd05:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-rblock l-form-viewer",staticStyle:{padding:"8px"}},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,size:"mini",labelPosition:"right",labelWidth:"100px"}},[a("div",{staticClass:"l-auto-window only-tabs"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("主表信息"),name:"tab0"}},[a("el-row",{attrs:{gutter:16}},[a("div",{staticClass:"l-rblock"},[a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("供应商编号"),prop:"case_erp_supplier_f_Number"}},[a("el-input",{attrs:{readonly:!0,placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplier_f_Number,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_Number",t)},expression:"formData.case_erp_supplier_f_Number"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("供应商名称"),prop:"case_erp_supplier_f_Name"}},[a("el-input",{attrs:{readonly:!0,placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplier_f_Name,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_Name",t)},expression:"formData.case_erp_supplier_f_Name"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("淘汰原因"),prop:"case_erp_supplier_f_OutType"}},[a("l-select",{attrs:{options:e.case_erp_supplier_f_OutTypeOptions},model:{value:e.formData.case_erp_supplier_f_OutType,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_OutType",t)},expression:"formData.case_erp_supplier_f_OutType"}})],1)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{label:e.$t("淘汰说明"),prop:"case_erp_supplier_f_OutReason"}},[a("el-input",{attrs:{type:"textarea",placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplier_f_OutReason,callback:function(t){e.$set(e.formData,"case_erp_supplier_f_OutReason",t)},expression:"formData.case_erp_supplier_f_OutReason"}})],1)],1)],1)])],1)],1)],1)])],1)},s=[],i=(a("96cf"),a("1da1")),l=window.$api.erpcase.supplier,p={data:function(){return{moduleCode:"ERP_FormalSuppliers",activeName:"tab0",formData:{case_erp_supplier_f_Number:"",case_erp_supplier_f_Name:"",case_erp_supplier_f_OutType:"",case_erp_supplier_f_OutReason:""},rules:{case_erp_supplier_f_Number:[{required:!0,message:"请输入"}],case_erp_supplier_f_Name:[{required:!0,message:"请输入"}],case_erp_supplier_f_OutType:[{required:!0,message:"请选择"}],case_erp_supplier_f_OutReason:[{required:!0,message:"请输入"}]}}},computed:{case_erp_supplier_f_OutTypeOptions:function(){return[{value:"1",label:"年审不合格"},{value:"2",label:"其他"}]}},methods:{resetForm:function(){this.$formClear(this.$refs.form),this.activeName="tab0"},validateForm:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$formValidateWraper(e.$refs.form);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",!1);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))()},setForm:function(e){e.f_OutType="",e.f_OutReason="",this.$setFormData(this.formData,e,"case_erp_supplier")},getForm:function(){var e=this.$getFormData(this.formData,"case_erp_supplier");return e.f_State=2,e.isOut=!0,e},loadFormData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.keyValue,a.next=3,t.$awaitWraper(l.get(r));case 3:if(s=a.sent,!s){a.next=9;break}return t.setForm(s),a.abrupt("return",!0);case 9:return a.abrupt("return",!1);case 10:case"end":return a.stop()}}),a)})))()},saveForm:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.keyValue,s=t.getForm(),a.next=4,t.$awaitWraper(l.update(r,s));case 4:return a.abrupt("return",a.sent);case 5:case"end":return a.stop()}}),a)})))()}}},n=p,o=a("2877"),u=Object(o["a"])(n,r,s,!1,null,null,null);t["default"]=u.exports},fe5f:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"l-rblock l-form-viewer learun-el-form-left"},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,size:"mini",labelPosition:"left",labelWidth:"110px"}},[a("div",{staticClass:"l-auto-window only-tabs"},[a("el-tabs",{attrs:{type:"card"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticClass:"l-tabs-container",attrs:{label:e.$t("主表信息"),name:"tab0"}},[a("el-row",{attrs:{gutter:16}},[a("div",{staticClass:"l-rblock pd-16"},[a("div",{staticClass:"flex flex-center flex-c-between"},[a("div",{staticClass:"learun-form-title",staticStyle:{"margin-bottom":"0"}},[e._v(" "+e._s(e.$t("选择物料"))+" ")]),e.isEdit?e._e():a("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.materialBtn}},[e._v(e._s(e.$t("选择物料")))])],1),a("div",{staticClass:"mt-16"},[a("el-form-item",{attrs:{label:e.$t("物料编号"),prop:"case_erp_supplymaterial_f_Number"}},[a("el-input",{attrs:{size:"mini",disabled:"",placeholder:e.$t("请选择")},model:{value:e.formData.case_erp_supplymaterial_f_Number,callback:function(t){e.$set(e.formData,"case_erp_supplymaterial_f_Number",t)},expression:"formData.case_erp_supplymaterial_f_Number"}})],1),a("el-form-item",{attrs:{label:e.$t("物料名称"),prop:"case_erp_supplymaterial_f_Name"}},[a("el-input",{attrs:{readonly:!0,placeholder:e.$t("请选择")},model:{value:e.formData.case_erp_supplymaterial_f_Name,callback:function(t){e.$set(e.formData,"case_erp_supplymaterial_f_Name",t)},expression:"formData.case_erp_supplymaterial_f_Name"}})],1),a("el-form-item",{attrs:{label:e.$t("规格型号"),prop:"case_erp_supplymaterial_f_Model"}},[a("el-input",{attrs:{readonly:!0,placeholder:e.$t("请选择")},model:{value:e.formData.case_erp_supplymaterial_f_Model,callback:function(t){e.$set(e.formData,"case_erp_supplymaterial_f_Model",t)},expression:"formData.case_erp_supplymaterial_f_Model"}})],1)],1),a("div",{staticClass:"learun-form-title mt-16"},[e._v(e._s(e.$t("其他设置")))]),a("div",[a("el-form-item",{attrs:{label:e.$t("当前采购单价"),prop:"case_erp_supplymaterial_f_Price"}},[a("el-input",{attrs:{placeholder:e.$t("请输入")},model:{value:e.formData.case_erp_supplymaterial_f_Price,callback:function(t){e.$set(e.formData,"case_erp_supplymaterial_f_Price",t)},expression:"formData.case_erp_supplymaterial_f_Price"}})],1),a("el-form-item",{attrs:{label:e.$t("状态"),prop:"case_erp_supplymaterial_f_State"}},[a("el-switch",{attrs:{activeValue:1,inactiveValue:0},model:{value:e.formData.case_erp_supplymaterial_f_State,callback:function(t){e.$set(e.formData,"case_erp_supplymaterial_f_State",t)},expression:"formData.case_erp_supplymaterial_f_State"}})],1)],1)])])],1)],1)],1)]),a("l-dialog",{attrs:{title:e.$t("选择物料"),visible:e.materialVisible,height:600,width:1e3},on:{"update:visible":function(t){e.materialVisible=t},ok:e.handleSelect}},[a("l-choose-material",{ref:"choseForm",attrs:{multiple:!1}})],1)],1)},s=[],i=(a("96cf"),a("1da1")),l=window.$api.erpcase.supplier,p={props:{isReadOnly:{type:Boolean,default:!1},supplierId:String},data:function(){return{materialVisible:!1,isEdit:!1,moduleCode:"erpCase_supplymaterial",activeName:"tab0",formData:{case_erp_supplymaterial_f_Number:"",case_erp_supplymaterial_f_Name:"",case_erp_supplymaterial_f_Model:"",case_erp_supplymaterial_f_Price:"",case_erp_supplymaterial_f_State:1},rules:{case_erp_supplymaterial_f_Number:[{required:!0,message:"请选择物料"}],case_erp_supplymaterial_f_Name:[{required:!0,message:"请选择物料"}],case_erp_supplymaterial_f_Model:[{required:!0,message:"请选择物料"}],case_erp_supplymaterial_f_Price:[{required:!0,message:"请输入采购单价"},{pattern:/^-?[0-9]+$/,message:"请输入数字"}]}}},computed:{},methods:{handleSelect:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.choseForm.getSelectData();case 2:a=t.sent,e.formData.case_erp_supplymaterial_f_Number=a[0].f_Number,e.formData.case_erp_supplymaterial_f_Name=a[0].f_Name,e.formData.case_erp_supplymaterial_f_Model=a[0].f_Model,e.formData.case_erp_supplymaterial_f_Unit=a[0].f_Unit,e.$refs.choseForm.resetForm(),e.materialVisible=!1;case 9:case"end":return t.stop()}}),t)})))()},materialBtn:function(){this.materialVisible=!0},resetForm:function(){this.$formClear(this.$refs.form),this.formData.case_erp_supplymaterial_f_Id="",this.isEdit=!1,this.activeName="tab0"},validateForm:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$formValidateWraper(e.$refs.form);case 2:if(t.sent){t.next=4;break}return t.abrupt("return",!1);case 4:return t.abrupt("return",!0);case 5:case"end":return t.stop()}}),t)})))()},setForm:function(e){this.$setFormData(this.formData,e,"case_erp_supplymaterial")},getForm:function(){return this.$getFormData(this.formData,"case_erp_supplymaterial")},loadFormData:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return r=e.keyValue,t.isEdit=!0,a.next=4,t.$awaitWraper(l.oneMaterial(r));case 4:if(s=a.sent,!s){a.next=10;break}return t.setForm(s),a.abrupt("return",!0);case 10:return a.abrupt("return",!1);case 11:case"end":return a.stop()}}),a)})))()},saveForm:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var r,s,i;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(r=e.keyValue,s=e.isEdit,i=t.getForm(),i.f_SupplierId=t.supplierId,!s){a.next=9;break}return a.next=6,t.$awaitWraper(l.updateMaterial(r,i));case 6:return a.abrupt("return",a.sent);case 9:return a.next=11,t.$awaitWraper(l.addMaterial(i));case 11:return a.abrupt("return",a.sent);case 12:case"end":return a.stop()}}),a)})))()}}},n=p,o=a("2877"),u=Object(o["a"])(n,r,s,!1,null,null,null);t["default"]=u.exports}}]);