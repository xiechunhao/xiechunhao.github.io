(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["mycustmerForm"],{"40b4":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.isInit&&!e.lr_loadPage?a("l-layout",{staticClass:"l-tab-page",attrs:{top:e.queryHeight+12},scopedSlots:e._u([{key:"left",fn:function(){return[[2].includes(e.pageScheme.layoutType)?a("l-panel",{staticStyle:{"padding-right":"0"},scopedSlots:e._u([{key:"title",fn:function(){return[e._v(" "+e._s(e.$t(e.pageScheme.left.title))+" "),"2"==e.pageScheme.left.dataType&&e.lr_hasPageAuth("classifysSetting","buttons")?a("div",{staticClass:"tree-setting-btn"},[a("el-tooltip",{attrs:{effect:"dark",content:"分类管理",placement:"top"}},[a("el-button",{attrs:{type:"text",icon:"el-icon-setting"},on:{click:e.handleSettingClick}})],1)],1):e._e()]},proxy:!0}],null,!1,531449341)},[a("el-tree",{attrs:{data:e.leftTreeData,"expand-on-click-node":!1},on:{"node-click":e.handleLeftNodeClick},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.node;return a("span",{staticClass:"lr-tree-node"},[e._v(" "+e._s(e.$t(n.label))+" ")])}}],null,!1,3997867947)})],1):e._e()]},proxy:!0},{key:"top",fn:function(){return["1"!=e.queryType?a("l-panel",{style:{"padding-left":[2].includes(e.pageScheme.layoutType)?0:1,"padding-top":"1"!=e.queryType?"4px":1,"padding-bottom":0}},[a("l-query",{attrs:{items:e.queryItems,height:e.queryHeight,formData:e.queryData},on:{"update:height":function(t){e.queryHeight=t},search:e.handleSearch},scopedSlots:e._u([e._l(e.queryComponents,(function(t){return{key:t.prop,fn:function(){return[a("form-item",{key:t.prop,attrs:{upCtrls:e.upCtrls,formData:e.queryData,data:t},model:{value:e.queryData[t.prop],callback:function(a){e.$set(e.queryData,t.prop,a)},expression:"queryData[queryComponent.prop]"}})]},proxy:!0}}))],null,!0)})],1):e._e()]},proxy:!0}],null,!1,3319067385)},[a("l-panel",{style:{"padding-left":[2].includes(e.pageScheme.layoutType)?0:1,"padding-top":"1"!=e.queryType?"4px":1},scopedSlots:e._u([{key:"toolLeft",fn:function(){return["1"==e.queryType?a("l-query2",{attrs:{formData:e.queryData,items:e.queryItems},on:{search:e.handleSearch},scopedSlots:e._u([e._l(e.queryComponents,(function(t){return{key:t.prop,fn:function(){return[a("form-item",{key:t.prop,attrs:{upCtrls:e.upCtrls,formData:e.queryData,data:t},model:{value:e.queryData[t.prop],callback:function(a){e.$set(e.queryData,t.prop,a)},expression:"queryData[queryComponent.prop]"}})]},proxy:!0}}))],null,!0)}):a("div",{staticClass:"l-panel--item"},[-1!=e.pageScheme.btns.findIndex((function(e){return"Add"==e.id}))&&e.lr_hasPageAuth("Add","buttons")?a("el-button",{staticStyle:{"margin-right":"8px"},attrs:{type:"primary",size:"mini",icon:"el-icon-plus"},on:{click:function(t){return e.handleAdd()}}},[e._v(e._s(e.$t("新增"))+" ")]):e._e(),a("l-excel-btns")],1)]},proxy:!0},{key:"toolRight",fn:function(){return[e.isDeleteMore?a("el-button",{staticStyle:{"margin-right":"8px"},attrs:{type:"danger",size:"mini",icon:"el-icon-delete"},on:{click:e.handleDeleteMore}},[e._v(e._s(e.$t("批量删除"))+" ")]):e._e(),a("l-tool-btns",{attrs:{hasAdd:-1!=e.pageScheme.btns.findIndex((function(e){return"Add"==e.id}))&&"1"==e.queryType},on:{click:function(t){return e.handleAdd()}}},["1"==e.queryType?a("l-excel-btns"):e._e()],1)]},proxy:!0}],null,!1,3842661361)},[a("l-table",{ref:"mainTable",attrs:{isMultiSelect:e.isDeleteMore,columns:e.lr_getPageColumns(e.tableColumns),dataSource:e.tableData,"row-key":e.rowKey,isPage:e.isTablePage,tablePage:e.tableCurrentPage,pageTotal:e.tableTotal},on:{"update:tablePage":function(t){e.tableCurrentPage=t},"update:table-page":function(t){e.tableCurrentPage=t},loadPageData:e.turnTablePage},scopedSlots:e._u([e._l(e.tableColumnsByToLabel,(function(e){return{key:e.prop,fn:function(t){return[a("l-value-to-label",{key:e.prop,attrs:{value:t.row[e.prop],type:e.dataType,code:e.dataCode,valueKey:e.valueKey,labelKey:e.labelKey,options:e.options,format:e.format,setting:e.setting}})]}}}))],null,!0)},[a("l-table-btns",{attrs:{btns:e.tableBtns},on:{click:e.handleTableBtnClick}})],1)],1),a("custmer-form",{ref:"CustmerForm",attrs:{isDialog:e.isDialog,dialogHeight:e.dialogHeight,dialogWidth:e.dialogWidth,drawerWidth:e.drawerWidth,handleSave:e.handleSave,handleOpenedForm:e.handleOpenedForm,loadTableData:e.loadTableData,formInfo:e.formScheme.formInfo,classifyCode:e.pageScheme.left.dataCode,wfcode:e.wfcode,name:e.name}}),e.wordPrintCode?a("l-wordprint-btn",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"wordprintBtn",attrs:{code:e.wordPrintCode,getFormData:e.getPrintData}}):e._e(),e.commonPrintCode?a("l-print-btn",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"commonprintBtn",attrs:{code:e.commonPrintCode,getFormData:e.getPrintData}}):e._e()],1):e._e()},r=[],i=(a("99af"),a("4de4"),a("7db0"),a("c740"),a("caad"),a("a15b"),a("d81d"),a("a434"),a("b0c0"),a("a9e3"),a("ac1f"),a("5319"),a("1276"),a("159b"),a("96cf"),a("1da1")),o=a("5530"),s=a("5880"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[e.isDialog?a("l-dialog",{attrs:{title:e.$t(e.formTitle),visible:e.formVisible,height:e.dialogHeight,width:e.dialogWidth,hasBtns:!e.isDetails,hidden:e.isHide},on:{"update:visible":function(t){e.formVisible=t},ok:e.handleSave,closed:e.handleCloseForm,opened:e.handleOpenedForm}},[a("l-form-viewer",{ref:"form",attrs:{formInfo:e.formInfo,isAuth:!0,isRead:e.isDetails}})],1):a("l-drawer",{attrs:{title:e.$t(e.formTitle),visible:e.formVisible,width:e.drawerWidth,showOk:!e.isDetails,showClose:!e.isDetails,hidden:e.isHide},on:{"update:visible":function(t){e.formVisible=t},ok:e.handleSave,closed:e.handleCloseForm,opened:e.handleOpenedForm}},[a("l-form-viewer",{ref:"form",attrs:{formInfo:e.formInfo,isAuth:!0,isRead:e.isDetails}})],1),a("l-drawer",{attrs:{title:e.$t("分类管理"),visible:e.classifysVisible,showOk:!1,showClose:!1,size:"800px"},on:{"update:visible":function(t){e.classifysVisible=t}}},[a("l-dataitem-index",{attrs:{classifyCode:e.classifyCode}})],1),a("wf-create-form",{ref:"wfform",attrs:{code:e.myWfcode,isDraftBtn:!1,title:e.name,visible:e.wfVisible},on:{refresh:e.myLoadTableData,"update:visible":function(t){e.wfVisible=t}}})],1)},c=[],u={props:{isDialog:Boolean,dialogHeight:Number,dialogWidth:Number,drawerWidth:Number,handleSave:Function,handleOpenedForm:Function,loadTableData:Function,formInfo:{type:Object,default:function(){}},classifyCode:String,wfcode:String,name:String},data:function(){return{formVisible:!1,classifysVisible:!1,wfVisible:!1,formTitle:"",isDetails:!1,isHide:!1,rowWfCode:""}},computed:{myWfcode:function(){return console.log(this.rowWfCode,"this.rowWfCode"),this.rowWfCode?this.rowWfCode:this.wfcode}},methods:{openForm:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.formTitle=e,this.isDetails=t,this.isHide=a,this.formVisible=!0},closeForm:function(){this.formVisible=!1},handleCloseForm:function(){this.$refs.form&&this.$refs.form.resetFormData()},validateForm:function(){return this.$refs.form.validateForm()},getForm:function(){return this.$refs.form.getForm()},init:function(e){return this.$refs.form.init(e)},getDiffFormData:function(){return this.$refs.form.getDiffFormData()},afterSaveEvent:function(e,t){return this.$refs.form.afterSaveEvent(e,t)},openClassify:function(){this.classifysVisible=!0},openWf:function(){this.rowWfCode="",this.wfVisible=!0},myLoadTableData:function(){this.loadTableData&&this.loadTableData(!0)},getPrintData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$refs.form.getPrintData();case 2:return a=t.sent,t.abrupt("return",a);case 4:case"end":return t.stop()}}),t)})))()},handleCreateFlow:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a.rowWfCode=e,n.prev=1,n.next=4,a.$refs.wfform.handleCreateFlow(a.loginInfo.f_UserId,t);case 4:n.next=9;break;case 6:n.prev=6,n.t0=n["catch"](1),console.log(n.t0);case 9:case"end":return n.stop()}}),n,null,[[1,6]])})))()}}},d=u,m=a("2877"),f=Object(m["a"])(d,l,c,!1,null,null,null),p=f.exports,h=window.$api.custmerForm.module,y=window.$api.custmerForm.scheme,b={components:{CustmerForm:p},data:function(){return{lr_isPage:!0,lr_isCustmerFormPage:!0,name:"",moduleId:"",tableLoading:!1,columns:[{label:"",prop:"",minWidth:"1"}],tableData:[],tableTotal:0,tablePageSize:50,tableCurrentPage:1,tableBtns:[],leftTreeId:"",formSchemeId:"",formEditRow:null,formEdit:!1,isInit:!1,pageScheme:{},formScheme:{},mainTable:null,mainTableIndex:0,componentMap:{},queryData:{},queryItems:[],queryComponents:[],queryHeight:44,isWFlow:!1,wfcode:"",isDetails:!1,ldparam:{},selectListId:[],selProCode:"",selProId:"",printType:"word",isPrint:!1,printLoading:null}},computed:Object(o["a"])(Object(o["a"])({},Object(s["mapGetters"])(["modules"])),{},{leftTreeData:function(){var e=this.pageScheme.left,t=e.dataType,a=e.dataCode,n=e.dataIdKey,r=e.dataPIdKey,i=e.dataValueKey,o=e.dataLabelKey,s=e.options;switch(t){case"1":return s;case"2":return this.lr_dataItemTree(this.lr_dataItem[a]);case"3":return this.lr_DataSourceTree(this.lr_dataSourceData[a],n,r,i,o);default:return[]}},tableColumns:function(){var e=this,t=[];return this.pageScheme.table.columns.forEach((function(a){var n=e.componentMap[a.prop];if(n.field){var r="".concat(n.field).concat(1==e.formScheme.formType?"":e.formScheme.db.findIndex((function(e){return e.name==n.table}))),i={label:a.label,prop:r.toLowerCase(),align:a.align};a.isMinWidth?i.minWidth=a.width:i.width=a.width;var o=e.getComponentDataType(n);i.dataType=o.type,i.dataCode=o.code,i.valueKey=o.valueKey,i.labelKey=o.labelKey,i.options=o.options,i.format=o.format,["rate","switch"].includes(n.type)&&(i.setting=n),t.push(i)}})),t.length>0&&-1==t.findIndex((function(e){return e.minWidth>0}))&&t.forEach((function(e){e.minWidth=e.width,delete e.width})),t},tableColumnsByToLabel:function(){return this.lr_tableColumnsByToLabel(this.lr_getPageColumns(this.tableColumns))},mainTablePk:function(){return this.formScheme.primaryKey},rowKey:function(){return this.mainTablePk?"".concat(this.mainTablePk.toLowerCase()).concat(1==this.formScheme.formType?"":this.mainTableIndex):""},isTablePage:function(){return this.pageScheme.table.isPage},isDeleteMore:function(){return this.pageScheme.table.isDeleteMore},queryType:function(){return this.pageScheme.queryType},isDialog:function(){return"2"!=this.formScheme.formInfo.openType},dialogHeight:function(){return this.formScheme.formInfo.dialogHeight||600},dialogWidth:function(){return this.formScheme.formInfo.dialogWidth||800},drawerWidth:function(){return this.formScheme.formInfo.drawerWidth||600},upCtrls:function(){var e={};return this.queryComponents.forEach((function(t){t.upCtrl&&(e[t.upCtrl]=e[t.upCtrl]||[],e[t.upCtrl].push(t.prop))})),e},wordPrintCode:function(){var e=this.pageScheme.btns.find((function(e){return"Wordprint"==e.id}))||{};return e.printCode||""},commonPrintCode:function(){var e=this.pageScheme.btns.find((function(e){return"Print"==e.id}))||{};return console.log(e,"btn"),e.printCode||""}}),watch:{$route:{handler:function(e){"mycustmerForm"==e.name&&this.init()},immediate:!0}},methods:{init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.isInit=!1,a=e.modules.find((function(t){return t.f_UrlAddress==e.$route.query.src})),t.next=4,e.lr_loadPageAuth();case 4:return t.next=6,e.$awaitWraper(h.getScheme(a.f_UrlAddress));case 6:n=t.sent,e.queryHeight=44,n&&a.f_UrlAddress==e.$route.query.src&&(e.id=n.entity.f_Id,r=a.f_ModuleId,e.moduleId=a.f_ModuleId,window.$ldparam&&(e.ldparam[e.moduleId]=window.$ldparam[e.moduleId],window.$ldparam[e.moduleId]=void 0),e.pageScheme=JSON.parse(n.entity.f_Scheme),e.formScheme=JSON.parse(n.formScheme.f_Scheme),e.formSchemeId=n.formScheme.f_Id,e.mainTableIndex=e.formScheme.db.findIndex((function(e){return"main"==e.type})),e.mainTable=e.formScheme.db[e.mainTableIndex],e.componentMap=e.getComponentMap(e.formScheme),e.setQueryData(e.pageScheme),e.setBtns(),e.setTree(),e.isInit=!0,e.$nextTick((function(){e.loadTableData(!1,r)})));case 9:case"end":return t.stop()}}),t)})))()},getComponentMap:function(e){var t={};return e.formInfo.tabList.forEach((function(e){e.components.forEach((function(e){t[e.prop]=e}))})),t},setQueryData:function(e){var t=this,a=[],n=[];e.table.querys.forEach((function(r){var i=r.prop,o=t.$deepClone(t.componentMap[r.prop]);o.disabled=!1,o.readonly=!1,n.push(o),["switch"].includes(o.type)?t.$set(t.queryData,o.prop,t.toValueType(o.valueType,o.default)||t.toValueType(o.valueType,o.inactiveValue)):t.$set(t.queryData,o.prop,void 0),"1"==e.queryType&&["modifytime","createtime","datetime"].includes(o.type),a.push({label:o.label,prop:i,span:24}),["textarea","password","guid","encode"].includes(o.type)?o.type="input":["datetime","time"].includes(o.type)?o.dateType="".concat(o.dateType,"range"):["company"].includes(o.type)?o.type="companySelect":["department"].includes(o.type)?o.type="departmentSelect":["createuser","modifyuser"].includes(o.type)?o.type="userSelect":["createtime","modifytime"].includes(o.type)&&(o.type="datetimerange",o.dateType="datetimerange"),["userSelect","departmentSelect","companySelect","select"].includes(o.type)&&(o.multiple=!0,["select"].includes(o.type)&&(o.collapseTags=!0))})),this.queryItems=a,this.queryComponents=n},toValueType:function(e,t){if(!this.$validatenull(t)&&!this.$validatenull(e))switch(e){case"boolean":return"true"==t;case"string":return t;case"number":return Number(t)}},setBtns:function(){var e=this.pageScheme.btns.find((function(e){return e.isWFlow&&e.wFlowCode}));e?(this.isWFlow=!0,this.wfcode=e.wFlowCode):(this.isWFlow=!1,this.wfcode="");var t=this.pageScheme.btns.find((function(e){return e.isRowBtn&&e.wFlowCode}));t&&(this.selProCode=t.wFlowCode,this.selProId=t.tableColumnCode),this.tableBtns=this.pageScheme.btns.filter((function(e){return e.isRowBtn}))},setTree:function(){if(2==this.pageScheme.layoutType){var e=this.pageScheme.left,t=e.dataType,a=e.dataCode;switch(t){case"2":this.lr_loadDataItem(a);break;case"3":this.lr_loadDataSourceData(a);break}}},handleLeftNodeClick:function(e){this.leftTreeId=e.value,this.loadTableData()},setTreeNodeValue:function(e){2==this.pageScheme.layoutType&&(e[this.pageScheme.left.colField]=this.leftTreeId||e[this.pageScheme.left.colField])},handleSettingClick:function(){this.$refs.CustmerForm.openClassify()},getComponentDataType:function(e){var t={};if(["radio","checkbox","select","selectMultiple","treeselect","layerselect"].includes(e.type))switch(e.dataType){case"1":t.type="mydata",t.options=e.options;break;case"2":t.type="dataItem",t.code=e.dataCode;break;case"3":t.type="dataSource",t.code=e.dataCode,t.valueKey=e.dataValueKey,t.labelKey=e.dataLabelKey;break}else["datetime","createtime","modifytime"].includes(e.type)?(t.type="datetime",t.format=e.format||"yyyy-MM-dd HH:mm:ss"):["upload"].includes(e.type)?t.type="file":["uploadimg"].includes(e.type)?t.type="img":["companySelect","company"].includes(e.type)?t.type="company":["departmentSelect","department"].includes(e.type)?t.type="department":["userSelect","createuser","modifyuser"].includes(e.type)?t.type="user":["areaselect"].includes(e.type)?t.type="areas":t.type=e.type;return t},handleTableBtnClick:function(e){var t=this["handle"+e.type];t&&t(e.rowIndex,e.row)},loadTableData:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,i,o,s,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a.isInit){n.next=2;break}return n.abrupt("return");case 2:if(e||(a.tableCurrentPage=1),r=a.$loading({target:a.$refs.mainTable?a.$refs.mainTable.$el:"document.body",lock:!0,text:"加载数据中...",spinner:"el-icon-loading"}),i=a.$deepClone(a.queryData),a.setTreeNodeValue(i),o={queryJson:JSON.stringify(i||{})},s=a.pageScheme.table.sidx?a.componentMap[a.pageScheme.table.sidx]:null,s?(o.sidx="".concat(s.field).concat(1==a.formScheme.formType?"":a.formScheme.db.findIndex((function(e){return e.name==s.table}))),a.pageScheme.table.isDESC&&(o.sidx+=" DESC")):a.mainTablePk?o.sidx="".concat(a.mainTablePk.replace(/,/g,"".concat(a.mainTableIndex,","))).concat(a.mainTableIndex):a.tableColumns.length>0&&(o.sidx=a.tableColumns[0].prop),"0"==o.sidx&&(o.sidx=""),t&&t!=a.moduleId){n.next=24;break}if(a.ldparam&&void 0!==a.ldparam[a.moduleId]?o.ldparam=a.ldparam[a.moduleId]:a.ldparam={},!a.isTablePage){n.next=21;break}return o.paginationInputDto={rows:a.tablePageSize,page:a.tableCurrentPage,sidx:o.sidx},n.next=16,a.$awaitWraper(y.getDataPage(a.moduleId,a.formSchemeId,o));case 16:l=n.sent,a.selectListId=[],null!=l?(a.tableData=l.rows,a.tableTotal=l.records):(a.tableData=[],a.tableTotal=0),n.next=24;break;case 21:return n.next=23,a.$awaitWraper(y.getDataList(a.moduleId,a.formSchemeId,o));case 23:a.tableData=n.sent;case 24:r.close();case 25:case"end":return n.stop()}}),n)})))()},turnTablePage:function(e){var t=e.rows;this.tablePageSize=t,this.loadTableData(!0)},handleSearch:function(){this.loadTableData()},handleAdd:function(){this.isWFlow?this.$refs.CustmerForm.openWf():(this.formEdit=!1,this.$refs.CustmerForm.openForm("新增数据"))},handleDeleteMore:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e.$refs.mainTable.getSelected(),e.selectListId=a.map((function(t){return t["".concat(e.mainTablePk.toLowerCase()).concat(1==e.formScheme.formType?"":e.mainTableIndex)]})),0==e.selectListId.length?e.$message("请先选择数据"):e.$confirm(e.$t("此操作将永久删除数据, 是否继续?"),e.$t("提示"),{confirmButtonText:e.$t("确定"),cancelButtonText:e.$t("取消"),type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function t(){var a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:for(a in e.selectListId)for(n in e.tableData)e.selectListId[a]==e.tableData[n].f_id0&&(e.tableData.splice(n,1),e.tableTotal--);return setTimeout((function(){console.log("延时清空"),e.$refs.mainTable.clearSelection()}),1),t.next=4,y.deleteCusterForm(e.formSchemeId,{key:e.mainTablePk,keyValues:e.selectListId.join(",")});case 4:e.$message({type:"success",message:"删除成功!"});case 5:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({type:"info",message:"已取消删除"})}));case 3:case"end":return t.stop()}}),t)})))()},handleEdit:function(e,t){this.formEdit=!0,this.formEditRow=t,this.$refs.CustmerForm.openForm("编辑数据")},handleDetails:function(e,t){this.formEdit=!0,this.formEditRow=t,this.$refs.CustmerForm.openForm("详细数据",!0)},handleDelete:function(e,t){var a=this;this.$confirm(this.$t("此操作将永久删除该数据, 是否继续?"),this.$t("提示"),{confirmButtonText:this.$t("确定"),cancelButtonText:this.$t("取消"),type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a.tableData.splice(e,1),a.tableTotal--,n.next=4,y.removeData(a.formSchemeId,{key:a.mainTablePk,keyValue:a.getpkeyValue(t)});case 4:a.$message({type:"success",message:"删除成功!"});case 5:case"end":return n.stop()}}),n)})))).catch((function(){a.$message({type:"info",message:"已取消删除"})}))},openPrint:function(e,t){this.printLoading=this.$loading({target:"document.body",lock:!0,text:"打印数据加载中...",spinner:"el-icon-loading"}),this.formEdit=!0,this.formEditRow=e,this.isPrint=!0,this.printType=t,this.$refs.CustmerForm.openForm("打印数据",!0,!0)},handleWordprint:function(e,t){this.openPrint(t,"word")},handlePrint:function(e,t){this.openPrint(t,"common")},handleSelectionProcess:function(e,t){var a=this;this.$confirm(this.$t("此操作发起流程, 是否继续?"),this.$t("提示"),{confirmButtonText:this.$t("确定"),cancelButtonText:this.$t("取消"),type:"warning"}).then(Object(i["a"])(regeneratorRuntime.mark((function e(){var n,r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(n=a.componentMap[a.selProId],!n.field){e.next=8;break}return r="".concat(n.field).concat(1==a.formScheme.formType?"":a.formScheme.db.findIndex((function(e){return e.name==n.table}))),i=r.toLowerCase(),e.next=6,a.$refs.CustmerForm.handleCreateFlow(a.selProCode,t[i]);case 6:e.next=9;break;case 8:a.$message({type:"info",message:"发布失败"});case 9:case"end":return e.stop()}}),e)})))).catch((function(){a.$message({type:"info",message:"已取消发布"})}))},handleSave:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,i,o,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e(),n.next=3,a.$refs.CustmerForm.validateForm();case 3:if(!n.sent){n.next=16;break}return r=a.$refs.CustmerForm.getForm(),i=a.$refs.CustmerForm.getDiffFormData(),o={schemeId:a.formSchemeId,isUpdate:a.formEdit,pkey:a.mainTablePk,pkeyValue:a.formEdit?a.getpkeyValue(a.formEditRow):"",data:JSON.stringify(r),diffFormData:i},n.next=9,a.$awaitWraper(y.saveData(o));case 9:if(s=n.sent,!s){n.next=16;break}return n.next=13,a.$awaitWraper(a.$refs.CustmerForm.afterSaveEvent(s,a.formEdit));case 13:a.$message({type:"success",message:a.$t("保存成功!")}),a.$refs.CustmerForm.closeForm(),a.loadTableData(!0);case 16:t();case 17:case"end":return n.stop()}}),n)})))()},handleOpenedForm:function(e,t){var a=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var r,i,s,l;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a.isPrint||e("加载数据中"),!a.formEdit){n.next=23;break}if(1!=a.formScheme.formType){n.next=16;break}if(r={},r[a.mainTable.name]=[a.formEditRow],i={},!(a.formScheme.db.length>1)){n.next=12;break}return a.formScheme.db.forEach((function(e){i[e.relationField]=a.formEditRow[e.relationField]})),n.next=10,a.$awaitWraper(y.getViewData(a.formSchemeId,{mainData:JSON.stringify(i)}));case 10:s=n.sent,r=Object(o["a"])(Object(o["a"])({},r),s);case 12:return n.next=14,a.$refs.CustmerForm.init(r);case 14:n.next=21;break;case 16:return n.next=18,a.$awaitWraper(y.getData(a.formSchemeId,{key:a.mainTablePk,keyValue:a.getpkeyValue(a.formEditRow)}));case 18:return l=n.sent,n.next=21,a.$refs.CustmerForm.init(l);case 21:n.next=25;break;case 23:return n.next=25,a.$refs.CustmerForm.init();case 25:if(a.isPrint){n.next=29;break}t(),n.next=44;break;case 29:if(a.isPrint=!1,"word"!=a.printType||!a.$refs.wordprintBtn){n.next=35;break}return n.next=33,a.$refs.wordprintBtn.handleClick();case 33:n.next=41;break;case 35:if("common"!=a.printType||!a.$refs.commonprintBtn){n.next=40;break}return n.next=38,a.$refs.commonprintBtn.handleClick();case 38:n.next=41;break;case 40:a.$message({type:"warning",message:"请设置打印模版编码!"});case 41:a.$refs.CustmerForm.closeForm(),a.printLoading.close(),a.printLoading=null;case 44:case"end":return n.stop()}}),n)})))()},getpkeyValue:function(e){var t=[],a=this.mainTablePk.split(",");return a.forEach((function(a){e["".concat(a.toLowerCase(),"0")]&&t.push(e["".concat(a.toLowerCase(),"0")])})),String(t)},getPrintData:function(){return this.$refs.CustmerForm.getPrintData()}}},g=b,w=Object(m["a"])(g,n,r,!1,null,null,null);t["default"]=w.exports}}]);