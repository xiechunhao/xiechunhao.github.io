(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["print"],{"28eb":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return t.lr_loadPage?t._e():a("l-layout",{staticClass:"l-tab-page",scopedSlots:t._u([{key:"left",fn:function(){return[a("l-panel",{staticStyle:{"padding-right":"0"},scopedSlots:t._u([{key:"title",fn:function(){return[t._v(" "+t._s(t.$t("流程分类"))+" "),a("div",{staticClass:"tree-setting-btn"},[a("el-tooltip",{attrs:{effect:"dark",content:t.$t("分类管理"),placement:"top"}},[a("el-button",{attrs:{type:"text",icon:"el-icon-setting"},on:{click:t.handleSettingClick}})],1)],1)]},proxy:!0}],null,!1,1707119425)},[a("el-tree",{ref:"tree",staticClass:"learun-tree",attrs:{"node-key":"id","highlight-current":!0,data:t.dataItemTree_FlowSort},on:{"node-click":t.handleNodeClick},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node;return a("span",{staticClass:"lr-tree-node"},[a("i",{staticClass:"el-icon-notebook-2"}),t._v(" "+t._s(i.label)+" ")])}}],null,!1,1970407520)})],1)]},proxy:!0}],null,!1,1935739608)},[a("l-panel",{staticStyle:{"padding-left":"0"},scopedSlots:t._u([{key:"toolLeft",fn:function(){return[a("div",{staticClass:"l-panel--item"},[a("el-input",{attrs:{placeholder:t.$t("请输入模版名称"),size:"mini"},model:{value:t.searchWord,callback:function(e){t.searchWord=e},expression:"searchWord"}})],1)]},proxy:!0},{key:"toolRight",fn:function(){return[a("l-tool-btns",{attrs:{hasAdd:!1}},[a("l-wordprint-btn",{ref:"wordprintBtn",attrs:{label:t.$t("批量打印"),btnType:"primary"},on:{click:t.handlePrints}})],1)]},proxy:!0}],null,!1,828015279)},[a("div",{staticStyle:{display:"flex",height:"100%",width:"100%"}},[a("l-table",{staticStyle:{width:"500px","border-right":"1px solid #d9d9d9"},attrs:{loading:t.tableLoading,columns:t.columns,dataSource:t.schemeDataList,"row-key":"f_Id"},on:{rowClick:t.handleRowClick}}),a("l-table",{ref:"mainTable",staticStyle:{flex:"2"},attrs:{loading:t.tableLoading2,columns:t.columns2,dataSource:t.tableData2,"row-key":"f_Id",isPage:!0,isMultiSelect:!0,pageTotal:t.tableTotal2,tablePage:t.tableCurrentPage2},on:{"update:tablePage":function(e){t.tableCurrentPage2=e},"update:table-page":function(e){t.tableCurrentPage2=e},loadPageData:t.turnTablePage2},scopedSlots:t._u([{key:"f_MakeTime",fn:function(e){return[t._v(" "+t._s(t.lr_dateFormat(e.row.f_MakeTime))+" ")]}},{key:"f_IsFinished",fn:function(e){return[3==e.row.isDelete?a("el-tag",{attrs:{size:"mini",type:"danger"}},[t._v(t._s(t.$t("作废")))]):1==e.row.f_IsFinished?a("el-tag",{attrs:{size:"mini",type:"warning"}},[t._v(t._s(t.$t("结束")))]):a("el-tag",{attrs:{size:"mini",type:"success"}},[t._v(t._s(t.$t("审批中")))])]}}],null,!1,3448508387)})],1)]),a("wf-look-form",{ref:"form",attrs:{type:"look",params:{taskId:t.taskId},isLoadFormData:!0,title:t.title,visible:t.visible,wfIsPrints:t.isPrints},on:{"update:visible":function(e){t.visible=e},printDataLoaded:t.printDataLoaded}})],1)},n=[],l=(a("99af"),a("4de4"),a("d81d"),a("ac1f"),a("466d"),a("5319"),a("1276"),a("5530")),r=a("b85c"),s=(a("96cf"),a("1da1")),o=window.$api.workflow.scheme,d=window.$api.workflow.process,c={components:{},data:function(){return{classifysVisible:!1,treeCategory:"",searchWord:"",columns:[{label:"编号",prop:"f_Code",minWidth:"150"},{label:"名称",prop:"f_Name",minWidth:"150"}],columns2:[{label:"任务",prop:"f_UnitName",minWidth:100,align:"left"},{label:"标题",prop:"f_ProcessTitle",minWidth:100,align:"left"},{label:"审核",prop:"f_OperationName",width:100,align:"center"},{label:"状态",prop:"f_IsFinished",width:72,align:"center"},{label:"提交人",prop:"f_ProcessUserId",width:160,align:"left",dataType:"fullUser",isNotAutoWrap:!0},{label:"时间",prop:"f_MakeTime",width:160,align:"left"}],tableLoading:!1,tableData:[],schemeAuth:{},schemeCode:"",nodeIds:[],tableLoading2:!1,tableTotal2:0,tablePageSize2:50,tableCurrentPage2:1,tableData2:[],taskId:"",title:"",visible:!1,isPrints:!1,printList:[],printLoading:null,printIndex:0,printHtml:""}},computed:{dataItemTree_FlowSort:function(){return this.lr_dataItemTree(this.lr_dataItem["FlowSort"])},schemeDataList:function(){var t=this,e=this.tableData;return this.$validatenull(this.searchWord)||(e=this.tableData.filter((function(e){return-1!=e.f_Name.indexOf(t.searchWord)}))),e}},mounted:function(){this.lr_loadDataItem("FlowSort"),this.loadScheme()},methods:{loadScheme:function(){var t=this;return Object(s["a"])(regeneratorRuntime.mark((function e(){var a,i,n,l,s,d,c,h;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.tableLoading=!0,e.next=3,t.$awaitWraper(o.getPrintList());case 3:if(e.t0=e.sent,e.t0){e.next=6;break}e.t0={};case 6:a=e.t0,i=a.schemeAuthList,n=a.schemeinfoList,l={},s=Object(r["a"])(i);try{for(s.s();!(d=s.n()).done;)c=d.value,l[c.f_SchemeInfoId]=l[c.f_SchemeInfoId]||[],h=c.f_ObjName.split("|"),-1==l[c.f_SchemeInfoId].indexOf(h[2])&&l[c.f_SchemeInfoId].push(h[2])}catch(p){s.e(p)}finally{s.f()}t.tableData=n||[],t.schemeAuth=l,t.tableLoading=!1;case 15:case"end":return e.stop()}}),e)})))()},handleRowClick:function(t){var e=t.row;this.schemeCode=e.f_Code,this.nodeIds=this.schemeAuth[e.f_Id],this.$refs.mainTable.clearSelection(),this.loadTablePage2()},loadTablePage2:function(t){var e=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){var i,n,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return t||(e.tableCurrentPage2=1),e.tableLoading2=!0,i={unitId:String(e.nodeIds),code:e.schemeCode},n={rows:e.tablePageSize,page:e.tableCurrentPage,sidx:"t2.F_CreateDate DESC"},a.next=6,e.$awaitWraper(d.getPrintPage(n,i));case 6:r=a.sent,null!=r?(e.tableData2=r.rows.map((function(t,e){return Object(l["a"])(Object(l["a"])({},t),{},{id:t.f_Id+e})})),e.tableTotal2=r.records):e.tableData2=[],e.tableLoading2=!1;case 9:case"end":return a.stop()}}),a)})))()},turnTablePage2:function(t){var e=t.rows;this.tablePageSize2=e,this.loadTablePage2(!0)},hanleSearch2:function(){this.loadTablePage()},handlePrints:function(){if(!(this.printList.length>0)){var t=this.$refs.mainTable.getSelected();0!=t.length?(this.isPrints=!0,this.printIndex=0,this.printList=t,this.printLoading=this.$loading({target:"document.body",lock:!0,text:"".concat(this.$t("打印数据加载中"),"(0/").concat(this.printList.length,")..."),spinner:"el-icon-loading"}),this.taskId=this.printList[this.printIndex].f_Id,this.visible=!0,console.log(t,"批量打印reset")):this.$message({type:"warning",message:this.$t("请选择打印数据!")})}},printDataLoaded:function(t){var e=this;if(this.printList.length>0){if(t)if(""==this.printHtml)this.printHtml=t;else{var a=t.match(/<body>.*<\/body>/g);this.printHtml=this.printHtml.replace("</body>",a[0].replace("<body>",'<div style="page-break-after:always;"></div><div style="height:10mm;width:100%;"></div>'))}this.visible=!1,this.printLoading.close(),this.printIndex++,this.printIndex==this.printList.length?this.$nextTick((function(){e.printHtml&&e.$refs.wordprintBtn.print(e.printHtml),e.printLoading=null,e.printList=[],e.printIndex=0,e.printHtml=""})):this.$nextTick((function(){e.printLoading=e.$loading({target:"document.body",lock:!0,text:"".concat(e.$t("打印数据加载中"),"(").concat(e.printIndex,"/").concat(e.printList.length,")..."),spinner:"el-icon-loading"}),e.taskId=e.printList[e.printIndex].f_Id,e.visible=!0}))}},handleNodeClick:function(t){this.treeCategory=t.value,this.tableCurrentPage=1,this.loadTablePage(),this.tableData2=[]},handleSettingClick:function(){this.classifysVisible=!0}}},h=c,p=a("2877"),u=Object(p["a"])(h,i,n,!1,null,null,null);e["default"]=u.exports}}]);