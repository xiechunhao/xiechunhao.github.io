/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2024-09-25 17:01:24 
 */
import{a as E}from"./roleManagement-CCMcQjYt.js";import{G as L,_ as M}from"./index-BnT9uhJE.js";import{d as B,F as d,o as D,D as F,V as l,M as s,_ as N,u as a,e as x,Z as U,K as j}from"./vsv-element-plus-CbS2IxKo.js";import"./vsv-icon-93gfr_RM.js";import"./vsv-nprogress-DzPgnd7z.js";const K={class:"vab-tree-border"},O=B({name:"RoleManagementEdit",__name:"RoleManagementEdit",emits:["fetch-data"],setup(T,{expose:y,emit:v}){const k=v,c=ref(),p=ref(null),o=reactive({role:"",btnRolesCheckedList:["read:system","write:system","delete:system","read:index","write:index","delete:index","read:index","write:index","delete:index"]}),w=reactive({role:[{required:!0,trigger:"blur",message:"请输入角色码"}]}),m=ref(""),r=ref(!1),_=ref([]);y({showEdit:t=>{r.value=!0,nextTick(()=>{t?(m.value="编辑",Object.assign(o,t)):(m.value="添加",o.btnRolesCheckedList=["read:system","write:system","delete:system","read:index","write:index","delete:index","read:index","write:index","delete:index"])})}});const b=()=>{var t,e;(t=c.value)==null||t.clearValidate(),(e=c.value)==null||e.resetFields(),k("fetch-data")},g=async()=>{const{data:t}=await L();_.value=t.list},V=()=>{var t;(t=c.value)==null||t.validate(async e=>{if(e){const i={"treeArray:":p.value.getCheckedKeys()},{msg:f}=await E({...o,...i});await $baseMessage(f,"success","hey"),await b(),r.value=!1}})};return onBeforeMount(()=>{g()}),(t,e)=>{const u=d("el-input"),i=d("el-form-item"),f=d("el-tree"),h=d("el-form"),R=d("el-button"),C=d("vab-dialog");return D(),F(C,{modelValue:a(r),"onUpdate:modelValue":e[2]||(e[2]=n=>j(r)?r.value=n:null),"append-to-body":"",title:a(m),width:"500px",onClose:b},{footer:l(()=>[s(R,{type:"primary",onClick:V},{default:l(()=>e[3]||(e[3]=[N("保存")])),_:1})]),default:l(()=>[s(h,{ref_key:"formRef",ref:c,"label-width":"80px",model:a(o),rules:a(w)},{default:l(()=>[s(i,{label:"角色码",prop:"role"},{default:l(()=>[s(u,{modelValue:a(o).role,"onUpdate:modelValue":e[0]||(e[0]=n=>a(o).role=n),clearable:""},null,8,["modelValue"])]),_:1}),s(i,{label:"菜单"},{default:l(()=>[x("div",K,[s(f,{ref_key:"treeRef",ref:p,data:a(_),"default-checked-keys":a(o).menuCheckedList,"default-expanded-keys":[],"node-key":"path","show-checkbox":""},{default:l(({data:n})=>[x("span",null,U(n.meta.title),1)]),_:1},8,["data","default-checked-keys"])])]),_:1}),s(i,{label:"按钮权限"},{default:l(()=>[s(u,{modelValue:a(o).btnRolesCheckedList,"onUpdate:modelValue":e[1]||(e[1]=n=>a(o).btnRolesCheckedList=n),clearable:"",rows:3,type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])}}}),$=M(O,[["__scopeId","data-v-09484dba"]]);export{$ as default};
