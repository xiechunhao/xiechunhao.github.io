/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2025-02-28 11:53:44 
 */
import{d as Z,C as h,V as o,D as i,X as S,o as y,e as u,L as r,u as e,Y as $,Q as U,Z as f,_ as x}from"./vsv-element-plus-DQNbQgVr.js";import{u as z,a as A,t as n,i as F,_ as H}from"./index-DXRDwnmL.js";import"./vsv-icon-BSoeDgwL.js";import"./vsv-nprogress-BCb6Y0ID.js";const J=""+new URL("../png/left_img_1-Dp36PNG8.png",import.meta.url).href,K={class:"login-form"},O=["src"],W={class:"title-tips"},ee=["src"],te=Z({name:"Login",__name:"Login",setup(oe){const V=useRoute(),k=useRouter(),D=z(),T=A(),{title:re}=storeToRefs(T),B=l=>D.login(l),d=ref(!1),M=ref("password"),p=ref(void 0);let m;const b=ref("https://www.oschina.net/action/user/captcha"),C=ref(""),_=ref(),q=ref(),a=reactive({username:"",password:"",verificationCode:""}),N=(l,t,s)=>{t===""?s(new Error(n("用户名不能为空"))):s()},E=(l,t,s)=>{F(t)?s():s(new Error(n("密码不能少于6位")))},P=reactive({username:[{required:!0,trigger:"blur",validator:N}],password:[{required:!0,trigger:"blur",validator:E}]}),I=()=>p.value==="/404"||p.value==="/403"?"/":p.value,R=async()=>{var l;_.value&&((l=_.value)==null||l.validate(async t=>{if(t)try{d.value=!0,await B(a).catch(()=>{d.value=!1}),await k.push(I())}finally{d.value=!1}}))},j=()=>{b.value=`https://www.oschina.net/action/user/captcha?timestamp=${Date.now()}`};return onBeforeMount(()=>{a.username="admin",a.password="123456",location.hostname.includes("vuejs-core")&&(C.value="（演示地址验证码可不填）",m=setTimeout(()=>{R()},1e3*10))}),watchEffect(()=>{p.value=V.query&&V.query.redirect||"/"}),onBeforeRouteLeave((l,t,s)=>{try{m&&clearTimeout(m)}catch{}s()}),(l,t)=>{const s=i("vab-icon"),v=i("el-input"),g=i("el-form-item"),w=i("el-button"),L=i("router-link"),G=i("el-form"),Q=i("login-container"),X=S("focus"),Y=S("throttle");return y(),h(Q,null,{default:o(()=>[u("div",K,[u("img",{alt:"",class:"left-img",src:e(J)},null,8,O),r(G,{ref_key:"formRef",ref:_,"label-position":"left",model:e(a),rules:e(P),onSubmit:t[3]||(t[3]=$(()=>{},["prevent"]))},{default:o(()=>[t[4]||(t[4]=u("div",{class:"title"},"hello !",-1)),u("div",W,f(e(n)("欢迎来到"))+" 云商城",1),r(g,{prop:"username"},{default:o(()=>[U((y(),h(v,{modelValue:e(a).username,"onUpdate:modelValue":t[0]||(t[0]=c=>e(a).username=c),modelModifiers:{trim:!0},clearable:"",placeholder:e(n)("请输入用户名"),type:"text"},{prefix:o(()=>[r(s,{icon:"user-line"})]),_:1},8,["modelValue","placeholder"])),[[X]])]),_:1}),r(g,{prop:"password"},{default:o(()=>[r(v,{ref_key:"passwordRef",ref:q,modelValue:e(a).password,"onUpdate:modelValue":t[1]||(t[1]=c=>e(a).password=c),modelModifiers:{trim:!0},clearable:"",placeholder:e(n)("请输入密码"),"show-password":"",type:e(M)},{prefix:o(()=>[r(s,{icon:"lock-line"})]),_:1},8,["modelValue","placeholder","type"])]),_:1}),r(g,{prop:"verificationCode"},{default:o(()=>[r(v,{modelValue:e(a).verificationCode,"onUpdate:modelValue":t[2]||(t[2]=c=>e(a).verificationCode=c),modelModifiers:{trim:!0},placeholder:e(n)("验证码")+e(C),type:"text"},{prefix:o(()=>[r(s,{icon:"barcode-box-line"})]),_:1},8,["modelValue","placeholder"]),u("img",{class:"code",src:e(b),onClick:j},null,8,ee)]),_:1}),U((y(),h(w,{class:"login-btn",loading:e(d),type:"primary"},{default:o(()=>[x(f(e(n)("登录")),1)]),_:1},8,["loading"])),[[Y,R]]),r(L,{to:"/register"},{default:o(()=>[r(w,{style:{"margin-top":"20px","margin-left":"-10px"},type:"primary"},{default:o(()=>[x(f(e(n)("注册")),1)]),_:1})]),_:1}),r(L,{to:"/password"},{default:o(()=>[r(w,{style:{"margin-top":"20px"},text:"",type:"primary"},{default:o(()=>[x(f(e(n)("忘记密码")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1})}}}),ie=H(te,[["__scopeId","data-v-01ba0799"]]);export{ie as default};
