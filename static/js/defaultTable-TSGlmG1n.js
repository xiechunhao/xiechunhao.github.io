/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2025-02-28 11:53:44 
 */
import{d as ge,b as h,L as e,Q as w,V as l,D as s,X as ve,u as a,C as Y,o as y,Y as he,R,a0 as we,_ as d,n as ke,a7 as Ce,ac as Ve,Z as B,b6 as De,G as Se}from"./vsv-element-plus-DQNbQgVr.js";import{g as xe,d as E}from"./table-4tHDlJ8_.js";import{m as Re,k as $e,a as Me,J as qe,K as Te}from"./index-DXRDwnmL.js";import"./vsv-icon-BSoeDgwL.js";import"./vsv-nprogress-BCb6Y0ID.js";const Ue={class:"comprehensive-table-container auto-height-container"},ze={key:0},Ne={key:1},Ye={key:0},je=ge({name:"DefaultTable",__name:"defaultTable",setup(Be){const $=useRouter(),F=Re(),{getAllRoutes:L}=storeToRefs(F),A=$e(),{changeTabsMeta:H,addVisitedRoute:j}=A,k=ref(null),M=ref(),f=ref(!0),q=ref([]),v=ref(!0),T=ref(0),m=ref([]),i=reactive({pageNo:1,pageSize:20}),b=ref(!1),G=Me(),{device:U}=storeToRefs(G),z=ref(!1),_=async()=>{v.value=!0;const{data:o}=await xe(i);q.value=o.list,T.value=o.total,v.value=!1},J=o=>{i.pageNo=1,i.pageSize=o,_()},K=o=>{i.pageNo=o,_()},O=()=>{i.pageNo=1,_()},Q=o=>({published:"success",draft:"primary",deleted:"danger"})[o],X=()=>{f.value=!f.value},Z=o=>{m.value=o},I=()=>{k.value.showEdit()},N=(o={})=>{k.value.showEdit(o)},C=o=>{if(o.id)$baseConfirm("您确定要删除当前项吗",null,async()=>{const{msg:t}=await E({ids:o.id});$baseMessage(t,"success","hey"),await _()});else if(m.value.length>0){const t=m.value.map(u=>u.id).join(",");$baseConfirm("您确定要删除选中项吗",null,async()=>{const{msg:u}=await E({ids:t});$baseMessage(u,"success","hey"),await _()})}else $baseMessage("您未选中任何行","warning","hey")},P=async()=>{if(m.value.length>0)for(let o=0;o<m.value.length;o++){const t=qe(L.value,"/vab/table/defaultTableDetail"),u=Te({...t.at(-1),query:m.value[o]});u&&(await j(u),await H({title:"详情页",meta:{title:`${u.query.title} 详情页`}}))}else $baseMessage("请至少选择一行进行详情页跳转","warning","hey")},V=o=>{o.id?$.push({path:"/vab/table/defaultTableDetail",query:{...o,timestamp:Date.now()}}):m.value.length===1?$.push({path:"/vab/table/defaultTableDetail",query:{...m.value[0],timestamp:Date.now()}}):$baseMessage("请选择一行进行详情页跳转","warning","hey")};return watch(()=>U.value,()=>{U.value==="mobile"&&(b.value=!0,z.value="right")},{immediate:!0}),onActivated(()=>{var o;(o=M.value)==null||o.doLayout()}),onBeforeMount(()=>{_()}),(o,t)=>{const u=s("el-input"),g=s("el-form-item"),W=s("el-date-picker"),D=s("el-option"),ee=s("el-select"),r=s("el-button"),te=s("vab-icon"),le=s("el-form"),ae=s("vab-query-form-top-panel"),ne=s("vab-query-form-left-panel"),oe=s("vab-query-form"),p=s("el-table-column"),se=s("el-rate"),ie=s("el-switch"),de=s("el-tag"),ue=s("el-checkbox"),re=s("el-icon"),S=s("el-link"),x=s("el-dropdown-item"),pe=s("el-dropdown-menu"),ce=s("el-dropdown"),me=s("el-empty"),fe=s("el-table"),_e=s("vab-pagination"),be=s("default-table-edit"),ye=ve("loading");return y(),h("div",Ue,[e(oe,null,{default:l(()=>[e(ae,null,{default:l(()=>[e(le,{inline:"",model:a(i),onSubmit:t[4]||(t[4]=he(()=>{},["prevent"]))},{default:l(()=>[e(g,{label:"标题"},{default:l(()=>[e(u,{modelValue:a(i).title,"onUpdate:modelValue":t[0]||(t[0]=n=>a(i).title=n),clearable:"",placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),w(e(g,{label:"作者"},{default:l(()=>[e(u,{modelValue:a(i).author,"onUpdate:modelValue":t[1]||(t[1]=n=>a(i).author=n),clearable:"",placeholder:"请输入作者"},null,8,["modelValue"])]),_:1},512),[[R,!a(f)]]),w(e(g,{label:"时间"},{default:l(()=>[e(W,{modelValue:a(i).datetime,"onUpdate:modelValue":t[2]||(t[2]=n=>a(i).datetime=n),format:"YYYY/MM/DD HH:mm:ss",placeholder:"请选择时间",type:"datetime"},null,8,["modelValue"])]),_:1},512),[[R,!a(f)]]),w(e(g,{label:"状态"},{default:l(()=>[e(ee,{modelValue:a(i).status,"onUpdate:modelValue":t[3]||(t[3]=n=>a(i).status=n),placeholder:"请选择状态"},{default:l(()=>[e(D,{label:"success",value:"published"}),e(D,{label:"primary",value:"draft"}),e(D,{label:"danger",value:"deleted"})]),_:1},8,["modelValue"])]),_:1},512),[[R,!a(f)]]),e(g,null,{default:l(()=>[e(r,{icon:a(we),loading:a(v),"native-type":"submit",type:"primary",onClick:O},{default:l(()=>t[6]||(t[6]=[d("查询")])),_:1},8,["icon","loading"]),e(r,{class:"hidden-xs-only",text:"",type:"primary",onClick:X},{default:l(()=>[a(f)?(y(),h("span",ze,"展开")):(y(),h("span",Ne,"合并")),e(te,{class:ke(["vab-dropdown",{"vab-dropdown-active":a(f)}]),icon:"arrow-up-s-line"},null,8,["class"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(ne,{span:24},{default:l(()=>[e(r,{icon:a(Ce),type:"primary",onClick:I},{default:l(()=>t[7]||(t[7]=[d("添加")])),_:1},8,["icon"]),e(r,{icon:a(Ve),type:"danger",onClick:C},{default:l(()=>t[8]||(t[8]=[d("删除")])),_:1},8,["icon"]),e(r,{type:"primary",onClick:V},{default:l(()=>t[9]||(t[9]=[d("详情")])),_:1}),e(r,{class:"hidden-xs-only",type:"primary",onClick:P},{default:l(()=>t[10]||(t[10]=[d("后台打开详情")])),_:1})]),_:1})]),_:1}),w((y(),Y(fe,{ref_key:"tableRef",ref:M,border:"",data:a(q),onSelectionChange:Z},{empty:l(()=>[e(me,{class:"vab-data-empty",description:"暂无数据"})]),default:l(()=>[e(p,{type:"selection",width:"38"}),e(p,{align:"center",label:"序号",width:"55"},{default:l(({$index:n})=>[d(B(n+1),1)]),_:1}),e(p,{align:"center",label:"标题","min-width":"200",prop:"title"}),e(p,{align:"center",label:"作者",prop:"author"}),e(p,{align:"center",label:"评级","min-width":"200"},{default:l(({row:n})=>[e(se,{modelValue:n.rate,"onUpdate:modelValue":c=>n.rate=c,disabled:""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{align:"center",label:"数量","min-width":"100",prop:"count",sortable:""}),e(p,{align:"center",label:"开关",prop:"switch"},{default:l(({row:n})=>[e(ie,{modelValue:n.switch,"onUpdate:modelValue":c=>n.switch=c},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{align:"center",label:"状态","min-width":"100"},{default:l(({row:n})=>[e(de,{effect:"dark",type:Q(n.status)},{default:l(()=>[d(B(n.status),1)]),_:2},1032,["type"])]),_:1}),e(p,{align:"center",label:"时间","min-width":"160",prop:"datetime"}),e(p,{align:"center",fixed:a(z),label:"操作",width:a(b)?120:215},{header:l(()=>[e(ue,{modelValue:a(b),"onUpdate:modelValue":t[5]||(t[5]=n=>Se(b)?b.value=n:null),label:"折叠操作列","true-value":"right"},null,8,["modelValue"])]),default:l(({row:n})=>[a(b)?(y(),Y(ce,{key:1},{dropdown:l(()=>[e(pe,null,{default:l(()=>[e(x,{onClick:c=>V(n)},{default:l(()=>[e(S,{type:"primary",underline:!1},{default:l(()=>t[15]||(t[15]=[d("详情")])),_:1})]),_:2},1032,["onClick"]),e(x,{onClick:c=>N(n)},{default:l(()=>[e(S,{type:"primary",underline:!1},{default:l(()=>t[16]||(t[16]=[d("编辑")])),_:1})]),_:2},1032,["onClick"]),e(x,{onClick:c=>C(n)},{default:l(()=>[e(S,{type:"danger",underline:!1},{default:l(()=>t[17]||(t[17]=[d("删除")])),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),default:l(()=>[e(r,{text:"",type:"primary"},{default:l(()=>[t[14]||(t[14]=d(" 操作 ")),e(re,{class:"el-icon--right"},{default:l(()=>[e(a(De))]),_:1})]),_:1})]),_:2},1024)):(y(),h("div",Ye,[e(r,{text:"",type:"primary",onClick:c=>V(n)},{default:l(()=>t[11]||(t[11]=[d("详情")])),_:2},1032,["onClick"]),e(r,{text:"",type:"primary",onClick:c=>N(n)},{default:l(()=>t[12]||(t[12]=[d("编辑")])),_:2},1032,["onClick"]),e(r,{text:"",type:"danger",onClick:c=>C(n)},{default:l(()=>t[13]||(t[13]=[d("删除")])),_:2},1032,["onClick"])]))]),_:1},8,["fixed","width"])]),_:1},8,["data"])),[[ye,a(v)]]),e(_e,{"current-page":a(i).pageNo,"page-size":a(i).pageSize,total:a(T),onCurrentChange:K,onSizeChange:J},null,8,["current-page","page-size","total"]),e(be,{ref_key:"editRef",ref:k,onFetchData:_},null,512)])}}});export{je as default};
