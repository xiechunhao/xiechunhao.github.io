/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2024-09-27 15:46:00 
 */
import{d as F,M as x,$ as s,N as n,a2 as U,o as m,e as d,u as e,T as o,a3 as u,Y as b,a4 as V,b as H,a5 as J}from"./vsv-element-plus-CxGOTlXz.js";import{u as K,a as O,t as a,i as Q,_ as W}from"./index-BxCyh4rX.js";import"./vsv-icon-B5tQoIEl.js";import"./vsv-nprogress-DAXSSYSi.js";const X=""+new URL("../png/left_img_1-Dp36PNG8.png",import.meta.url).href,Z={class:"login-form"},ee=["src"],oe={class:"title-tips"},te=["src"],re={class:"login-other hidden-xs-only"},se=F({name:"Login",__name:"Login",setup(le){const R=useRoute(),q=useRouter(),B=K(),L=O(),{title:M}=storeToRefs(L),D=i=>B.login(i),f=ref(!1),N=ref("password"),p=ref(void 0);let _;const k=ref("https://www.oschina.net/action/user/captcha"),C=ref(""),v=ref(),E=ref(),l=reactive({username:"",password:"",verificationCode:""}),P=(i,r,t)=>{r===""?t(new Error(a("用户名不能为空"))):t()},I=(i,r,t)=>{Q(r)?t():t(new Error(a("密码不能少于6位")))},$=reactive({username:[{required:!0,trigger:"blur",validator:P}],password:[{required:!0,trigger:"blur",validator:I}]}),j=()=>p.value==="/404"||p.value==="/403"?"/":p.value,g=async()=>{var i;v.value&&((i=v.value)==null||i.validate(async r=>{if(r)try{f.value=!0,await D(l).catch(()=>{f.value=!1}),await q.push(j())}finally{f.value=!1}}))},G=()=>{k.value=`https://www.oschina.net/action/user/captcha?timestamp=${Date.now()}`};return onBeforeMount(()=>{l.username="admin",l.password="123456",location.hostname.includes("vuejs-core")&&(C.value="（演示地址验证码可不填）",_=setTimeout(()=>{g()},1e3*10))}),watchEffect(()=>{p.value=R.query&&R.query.redirect||"/"}),onBeforeRouteLeave((i,r,t)=>{try{_&&clearTimeout(_)}catch{}t()}),(i,r)=>{const t=n("vab-icon"),w=n("el-input"),y=n("el-form-item"),h=n("el-button"),S=n("router-link"),Y=n("el-form"),z=n("login-container"),A=U("focus"),T=U("throttle");return m(),x(z,null,{default:s(()=>[d("div",Z,[d("img",{alt:"",class:"left-img",src:e(X)},null,8,ee),o(Y,{ref_key:"formRef",ref:v,"label-position":"left",model:e(l),rules:e($),onSubmit:r[3]||(r[3]=J(()=>{},["prevent"]))},{default:s(()=>[r[4]||(r[4]=d("div",{class:"title"},"hello !",-1)),d("div",oe,u(e(a)("欢迎来到"))+" "+u(e(M)),1),o(y,{prop:"username"},{default:s(()=>[b((m(),x(w,{modelValue:e(l).username,"onUpdate:modelValue":r[0]||(r[0]=c=>e(l).username=c),modelModifiers:{trim:!0},clearable:"",placeholder:e(a)("请输入用户名"),type:"text"},{prefix:s(()=>[o(t,{icon:"user-line"})]),_:1},8,["modelValue","placeholder"])),[[A]])]),_:1}),o(y,{prop:"password"},{default:s(()=>[o(w,{ref_key:"passwordRef",ref:E,modelValue:e(l).password,"onUpdate:modelValue":r[1]||(r[1]=c=>e(l).password=c),modelModifiers:{trim:!0},clearable:"",placeholder:e(a)("请输入密码"),"show-password":"",type:e(N)},{prefix:s(()=>[o(t,{icon:"lock-line"})]),_:1},8,["modelValue","placeholder","type"])]),_:1}),o(y,{prop:"verificationCode"},{default:s(()=>[o(w,{modelValue:e(l).verificationCode,"onUpdate:modelValue":r[2]||(r[2]=c=>e(l).verificationCode=c),modelModifiers:{trim:!0},placeholder:e(a)("验证码")+e(C),type:"text"},{prefix:s(()=>[o(t,{icon:"barcode-box-line"})]),_:1},8,["modelValue","placeholder"]),d("img",{class:"code",src:e(k),onClick:G},null,8,te)]),_:1}),b((m(),x(h,{class:"login-btn",loading:e(f),type:"primary"},{default:s(()=>[V(u(e(a)("登录")),1)]),_:1},8,["loading"])),[[T,g]]),o(S,{to:"/register"},{default:s(()=>[o(h,{style:{"margin-top":"20px","margin-left":"-10px"},type:"primary"},{default:s(()=>[V(u(e(a)("注册")),1)]),_:1})]),_:1}),o(S,{to:"/password"},{default:s(()=>[o(h,{style:{"margin-top":"20px"},text:"",type:"primary"},{default:s(()=>[V(u(e(a)("忘记密码")),1)]),_:1})]),_:1}),b((m(),H("div",re,[o(t,{icon:"wechat-fill",style:{color:"#08c25f"}}),o(t,{icon:"alipay-fill",style:{color:"#226bf3"}}),o(t,{icon:"dingding-fill",style:{color:"#007ef8"}}),o(t,{icon:"qq-fill",style:{color:"#009dff"}}),o(t,{icon:"tiktok-fill",style:{color:"#000000"}}),o(t,{icon:"weibo-fill",style:{color:"#df1e33"}}),o(t,{icon:"github-fill",style:{color:"#151515"}})])),[[T,g]])]),_:1},8,["model","rules"])])]),_:1})}}}),de=W(se,[["__scopeId","data-v-2f167483"]]);export{de as default};
