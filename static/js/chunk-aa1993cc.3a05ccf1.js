/*!
 *  build: vue-admin-better 
 *  vue-admin-beautiful.com 
 *  https://gitee.com/chu1204505056/vue-admin-better 
 *  time: 2024-6-26 09:21:57
 */
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-aa1993cc"],{"84e5":function(t,e,n){
/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */
(function(e,n){t.exports=n()})(0,(function(){return function(){var t={686:function(t,e,n){"use strict";n.d(e,{default:function(){return O}});var i=n(279),o=n.n(i),a=n(370),r=n.n(a),s=n(817),l=n.n(s);function u(t){try{return document.execCommand(t)}catch(e){return!1}}var h=function(t){var e=l()(t);return u("cut"),e},c=h;function p(t){var e="rtl"===document.documentElement.getAttribute("dir"),n=document.createElement("textarea");n.style.fontSize="12pt",n.style.border="0",n.style.padding="0",n.style.margin="0",n.style.position="absolute",n.style[e?"right":"left"]="-9999px";var i=window.pageYOffset||document.documentElement.scrollTop;return n.style.top="".concat(i,"px"),n.setAttribute("readonly",""),n.value=t,n}var d=function(t,e){var n=p(t);e.container.appendChild(n);var i=l()(n);return u("copy"),n.remove(),i},v=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body},n="";return"string"===typeof t?n=d(t,e):t instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(null===t||void 0===t?void 0:t.type)?n=d(t.value,e):(n=l()(t),u("copy")),n},f=v;function g(t){return g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(t)}var m=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.action,n=void 0===e?"copy":e,i=t.container,o=t.target,a=t.text;if("copy"!==n&&"cut"!==n)throw new Error('Invalid "action" value, use either "copy" or "cut"');if(void 0!==o){if(!o||"object"!==g(o)||1!==o.nodeType)throw new Error('Invalid "target" value, use a valid Element');if("copy"===n&&o.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if("cut"===n&&(o.hasAttribute("readonly")||o.hasAttribute("disabled")))throw new Error('Invalid "target" attribute. You can\'t cut text from elements with "readonly" or "disabled" attributes')}return a?f(a,{container:i}):o?"cut"===n?c(o):f(o,{container:i}):void 0},y=m;function x(t){return x="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},x(t)}function b(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function w(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function _(t,e,n){return e&&w(t.prototype,e),n&&w(t,n),t}function E(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&S(t,e)}function S(t,e){return S=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},S(t,e)}function C(t){var e=L();return function(){var n,i=P(t);if(e){var o=P(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return k(this,n)}}function k(t,e){return!e||"object"!==x(e)&&"function"!==typeof e?M(t):e}function M(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function L(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function P(t){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},P(t)}function T(t,e){var n="data-clipboard-".concat(t);if(e.hasAttribute(n))return e.getAttribute(n)}var D=function(t){E(n,t);var e=C(n);function n(t,i){var o;return b(this,n),o=e.call(this),o.resolveOptions(i),o.listenClick(t),o}return _(n,[{key:"resolveOptions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.action="function"===typeof t.action?t.action:this.defaultAction,this.target="function"===typeof t.target?t.target:this.defaultTarget,this.text="function"===typeof t.text?t.text:this.defaultText,this.container="object"===x(t.container)?t.container:document.body}},{key:"listenClick",value:function(t){var e=this;this.listener=r()(t,"click",(function(t){return e.onClick(t)}))}},{key:"onClick",value:function(t){var e=t.delegateTarget||t.currentTarget,n=this.action(e)||"copy",i=y({action:n,container:this.container,target:this.target(e),text:this.text(e)});this.emit(i?"success":"error",{action:n,text:i,trigger:e,clearSelection:function(){e&&e.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(t){return T("action",t)}},{key:"defaultTarget",value:function(t){var e=T("target",t);if(e)return document.querySelector(e)}},{key:"defaultText",value:function(t){return T("text",t)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{container:document.body};return f(t,e)}},{key:"cut",value:function(t){return c(t)}},{key:"isSupported",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:["copy","cut"],e="string"===typeof t?[t]:t,n=!!document.queryCommandSupported;return e.forEach((function(t){n=n&&!!document.queryCommandSupported(t)})),n}}]),n}(o()),O=D},828:function(t){var e=9;if("undefined"!==typeof Element&&!Element.prototype.matches){var n=Element.prototype;n.matches=n.matchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector||n.webkitMatchesSelector}function i(t,n){while(t&&t.nodeType!==e){if("function"===typeof t.matches&&t.matches(n))return t;t=t.parentNode}}t.exports=i},438:function(t,e,n){var i=n(828);function o(t,e,n,i,o){var a=r.apply(this,arguments);return t.addEventListener(n,a,o),{destroy:function(){t.removeEventListener(n,a,o)}}}function a(t,e,n,i,a){return"function"===typeof t.addEventListener?o.apply(null,arguments):"function"===typeof n?o.bind(null,document).apply(null,arguments):("string"===typeof t&&(t=document.querySelectorAll(t)),Array.prototype.map.call(t,(function(t){return o(t,e,n,i,a)})))}function r(t,e,n,o){return function(n){n.delegateTarget=i(n.target,e),n.delegateTarget&&o.call(t,n)}}t.exports=a},879:function(t,e){e.node=function(t){return void 0!==t&&t instanceof HTMLElement&&1===t.nodeType},e.nodeList=function(t){var n=Object.prototype.toString.call(t);return void 0!==t&&("[object NodeList]"===n||"[object HTMLCollection]"===n)&&"length"in t&&(0===t.length||e.node(t[0]))},e.string=function(t){return"string"===typeof t||t instanceof String},e.fn=function(t){var e=Object.prototype.toString.call(t);return"[object Function]"===e}},370:function(t,e,n){var i=n(879),o=n(438);function a(t,e,n){if(!t&&!e&&!n)throw new Error("Missing required arguments");if(!i.string(e))throw new TypeError("Second argument must be a String");if(!i.fn(n))throw new TypeError("Third argument must be a Function");if(i.node(t))return r(t,e,n);if(i.nodeList(t))return s(t,e,n);if(i.string(t))return l(t,e,n);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function r(t,e,n){return t.addEventListener(e,n),{destroy:function(){t.removeEventListener(e,n)}}}function s(t,e,n){return Array.prototype.forEach.call(t,(function(t){t.addEventListener(e,n)})),{destroy:function(){Array.prototype.forEach.call(t,(function(t){t.removeEventListener(e,n)}))}}}function l(t,e,n){return o(document.body,t,e,n)}t.exports=a},817:function(t){function e(t){var e;if("SELECT"===t.nodeName)t.focus(),e=t.value;else if("INPUT"===t.nodeName||"TEXTAREA"===t.nodeName){var n=t.hasAttribute("readonly");n||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),n||t.removeAttribute("readonly"),e=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var i=window.getSelection(),o=document.createRange();o.selectNodeContents(t),i.removeAllRanges(),i.addRange(o),e=i.toString()}return e}t.exports=e},279:function(t){function e(){}e.prototype={on:function(t,e,n){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:n}),this},once:function(t,e,n){var i=this;function o(){i.off(t,o),e.apply(n,arguments)}return o._=e,this.on(t,o,n)},emit:function(t){var e=[].slice.call(arguments,1),n=((this.e||(this.e={}))[t]||[]).slice(),i=0,o=n.length;for(i;i<o;i++)n[i].fn.apply(n[i].ctx,e);return this},off:function(t,e){var n=this.e||(this.e={}),i=n[t],o=[];if(i&&e)for(var a=0,r=i.length;a<r;a++)i[a].fn!==e&&i[a].fn._!==e&&o.push(i[a]);return o.length?n[t]=o:delete n[t],this}},t.exports=e,t.exports.TinyEmitter=e}},e={};function n(i){if(e[i])return e[i].exports;var o=e[i]={exports:{}};return t[i](o,o.exports,n),o.exports}return function(){n.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return n.d(e,{a:e}),e}}(),function(){n.d=function(t,e){for(var i in e)n.o(e,i)&&!n.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),n(686)}().default}))},a46a:function(t,e,n){"use strict";
/**!
 * Sortable 1.15.2
 * @author	RubaXa   <trash@rubaxa.org>
 * @author	owenm    <owen23355@gmail.com>
 * @license MIT
 */function i(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function o(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?i(Object(n),!0).forEach((function(e){r(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function a(t){return a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"===typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a(t)}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s(){return s=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},s.apply(this,arguments)}function l(t,e){if(null==t)return{};var n,i,o={},a=Object.keys(t);for(i=0;i<a.length;i++)n=a[i],e.indexOf(n)>=0||(o[n]=t[n]);return o}function u(t,e){if(null==t)return{};var n,i,o=l(t,e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);for(i=0;i<a.length;i++)n=a[i],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}var h="1.15.2";function c(t){if("undefined"!==typeof window&&window.navigator)return!!navigator.userAgent.match(t)}var p=c(/(?:Trident.*rv[ :]?11\.|msie|iemobile|Windows Phone)/i),d=c(/Edge/i),v=c(/firefox/i),f=c(/safari/i)&&!c(/chrome/i)&&!c(/android/i),g=c(/iP(ad|od|hone)/i),m=c(/chrome/i)&&c(/android/i),y={capture:!1,passive:!1};function x(t,e,n){t.addEventListener(e,n,!p&&y)}function b(t,e,n){t.removeEventListener(e,n,!p&&y)}function w(t,e){if(e){if(">"===e[0]&&(e=e.substring(1)),t)try{if(t.matches)return t.matches(e);if(t.msMatchesSelector)return t.msMatchesSelector(e);if(t.webkitMatchesSelector)return t.webkitMatchesSelector(e)}catch(n){return!1}return!1}}function _(t){return t.host&&t!==document&&t.host.nodeType?t.host:t.parentNode}function E(t,e,n,i){if(t){n=n||document;do{if(null!=e&&(">"===e[0]?t.parentNode===n&&w(t,e):w(t,e))||i&&t===n)return t;if(t===n)break}while(t=_(t))}return null}var S,C=/\s+/g;function k(t,e,n){if(t&&e)if(t.classList)t.classList[n?"add":"remove"](e);else{var i=(" "+t.className+" ").replace(C," ").replace(" "+e+" "," ");t.className=(i+(n?" "+e:"")).replace(C," ")}}function M(t,e,n){var i=t&&t.style;if(i){if(void 0===n)return document.defaultView&&document.defaultView.getComputedStyle?n=document.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in i||-1!==e.indexOf("webkit")||(e="-webkit-"+e),i[e]=n+("string"===typeof n?"":"px")}}function L(t,e){var n="";if("string"===typeof t)n=t;else do{var i=M(t,"transform");i&&"none"!==i&&(n=i+" "+n)}while(!e&&(t=t.parentNode));var o=window.DOMMatrix||window.WebKitCSSMatrix||window.CSSMatrix||window.MSCSSMatrix;return o&&new o(n)}function P(t,e,n){if(t){var i=t.getElementsByTagName(e),o=0,a=i.length;if(n)for(;o<a;o++)n(i[o],o);return i}return[]}function T(){var t=document.scrollingElement;return t||document.documentElement}function D(t,e,n,i,o){if(t.getBoundingClientRect||t===window){var a,r,s,l,u,h,c;if(t!==window&&t.parentNode&&t!==T()?(a=t.getBoundingClientRect(),r=a.top,s=a.left,l=a.bottom,u=a.right,h=a.height,c=a.width):(r=0,s=0,l=window.innerHeight,u=window.innerWidth,h=window.innerHeight,c=window.innerWidth),(e||n)&&t!==window&&(o=o||t.parentNode,!p))do{if(o&&o.getBoundingClientRect&&("none"!==M(o,"transform")||n&&"static"!==M(o,"position"))){var d=o.getBoundingClientRect();r-=d.top+parseInt(M(o,"border-top-width")),s-=d.left+parseInt(M(o,"border-left-width")),l=r+a.height,u=s+a.width;break}}while(o=o.parentNode);if(i&&t!==window){var v=L(o||t),f=v&&v.a,g=v&&v.d;v&&(r/=g,s/=f,c/=f,h/=g,l=r+h,u=s+c)}return{top:r,left:s,bottom:l,right:u,width:c,height:h}}}function O(t,e,n){var i=B(t,!0),o=D(t)[e];while(i){var a=D(i)[n],r=void 0;if(r="top"===n||"left"===n?o>=a:o<=a,!r)return i;if(i===T())break;i=B(i,!1)}return!1}function A(t,e,n,i){var o=0,a=0,r=t.children;while(a<r.length){if("none"!==r[a].style.display&&r[a]!==$t.ghost&&(i||r[a]!==$t.dragged)&&E(r[a],n.draggable,t,!1)){if(o===e)return r[a];o++}a++}return null}function I(t,e){var n=t.lastElementChild;while(n&&(n===$t.ghost||"none"===M(n,"display")||e&&!w(n,e)))n=n.previousElementSibling;return n||null}function z(t,e){var n=0;if(!t||!t.parentNode)return-1;while(t=t.previousElementSibling)"TEMPLATE"===t.nodeName.toUpperCase()||t===$t.clone||e&&!w(t,e)||n++;return n}function R(t){var e=0,n=0,i=T();if(t)do{var o=L(t),a=o.a,r=o.d;e+=t.scrollLeft*a,n+=t.scrollTop*r}while(t!==i&&(t=t.parentNode));return[e,n]}function F(t,e){for(var n in t)if(t.hasOwnProperty(n))for(var i in e)if(e.hasOwnProperty(i)&&e[i]===t[n][i])return Number(n);return-1}function B(t,e){if(!t||!t.getBoundingClientRect)return T();var n=t,i=!1;do{if(n.clientWidth<n.scrollWidth||n.clientHeight<n.scrollHeight){var o=M(n);if(n.clientWidth<n.scrollWidth&&("auto"==o.overflowX||"scroll"==o.overflowX)||n.clientHeight<n.scrollHeight&&("auto"==o.overflowY||"scroll"==o.overflowY)){if(!n.getBoundingClientRect||n===document.body)return T();if(i||e)return n;i=!0}}}while(n=n.parentNode);return T()}function N(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function j(t,e){return Math.round(t.top)===Math.round(e.top)&&Math.round(t.left)===Math.round(e.left)&&Math.round(t.height)===Math.round(e.height)&&Math.round(t.width)===Math.round(e.width)}function U(t,e){return function(){if(!S){var n=arguments,i=this;1===n.length?t.call(i,n[0]):t.apply(i,n),S=setTimeout((function(){S=void 0}),e)}}}function Z(){clearTimeout(S),S=void 0}function W(t,e,n){t.scrollLeft+=e,t.scrollTop+=n}function H(t){var e=window.Polymer,n=window.jQuery||window.Zepto;return e&&e.dom?e.dom(t).cloneNode(!0):n?n(t).clone(!0)[0]:t.cloneNode(!0)}function Y(t,e,n){var i={};return Array.from(t.children).forEach((function(o){var a,r,s,l;if(E(o,e.draggable,t,!1)&&!o.animated&&o!==n){var u=D(o);i.left=Math.min(null!==(a=i.left)&&void 0!==a?a:1/0,u.left),i.top=Math.min(null!==(r=i.top)&&void 0!==r?r:1/0,u.top),i.right=Math.max(null!==(s=i.right)&&void 0!==s?s:-1/0,u.right),i.bottom=Math.max(null!==(l=i.bottom)&&void 0!==l?l:-1/0,u.bottom)}})),i.width=i.right-i.left,i.height=i.bottom-i.top,i.x=i.left,i.y=i.top,i}var X="Sortable"+(new Date).getTime();function q(){var t,e=[];return{captureAnimationState:function(){if(e=[],this.options.animation){var t=[].slice.call(this.el.children);t.forEach((function(t){if("none"!==M(t,"display")&&t!==$t.ghost){e.push({target:t,rect:D(t)});var n=o({},e[e.length-1].rect);if(t.thisAnimationDuration){var i=L(t,!0);i&&(n.top-=i.f,n.left-=i.e)}t.fromRect=n}}))}},addAnimationState:function(t){e.push(t)},removeAnimationState:function(t){e.splice(F(e,{target:t}),1)},animateAll:function(n){var i=this;if(!this.options.animation)return clearTimeout(t),void("function"===typeof n&&n());var o=!1,a=0;e.forEach((function(t){var e=0,n=t.target,r=n.fromRect,s=D(n),l=n.prevFromRect,u=n.prevToRect,h=t.rect,c=L(n,!0);c&&(s.top-=c.f,s.left-=c.e),n.toRect=s,n.thisAnimationDuration&&j(l,s)&&!j(r,s)&&(h.top-s.top)/(h.left-s.left)===(r.top-s.top)/(r.left-s.left)&&(e=$(h,l,u,i.options)),j(s,r)||(n.prevFromRect=r,n.prevToRect=s,e||(e=i.options.animation),i.animate(n,h,s,e)),e&&(o=!0,a=Math.max(a,e),clearTimeout(n.animationResetTimer),n.animationResetTimer=setTimeout((function(){n.animationTime=0,n.prevFromRect=null,n.fromRect=null,n.prevToRect=null,n.thisAnimationDuration=null}),e),n.thisAnimationDuration=e)})),clearTimeout(t),o?t=setTimeout((function(){"function"===typeof n&&n()}),a):"function"===typeof n&&n(),e=[]},animate:function(t,e,n,i){if(i){M(t,"transition",""),M(t,"transform","");var o=L(this.el),a=o&&o.a,r=o&&o.d,s=(e.left-n.left)/(a||1),l=(e.top-n.top)/(r||1);t.animatingX=!!s,t.animatingY=!!l,M(t,"transform","translate3d("+s+"px,"+l+"px,0)"),this.forRepaintDummy=V(t),M(t,"transition","transform "+i+"ms"+(this.options.easing?" "+this.options.easing:"")),M(t,"transform","translate3d(0,0,0)"),"number"===typeof t.animated&&clearTimeout(t.animated),t.animated=setTimeout((function(){M(t,"transition",""),M(t,"transform",""),t.animated=!1,t.animatingX=!1,t.animatingY=!1}),i)}}}}function V(t){return t.offsetWidth}function $(t,e,n,i){return Math.sqrt(Math.pow(e.top-t.top,2)+Math.pow(e.left-t.left,2))/Math.sqrt(Math.pow(e.top-n.top,2)+Math.pow(e.left-n.left,2))*i.animation}var G=[],J={initializeByDefault:!0},Q={mount:function(t){for(var e in J)J.hasOwnProperty(e)&&!(e in t)&&(t[e]=J[e]);G.forEach((function(e){if(e.pluginName===t.pluginName)throw"Sortable: Cannot mount plugin ".concat(t.pluginName," more than once")})),G.push(t)},pluginEvent:function(t,e,n){var i=this;this.eventCanceled=!1,n.cancel=function(){i.eventCanceled=!0};var a=t+"Global";G.forEach((function(i){e[i.pluginName]&&(e[i.pluginName][a]&&e[i.pluginName][a](o({sortable:e},n)),e.options[i.pluginName]&&e[i.pluginName][t]&&e[i.pluginName][t](o({sortable:e},n)))}))},initializePlugins:function(t,e,n,i){for(var o in G.forEach((function(i){var o=i.pluginName;if(t.options[o]||i.initializeByDefault){var a=new i(t,e,t.options);a.sortable=t,a.options=t.options,t[o]=a,s(n,a.defaults)}})),t.options)if(t.options.hasOwnProperty(o)){var a=this.modifyOption(t,o,t.options[o]);"undefined"!==typeof a&&(t.options[o]=a)}},getEventProperties:function(t,e){var n={};return G.forEach((function(i){"function"===typeof i.eventProperties&&s(n,i.eventProperties.call(e[i.pluginName],t))})),n},modifyOption:function(t,e,n){var i;return G.forEach((function(o){t[o.pluginName]&&o.optionListeners&&"function"===typeof o.optionListeners[e]&&(i=o.optionListeners[e].call(t[o.pluginName],n))})),i}};function K(t){var e=t.sortable,n=t.rootEl,i=t.name,a=t.targetEl,r=t.cloneEl,s=t.toEl,l=t.fromEl,u=t.oldIndex,h=t.newIndex,c=t.oldDraggableIndex,v=t.newDraggableIndex,f=t.originalEvent,g=t.putSortable,m=t.extraEventProperties;if(e=e||n&&n[X],e){var y,x=e.options,b="on"+i.charAt(0).toUpperCase()+i.substr(1);!window.CustomEvent||p||d?(y=document.createEvent("Event"),y.initEvent(i,!0,!0)):y=new CustomEvent(i,{bubbles:!0,cancelable:!0}),y.to=s||n,y.from=l||n,y.item=a||n,y.clone=r,y.oldIndex=u,y.newIndex=h,y.oldDraggableIndex=c,y.newDraggableIndex=v,y.originalEvent=f,y.pullMode=g?g.lastPutMode:void 0;var w=o(o({},m),Q.getEventProperties(i,e));for(var _ in w)y[_]=w[_];n&&n.dispatchEvent(y),x[b]&&x[b].call(e,y)}}var tt=["evt"],et=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.evt,a=u(n,tt);Q.pluginEvent.bind($t)(t,e,o({dragEl:it,parentEl:ot,ghostEl:at,rootEl:rt,nextEl:st,lastDownEl:lt,cloneEl:ut,cloneHidden:ht,dragStarted:Et,putSortable:gt,activeSortable:$t.active,originalEvent:i,oldIndex:ct,oldDraggableIndex:dt,newIndex:pt,newDraggableIndex:vt,hideGhostForTarget:Yt,unhideGhostForTarget:Xt,cloneNowHidden:function(){ht=!0},cloneNowShown:function(){ht=!1},dispatchSortableEvent:function(t){nt({sortable:e,name:t,originalEvent:i})}},a))};function nt(t){K(o({putSortable:gt,cloneEl:ut,targetEl:it,rootEl:rt,oldIndex:ct,oldDraggableIndex:dt,newIndex:pt,newDraggableIndex:vt},t))}var it,ot,at,rt,st,lt,ut,ht,ct,pt,dt,vt,ft,gt,mt,yt,xt,bt,wt,_t,Et,St,Ct,kt,Mt,Lt=!1,Pt=!1,Tt=[],Dt=!1,Ot=!1,At=[],It=!1,zt=[],Rt="undefined"!==typeof document,Ft=g,Bt=d||p?"cssFloat":"float",Nt=Rt&&!m&&!g&&"draggable"in document.createElement("div"),jt=function(){if(Rt){if(p)return!1;var t=document.createElement("x");return t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}}(),Ut=function(t,e){var n=M(t),i=parseInt(n.width)-parseInt(n.paddingLeft)-parseInt(n.paddingRight)-parseInt(n.borderLeftWidth)-parseInt(n.borderRightWidth),o=A(t,0,e),a=A(t,1,e),r=o&&M(o),s=a&&M(a),l=r&&parseInt(r.marginLeft)+parseInt(r.marginRight)+D(o).width,u=s&&parseInt(s.marginLeft)+parseInt(s.marginRight)+D(a).width;if("flex"===n.display)return"column"===n.flexDirection||"column-reverse"===n.flexDirection?"vertical":"horizontal";if("grid"===n.display)return n.gridTemplateColumns.split(" ").length<=1?"vertical":"horizontal";if(o&&r["float"]&&"none"!==r["float"]){var h="left"===r["float"]?"left":"right";return!a||"both"!==s.clear&&s.clear!==h?"horizontal":"vertical"}return o&&("block"===r.display||"flex"===r.display||"table"===r.display||"grid"===r.display||l>=i&&"none"===n[Bt]||a&&"none"===n[Bt]&&l+u>i)?"vertical":"horizontal"},Zt=function(t,e,n){var i=n?t.left:t.top,o=n?t.right:t.bottom,a=n?t.width:t.height,r=n?e.left:e.top,s=n?e.right:e.bottom,l=n?e.width:e.height;return i===r||o===s||i+a/2===r+l/2},Wt=function(t,e){var n;return Tt.some((function(i){var o=i[X].options.emptyInsertThreshold;if(o&&!I(i)){var a=D(i),r=t>=a.left-o&&t<=a.right+o,s=e>=a.top-o&&e<=a.bottom+o;return r&&s?n=i:void 0}})),n},Ht=function(t){function e(t,n){return function(i,o,a,r){var s=i.options.group.name&&o.options.group.name&&i.options.group.name===o.options.group.name;if(null==t&&(n||s))return!0;if(null==t||!1===t)return!1;if(n&&"clone"===t)return t;if("function"===typeof t)return e(t(i,o,a,r),n)(i,o,a,r);var l=(n?i:o).options.group.name;return!0===t||"string"===typeof t&&t===l||t.join&&t.indexOf(l)>-1}}var n={},i=t.group;i&&"object"==a(i)||(i={name:i}),n.name=i.name,n.checkPull=e(i.pull,!0),n.checkPut=e(i.put),n.revertClone=i.revertClone,t.group=n},Yt=function(){!jt&&at&&M(at,"display","none")},Xt=function(){!jt&&at&&M(at,"display","")};Rt&&!m&&document.addEventListener("click",(function(t){if(Pt)return t.preventDefault(),t.stopPropagation&&t.stopPropagation(),t.stopImmediatePropagation&&t.stopImmediatePropagation(),Pt=!1,!1}),!0);var qt=function(t){if(it){t=t.touches?t.touches[0]:t;var e=Wt(t.clientX,t.clientY);if(e){var n={};for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.target=n.rootEl=e,n.preventDefault=void 0,n.stopPropagation=void 0,e[X]._onDragOver(n)}}},Vt=function(t){it&&it.parentNode[X]._isOutsideThisEl(t.target)};function $t(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be an HTMLElement, not ".concat({}.toString.call(t));this.el=t,this.options=e=s({},e),t[X]=this;var n={group:null,sort:!0,disabled:!1,store:null,handle:null,draggable:/^[uo]l$/i.test(t.nodeName)?">li":">*",swapThreshold:1,invertSwap:!1,invertedSwapThreshold:null,removeCloneOnHide:!0,direction:function(){return Ut(t,this.options)},ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",dragClass:"sortable-drag",ignore:"a, img",filter:null,preventOnFilter:!0,animation:0,easing:null,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,delayOnTouchOnly:!1,touchStartThreshold:(Number.parseInt?Number:window).parseInt(window.devicePixelRatio,10)||1,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1,fallbackTolerance:0,fallbackOffset:{x:0,y:0},supportPointer:!1!==$t.supportPointer&&"PointerEvent"in window&&!f,emptyInsertThreshold:5};for(var i in Q.initializePlugins(this,t,n),n)!(i in e)&&(e[i]=n[i]);for(var o in Ht(e),this)"_"===o.charAt(0)&&"function"===typeof this[o]&&(this[o]=this[o].bind(this));this.nativeDraggable=!e.forceFallback&&Nt,this.nativeDraggable&&(this.options.touchStartThreshold=1),e.supportPointer?x(t,"pointerdown",this._onTapStart):(x(t,"mousedown",this._onTapStart),x(t,"touchstart",this._onTapStart)),this.nativeDraggable&&(x(t,"dragover",this),x(t,"dragenter",this)),Tt.push(this.el),e.store&&e.store.get&&this.sort(e.store.get(this)||[]),s(this,q())}function Gt(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.cancelable&&t.preventDefault()}function Jt(t,e,n,i,o,a,r,s){var l,u,h=t[X],c=h.options.onMove;return!window.CustomEvent||p||d?(l=document.createEvent("Event"),l.initEvent("move",!0,!0)):l=new CustomEvent("move",{bubbles:!0,cancelable:!0}),l.to=e,l.from=t,l.dragged=n,l.draggedRect=i,l.related=o||e,l.relatedRect=a||D(e),l.willInsertAfter=s,l.originalEvent=r,t.dispatchEvent(l),c&&(u=c.call(h,l,r)),u}function Qt(t){t.draggable=!1}function Kt(){It=!1}function te(t,e,n){var i=D(A(n.el,0,n.options,!0)),o=Y(n.el,n.options,at),a=10;return e?t.clientX<o.left-a||t.clientY<i.top&&t.clientX<i.right:t.clientY<o.top-a||t.clientY<i.bottom&&t.clientX<i.left}function ee(t,e,n){var i=D(I(n.el,n.options.draggable)),o=Y(n.el,n.options,at),a=10;return e?t.clientX>o.right+a||t.clientY>i.bottom&&t.clientX>i.left:t.clientY>o.bottom+a||t.clientX>i.right&&t.clientY>i.top}function ne(t,e,n,i,o,a,r,s){var l=i?t.clientY:t.clientX,u=i?n.height:n.width,h=i?n.top:n.left,c=i?n.bottom:n.right,p=!1;if(!r)if(s&&kt<u*o){if(!Dt&&(1===Ct?l>h+u*a/2:l<c-u*a/2)&&(Dt=!0),Dt)p=!0;else if(1===Ct?l<h+kt:l>c-kt)return-Ct}else if(l>h+u*(1-o)/2&&l<c-u*(1-o)/2)return ie(e);return p=p||r,p&&(l<h+u*a/2||l>c-u*a/2)?l>h+u/2?1:-1:0}function ie(t){return z(it)<z(t)?1:-1}function oe(t){var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,i=0;while(n--)i+=e.charCodeAt(n);return i.toString(36)}function ae(t){zt.length=0;var e=t.getElementsByTagName("input"),n=e.length;while(n--){var i=e[n];i.checked&&zt.push(i)}}function re(t){return setTimeout(t,0)}function se(t){return clearTimeout(t)}$t.prototype={constructor:$t,_isOutsideThisEl:function(t){this.el.contains(t)||t===this.el||(St=null)},_getDirection:function(t,e){return"function"===typeof this.options.direction?this.options.direction.call(this,t,e,it):this.options.direction},_onTapStart:function(t){if(t.cancelable){var e=this,n=this.el,i=this.options,o=i.preventOnFilter,a=t.type,r=t.touches&&t.touches[0]||t.pointerType&&"touch"===t.pointerType&&t,s=(r||t).target,l=t.target.shadowRoot&&(t.path&&t.path[0]||t.composedPath&&t.composedPath()[0])||s,u=i.filter;if(ae(n),!it&&!(/mousedown|pointerdown/.test(a)&&0!==t.button||i.disabled)&&!l.isContentEditable&&(this.nativeDraggable||!f||!s||"SELECT"!==s.tagName.toUpperCase())&&(s=E(s,i.draggable,n,!1),(!s||!s.animated)&&lt!==s)){if(ct=z(s),dt=z(s,i.draggable),"function"===typeof u){if(u.call(this,t,s,this))return nt({sortable:e,rootEl:l,name:"filter",targetEl:s,toEl:n,fromEl:n}),et("filter",e,{evt:t}),void(o&&t.cancelable&&t.preventDefault())}else if(u&&(u=u.split(",").some((function(i){if(i=E(l,i.trim(),n,!1),i)return nt({sortable:e,rootEl:i,name:"filter",targetEl:s,fromEl:n,toEl:n}),et("filter",e,{evt:t}),!0})),u))return void(o&&t.cancelable&&t.preventDefault());i.handle&&!E(l,i.handle,n,!1)||this._prepareDragStart(t,r,s)}}},_prepareDragStart:function(t,e,n){var i,o=this,a=o.el,r=o.options,s=a.ownerDocument;if(n&&!it&&n.parentNode===a){var l=D(n);if(rt=a,it=n,ot=it.parentNode,st=it.nextSibling,lt=n,ft=r.group,$t.dragged=it,mt={target:it,clientX:(e||t).clientX,clientY:(e||t).clientY},wt=mt.clientX-l.left,_t=mt.clientY-l.top,this._lastX=(e||t).clientX,this._lastY=(e||t).clientY,it.style["will-change"]="all",i=function(){et("delayEnded",o,{evt:t}),$t.eventCanceled?o._onDrop():(o._disableDelayedDragEvents(),!v&&o.nativeDraggable&&(it.draggable=!0),o._triggerDragStart(t,e),nt({sortable:o,name:"choose",originalEvent:t}),k(it,r.chosenClass,!0))},r.ignore.split(",").forEach((function(t){P(it,t.trim(),Qt)})),x(s,"dragover",qt),x(s,"mousemove",qt),x(s,"touchmove",qt),x(s,"mouseup",o._onDrop),x(s,"touchend",o._onDrop),x(s,"touchcancel",o._onDrop),v&&this.nativeDraggable&&(this.options.touchStartThreshold=4,it.draggable=!0),et("delayStart",this,{evt:t}),!r.delay||r.delayOnTouchOnly&&!e||this.nativeDraggable&&(d||p))i();else{if($t.eventCanceled)return void this._onDrop();x(s,"mouseup",o._disableDelayedDrag),x(s,"touchend",o._disableDelayedDrag),x(s,"touchcancel",o._disableDelayedDrag),x(s,"mousemove",o._delayedDragTouchMoveHandler),x(s,"touchmove",o._delayedDragTouchMoveHandler),r.supportPointer&&x(s,"pointermove",o._delayedDragTouchMoveHandler),o._dragStartTimer=setTimeout(i,r.delay)}}},_delayedDragTouchMoveHandler:function(t){var e=t.touches?t.touches[0]:t;Math.max(Math.abs(e.clientX-this._lastX),Math.abs(e.clientY-this._lastY))>=Math.floor(this.options.touchStartThreshold/(this.nativeDraggable&&window.devicePixelRatio||1))&&this._disableDelayedDrag()},_disableDelayedDrag:function(){it&&Qt(it),clearTimeout(this._dragStartTimer),this._disableDelayedDragEvents()},_disableDelayedDragEvents:function(){var t=this.el.ownerDocument;b(t,"mouseup",this._disableDelayedDrag),b(t,"touchend",this._disableDelayedDrag),b(t,"touchcancel",this._disableDelayedDrag),b(t,"mousemove",this._delayedDragTouchMoveHandler),b(t,"touchmove",this._delayedDragTouchMoveHandler),b(t,"pointermove",this._delayedDragTouchMoveHandler)},_triggerDragStart:function(t,e){e=e||"touch"==t.pointerType&&t,!this.nativeDraggable||e?this.options.supportPointer?x(document,"pointermove",this._onTouchMove):x(document,e?"touchmove":"mousemove",this._onTouchMove):(x(it,"dragend",this),x(rt,"dragstart",this._onDragStart));try{document.selection?re((function(){document.selection.empty()})):window.getSelection().removeAllRanges()}catch(n){}},_dragStarted:function(t,e){if(Lt=!1,rt&&it){et("dragStarted",this,{evt:e}),this.nativeDraggable&&x(document,"dragover",Vt);var n=this.options;!t&&k(it,n.dragClass,!1),k(it,n.ghostClass,!0),$t.active=this,t&&this._appendGhost(),nt({sortable:this,name:"start",originalEvent:e})}else this._nulling()},_emulateDragOver:function(){if(yt){this._lastX=yt.clientX,this._lastY=yt.clientY,Yt();var t=document.elementFromPoint(yt.clientX,yt.clientY),e=t;while(t&&t.shadowRoot){if(t=t.shadowRoot.elementFromPoint(yt.clientX,yt.clientY),t===e)break;e=t}if(it.parentNode[X]._isOutsideThisEl(t),e)do{if(e[X]){var n=void 0;if(n=e[X]._onDragOver({clientX:yt.clientX,clientY:yt.clientY,target:t,rootEl:e}),n&&!this.options.dragoverBubble)break}t=e}while(e=e.parentNode);Xt()}},_onTouchMove:function(t){if(mt){var e=this.options,n=e.fallbackTolerance,i=e.fallbackOffset,o=t.touches?t.touches[0]:t,a=at&&L(at,!0),r=at&&a&&a.a,s=at&&a&&a.d,l=Ft&&Mt&&R(Mt),u=(o.clientX-mt.clientX+i.x)/(r||1)+(l?l[0]-At[0]:0)/(r||1),h=(o.clientY-mt.clientY+i.y)/(s||1)+(l?l[1]-At[1]:0)/(s||1);if(!$t.active&&!Lt){if(n&&Math.max(Math.abs(o.clientX-this._lastX),Math.abs(o.clientY-this._lastY))<n)return;this._onDragStart(t,!0)}if(at){a?(a.e+=u-(xt||0),a.f+=h-(bt||0)):a={a:1,b:0,c:0,d:1,e:u,f:h};var c="matrix(".concat(a.a,",").concat(a.b,",").concat(a.c,",").concat(a.d,",").concat(a.e,",").concat(a.f,")");M(at,"webkitTransform",c),M(at,"mozTransform",c),M(at,"msTransform",c),M(at,"transform",c),xt=u,bt=h,yt=o}t.cancelable&&t.preventDefault()}},_appendGhost:function(){if(!at){var t=this.options.fallbackOnBody?document.body:rt,e=D(it,!0,Ft,!0,t),n=this.options;if(Ft){Mt=t;while("static"===M(Mt,"position")&&"none"===M(Mt,"transform")&&Mt!==document)Mt=Mt.parentNode;Mt!==document.body&&Mt!==document.documentElement?(Mt===document&&(Mt=T()),e.top+=Mt.scrollTop,e.left+=Mt.scrollLeft):Mt=T(),At=R(Mt)}at=it.cloneNode(!0),k(at,n.ghostClass,!1),k(at,n.fallbackClass,!0),k(at,n.dragClass,!0),M(at,"transition",""),M(at,"transform",""),M(at,"box-sizing","border-box"),M(at,"margin",0),M(at,"top",e.top),M(at,"left",e.left),M(at,"width",e.width),M(at,"height",e.height),M(at,"opacity","0.8"),M(at,"position",Ft?"absolute":"fixed"),M(at,"zIndex","100000"),M(at,"pointerEvents","none"),$t.ghost=at,t.appendChild(at),M(at,"transform-origin",wt/parseInt(at.style.width)*100+"% "+_t/parseInt(at.style.height)*100+"%")}},_onDragStart:function(t,e){var n=this,i=t.dataTransfer,o=n.options;et("dragStart",this,{evt:t}),$t.eventCanceled?this._onDrop():(et("setupClone",this),$t.eventCanceled||(ut=H(it),ut.removeAttribute("id"),ut.draggable=!1,ut.style["will-change"]="",this._hideClone(),k(ut,this.options.chosenClass,!1),$t.clone=ut),n.cloneId=re((function(){et("clone",n),$t.eventCanceled||(n.options.removeCloneOnHide||rt.insertBefore(ut,it),n._hideClone(),nt({sortable:n,name:"clone"}))})),!e&&k(it,o.dragClass,!0),e?(Pt=!0,n._loopId=setInterval(n._emulateDragOver,50)):(b(document,"mouseup",n._onDrop),b(document,"touchend",n._onDrop),b(document,"touchcancel",n._onDrop),i&&(i.effectAllowed="move",o.setData&&o.setData.call(n,i,it)),x(document,"drop",n),M(it,"transform","translateZ(0)")),Lt=!0,n._dragStartId=re(n._dragStarted.bind(n,e,t)),x(document,"selectstart",n),Et=!0,f&&M(document.body,"user-select","none"))},_onDragOver:function(t){var e,n,i,a,r=this.el,s=t.target,l=this.options,u=l.group,h=$t.active,c=ft===u,p=l.sort,d=gt||h,v=this,f=!1;if(!It){if(void 0!==t.preventDefault&&t.cancelable&&t.preventDefault(),s=E(s,l.draggable,r,!0),B("dragOver"),$t.eventCanceled)return f;if(it.contains(t.target)||s.animated&&s.animatingX&&s.animatingY||v._ignoreWhileAnimating===s)return j(!1);if(Pt=!1,h&&!l.disabled&&(c?p||(i=ot!==rt):gt===this||(this.lastPutMode=ft.checkPull(this,h,it,t))&&u.checkPut(this,h,it,t))){if(a="vertical"===this._getDirection(t,s),e=D(it),B("dragOverValid"),$t.eventCanceled)return f;if(i)return ot=rt,N(),this._hideClone(),B("revert"),$t.eventCanceled||(st?rt.insertBefore(it,st):rt.appendChild(it)),j(!0);var g=I(r,l.draggable);if(!g||ee(t,a,this)&&!g.animated){if(g===it)return j(!1);if(g&&r===t.target&&(s=g),s&&(n=D(s)),!1!==Jt(rt,r,it,e,s,n,t,!!s))return N(),g&&g.nextSibling?r.insertBefore(it,g.nextSibling):r.appendChild(it),ot=r,U(),j(!0)}else if(g&&te(t,a,this)){var m=A(r,0,l,!0);if(m===it)return j(!1);if(s=m,n=D(s),!1!==Jt(rt,r,it,e,s,n,t,!1))return N(),r.insertBefore(it,m),ot=r,U(),j(!0)}else if(s.parentNode===r){n=D(s);var y,x,b=0,w=it.parentNode!==r,_=!Zt(it.animated&&it.toRect||e,s.animated&&s.toRect||n,a),S=a?"top":"left",C=O(s,"top","top")||O(it,"top","top"),L=C?C.scrollTop:void 0;if(St!==s&&(y=n[S],Dt=!1,Ot=!_&&l.invertSwap||w),b=ne(t,s,n,a,_?1:l.swapThreshold,null==l.invertedSwapThreshold?l.swapThreshold:l.invertedSwapThreshold,Ot,St===s),0!==b){var P=z(it);do{P-=b,x=ot.children[P]}while(x&&("none"===M(x,"display")||x===at))}if(0===b||x===s)return j(!1);St=s,Ct=b;var T=s.nextElementSibling,R=!1;R=1===b;var F=Jt(rt,r,it,e,s,n,t,R);if(!1!==F)return 1!==F&&-1!==F||(R=1===F),It=!0,setTimeout(Kt,30),N(),R&&!T?r.appendChild(it):s.parentNode.insertBefore(it,R?T:s),C&&W(C,0,L-C.scrollTop),ot=it.parentNode,void 0===y||Ot||(kt=Math.abs(y-D(s)[S])),U(),j(!0)}if(r.contains(it))return j(!1)}return!1}function B(l,u){et(l,v,o({evt:t,isOwner:c,axis:a?"vertical":"horizontal",revert:i,dragRect:e,targetRect:n,canSort:p,fromSortable:d,target:s,completed:j,onMove:function(n,i){return Jt(rt,r,it,e,n,D(n),t,i)},changed:U},u))}function N(){B("dragOverAnimationCapture"),v.captureAnimationState(),v!==d&&d.captureAnimationState()}function j(e){return B("dragOverCompleted",{insertion:e}),e&&(c?h._hideClone():h._showClone(v),v!==d&&(k(it,gt?gt.options.ghostClass:h.options.ghostClass,!1),k(it,l.ghostClass,!0)),gt!==v&&v!==$t.active?gt=v:v===$t.active&&gt&&(gt=null),d===v&&(v._ignoreWhileAnimating=s),v.animateAll((function(){B("dragOverAnimationComplete"),v._ignoreWhileAnimating=null})),v!==d&&(d.animateAll(),d._ignoreWhileAnimating=null)),(s===it&&!it.animated||s===r&&!s.animated)&&(St=null),l.dragoverBubble||t.rootEl||s===document||(it.parentNode[X]._isOutsideThisEl(t.target),!e&&qt(t)),!l.dragoverBubble&&t.stopPropagation&&t.stopPropagation(),f=!0}function U(){pt=z(it),vt=z(it,l.draggable),nt({sortable:v,name:"change",toEl:r,newIndex:pt,newDraggableIndex:vt,originalEvent:t})}},_ignoreWhileAnimating:null,_offMoveEvents:function(){b(document,"mousemove",this._onTouchMove),b(document,"touchmove",this._onTouchMove),b(document,"pointermove",this._onTouchMove),b(document,"dragover",qt),b(document,"mousemove",qt),b(document,"touchmove",qt)},_offUpEvents:function(){var t=this.el.ownerDocument;b(t,"mouseup",this._onDrop),b(t,"touchend",this._onDrop),b(t,"pointerup",this._onDrop),b(t,"touchcancel",this._onDrop),b(document,"selectstart",this)},_onDrop:function(t){var e=this.el,n=this.options;pt=z(it),vt=z(it,n.draggable),et("drop",this,{evt:t}),ot=it&&it.parentNode,pt=z(it),vt=z(it,n.draggable),$t.eventCanceled||(Lt=!1,Ot=!1,Dt=!1,clearInterval(this._loopId),clearTimeout(this._dragStartTimer),se(this.cloneId),se(this._dragStartId),this.nativeDraggable&&(b(document,"drop",this),b(e,"dragstart",this._onDragStart)),this._offMoveEvents(),this._offUpEvents(),f&&M(document.body,"user-select",""),M(it,"transform",""),t&&(Et&&(t.cancelable&&t.preventDefault(),!n.dropBubble&&t.stopPropagation()),at&&at.parentNode&&at.parentNode.removeChild(at),(rt===ot||gt&&"clone"!==gt.lastPutMode)&&ut&&ut.parentNode&&ut.parentNode.removeChild(ut),it&&(this.nativeDraggable&&b(it,"dragend",this),Qt(it),it.style["will-change"]="",Et&&!Lt&&k(it,gt?gt.options.ghostClass:this.options.ghostClass,!1),k(it,this.options.chosenClass,!1),nt({sortable:this,name:"unchoose",toEl:ot,newIndex:null,newDraggableIndex:null,originalEvent:t}),rt!==ot?(pt>=0&&(nt({rootEl:ot,name:"add",toEl:ot,fromEl:rt,originalEvent:t}),nt({sortable:this,name:"remove",toEl:ot,originalEvent:t}),nt({rootEl:ot,name:"sort",toEl:ot,fromEl:rt,originalEvent:t}),nt({sortable:this,name:"sort",toEl:ot,originalEvent:t})),gt&&gt.save()):pt!==ct&&pt>=0&&(nt({sortable:this,name:"update",toEl:ot,originalEvent:t}),nt({sortable:this,name:"sort",toEl:ot,originalEvent:t})),$t.active&&(null!=pt&&-1!==pt||(pt=ct,vt=dt),nt({sortable:this,name:"end",toEl:ot,originalEvent:t}),this.save())))),this._nulling()},_nulling:function(){et("nulling",this),rt=it=ot=at=st=ut=lt=ht=mt=yt=Et=pt=vt=ct=dt=St=Ct=gt=ft=$t.dragged=$t.ghost=$t.clone=$t.active=null,zt.forEach((function(t){t.checked=!0})),zt.length=xt=bt=0},handleEvent:function(t){switch(t.type){case"drop":case"dragend":this._onDrop(t);break;case"dragenter":case"dragover":it&&(this._onDragOver(t),Gt(t));break;case"selectstart":t.preventDefault();break}},toArray:function(){for(var t,e=[],n=this.el.children,i=0,o=n.length,a=this.options;i<o;i++)t=n[i],E(t,a.draggable,this.el,!1)&&e.push(t.getAttribute(a.dataIdAttr)||oe(t));return e},sort:function(t,e){var n={},i=this.el;this.toArray().forEach((function(t,e){var o=i.children[e];E(o,this.options.draggable,i,!1)&&(n[t]=o)}),this),e&&this.captureAnimationState(),t.forEach((function(t){n[t]&&(i.removeChild(n[t]),i.appendChild(n[t]))})),e&&this.animateAll()},save:function(){var t=this.options.store;t&&t.set&&t.set(this)},closest:function(t,e){return E(t,e||this.options.draggable,this.el,!1)},option:function(t,e){var n=this.options;if(void 0===e)return n[t];var i=Q.modifyOption(this,t,e);n[t]="undefined"!==typeof i?i:e,"group"===t&&Ht(n)},destroy:function(){et("destroy",this);var t=this.el;t[X]=null,b(t,"mousedown",this._onTapStart),b(t,"touchstart",this._onTapStart),b(t,"pointerdown",this._onTapStart),this.nativeDraggable&&(b(t,"dragover",this),b(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),(function(t){t.removeAttribute("draggable")})),this._onDrop(),this._disableDelayedDragEvents(),Tt.splice(Tt.indexOf(this.el),1),this.el=t=null},_hideClone:function(){if(!ht){if(et("hideClone",this),$t.eventCanceled)return;M(ut,"display","none"),this.options.removeCloneOnHide&&ut.parentNode&&ut.parentNode.removeChild(ut),ht=!0}},_showClone:function(t){if("clone"===t.lastPutMode){if(ht){if(et("showClone",this),$t.eventCanceled)return;it.parentNode!=rt||this.options.group.revertClone?st?rt.insertBefore(ut,st):rt.appendChild(ut):rt.insertBefore(ut,it),this.options.group.revertClone&&this.animate(it,ut),M(ut,"display",""),ht=!1}}else this._hideClone()}},Rt&&x(document,"touchmove",(function(t){($t.active||Lt)&&t.cancelable&&t.preventDefault()})),$t.utils={on:x,off:b,css:M,find:P,is:function(t,e){return!!E(t,e,t,!1)},extend:N,throttle:U,closest:E,toggleClass:k,clone:H,index:z,nextTick:re,cancelNextTick:se,detectDirection:Ut,getChild:A},$t.get=function(t){return t[X]},$t.mount=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];e[0].constructor===Array&&(e=e[0]),e.forEach((function(t){if(!t.prototype||!t.prototype.constructor)throw"Sortable: Mounted plugin must be a constructor function, not ".concat({}.toString.call(t));t.utils&&($t.utils=o(o({},$t.utils),t.utils)),Q.mount(t)}))},$t.create=function(t,e){return new $t(t,e)},$t.version=h;var le,ue,he,ce,pe,de,ve=[],fe=!1;function ge(){function t(){for(var t in this.defaults={scroll:!0,forceAutoScrollFallback:!1,scrollSensitivity:30,scrollSpeed:10,bubbleScroll:!0},this)"_"===t.charAt(0)&&"function"===typeof this[t]&&(this[t]=this[t].bind(this))}return t.prototype={dragStarted:function(t){var e=t.originalEvent;this.sortable.nativeDraggable?x(document,"dragover",this._handleAutoScroll):this.options.supportPointer?x(document,"pointermove",this._handleFallbackAutoScroll):e.touches?x(document,"touchmove",this._handleFallbackAutoScroll):x(document,"mousemove",this._handleFallbackAutoScroll)},dragOverCompleted:function(t){var e=t.originalEvent;this.options.dragOverBubble||e.rootEl||this._handleAutoScroll(e)},drop:function(){this.sortable.nativeDraggable?b(document,"dragover",this._handleAutoScroll):(b(document,"pointermove",this._handleFallbackAutoScroll),b(document,"touchmove",this._handleFallbackAutoScroll),b(document,"mousemove",this._handleFallbackAutoScroll)),ye(),me(),Z()},nulling:function(){pe=ue=le=fe=de=he=ce=null,ve.length=0},_handleFallbackAutoScroll:function(t){this._handleAutoScroll(t,!0)},_handleAutoScroll:function(t,e){var n=this,i=(t.touches?t.touches[0]:t).clientX,o=(t.touches?t.touches[0]:t).clientY,a=document.elementFromPoint(i,o);if(pe=t,e||this.options.forceAutoScrollFallback||d||p||f){xe(t,this.options,a,e);var r=B(a,!0);!fe||de&&i===he&&o===ce||(de&&ye(),de=setInterval((function(){var a=B(document.elementFromPoint(i,o),!0);a!==r&&(r=a,me()),xe(t,n.options,a,e)}),10),he=i,ce=o)}else{if(!this.options.bubbleScroll||B(a,!0)===T())return void me();xe(t,this.options,B(a,!1),!1)}}},s(t,{pluginName:"scroll",initializeByDefault:!0})}function me(){ve.forEach((function(t){clearInterval(t.pid)})),ve=[]}function ye(){clearInterval(de)}var xe=U((function(t,e,n,i){if(e.scroll){var o,a=(t.touches?t.touches[0]:t).clientX,r=(t.touches?t.touches[0]:t).clientY,s=e.scrollSensitivity,l=e.scrollSpeed,u=T(),h=!1;ue!==n&&(ue=n,me(),le=e.scroll,o=e.scrollFn,!0===le&&(le=B(n,!0)));var c=0,p=le;do{var d=p,v=D(d),f=v.top,g=v.bottom,m=v.left,y=v.right,x=v.width,b=v.height,w=void 0,_=void 0,E=d.scrollWidth,S=d.scrollHeight,C=M(d),k=d.scrollLeft,L=d.scrollTop;d===u?(w=x<E&&("auto"===C.overflowX||"scroll"===C.overflowX||"visible"===C.overflowX),_=b<S&&("auto"===C.overflowY||"scroll"===C.overflowY||"visible"===C.overflowY)):(w=x<E&&("auto"===C.overflowX||"scroll"===C.overflowX),_=b<S&&("auto"===C.overflowY||"scroll"===C.overflowY));var P=w&&(Math.abs(y-a)<=s&&k+x<E)-(Math.abs(m-a)<=s&&!!k),O=_&&(Math.abs(g-r)<=s&&L+b<S)-(Math.abs(f-r)<=s&&!!L);if(!ve[c])for(var A=0;A<=c;A++)ve[A]||(ve[A]={});ve[c].vx==P&&ve[c].vy==O&&ve[c].el===d||(ve[c].el=d,ve[c].vx=P,ve[c].vy=O,clearInterval(ve[c].pid),0==P&&0==O||(h=!0,ve[c].pid=setInterval(function(){i&&0===this.layer&&$t.active._onTouchMove(pe);var e=ve[this.layer].vy?ve[this.layer].vy*l:0,n=ve[this.layer].vx?ve[this.layer].vx*l:0;"function"===typeof o&&"continue"!==o.call($t.dragged.parentNode[X],n,e,t,pe,ve[this.layer].el)||W(ve[this.layer].el,n,e)}.bind({layer:c}),24))),c++}while(e.bubbleScroll&&p!==u&&(p=B(p,!1)));fe=h}}),30),be=function(t){var e=t.originalEvent,n=t.putSortable,i=t.dragEl,o=t.activeSortable,a=t.dispatchSortableEvent,r=t.hideGhostForTarget,s=t.unhideGhostForTarget;if(e){var l=n||o;r();var u=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:e,h=document.elementFromPoint(u.clientX,u.clientY);s(),l&&!l.el.contains(h)&&(a("spill"),this.onSpill({dragEl:i,putSortable:n}))}};function we(){}function _e(){}we.prototype={startIndex:null,dragStart:function(t){var e=t.oldDraggableIndex;this.startIndex=e},onSpill:function(t){var e=t.dragEl,n=t.putSortable;this.sortable.captureAnimationState(),n&&n.captureAnimationState();var i=A(this.sortable.el,this.startIndex,this.options);i?this.sortable.el.insertBefore(e,i):this.sortable.el.appendChild(e),this.sortable.animateAll(),n&&n.animateAll()},drop:be},s(we,{pluginName:"revertOnSpill"}),_e.prototype={onSpill:function(t){var e=t.dragEl,n=t.putSortable,i=n||this.sortable;i.captureAnimationState(),e.parentNode&&e.parentNode.removeChild(e),i.animateAll()},drop:be},s(_e,{pluginName:"removeOnSpill"});$t.mount(new ge),$t.mount(_e,we),e["a"]=$t},d60d:function(t,e,n){(function(t,n){(function(t,n){n(e)})(0,(function(e){"use strict";var i="2.0.62",o=function(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)},a=function(t){var e=window.devicePixelRatio||1;t.canvas.width=t.canvas.width*e,t.canvas.height=t.canvas.height*e,t.canvas.style.width=t.canvas.width/e+"px",t.canvas.style.height=t.canvas.height/e+"px",t.scale(e,e)};function r(){this._subscribers={}}r.prototype.on=function(t,e){var n=this._subscribers[t];n||(n=[],this._subscribers[t]=n),n.push({callback:e})},r.prototype.off=function(t,e){var n=this._subscribers[t];if(n)for(var i=0;i<n.length;i++)n[i].callback==e&&(n.splice(i,1),i--)},r.prototype._trigger=function(t,e,n){if("*"==t)throw new Error("Cannot trigger event *");var i=[];t in this._subscribers&&(i=i.concat(this._subscribers[t])),"*"in this._subscribers&&(i=i.concat(this._subscribers["*"]));for(var o=0,a=i.length;o<a;o++){var r=i[o];r.callback&&r.callback(t,e,n||null)}};var s={municipalities:[{n:"北京",g:"116.395645,39.929986|12"},{n:"上海",g:"121.487899,31.249162|12"},{n:"天津",g:"117.210813,39.14393|12"},{n:"重庆",g:"106.530635,29.544606|12"}],provinces:[{n:"安徽",g:"117.216005,31.859252|8",cities:[{n:"合肥",g:"117.282699,31.866942|12"},{n:"安庆",g:"117.058739,30.537898|13"},{n:"蚌埠",g:"117.35708,32.929499|13"},{n:"亳州",g:"115.787928,33.871211|13"},{n:"巢湖",g:"117.88049,31.608733|13"},{n:"池州",g:"117.494477,30.660019|14"},{n:"滁州",g:"118.32457,32.317351|13"},{n:"阜阳",g:"115.820932,32.901211|13"},{n:"淮北",g:"116.791447,33.960023|13"},{n:"淮南",g:"117.018639,32.642812|13"},{n:"黄山",g:"118.29357,29.734435|13"},{n:"六安",g:"116.505253,31.755558|13"},{n:"马鞍山",g:"118.515882,31.688528|13"},{n:"宿州",g:"116.988692,33.636772|13"},{n:"铜陵",g:"117.819429,30.94093|14"},{n:"芜湖",g:"118.384108,31.36602|12"},{n:"宣城",g:"118.752096,30.951642|13"}]},{n:"福建",g:"117.984943,26.050118|8",cities:[{n:"福州",g:"119.330221,26.047125|12"},{n:"龙岩",g:"117.017997,25.078685|13"},{n:"南平",g:"118.181883,26.643626|13"},{n:"宁德",g:"119.542082,26.656527|14"},{n:"莆田",g:"119.077731,25.44845|13"},{n:"泉州",g:"118.600362,24.901652|12"},{n:"三明",g:"117.642194,26.270835|14"},{n:"厦门",g:"118.103886,24.489231|12"},{n:"漳州",g:"117.676205,24.517065|12"}]},{n:"甘肃",g:"102.457625,38.103267|6",cities:[{n:"兰州",g:"103.823305,36.064226|12"},{n:"白银",g:"104.171241,36.546682|13"},{n:"定西",g:"104.626638,35.586056|13"},{n:"甘南州",g:"102.917442,34.992211|14"},{n:"嘉峪关",g:"98.281635,39.802397|13"},{n:"金昌",g:"102.208126,38.516072|13"},{n:"酒泉",g:"98.508415,39.741474|13"},{n:"临夏州",g:"103.215249,35.598514|13"},{n:"陇南",g:"104.934573,33.39448|14"},{n:"平凉",g:"106.688911,35.55011|13"},{n:"庆阳",g:"107.644227,35.726801|13"},{n:"天水",g:"105.736932,34.584319|13"},{n:"武威",g:"102.640147,37.933172|13"},{n:"张掖",g:"100.459892,38.93932|13"}]},{n:"广东",g:"113.394818,23.408004|8",cities:[{n:"广州",g:"113.30765,23.120049|12"},{n:"潮州",g:"116.630076,23.661812|13"},{n:"东莞",g:"113.763434,23.043024|12"},{n:"佛山",g:"113.134026,23.035095|13"},{n:"河源",g:"114.713721,23.757251|12"},{n:"惠州",g:"114.410658,23.11354|12"},{n:"江门",g:"113.078125,22.575117|13"},{n:"揭阳",g:"116.379501,23.547999|13"},{n:"茂名",g:"110.931245,21.668226|13"},{n:"梅州",g:"116.126403,24.304571|13"},{n:"清远",g:"113.040773,23.698469|13"},{n:"汕头",g:"116.72865,23.383908|13"},{n:"汕尾",g:"115.372924,22.778731|14"},{n:"韶关",g:"113.594461,24.80296|13"},{n:"深圳",g:"114.025974,22.546054|12"},{n:"阳江",g:"111.97701,21.871517|14"},{n:"云浮",g:"112.050946,22.937976|13"},{n:"湛江",g:"110.365067,21.257463|13"},{n:"肇庆",g:"112.479653,23.078663|13"},{n:"中山",g:"113.42206,22.545178|12"},{n:"珠海",g:"113.562447,22.256915|13"}]},{n:"广西",g:"108.924274,23.552255|7",cities:[{n:"南宁",g:"108.297234,22.806493|12"},{n:"百色",g:"106.631821,23.901512|13"},{n:"北海",g:"109.122628,21.472718|13"},{n:"崇左",g:"107.357322,22.415455|14"},{n:"防城港",g:"108.351791,21.617398|15"},{n:"桂林",g:"110.26092,25.262901|12"},{n:"贵港",g:"109.613708,23.103373|13"},{n:"河池",g:"108.069948,24.699521|14"},{n:"贺州",g:"111.552594,24.411054|14"},{n:"来宾",g:"109.231817,23.741166|14"},{n:"柳州",g:"109.422402,24.329053|12"},{n:"钦州",g:"108.638798,21.97335|13"},{n:"梧州",g:"111.305472,23.485395|13"},{n:"玉林",g:"110.151676,22.643974|14"}]},{n:"贵州",g:"106.734996,26.902826|8",cities:[{n:"贵阳",g:"106.709177,26.629907|12"},{n:"安顺",g:"105.92827,26.228595|13"},{n:"毕节地区",g:"105.300492,27.302612|14"},{n:"六盘水",g:"104.852087,26.591866|13"},{n:"铜仁地区",g:"109.196161,27.726271|14"},{n:"遵义",g:"106.93126,27.699961|13"},{n:"黔西南州",g:"104.900558,25.095148|11"},{n:"黔东南州",g:"107.985353,26.583992|11"},{n:"黔南州",g:"107.523205,26.264536|11"}]},{n:"海南",g:"109.733755,19.180501|9",cities:[{n:"海口",g:"110.330802,20.022071|13"},{n:"白沙",g:"109.358586,19.216056|12"},{n:"保亭",g:"109.656113,18.597592|12"},{n:"昌江",g:"109.0113,19.222483|12"},{n:"儋州",g:"109.413973,19.571153|13"},{n:"澄迈",g:"109.996736,19.693135|13"},{n:"东方",g:"108.85101,18.998161|13"},{n:"定安",g:"110.32009,19.490991|13"},{n:"琼海",g:"110.414359,19.21483|13"},{n:"琼中",g:"109.861849,19.039771|12"},{n:"乐东",g:"109.062698,18.658614|12"},{n:"临高",g:"109.724101,19.805922|13"},{n:"陵水",g:"109.948661,18.575985|12"},{n:"三亚",g:"109.522771,18.257776|12"},{n:"屯昌",g:"110.063364,19.347749|13"},{n:"万宁",g:"110.292505,18.839886|13"},{n:"文昌",g:"110.780909,19.750947|13"},{n:"五指山",g:"109.51775,18.831306|13"}]},{n:"河北",g:"115.661434,38.61384|7",cities:[{n:"石家庄",g:"114.522082,38.048958|12"},{n:"保定",g:"115.49481,38.886565|13"},{n:"沧州",g:"116.863806,38.297615|13"},{n:"承德",g:"117.933822,40.992521|14"},{n:"邯郸",g:"114.482694,36.609308|13"},{n:"衡水",g:"115.686229,37.746929|13"},{n:"廊坊",g:"116.703602,39.518611|13"},{n:"秦皇岛",g:"119.604368,39.945462|12"},{n:"唐山",g:"118.183451,39.650531|13"},{n:"邢台",g:"114.520487,37.069531|13"},{n:"张家口",g:"114.893782,40.811188|13"}]},{n:"河南",g:"113.486804,34.157184|7",cities:[{n:"郑州",g:"113.649644,34.75661|12"},{n:"安阳",g:"114.351807,36.110267|12"},{n:"鹤壁",g:"114.29777,35.755426|13"},{n:"焦作",g:"113.211836,35.234608|13"},{n:"开封",g:"114.351642,34.801854|13"},{n:"洛阳",g:"112.447525,34.657368|12"},{n:"漯河",g:"114.046061,33.576279|13"},{n:"南阳",g:"112.542842,33.01142|13"},{n:"平顶山",g:"113.300849,33.745301|13"},{n:"濮阳",g:"115.026627,35.753298|12"},{n:"三门峡",g:"111.181262,34.78332|13"},{n:"商丘",g:"115.641886,34.438589|13"},{n:"新乡",g:"113.91269,35.307258|13"},{n:"信阳",g:"114.085491,32.128582|13"},{n:"许昌",g:"113.835312,34.02674|13"},{n:"周口",g:"114.654102,33.623741|13"},{n:"驻马店",g:"114.049154,32.983158|13"}]},{n:"黑龙江",g:"128.047414,47.356592|6",cities:[{n:"哈尔滨",g:"126.657717,45.773225|12"},{n:"大庆",g:"125.02184,46.596709|12"},{n:"大兴安岭地区",g:"124.196104,51.991789|10"},{n:"鹤岗",g:"130.292472,47.338666|13"},{n:"黑河",g:"127.50083,50.25069|14"},{n:"鸡西",g:"130.941767,45.32154|13"},{n:"佳木斯",g:"130.284735,46.81378|12"},{n:"牡丹江",g:"129.608035,44.588521|13"},{n:"七台河",g:"131.019048,45.775005|14"},{n:"齐齐哈尔",g:"123.987289,47.3477|13"},{n:"双鸭山",g:"131.171402,46.655102|13"},{n:"绥化",g:"126.989095,46.646064|13"},{n:"伊春",g:"128.910766,47.734685|14"}]},{n:"湖北",g:"112.410562,31.209316|8",cities:[{n:"武汉",g:"114.3162,30.581084|12"},{n:"鄂州",g:"114.895594,30.384439|14"},{n:"恩施",g:"109.517433,30.308978|14"},{n:"黄冈",g:"114.906618,30.446109|14"},{n:"黄石",g:"115.050683,30.216127|13"},{n:"荆门",g:"112.21733,31.042611|13"},{n:"荆州",g:"112.241866,30.332591|12"},{n:"潜江",g:"112.768768,30.343116|13"},{n:"神农架林区",g:"110.487231,31.595768|13"},{n:"十堰",g:"110.801229,32.636994|13"},{n:"随州",g:"113.379358,31.717858|13"},{n:"天门",g:"113.12623,30.649047|13"},{n:"仙桃",g:"113.387448,30.293966|13"},{n:"咸宁",g:"114.300061,29.880657|13"},{n:"襄阳",g:"112.176326,32.094934|12"},{n:"孝感",g:"113.935734,30.927955|13"},{n:"宜昌",g:"111.310981,30.732758|13"}]},{n:"湖南",g:"111.720664,27.695864|7",cities:[{n:"长沙",g:"112.979353,28.213478|12"},{n:"常德",g:"111.653718,29.012149|12"},{n:"郴州",g:"113.037704,25.782264|13"},{n:"衡阳",g:"112.583819,26.898164|13"},{n:"怀化",g:"109.986959,27.557483|13"},{n:"娄底",g:"111.996396,27.741073|13"},{n:"邵阳",g:"111.461525,27.236811|13"},{n:"湘潭",g:"112.935556,27.835095|13"},{n:"湘西州",g:"109.745746,28.317951|14"},{n:"益阳",g:"112.366547,28.588088|13"},{n:"永州",g:"111.614648,26.435972|13"},{n:"岳阳",g:"113.146196,29.378007|13"},{n:"张家界",g:"110.48162,29.124889|13"},{n:"株洲",g:"113.131695,27.827433|13"}]},{n:"江苏",g:"119.368489,33.013797|8",cities:[{n:"南京",g:"118.778074,32.057236|12"},{n:"常州",g:"119.981861,31.771397|12"},{n:"淮安",g:"119.030186,33.606513|12"},{n:"连云港",g:"119.173872,34.601549|12"},{n:"南通",g:"120.873801,32.014665|12"},{n:"苏州",g:"120.619907,31.317987|12"},{n:"宿迁",g:"118.296893,33.95205|13"},{n:"泰州",g:"119.919606,32.476053|13"},{n:"无锡",g:"120.305456,31.570037|12"},{n:"徐州",g:"117.188107,34.271553|12"},{n:"盐城",g:"120.148872,33.379862|12"},{n:"扬州",g:"119.427778,32.408505|13"},{n:"镇江",g:"119.455835,32.204409|13"}]},{n:"江西",g:"115.676082,27.757258|7",cities:[{n:"南昌",g:"115.893528,28.689578|12"},{n:"抚州",g:"116.360919,27.954545|13"},{n:"赣州",g:"114.935909,25.845296|13"},{n:"吉安",g:"114.992039,27.113848|13"},{n:"景德镇",g:"117.186523,29.303563|12"},{n:"九江",g:"115.999848,29.71964|13"},{n:"萍乡",g:"113.859917,27.639544|13"},{n:"上饶",g:"117.955464,28.457623|13"},{n:"新余",g:"114.947117,27.822322|13"},{n:"宜春",g:"114.400039,27.81113|13"},{n:"鹰潭",g:"117.03545,28.24131|13"}]},{n:"吉林",g:"126.262876,43.678846|7",cities:[{n:"长春",g:"125.313642,43.898338|12"},{n:"白城",g:"122.840777,45.621086|13"},{n:"白山",g:"126.435798,41.945859|13"},{n:"吉林",g:"126.564544,43.871988|12"},{n:"辽源",g:"125.133686,42.923303|13"},{n:"四平",g:"124.391382,43.175525|12"},{n:"松原",g:"124.832995,45.136049|13"},{n:"通化",g:"125.94265,41.736397|13"},{n:"延边",g:"129.485902,42.896414|13"}]},{n:"辽宁",g:"122.753592,41.6216|8",cities:[{n:"沈阳",g:"123.432791,41.808645|12"},{n:"鞍山",g:"123.007763,41.118744|13"},{n:"本溪",g:"123.778062,41.325838|12"},{n:"朝阳",g:"120.446163,41.571828|13"},{n:"大连",g:"121.593478,38.94871|12"},{n:"丹东",g:"124.338543,40.129023|12"},{n:"抚顺",g:"123.92982,41.877304|12"},{n:"阜新",g:"121.660822,42.01925|14"},{n:"葫芦岛",g:"120.860758,40.74303|13"},{n:"锦州",g:"121.147749,41.130879|13"},{n:"辽阳",g:"123.172451,41.273339|14"},{n:"盘锦",g:"122.073228,41.141248|13"},{n:"铁岭",g:"123.85485,42.299757|13"},{n:"营口",g:"122.233391,40.668651|13"}]},{n:"内蒙古",g:"114.415868,43.468238|5",cities:[{n:"呼和浩特",g:"111.660351,40.828319|12"},{n:"阿拉善盟",g:"105.695683,38.843075|14"},{n:"包头",g:"109.846239,40.647119|12"},{n:"巴彦淖尔",g:"107.423807,40.76918|12"},{n:"赤峰",g:"118.930761,42.297112|12"},{n:"鄂尔多斯",g:"109.993706,39.81649|12"},{n:"呼伦贝尔",g:"119.760822,49.201636|12"},{n:"通辽",g:"122.260363,43.633756|12"},{n:"乌海",g:"106.831999,39.683177|13"},{n:"乌兰察布",g:"113.112846,41.022363|12"},{n:"锡林郭勒盟",g:"116.02734,43.939705|11"},{n:"兴安盟",g:"122.048167,46.083757|11"}]},{n:"宁夏",g:"106.155481,37.321323|8",cities:[{n:"银川",g:"106.206479,38.502621|12"},{n:"固原",g:"106.285268,36.021523|13"},{n:"石嘴山",g:"106.379337,39.020223|13"},{n:"吴忠",g:"106.208254,37.993561|14"},{n:"中卫",g:"105.196754,37.521124|14"}]},{n:"青海",g:"96.202544,35.499761|7",cities:[{n:"西宁",g:"101.767921,36.640739|12"},{n:"果洛州",g:"100.223723,34.480485|11"},{n:"海东地区",g:"102.085207,36.51761|11"},{n:"海北州",g:"100.879802,36.960654|11"},{n:"海南州",g:"100.624066,36.284364|11"},{n:"海西州",g:"97.342625,37.373799|11"},{n:"黄南州",g:"102.0076,35.522852|11"},{n:"玉树州",g:"97.013316,33.00624|14"}]},{n:"山东",g:"118.527663,36.09929|8",cities:[{n:"济南",g:"117.024967,36.682785|12"},{n:"滨州",g:"117.968292,37.405314|12"},{n:"东营",g:"118.583926,37.487121|12"},{n:"德州",g:"116.328161,37.460826|12"},{n:"菏泽",g:"115.46336,35.26244|13"},{n:"济宁",g:"116.600798,35.402122|13"},{n:"莱芜",g:"117.684667,36.233654|13"},{n:"聊城",g:"115.986869,36.455829|12"},{n:"临沂",g:"118.340768,35.072409|12"},{n:"青岛",g:"120.384428,36.105215|12"},{n:"日照",g:"119.50718,35.420225|12"},{n:"泰安",g:"117.089415,36.188078|13"},{n:"威海",g:"122.093958,37.528787|13"},{n:"潍坊",g:"119.142634,36.716115|12"},{n:"烟台",g:"121.309555,37.536562|12"},{n:"枣庄",g:"117.279305,34.807883|13"},{n:"淄博",g:"118.059134,36.804685|12"}]},{n:"山西",g:"112.515496,37.866566|7",cities:[{n:"太原",g:"112.550864,37.890277|12"},{n:"长治",g:"113.120292,36.201664|12"},{n:"大同",g:"113.290509,40.113744|12"},{n:"晋城",g:"112.867333,35.499834|13"},{n:"晋中",g:"112.738514,37.693362|13"},{n:"临汾",g:"111.538788,36.099745|13"},{n:"吕梁",g:"111.143157,37.527316|14"},{n:"朔州",g:"112.479928,39.337672|13"},{n:"忻州",g:"112.727939,38.461031|12"},{n:"阳泉",g:"113.569238,37.869529|13"},{n:"运城",g:"111.006854,35.038859|13"}]},{n:"陕西",g:"109.503789,35.860026|7",cities:[{n:"西安",g:"108.953098,34.2778|12"},{n:"安康",g:"109.038045,32.70437|13"},{n:"宝鸡",g:"107.170645,34.364081|12"},{n:"汉中",g:"107.045478,33.081569|13"},{n:"商洛",g:"109.934208,33.873907|13"},{n:"铜川",g:"108.968067,34.908368|13"},{n:"渭南",g:"109.483933,34.502358|13"},{n:"咸阳",g:"108.707509,34.345373|13"},{n:"延安",g:"109.50051,36.60332|13"},{n:"榆林",g:"109.745926,38.279439|12"}]},{n:"四川",g:"102.89916,30.367481|7",cities:[{n:"成都",g:"104.067923,30.679943|12"},{n:"阿坝州",g:"102.228565,31.905763|15"},{n:"巴中",g:"106.757916,31.869189|14"},{n:"达州",g:"107.494973,31.214199|14"},{n:"德阳",g:"104.402398,31.13114|13"},{n:"甘孜州",g:"101.969232,30.055144|15"},{n:"广安",g:"106.63572,30.463984|13"},{n:"广元",g:"105.819687,32.44104|13"},{n:"乐山",g:"103.760824,29.600958|13"},{n:"凉山州",g:"102.259591,27.892393|14"},{n:"泸州",g:"105.44397,28.89593|14"},{n:"南充",g:"106.105554,30.800965|13"},{n:"眉山",g:"103.84143,30.061115|13"},{n:"绵阳",g:"104.705519,31.504701|12"},{n:"内江",g:"105.073056,29.599462|13"},{n:"攀枝花",g:"101.722423,26.587571|14"},{n:"遂宁",g:"105.564888,30.557491|12"},{n:"雅安",g:"103.009356,29.999716|13"},{n:"宜宾",g:"104.633019,28.769675|13"},{n:"资阳",g:"104.63593,30.132191|13"},{n:"自贡",g:"104.776071,29.359157|13"}]},{n:"西藏",g:"89.137982,31.367315|6",cities:[{n:"拉萨",g:"91.111891,29.662557|13"},{n:"阿里地区",g:"81.107669,30.404557|11"},{n:"昌都地区",g:"97.185582,31.140576|15"},{n:"林芝地区",g:"94.349985,29.666941|11"},{n:"那曲地区",g:"92.067018,31.48068|14"},{n:"日喀则地区",g:"88.891486,29.269023|14"},{n:"山南地区",g:"91.750644,29.229027|11"}]},{n:"新疆",g:"85.614899,42.127001|6",cities:[{n:"乌鲁木齐",g:"87.564988,43.84038|12"},{n:"阿拉尔",g:"81.291737,40.61568|13"},{n:"阿克苏地区",g:"80.269846,41.171731|12"},{n:"阿勒泰地区",g:"88.137915,47.839744|13"},{n:"巴音郭楞",g:"86.121688,41.771362|12"},{n:"博尔塔拉州",g:"82.052436,44.913651|11"},{n:"昌吉州",g:"87.296038,44.007058|13"},{n:"哈密地区",g:"93.528355,42.858596|13"},{n:"和田地区",g:"79.930239,37.116774|13"},{n:"喀什地区",g:"75.992973,39.470627|12"},{n:"克拉玛依",g:"84.88118,45.594331|13"},{n:"克孜勒苏州",g:"76.137564,39.750346|11"},{n:"石河子",g:"86.041865,44.308259|13"},{n:"塔城地区",g:"82.974881,46.758684|12"},{n:"图木舒克",g:"79.198155,39.889223|13"},{n:"吐鲁番地区",g:"89.181595,42.96047|13"},{n:"五家渠",g:"87.565449,44.368899|13"},{n:"伊犁州",g:"81.297854,43.922248|11"}]},{n:"云南",g:"101.592952,24.864213|7",cities:[{n:"昆明",g:"102.714601,25.049153|12"},{n:"保山",g:"99.177996,25.120489|13"},{n:"楚雄州",g:"101.529382,25.066356|13"},{n:"大理州",g:"100.223675,25.5969|14"},{n:"德宏州",g:"98.589434,24.44124|14"},{n:"迪庆州",g:"99.713682,27.831029|14"},{n:"红河州",g:"103.384065,23.367718|11"},{n:"丽江",g:"100.229628,26.875351|13"},{n:"临沧",g:"100.092613,23.887806|14"},{n:"怒江州",g:"98.859932,25.860677|14"},{n:"普洱",g:"100.980058,22.788778|14"},{n:"曲靖",g:"103.782539,25.520758|12"},{n:"昭通",g:"103.725021,27.340633|13"},{n:"文山",g:"104.089112,23.401781|14"},{n:"西双版纳",g:"100.803038,22.009433|13"},{n:"玉溪",g:"102.545068,24.370447|13"}]},{n:"浙江",g:"119.957202,29.159494|8",cities:[{n:"杭州",g:"120.219375,30.259244|12"},{n:"湖州",g:"120.137243,30.877925|12"},{n:"嘉兴",g:"120.760428,30.773992|13"},{n:"金华",g:"119.652576,29.102899|12"},{n:"丽水",g:"119.929576,28.4563|13"},{n:"宁波",g:"121.579006,29.885259|12"},{n:"衢州",g:"118.875842,28.95691|12"},{n:"绍兴",g:"120.592467,30.002365|13"},{n:"台州",g:"121.440613,28.668283|13"},{n:"温州",g:"120.690635,28.002838|12"},{n:"舟山",g:"122.169872,30.03601|13"}]}],other:[{n:"香港",g:"114.186124,22.293586|11"},{n:"澳门",g:"113.557519,22.204118|13"},{n:"台湾",g:"120.961454,23.80406|8"}]};function l(t){var e=t.split("|");return e[0]=e[0].split(","),{lng:parseFloat(e[0][0]),lat:parseFloat(e[0][1])}}var u={getProvinceNameByCityName:function(t){for(var e=s.provinces,n=0;n<e.length;n++)for(var i=e[n].n,o=e[n].cities,a=0;a<o.length;a++)if(o[a].n==t)return i;return null},getCenterByCityName:function(t){t=t.replace("市","");for(var e=0;e<s.municipalities.length;e++)if(s.municipalities[e].n==t)return l(s.municipalities[e].g);for(e=0;e<s.other.length;e++)if(s.other[e].n==t)return l(s.other[e].g);var n=s.provinces;for(e=0;e<n.length;e++){if(n[e].n==t)return l(n[e].g);for(var i=n[e].cities,o=0;o<i.length;o++)if(i[o].n==t)return l(i[o].g)}return null}},h=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},c=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),p=function t(e,n,i){null===e&&(e=Function.prototype);var o=Object.getOwnPropertyDescriptor(e,n);if(void 0===o){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,n,i)}if("value"in o)return o.value;var r=o.get;return void 0!==r?r.call(i):void 0},d=function(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)},v=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e},f=function(){function t(t,e){var n=[],i=!0,o=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(i=(r=s.next()).done);i=!0)if(n.push(r.value),e&&n.length===e)break}catch(l){o=!0,a=l}finally{try{!i&&s["return"]&&s["return"]()}finally{if(o)throw a}}return n}return function(e,n){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return t(e,n);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();function g(t,e){r.bind(this)(),this._options=e||{},this._data=[],t&&this.add(t)}function m(t,e,n){var i=60*n+30,o=Math.PI/180*i;return[t.x+e*Math.cos(o),t.y+e*Math.sin(o)]}function y(t,e,n,i){for(var o=0;o<6;o++){var a=m({x:e,y:n},i,o);t.lineTo(a[0],a[1])}}g.prototype=Object.create(r.prototype),g.prototype.add=function(t,e){if(Array.isArray(t)){for(var n=0,i=t.length;n<i;n++)if(t[n]){if(t[n].time&&14==t[n].time.length&&"20"==t[n].time.substr(0,2)){var o=t[n].time;t[n].time=new Date(o.substr(0,4)+"-"+o.substr(4,2)+"-"+o.substr(6,2)+" "+o.substr(8,2)+":"+o.substr(10,2)+":"+o.substr(12,2)).getTime()}this._data.push(t[n])}}else{if(!(t instanceof Object))throw new Error("Unknown dataType");this._data.push(t)}this._dataCache=JSON.parse(JSON.stringify(this._data))},g.prototype.reset=function(){this._data=JSON.parse(JSON.stringify(this._dataCache))},g.prototype.get=function(t){t=t||{};new Date;var e=this._data;new Date;if(t.filter){for(var n=[],i=0;i<e.length;i++)t.filter(e[i])&&n.push(e[i]);e=n}return t.transferCoordinate&&(e=this.transferCoordinate(e,t.transferCoordinate,t.fromColumn,t.toColumn)),e},g.prototype.set=function(t){this._set(t),this._trigger("change")},g.prototype._set=function(t){this.clear(),this.add(t)},g.prototype.clear=function(t){this._data=[]},g.prototype.remove=function(t){},g.prototype.update=function(t,e){for(var n=this._data,i=0;i<n.length;i++)if(e){var o=!0;for(var a in e)n[i][a]!=e[a]&&(o=!1);o&&t&&t(n[i])}else t&&t(n[i]);this._dataCache=JSON.parse(JSON.stringify(this._data)),this._trigger("change")},g.prototype.transferCoordinate=function(t,e,n,i){i=i||"_coordinates",n=n||"coordinates";for(var o=0;o<t.length;o++){var a=t[o].geometry,r=a[n];switch(a.type){case"Point":a[i]=e(r);break;case"LineString":for(var s=[],l=0;l<r.length;l++)s.push(e(r[l]));a[i]=s;break;case"MultiLineString":case"Polygon":s=c(r);a[i]=s;break;case"MultiPolygon":s=[];for(var u=0;u<r.length;u++){var h=r[u];h=c(h);s.push(h)}a[i]=s;break}}function c(t){for(var n=[],i=0;i<t.length;i++){for(var o=t[i],a=[],r=0;r<o.length;r++)a.push(e(o[r]));n.push(a)}return n}return t},g.prototype.initGeometry=function(t){t?this._data.forEach((function(e){e.geometry=t(e)})):this._data.forEach((function(t){if(!t.geometry)if(t.lng&&t.lat)t.geometry={type:"Point",coordinates:[t.lng,t.lat]};else if(t.city){var e=u.getCenterByCityName(t.city);e&&(t.geometry={type:"Point",coordinates:[e.lng,e.lat]})}}))},g.prototype.getMax=function(t){var e=this._data;if(e&&!(e.length<=0)){for(var n=parseFloat(e[0][t]),i=1;i<e.length;i++){var o=parseFloat(e[i][t]);o>n&&(n=o)}return n}},g.prototype.getSum=function(t){var e=this._data;if(e&&!(e.length<=0)){for(var n=0,i=0;i<e.length;i++)e[i][t]&&(n+=parseFloat(e[i][t]));return n}},g.prototype.getMin=function(t){var e=this._data;if(e&&!(e.length<=0)){for(var n=parseFloat(e[0][t]),i=1;i<e.length;i++){var o=parseFloat(e[i][t]);o<n&&(n=o)}return n}},g.prototype.getUnique=function(t){var e=this._data;if(e&&!(e.length<=0)){for(var n={},i=1;i<e.length;i++)n[e[i][t]]=!0;e=[];for(var o in n)e.push(o);return e}};var x={drawDataSet:function(t,e,n){for(var i=e instanceof g?e.get():e,o=0,a=i.length;o<a;o++){var r=i[o];this.draw(t,r,n)}},draw:function(t,e,n){var i=e.geometry.type,o=e.geometry._coordinates||e.geometry.coordinates,a=e.symbol||n.symbol||"circle";switch(i){case"Point":var r=e._size||e.size||n._size||n.size||5;"circle"===a?("Point"===n.bigData&&t.moveTo(o[0],o[1]),t.arc(o[0],o[1],r,0,2*Math.PI)):"rect"===a?t.rect(o[0]-r/2,o[1]-r/2,r,r):"honeycomb"===a&&y(t,o[0],o[1],r);break;case"LineString":this.drawLineString(t,o);break;case"MultiLineString":for(var s=0;s<o.length;s++){var l=o[s];this.drawLineString(t,l)}break;case"Polygon":this.drawPolygon(t,o);break;case"MultiPolygon":for(s=0;s<o.length;s++){var u=o[s];if(this.drawPolygon(t,u),n.multiPolygonDraw){var h=n.multiPolygonDraw();if(h)return h}}break;default:console.error("type"+i+"is not support now!");break}},drawLineString:function(t,e){for(var n=0;n<e.length;n++){var i=e[n][0],o=e[n][1];0==n?t.moveTo(i,o):t.lineTo(i,o)}},drawPolygon:function(t,e){t.beginPath();for(var n=0;n<e.length;n++){var i=e[n];t.moveTo(i[0][0],i[0][1]);for(var o=1;o<i.length;o++)t.lineTo(i[o][0],i[o][1]);t.lineTo(i[0][0],i[0][1]),t.closePath()}}},b={draw:function(t,e,n){var i=e instanceof g?e.get():e;for(var o in t.save(),n)t[o]=n[o];if(n.bigData){t.save(),t.beginPath();for(var a=0,r=i.length;a<r;a++){var s=i[a];x.draw(t,s,n)}var l=n.bigData;"Point"==l||"Polygon"==l||"MultiPolygon"==l?(t.fill(),t.lineDash&&t.setLineDash(t.lineDash),s.lineDash&&t.setLineDash(s.lineDash),(s.strokeStyle||n.strokeStyle)&&n.lineWidth&&t.stroke()):"LineString"!=l&&"MultiLineString"!=l||t.stroke(),t.restore()}else for(a=0,r=i.length;a<r;a++){s=i[a];t.save(),(s.fillStyle||s._fillStyle)&&(t.fillStyle=s.fillStyle||s._fillStyle),(s.strokeStyle||s._strokeStyle)&&(t.strokeStyle=s.strokeStyle||s._strokeStyle),t.lineDash&&t.setLineDash(t.lineDash),s.lineDash&&t.setLineDash(s.lineDash);l=s.geometry.type;t.beginPath(),n.multiPolygonDraw=function(){t.fill(),(s.strokeStyle||n.strokeStyle)&&n.lineWidth&&t.stroke()},x.draw(t,s,n),"Point"==l||"Polygon"==l||"MultiPolygon"==l?(t.fill(),(s.strokeStyle||n.strokeStyle)&&n.lineWidth&&t.stroke()):"LineString"!=l&&"MultiLineString"!=l||((s.lineWidth||s._lineWidth)&&(t.lineWidth=s.lineWidth||s._lineWidth),t.stroke()),t.restore()}t.restore()}};function w(t,e){if("undefined"===typeof document);else{var n=document.createElement("canvas");t&&(n.width=t),e&&(n.height=e)}return n}function _(t){t=t||{},this.gradient=t.gradient||{.25:"rgba(0, 0, 255, 1)",.55:"rgba(0, 255, 0, 1)",.85:"rgba(255, 255, 0, 1)",1:"rgba(255, 0, 0, 1)"},this.maxSize=t.maxSize||35,this.minSize=t.minSize||0,this.max=t.max||100,this.min=t.min||0,this.initPalette()}_.prototype.setMax=function(t){this.max=t||100},_.prototype.setMin=function(t){this.min=t||0},_.prototype.setMaxSize=function(t){this.maxSize=t||35},_.prototype.setMinSize=function(t){this.minSize=t||0},_.prototype.initPalette=function(){var t=this.gradient,e=new w(256,1),n=this.paletteCtx=e.getContext("2d"),i=n.createLinearGradient(0,0,256,1);for(var o in t)i.addColorStop(parseFloat(o),t[o]);n.fillStyle=i,n.fillRect(0,0,256,1)},_.prototype.getColor=function(t){var e=this.getImageData(t);return"rgba("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]/256+")"},_.prototype.getImageData=function(t){var e=this.paletteCtx.getImageData(0,0,256,1).data;if(void 0===t)return e;var n=this.max,i=this.min;t>n&&(t=n),t<i&&(t=i);var o=4*Math.floor((t-i)/(n-i)*255);return[e[o],e[o+1],e[o+2],e[o+3]]},_.prototype.getSize=function(t){var e=0,n=this.max,i=this.min,o=this.maxSize,a=this.minSize;return t>n&&(t=n),t<i&&(t=i),n>i?(e=a+(t-i)/(n-i)*(o-a),e):o},_.prototype.getLegend=function(t){var e=this.gradient,n=t.width||20,i=t.height||180,o=new w(n,i),a=o.getContext("2d"),r=a.createLinearGradient(0,i,0,0);for(var s in e)r.addColorStop(parseFloat(s),e[s]);return a.fillStyle=r,a.fillRect(0,0,n,i),o};var E="undefined"===typeof window?{}:window,S=E.devicePixelRatio||1;function C(t){var e=t/2,n=t+e,i=1e4,o=new w(2*n,2*n),a=o.getContext("2d");return a.shadowBlur=e,a.shadowColor="black",a.shadowOffsetX=a.shadowOffsetY=i,a.beginPath(),a.arc(n-i,n-i,t,0,2*Math.PI,!0),a.closePath(),a.fill(),o}function k(t,e,n){var i=M(n),o=T(n),a=i-o,r=n.range||null,s=0,l=1024;r&&2===r.length&&(s=(r[0]-o)/a*1024),r&&2===r.length&&(l=(r[1]-o)/a*1024);for(var u,h=n.maxOpacity||.8,c=n.minOpacity||0,p=(r=n.range,3),d=t.length;p<d;p+=4)u=4*t[p],t[p]/256>h&&(t[p]=256*h),t[p]/256<c&&(t[p]=256*c),u&&u>=s&&u<=l?(t[p-3]=e[u],t[p-2]=e[u+1],t[p-1]=e[u+2]):t[p]=0}function M(t){var e=t.max||100;return e}function T(t){var e=t.min||0;return e}function D(t,e,n){var i=M(n),o=T(n),a=n._size;void 0==a&&(a=n.size,void 0==a&&(a=13));var r=new _({gradient:n.gradient,max:i,min:o}),s=C(a),l=s.width/2,u=s.height/2,h=e,c={};for(var p in h.forEach((function(t,e){var n=void 0===t.count?1:t.count,o=Math.min(1,n/i).toFixed(2);c[o]=c[o]||[],c[o].push(t)})),c)if(!isNaN(p)){var d=c[p];t.beginPath(),n.withoutAlpha||(t.globalAlpha=p),t.strokeStyle=r.getColor(p*i),d.forEach((function(e,o){if(e.geometry){var a=e.geometry._coordinates||e.geometry.coordinates,r=e.geometry.type;if("Point"===r){var h=void 0===e.count?1:e.count;t.globalAlpha=h/i,t.drawImage(s,a[0]-l,a[1]-u)}else if("LineString"===r){h=void 0===e.count?1:e.count;t.globalAlpha=h/i,t.beginPath(),x.draw(t,e,n),t.stroke()}}}))}}function O(t,e,n){if(!(t.canvas.width<=0||t.canvas.height<=0)){var i=n.strength||.3;t.strokeStyle="rgba(0,0,0,"+i+")";var o=new w(t.canvas.width,t.canvas.height),a=o.getContext("2d");a.scale(S,S),n=n||{};var r=e instanceof g?e.get():e;t.save();var s=new _({gradient:n.gradient});if(D(a,r,n),!n.absolute){var l=a.getImageData(0,0,t.canvas.width,t.canvas.height);k(l.data,s.getImageData(),n),t.putImageData(l,0,0),t.restore()}s=null,o=null}}var A={draw:O},I={draw:function(t,e,n){t.save();var i=e instanceof g?e.get():e,o={},a=n._size||n.size||50,r=!("enableCluster"in n)||n.enableCluster,s=n.offset||{x:0,y:0},l=new _({min:n.min||0,max:n.max||100,gradient:n.gradient});if(r){for(var u=0;u<i.length;u++){p=i[u].geometry._coordinates||i[u].geometry.coordinates,d=Math.floor((p[0]-s.x)/a)+","+Math.floor((p[1]-s.y)/a);o[d]||(o[d]=0),o[d]+=~~(i[u].count||1)}for(var h in o)h=h.split(","),t.beginPath(),t.rect(h[0]*a+.5+s.x,h[1]*a+.5+s.y,a,a),t.fillStyle=l.getColor(o[h]),t.fill(),n.strokeStyle&&n.lineWidth&&t.stroke()}else{for(var c=0;c<i.length;c++){var p=i[c].geometry._coordinates||i[c].geometry.coordinates,d=p.join(",");o[d]=i[c].count||1}for(var v in o)v=v.split(","),t.beginPath(),t.rect(+v[0]-a/2,+v[1]-a/2,a,a),t.fillStyle=l.getColor(o[v]),t.fill(),n.strokeStyle&&n.lineWidth&&t.stroke()}if(n.label&&!1!==n.label.show)for(var d in t.fillStyle=n.label.fillStyle||"white",n.label.font&&(t.font=n.label.font),n.label.shadowColor&&(t.shadowColor=n.label.shadowColor),n.label.shadowBlur&&(t.shadowBlur=n.label.shadowBlur),o){d=d.split(",");var f=o[d],m=t.measureText(f).width;r?t.fillText(f,d[0]*a+.5+s.x+a/2-m/2,d[1]*a+.5+s.y+a/2+5):t.fillText(f,+d[0]-m/2,+d[1]+5)}t.restore()}};function z(t,e,n){var i=60*n+30,o=Math.PI/180*i;return[t.x+e*Math.cos(o),t.y+e*Math.sin(o)]}var R={draw:function(t,e,n){t.save();var i=e instanceof g?e.get():e;for(var o in n)t[o]=n[o];var a=n.offset||{x:10,y:10},r=n._size||n.size||40;r=r/2/Math.sin(Math.PI/3);for(var s=2*r*Math.sin(Math.PI/3),l=1.5*r,u={},h=0;h<i.length;h++){var c=i[h].geometry._coordinates||i[h].geometry.coordinates,p=(c[1]-a.y)/l,d=Math.round(p),v=(c[0]-a.x)/s-(1&d?.5:0),f=Math.round(v),m=p-d;if(3*Math.abs(m)>1){var y=v-f,x=f+(v<f?-1:1)/2,b=d+(p<d?-1:1),w=v-x,E=p-b;y*y+m*m>w*w+E*E&&(f=x+(1&d?1:-1)/2,d=b)}var S=f+"-"+d,C=u[S];C?C.push(i[h]):(C=u[S]=[i[h]],C.i=f,C.j=d,C.x=(f+(1&d?.5:0))*s,C.y=d*l)}var k=new _({max:n.max||100,maxSize:r,gradient:n.gradient});for(var o in u){var M=u[o];t.beginPath();for(var L=0;L<6;L++){var P=z({x:M.x+a.x,y:M.y+a.y},r,L);t.lineTo(P[0],P[1])}t.closePath();var T=0;for(h=0;h<M.length;h++)T+=M[h].count||1;M.count=T,t.fillStyle=k.getColor(T),t.fill(),n.strokeStyle&&n.lineWidth&&t.stroke()}if(n.label&&!1!==n.label.show)for(var o in t.fillStyle=n.label.fillStyle||"white",n.label.font&&(t.font=n.label.font),n.label.shadowColor&&(t.shadowColor=n.label.shadowColor),n.label.shadowBlur&&(t.shadowBlur=n.label.shadowBlur),u){M=u[o];var D=M.count;D=D<0?D.toFixed(2):~~D;var O=t.measureText(D).width;t.fillText(D,M.x+a.x-O/2,M.y+a.y+5)}t.restore()}};function F(t,e,n){var i=t.createShader(n);return t.shaderSource(i,e),t.compileShader(i),i}function B(t,e,n){var i=F(t,e,t.VERTEX_SHADER),o=F(t,n,t.FRAGMENT_SHADER),a=t.createProgram();return t.attachShader(a,i),t.attachShader(a,o),t.linkProgram(a),t.useProgram(a),a}function N(t){var e=document.createElement("canvas"),n=e.getContext("2d");return e.width=1,e.height=1,n.fillStyle=t,n.fillRect(0,0,1,1),n.getImageData(0,0,1,1).data}var j=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join(""),U=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function Z(t,e,n){if(e){var i=B(t,j,U);t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE),t.clear(t.COLOR_BUFFER_BIT);var o=t.canvas.width/2,a=t.canvas.height/2,r=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,r);var s=t.getAttribLocation(i,"a_Position");t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(s);var l=t.getUniformLocation(i,"u_FragColor"),u=N(n.strokeStyle||"red");t.uniform4f(l,u[0]/255,u[1]/255,u[2]/255,u[3]/255),t.lineWidth(n.lineWidth||1);for(var h=0,c=e.length;h<c;h++){for(var p=e[h].geometry._coordinates,d=[],v=0;v<p.length;v++){var f=p[v],g=(f[0]-o)/o,m=(a-f[1])/a;d.push(g,m)}var y=new Float32Array(d);t.bufferData(t.ARRAY_BUFFER,y,t.STATIC_DRAW),t.drawArrays(t.LINE_STRIP,0,p.length)}}}var W={draw:Z},H=["attribute vec4 a_Position;","attribute float a_PointSize;","void main() {","gl_Position = a_Position;","gl_PointSize = a_PointSize;","}"].join(""),Y=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function X(t,e,n){if(e){var i=B(t,H,Y),o=t.getAttribLocation(i,"a_Position"),a=t.getAttribLocation(i,"a_PointSize"),r=t.getUniformLocation(i,"u_FragColor");t.clear(t.COLOR_BUFFER_BIT);for(var s=t.canvas.width/2,l=t.canvas.height/2,u=[],h=0,c=0;c<e.length;c++){var p=e[c].geometry._coordinates,d=(p[0]-s)/s,v=(l-p[1])/l;d<-1||d>1||v<-1||v>1||(u.push(d,v),h++)}var f=new Float32Array(u),g=h,m=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,m),t.bufferData(t.ARRAY_BUFFER,f,t.STATIC_DRAW),t.vertexAttribPointer(o,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(o),t.vertexAttrib1f(a,n._size);var y=N(n.fillStyle||"red");t.uniform4f(r,y[0]/255,y[1]/255,y[2]/255,y[3]/255),t.drawArrays(t.POINTS,0,g)}}var q={draw:X};function V(t,e,n){n=n||2;var i,o,a,r,s,l,u,h=e&&e.length,c=h?e[0]*n:t.length,p=$(t,0,c,n,!0),d=[];if(!p)return d;if(h&&(p=nt(t,e,p,n)),t.length>80*n){i=a=t[0],o=r=t[1];for(var v=n;v<c;v+=n)s=t[v],l=t[v+1],s<i&&(i=s),l<o&&(o=l),s>a&&(a=s),l>r&&(r=l);u=Math.max(a-i,r-o)}return J(p,d,n,i,o,u),d}function $(t,e,n,i,o){var a,r;if(o===_t(t,e,n,i)>0)for(a=e;a<n;a+=i)r=xt(a,t[a],t[a+1],r);else for(a=n-i;a>=e;a-=i)r=xt(a,t[a],t[a+1],r);return r&&dt(r,r.next)&&(bt(r),r=r.next),r}function G(t,e){if(!t)return t;e||(e=t);var n,i=t;do{if(n=!1,i.steiner||!dt(i,i.next)&&0!==pt(i.prev,i,i.next))i=i.next;else{if(bt(i),i=e=i.prev,i===i.next)return null;n=!0}}while(n||i!==e);return e}function J(t,e,n,i,o,a,r){if(t){!r&&a&&rt(t,i,o,a);var s,l,u=t;while(t.prev!==t.next)if(s=t.prev,l=t.next,a?K(t,i,o,a):Q(t))e.push(s.i/n),e.push(t.i/n),e.push(l.i/n),bt(t),t=l.next,u=l.next;else if(t=l,t===u){r?1===r?(t=tt(t,e,n),J(t,e,n,i,o,a,2)):2===r&&et(t,e,n,i,o,a):J(G(t),e,n,i,o,a,1);break}}}function Q(t){var e=t.prev,n=t,i=t.next;if(pt(e,n,i)>=0)return!1;var o=t.next.next;while(o!==t.prev){if(ht(e.x,e.y,n.x,n.y,i.x,i.y,o.x,o.y)&&pt(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function K(t,e,n,i){var o=t.prev,a=t,r=t.next;if(pt(o,a,r)>=0)return!1;var s=o.x<a.x?o.x<r.x?o.x:r.x:a.x<r.x?a.x:r.x,l=o.y<a.y?o.y<r.y?o.y:r.y:a.y<r.y?a.y:r.y,u=o.x>a.x?o.x>r.x?o.x:r.x:a.x>r.x?a.x:r.x,h=o.y>a.y?o.y>r.y?o.y:r.y:a.y>r.y?a.y:r.y,c=lt(s,l,e,n,i),p=lt(u,h,e,n,i),d=t.nextZ;while(d&&d.z<=p){if(d!==t.prev&&d!==t.next&&ht(o.x,o.y,a.x,a.y,r.x,r.y,d.x,d.y)&&pt(d.prev,d,d.next)>=0)return!1;d=d.nextZ}d=t.prevZ;while(d&&d.z>=c){if(d!==t.prev&&d!==t.next&&ht(o.x,o.y,a.x,a.y,r.x,r.y,d.x,d.y)&&pt(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function tt(t,e,n){var i=t;do{var o=i.prev,a=i.next.next;!dt(o,a)&&vt(o,i,i.next,a)&&gt(o,a)&&gt(a,o)&&(e.push(o.i/n),e.push(i.i/n),e.push(a.i/n),bt(i),bt(i.next),i=t=a),i=i.next}while(i!==t);return i}function et(t,e,n,i,o,a){var r=t;do{var s=r.next.next;while(s!==r.prev){if(r.i!==s.i&&ct(r,s)){var l=yt(r,s);return r=G(r,r.next),l=G(l,l.next),J(r,e,n,i,o,a),void J(l,e,n,i,o,a)}s=s.next}r=r.next}while(r!==t)}function nt(t,e,n,i){var o,a,r,s,l,u=[];for(o=0,a=e.length;o<a;o++)r=e[o]*i,s=o<a-1?e[o+1]*i:t.length,l=$(t,r,s,i,!1),l===l.next&&(l.steiner=!0),u.push(ut(l));for(u.sort(it),o=0;o<u.length;o++)ot(u[o],n),n=G(n,n.next);return n}function it(t,e){return t.x-e.x}function ot(t,e){if(e=at(t,e),e){var n=yt(e,t);G(n,n.next)}}function at(t,e){var n,i=e,o=t.x,a=t.y,r=-1/0;do{if(a<=i.y&&a>=i.next.y){var s=i.x+(a-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(s<=o&&s>r){if(r=s,s===o){if(a===i.y)return i;if(a===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==e);if(!n)return null;if(o===r)return n.prev;var l,u=n,h=n.x,c=n.y,p=1/0;i=n.next;while(i!==u)o>=i.x&&i.x>=h&&ht(a<c?o:r,a,h,c,a<c?r:o,a,i.x,i.y)&&(l=Math.abs(a-i.y)/(o-i.x),(l<p||l===p&&i.x>n.x)&&gt(i,t)&&(n=i,p=l)),i=i.next;return n}function rt(t,e,n,i){var o=t;do{null===o.z&&(o.z=lt(o.x,o.y,e,n,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next}while(o!==t);o.prevZ.nextZ=null,o.prevZ=null,st(o)}function st(t){var e,n,i,o,a,r,s,l,u=1;do{n=t,t=null,a=null,r=0;while(n){for(r++,i=n,s=0,e=0;e<u;e++)if(s++,i=i.nextZ,!i)break;l=u;while(s>0||l>0&&i)0===s?(o=i,i=i.nextZ,l--):0!==l&&i?n.z<=i.z?(o=n,n=n.nextZ,s--):(o=i,i=i.nextZ,l--):(o=n,n=n.nextZ,s--),a?a.nextZ=o:t=o,o.prevZ=a,a=o;n=i}a.nextZ=null,u*=2}while(r>1);return t}function lt(t,e,n,i,o){return t=32767*(t-n)/o,e=32767*(e-i)/o,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function ut(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function ht(t,e,n,i,o,a,r,s){return(o-r)*(e-s)-(t-r)*(a-s)>=0&&(t-r)*(i-s)-(n-r)*(e-s)>=0&&(n-r)*(a-s)-(o-r)*(i-s)>=0}function ct(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!ft(t,e)&&gt(t,e)&&gt(e,t)&&mt(t,e)}function pt(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function dt(t,e){return t.x===e.x&&t.y===e.y}function vt(t,e,n,i){return!!(dt(t,e)&&dt(n,i)||dt(t,i)&&dt(n,e))||pt(t,e,n)>0!==pt(t,e,i)>0&&pt(n,i,t)>0!==pt(n,i,e)>0}function ft(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&vt(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function gt(t,e){return pt(t.prev,t,t.next)<0?pt(t,e,t.next)>=0&&pt(t,t.prev,e)>=0:pt(t,e,t.prev)<0||pt(t,t.next,e)<0}function mt(t,e){var n=t,i=!1,o=(t.x+e.x)/2,a=(t.y+e.y)/2;do{n.y>a!==n.next.y>a&&o<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==t);return i}function yt(t,e){var n=new wt(t.i,t.x,t.y),i=new wt(e.i,e.x,e.y),o=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=o,o.prev=n,i.next=n,n.prev=i,a.next=i,i.prev=a,i}function xt(t,e,n,i){var o=new wt(t,e,n);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function bt(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function wt(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function _t(t,e,n,i){for(var o=0,a=e,r=n-i;a<n;a+=i)o+=(t[r]-t[a])*(t[a+1]+t[r+1]),r=a;return o}V.deviation=function(t,e,n,i){var o=e&&e.length,a=o?e[0]*n:t.length,r=Math.abs(_t(t,0,a,n));if(o)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,h=s<l-1?e[s+1]*n:t.length;r-=Math.abs(_t(t,u,h,n))}var c=0;for(s=0;s<i.length;s+=3){var p=i[s]*n,d=i[s+1]*n,v=i[s+2]*n;c+=Math.abs((t[p]-t[v])*(t[d+1]-t[p+1])-(t[p]-t[d])*(t[v+1]-t[p+1]))}return 0===r&&0===c?0:Math.abs((c-r)/r)},V.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},i=0,o=0;o<t.length;o++){for(var a=0;a<t[o].length;a++)for(var r=0;r<e;r++)n.vertices.push(t[o][a][r]);o>0&&(i+=t[o-1].length,n.holes.push(i))}return n};var Et=["attribute vec4 a_Position;","void main() {","gl_Position = a_Position;","gl_PointSize = 30.0;","}"].join(""),St=["precision mediump float;","uniform vec4 u_FragColor;","void main() {","gl_FragColor = u_FragColor;","}"].join("");function Ct(t,e,n){if(e){t.clear(t.COLOR_BUFFER_BIT),t.viewport(0,0,t.canvas.width,t.canvas.height);var i=B(t,Et,St);t.enable(t.BLEND),t.blendFunc(t.SRC_ALPHA,t.ONE);var o=t.canvas.width/2,a=t.canvas.height/2;t.bindBuffer(t.ARRAY_BUFFER,t.createBuffer()),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,t.createBuffer());var r=t.getAttribLocation(i,"a_Position");t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.enableVertexAttribArray(r);var s=t.getUniformLocation(i,"u_FragColor"),l=N(n.fillStyle||"red");t.uniform4f(s,l[0]/255,l[1]/255,l[2]/255,l[3]/255),t.lineWidth(n.lineWidth||1);for(var u=[],h=[],c=65536,p=0,d=0,v=e.length;d<v;d++){var f=V.flatten(e[d].geometry._coordinates||e[d].geometry.coordinates),g=f.vertices;p=u.length/2;for(var m=0;m<g.length;m+=2)g[m]=(g[m]-o)/o,g[m+1]=(a-g[m+1])/a;(u.length+g.length)/2>c&&(t.bufferData(t.ARRAY_BUFFER,new Float32Array(u),t.STATIC_DRAW),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(h),t.STATIC_DRAW),t.drawElements(t.TRIANGLES,h.length,t.UNSIGNED_SHORT,0),u.length=0,h.length=0,p=0);for(m=0;m<g.length;m++)u.push(g[m]);var y=V(g,f.holes,f.dimensions);for(m=0;m<y.length;m++)h.push(y[m]+p)}t.bufferData(t.ARRAY_BUFFER,new Float32Array(u),t.STATIC_DRAW),t.bufferData(t.ELEMENT_ARRAY_BUFFER,new Uint16Array(h),t.STATIC_DRAW),t.drawElements(t.TRIANGLES,h.length,t.UNSIGNED_SHORT,0),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}}var kt={draw:Ct},Mt={draw:function(t,e,n){var i=e instanceof g?e.get():e;i.length>0&&("LineString"==i[0].geometry.type?W.draw(t,i,n):"Polygon"==i[0].geometry.type||"MultiPolygon"==i[0].geometry.type?kt.draw(t,i,n):q.draw(t,i,n))}};function Lt(t,e){e=e||{};for(var n=[],i=0;i<t.length-1;i++){var o=Pt(t[i],t[i+1],e.count);o&&o.length>0&&(n=n.concat(o))}return n}function Pt(t,e,n){if(!t||!e)return null;var i,o,a,r,s,l,u=function(t){return 1-2*t+t*t},h=function(t){return 2*t-2*t*t},c=function(t){return t*t},p=[],d=(n=n||40,0),v=0;if("undefined"!=typeof e){var f=parseFloat(t.lat),g=parseFloat(e.lat),m=parseFloat(t.lng),y=parseFloat(e.lng);for(y>m&&parseFloat(y-m)>180&&m<0&&(m=parseFloat(360+m),y=parseFloat(360+y)),0,l=0,g==f?(i=0,o=m-y):y==m?(i=Math.PI/2,o=f-g):(i=Math.atan((g-f)/(y-m)),o=(g-f)/Math.sin(i)),0==l&&(l=i+Math.PI/5),a=o/2,s=a*Math.cos(l)+m,r=a*Math.sin(l)+f,d=0;d<n+1;d++){var x=m*u(v)+s*h(v)+y*c(v),b=f*u(v)+r*h(v)+g*c(v),w=t.lng,_=e.lng;p.push([w<0&&_>0?x-360:x,b]),v+=1/n}return p}"undefined"!=typeof p&&(p=[])}var Tt={getPoints:Lt},Dt=function(){var t={},e=[],n=[],i=[],o=.1,a=.1,r=1,s=2,l=6,u=70,h=.6666667,c=.6,p=1e-8;function d(t,e){return t.x*e.x+t.y*e.y}function v(e){return{x:t[e.target].x-t[e.source].x,y:t[e.target].y-t[e.source].y}}function f(e){return Math.sqrt(Math.pow(t[e.source].x-t[e.target].x,2)+Math.pow(t[e.source].y-t[e.target].y,2))}function g(t){return Math.sqrt(Math.pow(t.source.x-t.target.x,2)+Math.pow(t.source.y-t.target.y,2))}function m(e){var n=(t[e.source].x+t[e.target].x)/2,i=(t[e.source].y+t[e.target].y)/2;return{x:n,y:i}}function y(t){for(var e=0,n=1;n<i[t].length;n++){var o=x(i[t][n],i[t][n-1]);e+=o}return e}function x(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function b(t,e){var n=Math.sqrt((e.target.x-e.source.x)*(e.target.x-e.source.x)+(e.target.y-e.source.y)*(e.target.y-e.source.y)),i=((e.source.y-t.y)*(e.source.y-e.target.y)-(e.source.x-t.x)*(e.target.x-e.source.x))/(n*n);return{x:e.source.x+i*(e.target.x-e.source.x),y:e.source.y+i*(e.target.y-e.source.y)}}function w(){for(var n=0;n<e.length;n++)1==r?i[n]=[]:(i[n]=[],i[n].push(t[e[n].source]),i[n].push(t[e[n].target]))}function _(){for(var t=0;t<e.length;t++)n[t]=[]}function E(e){for(var n=[],i=0;i<e.length;i++)t[e[i].source].x!=t[e[i].target].x&&t[e[i].source].y!=t[e[i].target].y&&n.push(e[i]);return n}function S(t,e,n){var o=i[t][e-1],a=i[t][e+1],r=i[t][e],s=o.x-r.x+a.x-r.x,l=o.y-r.y+a.y-r.y;return s*=n,l*=n,{x:s,y:l}}function C(t,e,o){for(var a={x:0,y:0},r=n[t],s=0;s<r.length;s++){var l={x:i[r[s]][e].x-i[t][e].x,y:i[r[s]][e].y-i[t][e].y};if(Math.abs(l.x)>p||Math.abs(l.y)>p){var u=1/Math.pow(g({source:i[r[s]][e],target:i[t][e]}),1);a.x+=l.x*u,a.y+=l.y*u}}return a}function k(t,n,i){for(var a=o/(f(e[t])*(n+1)),r=[{x:0,y:0}],s=1;s<n+1;s++){var l={x:0,y:0},u=S(t,s,a),h=C(t,s,i);l.x=i*(u.x+h.x),l.y=i*(u.y+h.y),r.push(l)}return r.push({x:0,y:0}),r}function M(n){for(var o=0;o<e.length;o++)if(1==n)i[o].push(t[e[o].source]),i[o].push(m(e[o])),i[o].push(t[e[o].target]);else{var a=y(o),r=a/(n+1),s=r,l=[];l.push(t[e[o].source]);for(var u=1;u<i[o].length;u++){var h=x(i[o][u],i[o][u-1]);while(h>s){var c=s/h,p=i[o][u-1].x,d=i[o][u-1].y;p+=c*(i[o][u].x-i[o][u-1].x),d+=c*(i[o][u].y-i[o][u-1].y),l.push({x:p,y:d}),h-=s,s=r}s-=h}l.push(t[e[o].target]),i[o]=l}}function L(t,e){var n=Math.abs(d(v(t),v(e))/(f(t)*f(e)));return n}function T(t,e){var n=(f(t)+f(e))/2,i=2/(n/Math.min(f(t),f(e))+Math.max(f(t),f(e))/n);return i}function D(e,n){var i=(f(e)+f(n))/2,o={x:(t[e.source].x+t[e.target].x)/2,y:(t[e.source].y+t[e.target].y)/2},a={x:(t[n.source].x+t[n.target].x)/2,y:(t[n.source].y+t[n.target].y)/2},r=i/(i+x(o,a));return r}function O(e,n){var i=b(t[n.source],{source:t[e.source],target:t[e.target]}),o=b(t[n.target],{source:t[e.source],target:t[e.target]}),a={x:(i.x+o.x)/2,y:(i.y+o.y)/2},r={x:(t[e.source].x+t[e.target].x)/2,y:(t[e.source].y+t[e.target].y)/2},s=Math.max(0,1-2*x(r,a)/x(i,o));return s}function A(t,e){return Math.min(O(t,e),O(e,t))}function I(t,e){var n=L(t,e)*T(t,e)*D(t,e)*A(t,e);return n}function z(t,e){return I(t,e)>=c}function R(){for(var t=0;t<e.length-1;t++)for(var i=t+1;i<e.length;i++)t!=i&&z(e[t],e[i])&&(n[t].push(i),n[i].push(t))}var F=function(){var t=a,n=u,o=r;w(),_(),M(o),R();for(var s=0;s<l;s++){for(var c=0;c<n;c++){for(var p=[],d=0;d<e.length;d++)p[d]=k(d,o,t);for(var v=0;v<e.length;v++)for(var f=0;f<o+1;f++)i[v][f].x+=p[v][f].x,i[v][f].y+=p[v][f].y}t/=2,o*=2,n*=h,M(o)}return i};return F.nodes=function(e){return 0==arguments.length?t:(t=e,F)},F.edges=function(t){return 0==arguments.length?e:(e=E(t),F)},F.bundling_stiffness=function(t){return 0==arguments.length?o:(o=t,F)},F.step_size=function(t){return 0==arguments.length?a:(a=t,F)},F.cycles=function(t){return 0==arguments.length?l:(l=t,F)},F.iterations=function(t){return 0==arguments.length?u:(u=t,F)},F.iterations_rate=function(t){return 0==arguments.length?h:(h=t,F)},F.subdivision_points_seed=function(t){return 0==arguments.length?P:(P=t,F)},F.subdivision_rate=function(t){return 0==arguments.length?s:(s=t,F)},F.compatbility_threshold=function(t){return 0==arguments.length?compatbility_threshold:(c=t,F)},F};function Ot(t){this.splitList=t||{other:1}}function At(t){this.splitList=t||[{start:0,value:"red"}]}Ot.prototype.get=function(t){var e=this.splitList,n=e["other"];for(var i in e)if(t==i){n=e[i];break}return n},Ot.prototype.generateByDataSet=function(t,e){var n=e||["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"],i=t.get();this.splitList={};for(var o=0,a=0;a<i.length;a++)if(void 0===this.splitList[i[a].count]&&(this.splitList[i[a].count]=n[o],o++),o>=n.length-1)break;this.splitList["other"]=n[n.length-1]},Ot.prototype.getLegend=function(t){var e=this.splitList,n=document.createElement("div");n.style.cssText="background:#fff; padding: 5px; border: 1px solid #ccc;";var i="";for(var o in e)i+='<div style="line-height: 19px;" value="'+o+'"><span style="vertical-align: -2px; display: inline-block; width: 30px;height: 19px;background:'+e[o]+';"></span><span style="margin-left: 3px;">'+o+"<span></div>";return n.innerHTML=i,n},At.prototype.get=function(t){for(var e=this.splitList,n=!1,i=0;i<e.length;i++)if((void 0===e[i].start||void 0!==e[i].start&&t>=e[i].start)&&(void 0===e[i].end||void 0!==e[i].end&&t<e[i].end)){n=e[i].value;break}return n},At.prototype.generateByDataSet=function(t){var e=t.getMin("count"),n=t.getMax("count");this.generateByMinMax(e,n)},At.prototype.generateByMinMax=function(t,e){var n=["rgba(255, 255, 0, 0.8)","rgba(253, 98, 104, 0.8)","rgba(255, 146, 149, 0.8)","rgba(255, 241, 193, 0.8)","rgba(110, 176, 253, 0.8)","rgba(52, 139, 251, 0.8)","rgba(17, 102, 252, 0.8)"],i=Number((e-t)/7);e=Number(e);var o=Number(t);this.splitList=[];var a=0;while(o<e)this.splitList.push({start:o,end:o+i,value:n[a]}),a++,o+=i},At.prototype.getLegend=function(t){this.splitList};var It=function(){function t(e,n,i){if(h(this,t),!e||!n)return console.warn("id 和 type 为必填项"),!1;if("baidu"==n){if(!BMap)return console.warn("请先引入百度地图JS API"),!1}else console.warn("暂不支持你的地图类型");this.type=n;var o=i&&i.center?i.center:[106.962497,38.208726],a=i&&i.zoom?i.zoom:5,r=this.map=new BMap.Map(e,{enableMapClick:!1});r.centerAndZoom(new BMap.Point(o[0],o[1]),a),r.enableScrollWheelZoom(!0),r.setMapStyle({style:"light"})}return c(t,[{key:"addLayer",value:function(t,e){if("baidu"==this.type)return new mapv.baiduMapLayer(this.map,dataSet,e)}},{key:"getMap",value:function(){return this.map}}]),t}();function zt(t){this.options=t||{},this.paneName=this.options.paneName||"mapPane",this.context=this.options.context||"2d",this.zIndex=this.options.zIndex||0,this.mixBlendMode=this.options.mixBlendMode||null,this.enableMassClear=this.options.enableMassClear,this._map=t.map,this._lastDrawTime=null,this.show()}var Rt="undefined"===typeof window?{}:window,Ft=Rt.BMap||Rt.BMapGL;Ft&&(zt.prototype=new Ft.Overlay,zt.prototype.initialize=function(t){this._map=t;var e=this.canvas=document.createElement("canvas");e.style.cssText="position:absolute;left:0;top:0;z-index:"+this.zIndex+";user-select:none;",e.style.mixBlendMode=this.mixBlendMode,this.adjustSize();var n=t.getPanes()[this.paneName];n||(n=t.getPanes().floatShadow),n.appendChild(e);var i=this;return t.addEventListener("resize",(function(){i.adjustSize(),i._draw()})),t.addEventListener("update",(function(){i._draw()})),this.options.updateImmediate&&setTimeout((function(){i._draw()}),100),this.canvas},zt.prototype.adjustSize=function(){var t=this._map.getSize(),e=this.canvas,n=this.devicePixelRatio=Rt.devicePixelRatio||1;e.width=t.width*n,e.height=t.height*n,"2d"==this.context&&e.getContext(this.context).scale(n,n),e.style.width=t.width+"px",e.style.height=t.height+"px"},zt.prototype.draw=function(){var t=this;this.options.updateImmediate?t._draw():(clearTimeout(t.timeoutID),t.timeoutID=setTimeout((function(){t._draw()}),15))},zt.prototype._draw=function(){var t=this._map,e=t.getSize(),n=t.getCenter();if(n){var i=t.pointToOverlayPixel(n);this.canvas.style.left=i.x-e.width/2+"px",this.canvas.style.top=i.y-e.height/2+"px",this.dispatchEvent("draw"),this.options.update&&this.options.update.call(this)}},zt.prototype.getContainer=function(){return this.canvas},zt.prototype.show=function(){this.canvas||this._map.addOverlay(this),this.canvas.style.display="block"},zt.prototype.hide=function(){this.canvas.style.display="none"},zt.prototype.setZIndex=function(t){this.zIndex=t,this.canvas.style.zIndex=this.zIndex},zt.prototype.getZIndex=function(){return this.zIndex});var Bt=Bt||function(){var t=[];return{getAll:function(){return t},removeAll:function(){t=[]},add:function(e){t.push(e)},remove:function(e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)},update:function(e,n){if(0===t.length)return!1;var i=0;e=void 0!==e?e:Bt.now();while(i<t.length)t[i].update(e)||n?i++:t.splice(i,1);return!0}}}();function Nt(t,e){var n=e[0]-t[0],i=e[1]-t[1],o=360*Math.atan(i/n)/(2*Math.PI);return e[0]<t[0]&&(o+=180),o}"undefined"===typeof window&&"undefined"!==typeof t?Bt.now=function(){var e=t.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!==typeof window&&void 0!==window.performance&&void 0!==window.performance.now?Bt.now=window.performance.now.bind(window.performance):void 0!==Date.now?Bt.now=Date.now:Bt.now=function(){return(new Date).getTime()},Bt.Tween=function(t){var e,n=t,i={},o={},a={},r=1e3,s=0,l=!1,u=!1,h=!1,c=0,p=null,d=Bt.Easing.Linear.None,v=Bt.Interpolation.Linear,f=[],g=null,m=!1,y=null,x=null,b=null;this.to=function(t,e){return o=t,void 0!==e&&(r=e),this},this.start=function(t){for(var e in Bt.add(this),u=!0,m=!1,p=void 0!==t?t:Bt.now(),p+=c,o){if(o[e]instanceof Array){if(0===o[e].length)continue;o[e]=[n[e]].concat(o[e])}void 0!==n[e]&&(i[e]=n[e],i[e]instanceof Array===!1&&(i[e]*=1),a[e]=i[e]||0)}return this},this.stop=function(){return u?(Bt.remove(this),u=!1,null!==b&&b.call(n,n),this.stopChainedTweens(),this):this},this.end=function(){return this.update(p+r),this},this.stopChainedTweens=function(){for(var t=0,e=f.length;t<e;t++)f[t].stop()},this.delay=function(t){return c=t,this},this.repeat=function(t){return s=t,this},this.repeatDelay=function(t){return e=t,this},this.yoyo=function(t){return l=t,this},this.easing=function(t){return d=t,this},this.interpolation=function(t){return v=t,this},this.chain=function(){return f=arguments,this},this.onStart=function(t){return g=t,this},this.onUpdate=function(t){return y=t,this},this.onComplete=function(t){return x=t,this},this.onStop=function(t){return b=t,this},this.update=function(t){var u,b,w;if(t<p)return!0;for(u in!1===m&&(null!==g&&g.call(n,n),m=!0),b=(t-p)/r,b=b>1?1:b,w=d(b),o)if(void 0!==i[u]){var _=i[u]||0,E=o[u];E instanceof Array?n[u]=v(E,w):("string"===typeof E&&(E="+"===E.charAt(0)||"-"===E.charAt(0)?_+parseFloat(E):parseFloat(E)),"number"===typeof E&&(n[u]=_+(E-_)*w))}if(null!==y&&y.call(n,w),1===b){if(s>0){for(u in isFinite(s)&&s--,a){if("string"===typeof o[u]&&(a[u]=a[u]+parseFloat(o[u])),l){var S=a[u];a[u]=o[u],o[u]=S}i[u]=a[u]}return l&&(h=!h),p=void 0!==e?t+e:t+c,!0}null!==x&&x.call(n,n);for(var C=0,k=f.length;C<k;C++)f[C].start(p+r);return!1}return!0}},Bt.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-Bt.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*Bt.Easing.Bounce.In(2*t):.5*Bt.Easing.Bounce.Out(2*t-1)+.5}}},Bt.Interpolation={Linear:function(t,e){var n=t.length-1,i=n*e,o=Math.floor(i),a=Bt.Interpolation.Utils.Linear;return e<0?a(t[0],t[1],i):e>1?a(t[n],t[n-1],n-i):a(t[o],t[o+1>n?n:o+1],i-o)},Bezier:function(t,e){for(var n=0,i=t.length-1,o=Math.pow,a=Bt.Interpolation.Utils.Bernstein,r=0;r<=i;r++)n+=o(1-e,i-r)*o(e,r)*t[r]*a(i,r);return n},CatmullRom:function(t,e){var n=t.length-1,i=n*e,o=Math.floor(i),a=Bt.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(o=Math.floor(i=n*(1+e))),a(t[(o-1+n)%n],t[o],t[(o+1)%n],t[(o+2)%n],i-o)):e<0?t[0]-(a(t[0],t[0],t[1],t[1],-i)-t[0]):e>1?t[n]-(a(t[n],t[n],t[n-1],t[n-1],i-n)-t[n]):a(t[o?o-1:0],t[o],t[n<o+1?n:o+1],t[n<o+2?n:o+2],i-o)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=Bt.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n=1;if(t[e])return t[e];for(var i=e;i>1;i--)n*=i;return t[e]=n,n}}(),CatmullRom:function(t,e,n,i,o){var a=.5*(n-t),r=.5*(i-e),s=o*o,l=o*s;return(2*e-2*n+a+r)*l+(-3*e+3*n-2*a-r)*s+a*o+e}}};var jt={},Ut={draw:function(t,e,n){var i="http://huiyan.baidu.com/github/tools/gis-drawing/static/images/direction.png";n.arrow&&n.arrow.url&&(i=n.arrow.url),jt[i]||(jt[i]=null);var o=jt[i];if(!o){var a=Array.prototype.slice.call(arguments),r=new Image;return r.onload=function(){jt[i]=r,Ut.draw.apply(null,a)},void(r.src=i)}var s=e instanceof g?e.get():e;for(var l in t.save(),n)t[l]=n[l];for(var u=[],h=null,c=0,p=s.length;c<p;c++){var d=s[c];t.save(),(d.fillStyle||d._fillStyle)&&(t.fillStyle=d.fillStyle||d._fillStyle),(d.strokeStyle||d._strokeStyle)&&(t.strokeStyle=d.strokeStyle||d._strokeStyle);var v=d.geometry.type;if(t.beginPath(),"LineString"===v)for(var f=d.geometry._coordinates||d.geometry.coordinates,m=void 0!==n.arrow.interval?n.arrow.interval:1,y=0;y<f.length;y+=m)if(f[y]&&f[y+1]){var x=f[y];if(h&&Zt(x,h)<30)continue;t.save();var b=Nt(f[y],f[y+1]);t.translate(x[0],x[1]),t.rotate(b*Math.PI/180),t.drawImage(o,-o.width/2/2,-o.height/2/2,o.width/2,o.height/2),t.restore(),u.push(x),h=x}t.restore()}t.restore()}};function Zt(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}var Wt={draw:function(t,e,n){var i=e instanceof g?e.get():e;t.save(),t.fillStyle=n.fillStyle||"rgba(0, 0, 0, 0.5)",t.fillRect(0,0,t.canvas.width,t.canvas.height),n.multiPolygonDraw=function(){t.save(),t.clip(),o(t),t.restore()};for(var a=0,r=i.length;a<r;a++)t.beginPath(),x.drawDataSet(t,[i[a]],n),t.save(),t.clip(),o(t),t.restore();t.restore()}},Ht={},Yt={},Xt={draw:function(t,e,n){t.save();for(var i=e instanceof g?e.get():e,o=0;o<i.length;o++){var a=i[o],r=a.geometry._coordinates||a.geometry.coordinates;if(t.beginPath(),a.properties&&a.properties.cluster){if(t.arc(r[0],r[1],a.size,0,2*Math.PI),t.fillStyle=a.fillStyle,t.fill(),n.label&&!1!==n.label.show){t.fillStyle=n.label.fillStyle||"white",n.label.font&&(t.font=n.label.font),n.label.shadowColor&&(t.shadowColor=n.label.shadowColor),n.label.shadowBlur&&(t.shadowBlur=n.label.shadowBlur);var s=a.properties.point_count,l=t.measureText(s).width;t.fillText(s,r[0]+.5-l/2,r[1]+.5+3)}}else this.drawIcon(a,n,t)}t.restore()},drawIcon:function(t,e,n){var i=t.geometry._coordinates||t.geometry.coordinates,o=f(i,2),a=o[0],r=o[1],s=Object.assign({},e.iconOptions,t.iconOptions),l=function(){n.beginPath(),n.arc(a,r,e.size||5,0,2*Math.PI),n.fillStyle=e.fillStyle||"red",n.fill()};if(s.url){var u=s.width,h=s.height,c=s.offset||{x:0,y:0};a=a-~~u/2+c.x,r=r-~~h/2+c.y;var p=window.encodeURIComponent(s.url),d=Ht[p];d?"error"===d?l():u&&h?n.drawImage(d,a,r,u,h):n.drawImage(d,a,r):(Yt[p]||(Yt[p]=[],qt(p,(function(t,e){Yt[e]&&Yt[e].forEach((function(e){return e(t)})),Yt[e]=null,Ht[e]=t}),(function(t){Yt[t]&&Yt[t].forEach((function(e){return e("error",t)})),Yt[t]=null,Ht[t]="error",l()}))),Yt[p].push(function(t,e,i,o){return function(a){"error"===a?l():i&&o?n.drawImage(a,t,e,i,o):n.drawImage(a,t,e)}}(a,r,u,h)))}else l()}};function qt(t,e,n){var i=new Image;i.onload=function(){e&&e(i,t)},i.onerror=function(){n&&n(t)},i.src=window.decodeURIComponent(t)}var Vt={draw:function(t,e,n){var i=e instanceof g?e.get():e;for(var o in t.save(),n)t[o]=n[o];var a=[],r=n._size||n.size;r?t.font="bold "+r+"px Arial":r=12;var s=n.textKey||"text";if(n.textAlign||(t.textAlign="center"),n.textBaseline||(t.textBaseline="middle"),n.avoid)for(var l=0,u=i.length;l<u;l++){var h=i[l].offset||n.offset||{x:0,y:0},c=i[l].geometry._coordinates||i[l].geometry.coordinates,p=c[0]+h.x,d=c[1]+h.y,v=i[l][s],f=t.measureText(v).width,m=p-f/2,y=d-r/2,x={sw:{x:m,y:y+r},ne:{x:m+f,y:y}};$t(a,x)||(a.push(x),m+=f/2,y+=r/2,t.fillText(v,m,y))}else for(l=0,u=i.length;l<u;l++){h=i[l].offset||n.offset||{x:0,y:0},c=i[l].geometry._coordinates||i[l].geometry.coordinates,p=c[0]+h.x,d=c[1]+h.y,v=i[l][s];t.fillText(v,p,d)}t.restore()}};function $t(t,e){for(var n=0;n<t.length;n++)if(Gt(t[n],e))return!0;return!1}function Gt(t,e){var n=Math.min(t.ne.x,e.ne.x),i=Math.min(t.sw.y,e.sw.y),o=Math.max(t.sw.x,e.sw.x),a=Math.max(t.ne.y,e.ne.y);return n>o&&i>a}var Jt={},Qt={},Kt={draw:function(t,e,n){for(var i=e instanceof g?e.get():e,o=function(){var e=i[a];if(e.geometry)if(s=e.icon||n.icon,"string"===typeof s){var o=window.encodeURIComponent(s),r=Jt[o];r?te(r,n,t,e):(Qt[o]||(Qt[o]=[],ee(o,(function(t,e){Qt[e]&&Qt[e].forEach((function(e){return e(t)})),Qt[e]=null,Jt[e]=t}),(function(t){Qt[t]&&Qt[t].forEach((function(t){return t("error")})),Qt[t]=null,Jt[t]="error"}))),Qt[o].push((function(i){te(i,n,t,e)})))}else te(s,n,t,e)},a=0,r=i.length;a<r;a++){var s;o()}}};function te(t,e,n,i){n.save();var o=i.geometry._coordinates||i.geometry.coordinates,a=o[0],r=o[1],s=e.offset||{x:0,y:0},l=i.width||e._width||e.width,u=i.height||e._height||e.height;if(a=a-~~l/2+s.x,r=r-~~u/2+s.y,"string"===typeof t)return n.beginPath(),n.arc(a,r,e.size||5,0,2*Math.PI),n.fillStyle=e.fillStyle||"red",void n.fill();var h=i.deg||e.deg;h&&(n.translate(a,r),n.rotate(h*Math.PI/180),n.translate(-a,-r)),e.sx&&e.sy&&e.swidth&&e.sheight&&e.width&&e.height?n.drawImage(t,e.sx,e.sy,e.swidth,e.sheight,a,r,l,u):l&&u?n.drawImage(t,a,r,l,u):n.drawImage(t,a,r),n.restore()}function ee(t,e,n){var i=new Image;i.onload=function(){e&&e(i,t)},i.onerror=function(){n&&n(t)},i.src=window.decodeURIComponent(t)}function ne(t,e,n,i,o,a){if(!(o-i<=n)){var r=i+o>>1;ie(t,e,r,i,o,a%2),ne(t,e,n,i,r-1,a+1),ne(t,e,n,r+1,o,a+1)}}function ie(t,e,n,i,o,a){while(o>i){if(o-i>600){var r=o-i+1,s=n-i+1,l=Math.log(r),u=.5*Math.exp(2*l/3),h=.5*Math.sqrt(l*u*(r-u)/r)*(s-r/2<0?-1:1),c=Math.max(i,Math.floor(n-s*u/r+h)),p=Math.min(o,Math.floor(n+(r-s)*u/r+h));ie(t,e,n,c,p,a)}var d=e[2*n+a],v=i,f=o;oe(t,e,i,n),e[2*o+a]>d&&oe(t,e,i,o);while(v<f){oe(t,e,v,f),v++,f--;while(e[2*v+a]<d)v++;while(e[2*f+a]>d)f--}e[2*i+a]===d?oe(t,e,i,f):(f++,oe(t,e,f,o)),f<=n&&(i=f+1),n<=f&&(o=f-1)}}function oe(t,e,n,i){ae(t,n,i),ae(e,2*n,2*i),ae(e,2*n+1,2*i+1)}function ae(t,e,n){var i=t[e];t[e]=t[n],t[n]=i}function re(t,e,n,i,o,a,r){var s,l,u=[0,t.length-1,0],h=[];while(u.length){var c=u.pop(),p=u.pop(),d=u.pop();if(p-d<=r)for(var v=d;v<=p;v++)s=e[2*v],l=e[2*v+1],s>=n&&s<=o&&l>=i&&l<=a&&h.push(t[v]);else{var f=Math.floor((d+p)/2);s=e[2*f],l=e[2*f+1],s>=n&&s<=o&&l>=i&&l<=a&&h.push(t[f]);var g=(c+1)%2;(0===c?n<=s:i<=l)&&(u.push(d),u.push(f-1),u.push(g)),(0===c?o>=s:a>=l)&&(u.push(f+1),u.push(p),u.push(g))}}return h}function se(t,e,n,i,o,a){var r=[0,t.length-1,0],s=[],l=o*o;while(r.length){var u=r.pop(),h=r.pop(),c=r.pop();if(h-c<=a)for(var p=c;p<=h;p++)le(e[2*p],e[2*p+1],n,i)<=l&&s.push(t[p]);else{var d=Math.floor((c+h)/2),v=e[2*d],f=e[2*d+1];le(v,f,n,i)<=l&&s.push(t[d]);var g=(u+1)%2;(0===u?n-o<=v:i-o<=f)&&(r.push(c),r.push(d-1),r.push(g)),(0===u?n+o>=v:i+o>=f)&&(r.push(d+1),r.push(h),r.push(g))}}return s}function le(t,e,n,i){var o=t-n,a=e-i;return o*o+a*a}var ue=function(t){return t[0]},he=function(t){return t[1]},ce=function(t,e,n,i,o){void 0===e&&(e=ue),void 0===n&&(n=he),void 0===i&&(i=64),void 0===o&&(o=Float64Array),this.nodeSize=i,this.points=t;for(var a=t.length<65536?Uint16Array:Uint32Array,r=this.ids=new a(t.length),s=this.coords=new o(2*t.length),l=0;l<t.length;l++)r[l]=l,s[2*l]=e(t[l]),s[2*l+1]=n(t[l]);ne(r,s,i,0,r.length-1,0)};ce.prototype.range=function(t,e,n,i){return re(this.ids,this.coords,t,e,n,i,this.nodeSize)},ce.prototype.within=function(t,e,n){return se(this.ids,this.coords,t,e,n,this.nodeSize)};var pe={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(t){return t}},de=function(t){this.options=_e(Object.create(pe),t),this.trees=new Array(this.options.maxZoom+1)};function ve(t,e,n,i,o){return{x:t,y:e,zoom:1/0,id:n,parentId:-1,numPoints:i,properties:o}}function fe(t,e){var n=t.geometry.coordinates,i=n[0],o=n[1];return{x:ye(i),y:xe(o),zoom:1/0,index:e,parentId:-1}}function ge(t){return{type:"Feature",id:t.id,properties:me(t),geometry:{type:"Point",coordinates:[be(t.x),we(t.y)]}}}function me(t){var e=t.numPoints,n=e>=1e4?Math.round(e/1e3)+"k":e>=1e3?Math.round(e/100)/10+"k":e;return _e(_e({},t.properties),{cluster:!0,cluster_id:t.id,point_count:e,point_count_abbreviated:n})}function ye(t){return t/360+.5}function xe(t){var e=Math.sin(t*Math.PI/180),n=.5-.25*Math.log((1+e)/(1-e))/Math.PI;return n<0?0:n>1?1:n}function be(t){return 360*(t-.5)}function we(t){var e=(180-360*t)*Math.PI/180;return 360*Math.atan(Math.exp(e))/Math.PI-90}function _e(t,e){for(var n in e)t[n]=e[n];return t}function Ee(t){return t.x}function Se(t){return t.y}function Ce(t){requestAnimationFrame(Ce),Bt.update(t)}de.prototype.load=function(t){var e=this.options,n=(e.log,e.minZoom),i=e.maxZoom,o=e.nodeSize;t.length;this.points=t;for(var a=[],r=0;r<t.length;r++)t[r].geometry&&a.push(fe(t[r],r));this.trees[i+1]=new ce(a,Ee,Se,o,Float32Array);for(var s=i;s>=n;s--){Date.now();a=this._cluster(a,s),this.trees[s]=new ce(a,Ee,Se,o,Float32Array)}return this},de.prototype.getClusters=function(t,e){var n=((t[0]+180)%360+360)%360-180,i=Math.max(-90,Math.min(90,t[1])),o=180===t[2]?180:((t[2]+180)%360+360)%360-180,a=Math.max(-90,Math.min(90,t[3]));if(t[2]-t[0]>=360)n=-180,o=180;else if(n>o){var r=this.getClusters([n,i,180,a],e),s=this.getClusters([-180,i,o,a],e);return r.concat(s)}for(var l=this.trees[this._limitZoom(e)],u=l.range(ye(n),xe(a),ye(o),xe(i)),h=[],c=0,p=u;c<p.length;c+=1){var d=p[c],v=l.points[d];h.push(v.numPoints?ge(v):this.points[v.index])}return h},de.prototype.getChildren=function(t){var e=this._getOriginId(t),n=this._getOriginZoom(t),i="No cluster with the specified id.",o=this.trees[n];if(!o)throw new Error(i);var a=o.points[e];if(!a)throw new Error(i);for(var r=this.options.radius/(this.options.extent*Math.pow(2,n-1)),s=o.within(a.x,a.y,r),l=[],u=0,h=s;u<h.length;u+=1){var c=h[u],p=o.points[c];p.parentId===t&&l.push(p.numPoints?ge(p):this.points[p.index])}if(0===l.length)throw new Error(i);return l},de.prototype.getLeaves=function(t,e,n){e=e||10,n=n||0;var i=[];return this._appendLeaves(i,t,e,n,0),i},de.prototype.getTile=function(t,e,n){var i=this.trees[this._limitZoom(t)],o=Math.pow(2,t),a=this.options,r=a.extent,s=a.radius,l=s/r,u=(n-l)/o,h=(n+1+l)/o,c={features:[]};return this._addTileFeatures(i.range((e-l)/o,u,(e+1+l)/o,h),i.points,e,n,o,c),0===e&&this._addTileFeatures(i.range(1-l/o,u,1,h),i.points,o,n,o,c),e===o-1&&this._addTileFeatures(i.range(0,u,l/o,h),i.points,-1,n,o,c),c.features.length?c:null},de.prototype.getClusterExpansionZoom=function(t){var e=this._getOriginZoom(t)-1;while(e<=this.options.maxZoom){var n=this.getChildren(t);if(e++,1!==n.length)break;t=n[0].properties.cluster_id}return e},de.prototype._appendLeaves=function(t,e,n,i,o){for(var a=this.getChildren(e),r=0,s=a;r<s.length;r+=1){var l=s[r],u=l.properties;if(u&&u.cluster?o+u.point_count<=i?o+=u.point_count:o=this._appendLeaves(t,u.cluster_id,n,i,o):o<i?o++:t.push(l),t.length===n)break}return o},de.prototype._addTileFeatures=function(t,e,n,i,o,a){for(var r=0,s=t;r<s.length;r+=1){var l=s[r],u=e[l],h=u.numPoints,c={type:1,geometry:[[Math.round(this.options.extent*(u.x*o-n)),Math.round(this.options.extent*(u.y*o-i))]],tags:h?me(u):this.points[u.index].properties},p=void 0;h?p=u.id:this.options.generateId?p=u.index:this.points[u.index].id&&(p=this.points[u.index].id),void 0!==p&&(c.id=p),a.features.push(c)}},de.prototype._limitZoom=function(t){return Math.max(this.options.minZoom,Math.min(+t,this.options.maxZoom+1))},de.prototype._cluster=function(t,e){for(var n=[],i=this.options,o=i.radius,a=i.extent,r=i.reduce,s=i.minPoints,l=o/(a*Math.pow(2,e)),u=0;u<t.length;u++){var h=t[u];if(!(h.zoom<=e)){h.zoom=e;for(var c=this.trees[e+1],p=c.within(h.x,h.y,l),d=h.numPoints||1,v=d,f=0,g=p;f<g.length;f+=1){var m=g[f],y=c.points[m];y.zoom>e&&(v+=y.numPoints||1)}if(v>=s){for(var x=h.x*d,b=h.y*d,w=r&&d>1?this._map(h,!0):null,_=(u<<5)+(e+1)+this.points.length,E=0,S=p;E<S.length;E+=1){var C=S[E],k=c.points[C];if(!(k.zoom<=e)){k.zoom=e;var M=k.numPoints||1;x+=k.x*M,b+=k.y*M,k.parentId=_,r&&(w||(w=this._map(h,!0)),r(w,this._map(k)))}}h.parentId=_,n.push(ve(x/v,b/v,_,v,w))}else if(n.push(h),v>1)for(var L=0,P=p;L<P.length;L+=1){var T=P[L],D=c.points[T];D.zoom<=e||(D.zoom=e,n.push(D))}}}return n},de.prototype._getOriginId=function(t){return t-this.points.length>>5},de.prototype._getOriginZoom=function(t){return(t-this.points.length)%32},de.prototype._map=function(t,e){if(t.numPoints)return e?_e({},t.properties):t.properties;var n=this.points[t.index].properties,i=this.options.map(n);return e&&i===n?_e({},i):i},"undefined"!==typeof window&&requestAnimationFrame(Ce);var ke=function(){function t(e,n,i){h(this,t),n instanceof g||(n=new g(n)),this.dataSet=n,this.map=e,"cluster"===i.draw&&this.refreshCluster(i)}return c(t,[{key:"refreshCluster",value:function(t){t=t||this.options,this.supercluster=new de({maxZoom:t.maxZoom||19,radius:t.clusterRadius||100,minPoints:t.minPoints||2,extent:t.extent||512}),this.supercluster.load(this.dataSet.get()),this.supercluster.trees.forEach((function(t){var e=0,n=1/0;t.points.forEach((function(t){e=Math.max(t.numPoints||0,e),n=Math.min(t.numPoints||1/0,n)})),t.max=e,t.min=n})),this.clusterDataSet=new g}},{key:"getDefaultContextConfig",value:function(){return{globalAlpha:1,globalCompositeOperation:"source-over",imageSmoothingEnabled:!0,strokeStyle:"#000000",fillStyle:"#000000",shadowOffsetX:0,shadowOffsetY:0,shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0)",lineWidth:1,lineCap:"butt",lineJoin:"miter",miterLimit:10,lineDashOffset:0,font:"10px sans-serif",textAlign:"start",textBaseline:"alphabetic"}}},{key:"initDataRange",value:function(t){var e=this;if(e.intensity=new _({maxSize:e.options.maxSize,minSize:e.options.minSize,gradient:e.options.gradient,max:e.options.max||this.dataSet.getMax("count")}),e.category=new Ot(e.options.splitList),e.choropleth=new At(e.options.splitList),void 0===e.options.splitList&&e.category.generateByDataSet(this.dataSet,e.options.color),void 0===e.options.splitList){var n=e.options.min||this.dataSet.getMin("count"),i=e.options.max||this.dataSet.getMax("count");e.choropleth.generateByMinMax(n,i)}}},{key:"getLegend",value:function(t){this.options.draw;var e=this;return"intensity"==e.options.draw||"heatmap"==e.options.draw?this.intensity.getLegend(t):"category"==e.options.draw?this.category.getLegend(t):void 0}},{key:"processData",value:function(t){var e=this,n=e.options.draw;if("bubble"==n||"intensity"==n||"category"==n||"choropleth"==n||"simple"==n)for(var i=0;i<t.length;i++){var o=t[i];"bubble"==e.options.draw?t[i]._size=e.intensity.getSize(o.count):t[i]._size=void 0;var a="_fillStyle";"LineString"!==t[i].geometry.type&&"stroke"!==e.options.styleType||(a="_strokeStyle"),"intensity"==e.options.draw?t[i][a]=e.intensity.getColor(o.count):"category"==e.options.draw?t[i][a]=e.category.get(o.count):"choropleth"==e.options.draw&&(t[i][a]=e.choropleth.get(o.count))}}},{key:"isEnabledTime",value:function(){var t=this.options.animation,e=t&&!(!1===t.enabled);return e}},{key:"argCheck",value:function(t){"heatmap"==t.draw&&t.strokeStyle&&console.warn("[heatmap] options.strokeStyle is discard, pleause use options.strength [eg: options.strength = 0.1]")}},{key:"drawContext",value:function(t,e,n,i){var o=this;switch(o.options.draw){case"heatmap":A.draw(t,e,o.options);break;case"grid":case"cluster":case"honeycomb":o.options.offset={x:i.x,y:i.y},"grid"===o.options.draw?I.draw(t,e,o.options):"cluster"===o.options.draw?Xt.draw(t,e,o.options):R.draw(t,e,o.options);break;case"text":Vt.draw(t,e,o.options);break;case"icon":Kt.draw(t,e,o.options);break;case"clip":Wt.draw(t,e,o.options);break;default:"webgl"==o.options.context?Mt.draw(o.canvasLayer.canvas.getContext("webgl"),e,o.options):b.draw(t,e,o.options)}o.options.arrow&&!1!==o.options.arrow.show&&Ut.draw(t,e,o.options)}},{key:"isPointInPath",value:function(t,e){var n;t=this.canvasLayer.canvas.getContext(this.context);n="cluster"===this.options.draw&&(!this.options.maxClusterZoom||this.options.maxClusterZoom>=this.getZoom())?this.clusterDataSet.get():this.dataSet.get();for(var i=0;i<n.length;i++){t.beginPath();var o=this.options,a=e.x*this.canvasLayer.devicePixelRatio,r=e.y*this.canvasLayer.devicePixelRatio;o.multiPolygonDraw=function(){if(t.isPointInPath(a,r))return n[i]},x.draw(t,n[i],o);var s=n[i].geometry&&n[i].geometry.type;if(s.indexOf("LineString")>-1){if(t.isPointInStroke&&t.isPointInStroke(a,r))return n[i]}else if(t.isPointInPath(a,r))return n[i]}}},{key:"getClusterPoints",value:function(t){var e=this;if("Feature"!==t.type)return[];var n=this.supercluster.getChildren(t.id);return n.map((function(t){return"Feature"===t.type?e.getClusterPoints(t):t})).flat()}},{key:"clickEvent",value:function(t,e){if(this.options.methods){var n=this.isPointInPath(this.getContext(),t);if(n){if("cluster"===this.options.draw){var i=this.getClusterPoints(n);n.children=i}this.options.methods.click(n,e)}else this.options.methods.click(null,e)}}},{key:"mousemoveEvent",value:function(t,e){if(this.options.methods){var n=this.isPointInPath(this.getContext(),t);if(n){if("cluster"===this.options.draw){var i=this.getClusterPoints(n);n.children=i}this.options.methods.mousemove(n,e)}else this.options.methods.mousemove(null,e)}}},{key:"tapEvent",value:function(t,e){if(this.options.methods){var n=this.isPointInPath(this.getContext(),t);if(n){if("cluster"===this.options.draw){var i=this.getClusterPoints(n);n.children=i}this.options.methods.tap(n,e)}else this.options.methods.tap(null,e)}}},{key:"update",value:function(t,e){var n=this,i=t.options,o=n.options;for(var a in i)o[a]=i[a];n.init(o),!1!==e&&n.draw()}},{key:"setOptions",value:function(t){var e=this;e.dataSet.reset(),e.init(t),e.draw()}},{key:"set",value:function(t){var e=this,n=this.getContext(),i=this.getDefaultContextConfig();for(var o in i)n[o]=i[o];e.init(t.options),e.draw()}},{key:"destroy",value:function(){this.unbindEvent(),this.hide()}},{key:"initAnimator",value:function(){var t=this,e=t.options.animation;if("time"==t.options.draw||t.isEnabledTime()){e.stepsRange||(e.stepsRange={start:this.dataSet.getMin("time")||0,end:this.dataSet.getMax("time")||0}),this.steps={step:e.stepsRange.start},t.animator=new Bt.Tween(this.steps).onUpdate((function(){t._canvasUpdate(this.step)})).repeat(1/0),this.addAnimatorEvent();var n=1e3*e.duration||5e3;t.animator.to({step:e.stepsRange.end},n),t.animator.start()}else t.animator&&t.animator.stop()}},{key:"addAnimatorEvent",value:function(){}},{key:"animatorMovestartEvent",value:function(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start,this.animator.stop())}},{key:"animatorMoveendEvent",value:function(){this.isEnabledTime()&&this.animator&&this.animator.start()}}]),t}(),Me="undefined"===typeof window?{}:window,Le=Me.BMap||Me.BMapGL,Pe=function(t){function e(t,n,i){h(this,e);var o=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i));o.map=t,o.options=i||{},o.dataSet=n;var a=new zt({map:t,zIndex:o.options.zIndex,update:o._canvasUpdate.bind(o)});o.init(o.options),o.canvasLayer=a,o.transferToMercator();var r=o;return n.on("change",(function(){r.transferToMercator(),a.draw()})),o.ctx=a.canvas.getContext("2d"),o.start(),o}return d(e,t),c(e,[{key:"draw",value:function(){this.canvasLayer.draw()}},{key:"init",value:function(t){var e=this;e.options=t,this.initDataRange(t),this.context=e.options.context||"2d",e.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(e.options.zIndex),e.options.max&&this.intensity.setMax(e.options.max),e.options.min&&this.intensity.setMin(e.options.min),this.initAnimator()}},{key:"transferToMercator",value:function(){var t,e=this.map,n=e.getMapType();if(t=n.getProjection?n.getProjection():{lngLatToPoint:function(t){var n=e.lnglatToMercator(t.lng,t.lat);return{x:n[0],y:n[1]}}},"bd09mc"!==this.options.coordType){var i=this.dataSet.get();i=this.dataSet.transferCoordinate(i,(function(e){var n=t.lngLatToPoint({lng:e[0],lat:e[1]});return[n.x,n.y]}),"coordinates","coordinates_mercator"),this.dataSet._set(i)}}},{key:"_canvasUpdate",value:function(){var t=this.ctx;if(t){var e,n,i,a=this.map;a.getMapType().getProjection?(e=a.getMapType().getProjection(),n=e.lngLatToPoint(a.getCenter())):(n={x:a.getCenter().lng,y:a.getCenter().lat},n.x>-180&&n.x<180&&(n=a.lnglatToMercator(n.x,n.y),n={x:n[0],y:n[1]}),e={lngLatToPoint:function(t){var e=a.lnglatToMercator(t.lng,t.lat);return{x:e[0],y:e[1]}}}),i=e.getZoomUnits?e.getZoomUnits(a.getZoom()):Math.pow(2,18-a.getZoom());var r=new Le.Pixel(n.x-a.getSize().width/2*i,n.y+a.getSize().height/2*i);o(t);var s={fromColumn:"bd09mc"==this.options.coordType?"coordinates":"coordinates_mercator",transferCoordinate:function(t){if(t){var e=(t[0]-r.x)/i,n=(r.y-t[1])/i;return[e,n]}}};this.data=this.dataSet.get(s),this.processData(this.data),this.drawAnimation()}}},{key:"drawAnimation",value:function(){var t=this.ctx,e=this.data;if(e){t.save(),t.globalCompositeOperation="destination-out",t.fillStyle="rgba(0, 0, 0, .1)",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.restore(),t.save(),this.options.shadowColor&&(t.shadowColor=this.options.shadowColor),this.options.shadowBlur&&(t.shadowBlur=this.options.shadowBlur),this.options.globalAlpha&&(t.globalAlpha=this.options.globalAlpha),this.options.globalCompositeOperation&&(t.globalCompositeOperation=this.options.globalCompositeOperation);for(var n=this.options,i=0;i<e.length;i++)if("Point"===e[i].geometry.type){t.beginPath();var o=e[i].size||this.options.size,a=e[i].minSize||this.options.minSize||0;void 0===e[i]._size&&(e[i]._size=a),t.arc(e[i].geometry._coordinates[0],e[i].geometry._coordinates[1],e[i]._size,0,2*Math.PI,!0),t.closePath(),e[i]._size++,e[i]._size>o&&(e[i]._size=a),t.lineWidth=1,t.strokeStyle=e[i].strokeStyle||e[i]._strokeStyle||n.strokeStyle||"yellow",t.stroke();var r=e[i].fillStyle||e[i]._fillStyle||n.fillStyle;r&&(t.fillStyle=r,t.fill())}else if("LineString"===e[i].geometry.type){t.beginPath();var s=e[i].size||this.options.size||5;a=e[i].minSize||this.options.minSize||0;void 0===e[i]._index&&(e[i]._index=0);var l=e[i]._index;t.arc(e[i].geometry._coordinates[l][0],e[i].geometry._coordinates[l][1],s,0,2*Math.PI,!0),t.closePath(),e[i]._index++,e[i]._index>=e[i].geometry._coordinates.length&&(e[i]._index=0);var u=e[i].strokeStyle||n.strokeStyle;r=e[i].fillStyle||n.fillStyle||"yellow";t.fillStyle=r,t.fill(),u&&n.lineWidth&&(t.lineWidth=n.lineWidth||1,t.strokeStyle=u,t.stroke())}t.restore()}}},{key:"animate",value:function(){this.drawAnimation();var t=this.options.animateTime||100;this.timeout=setTimeout(this.animate.bind(this),t)}},{key:"start",value:function(){this.stop(),this.animate()}},{key:"stop",value:function(){clearTimeout(this.timeout)}},{key:"unbindEvent",value:function(){}},{key:"hide",value:function(){this.canvasLayer.hide(),this.stop()}},{key:"show",value:function(){this.start()}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"destroy",value:function(){this.stop(),this.unbindEvent(),this.clearData(),this.map.removeOverlay(this.canvasLayer),this.canvasLayer=null}}]),e}(ke),Te="undefined"===typeof window?{}:window,De=Te.BMap||Te.BMapGL,Oe=function(t){function e(t,n,i){h(this,e);var o=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i)),a=o;i=i||{},o.clickEvent=o.clickEvent.bind(o),o.mousemoveEvent=o.mousemoveEvent.bind(o),o.tapEvent=o.tapEvent.bind(o),a.init(i),a.argCheck(i),a.transferToMercator();var r=o.canvasLayer=new zt({map:t,context:o.context,updateImmediate:i.updateImmediate,paneName:i.paneName,mixBlendMode:i.mixBlendMode,enableMassClear:i.enableMassClear,zIndex:i.zIndex,update:function(){a._canvasUpdate()}});return n.on("change",(function(){a.transferToMercator(),"cluster"===i.draw&&a.refreshCluster(),r.draw()})),o}return d(e,t),c(e,[{key:"clickEvent",value:function(t){var n=t.pixel;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clickEvent",this).call(this,n,t)}},{key:"mousemoveEvent",value:function(t){var n=t.pixel;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mousemoveEvent",this).call(this,n,t)}},{key:"tapEvent",value:function(t){var n=t.pixel;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"tapEvent",this).call(this,n,t)}},{key:"bindEvent",value:function(t){this.unbindEvent();var e=this.map,n=0,i=this;this.options.methods&&(this.options.methods.click&&(e.setDefaultCursor("default"),e.addEventListener("click",this.clickEvent)),this.options.methods.mousemove&&e.addEventListener("mousemove",this.mousemoveEvent),"ontouchend"in window.document&&this.options.methods.tap&&(e.addEventListener("touchstart",(function(t){n=new Date})),e.addEventListener("touchend",(function(t){new Date-n<300&&i.tapEvent(t)}))))}},{key:"unbindEvent",value:function(t){var e=this.map;this.options.methods&&(this.options.methods.click&&e.removeEventListener("click",this.clickEvent),this.options.methods.mousemove&&e.removeEventListener("mousemove",this.mousemoveEvent))}},{key:"transferToMercator",value:function(t){t||(t=this.dataSet);var e,n=this.map,i=n.getMapType();if(e=i.getProjection?i.getProjection():{lngLatToPoint:function(t){var e=n.lnglatToMercator(t.lng,t.lat);return{x:e[0],y:e[1]}}},"bd09mc"!==this.options.coordType){var o=t.get();o=t.transferCoordinate(o,(function(t){if(t[0]<-180||t[0]>180||t[1]<-90||t[1]>90)return t;var n=e.lngLatToPoint({lng:t[0],lat:t[1]});return[n.x,n.y]}),"coordinates","coordinates_mercator"),t._set(o)}}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"_canvasUpdate",value:function(t){if(this.canvasLayer){var e,n,i,a=this,r=this.options.animation,s=this.canvasLayer._map;s.getMapType().getProjection?(e=s.getMapType().getProjection(),n=e.lngLatToPoint(s.getCenter())):(n={x:s.getCenter().lng,y:s.getCenter().lat},n.x>-180&&n.x<180&&(n=s.lnglatToMercator(n.x,n.y),n={x:n[0],y:n[1]}),e={lngLatToPoint:function(t){var e=s.lnglatToMercator(t.lng,t.lat);return{x:e[0],y:e[1]}}}),i=e.getZoomUnits?e.getZoomUnits(s.getZoom()):Math.pow(2,18-s.getZoom());var l=new De.Pixel(n.x-s.getSize().width/2*i,n.y+s.getSize().height/2*i),u=this.getContext();if(this.isEnabledTime()){if(void 0===t)return void o(u);"2d"==this.context&&(u.save(),u.globalCompositeOperation="destination-out",u.fillStyle="rgba(0, 0, 0, .1)",u.fillRect(0,0,u.canvas.width,u.canvas.height),u.restore())}else o(u);if("2d"==this.context)for(var h in this.options)u[h]=this.options[h];else u.clear(u.COLOR_BUFFER_BIT);if(!(this.options.minZoom&&s.getZoom()<this.options.minZoom||this.options.maxZoom&&s.getZoom()>this.options.maxZoom)){var c=1;"2d"!=this.context&&(c=this.canvasLayer.devicePixelRatio);var p,d={fromColumn:"bd09mc"==this.options.coordType?"coordinates":"coordinates_mercator",transferCoordinate:function(t){var e=(t[0]-l.x)/i*c,n=(l.y-t[1])/i*c;return[e,n]}};void 0!==t&&(d.filter=function(e){var n=r.trails||10;return!!(t&&e.time>t-n&&e.time<t)});var v=this.getZoom();if("cluster"===this.options.draw&&(!this.options.maxClusterZoom||this.options.maxClusterZoom>=v)){var f=this.map.getBounds(),g=f.getNorthEast(),m=f.getSouthWest(),y=this.supercluster.getClusters([m.lng,m.lat,g.lng,g.lat],v);this.pointCountMax=this.supercluster.trees[v].max,this.pointCountMin=this.supercluster.trees[v].min;var x={},b=null,w=null;this.pointCountMax===this.pointCountMin?(b=this.options.fillStyle,w=this.options.minSize||8):x=new _({min:this.pointCountMin,max:this.pointCountMax,minSize:this.options.minSize||8,maxSize:this.options.maxSize||30,gradient:this.options.gradient});for(var E=0;E<y.length;E++){var S=y[E];S.properties&&S.properties.cluster_id?(y[E].size=w||x.getSize(S.properties.point_count),y[E].fillStyle=b||x.getColor(S.properties.point_count)):y[E].size=a.options.size}this.clusterDataSet.set(y),this.transferToMercator(this.clusterDataSet),p=a.clusterDataSet.get(d)}else p=a.dataSet.get(d);this.processData(p);var C=s.pointToPixel(new De.Point(0,0));"m"==a.options.unit?(a.options.size&&(a.options._size=a.options.size/i),a.options.width&&(a.options._width=a.options.width/i),a.options.height&&(a.options._height=a.options.height/i)):(a.options._size=a.options.size,a.options._height=a.options.height,a.options._width=a.options.width),this.drawContext(u,p,a.options,C),a.options.updateCallback&&a.options.updateCallback(t)}}}},{key:"init",value:function(t){var e=this;e.options=t,this.initDataRange(t),this.context=e.options.context||"2d",e.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(e.options.zIndex),e.options.max&&this.intensity.setMax(e.options.max),e.options.min&&this.intensity.setMin(e.options.min),this.initAnimator(),this.bindEvent()}},{key:"getZoom",value:function(){return this.map.getZoom()}},{key:"addAnimatorEvent",value:function(){this.map.addEventListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addEventListener("moveend",this.animatorMoveendEvent.bind(this))}},{key:"show",value:function(){this.map.addOverlay(this.canvasLayer),this.bindEvent()}},{key:"hide",value:function(){this.unbindEvent(),this.map.removeOverlay(this.canvasLayer)}},{key:"draw",value:function(){this.canvasLayer&&this.canvasLayer.draw()}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"destroy",value:function(){this.unbindEvent(),this.clearData(),this.map.removeOverlay(this.canvasLayer),this.canvasLayer=null}}]),e}(ke);function Ae(t){this.isAdded_=!1,this.isAnimated_=!1,this.paneName_=Ae.DEFAULT_PANE_NAME_,this.updateHandler_=null,this.resizeHandler_=null,this.topLeft_=null,this.centerListener_=null,this.resizeListener_=null,this.needsResize_=!0,this.requestAnimationFrameId_=null;var e=document.createElement("canvas");function n(t,e){return function(){e.apply(t)}}e.style.position="absolute",e.style.top=0,e.style.left=0,e.style.pointerEvents="none",this.canvas=e,this.canvasCssWidth_=300,this.canvasCssHeight_=150,this.resolutionScale_=1,this.repositionFunction_=n(this,this.repositionCanvas_),this.resizeFunction_=n(this,this.resize_),this.requestUpdateFunction_=n(this,this.update_),t&&this.setOptions(t)}var Ie="undefined"===typeof window?{}:window;Ie.google&&Ie.google.maps&&(Ae.prototype=new google.maps.OverlayView,Ae.DEFAULT_PANE_NAME_="overlayLayer",Ae.CSS_TRANSFORM_=function(){for(var t=document.createElement("div"),e=["transform","WebkitTransform","MozTransform","OTransform","msTransform"],n=0;n<e.length;n++){var i=e[n];if(void 0!==t.style[i])return i}return e[0]}(),Ae.prototype.requestAnimFrame_=Ie.requestAnimationFrame||Ie.webkitRequestAnimationFrame||Ie.mozRequestAnimationFrame||Ie.oRequestAnimationFrame||Ie.msRequestAnimationFrame||function(t){return Ie.setTimeout(t,1e3/60)},Ae.prototype.cancelAnimFrame_=Ie.cancelAnimationFrame||Ie.webkitCancelAnimationFrame||Ie.mozCancelAnimationFrame||Ie.oCancelAnimationFrame||Ie.msCancelAnimationFrame||function(t){},Ae.prototype.setOptions=function(t){void 0!==t.animate&&this.setAnimate(t.animate),void 0!==t.paneName&&this.setPaneName(t.paneName),void 0!==t.updateHandler&&this.setUpdateHandler(t.updateHandler),void 0!==t.resizeHandler&&this.setResizeHandler(t.resizeHandler),void 0!==t.resolutionScale&&this.setResolutionScale(t.resolutionScale),void 0!==t.map&&this.setMap(t.map)},Ae.prototype.setAnimate=function(t){this.isAnimated_=!!t,this.isAnimated_&&this.scheduleUpdate()},Ae.prototype.isAnimated=function(){return this.isAnimated_},Ae.prototype.setPaneName=function(t){this.paneName_=t,this.setPane_()},Ae.prototype.getPaneName=function(){return this.paneName_},Ae.prototype.setPane_=function(){if(this.isAdded_){var t=this.getPanes();if(!t[this.paneName_])throw new Error('"'+this.paneName_+'" is not a valid MapPane name.');t[this.paneName_].appendChild(this.canvas)}},Ae.prototype.setResizeHandler=function(t){this.resizeHandler_=t},Ae.prototype.setResolutionScale=function(t){"number"===typeof t&&(this.resolutionScale_=t,this.resize_())},Ae.prototype.setUpdateHandler=function(t){this.updateHandler_=t},Ae.prototype.onAdd=function(){this.isAdded_||(this.isAdded_=!0,this.setPane_(),this.resizeListener_=google.maps.event.addListener(this.getMap(),"resize",this.resizeFunction_),this.centerListener_=google.maps.event.addListener(this.getMap(),"center_changed",this.repositionFunction_),this.resize_(),this.repositionCanvas_())},Ae.prototype.onRemove=function(){this.isAdded_&&(this.isAdded_=!1,this.topLeft_=null,this.canvas.parentElement.removeChild(this.canvas),this.centerListener_&&(google.maps.event.removeListener(this.centerListener_),this.centerListener_=null),this.resizeListener_&&(google.maps.event.removeListener(this.resizeListener_),this.resizeListener_=null),this.requestAnimationFrameId_&&(this.cancelAnimFrame_.call(Ie,this.requestAnimationFrameId_),this.requestAnimationFrameId_=null))},Ae.prototype.resize_=function(){if(this.isAdded_){var t=this.getMap(),e=t.getDiv().offsetWidth,n=t.getDiv().offsetHeight,i=e*this.resolutionScale_,o=n*this.resolutionScale_,a=this.canvas.width,r=this.canvas.height;a===i&&r===o||(this.canvas.width=i,this.canvas.height=o,this.needsResize_=!0,this.scheduleUpdate()),this.canvasCssWidth_===e&&this.canvasCssHeight_===n||(this.canvasCssWidth_=e,this.canvasCssHeight_=n,this.canvas.style.width=e+"px",this.canvas.style.height=n+"px")}},Ae.prototype.draw=function(){this.repositionCanvas_()},Ae.prototype.repositionCanvas_=function(){var t=this.getMap(),e=t.getBounds().getNorthEast().lat(),n=t.getCenter(),i=Math.pow(2,t.getZoom()),o=n.lng()-180*this.canvasCssWidth_/(256*i);this.topLeft_=new google.maps.LatLng(e,o);var a=this.getProjection(),r=a.fromLatLngToDivPixel(n),s=-Math.round(this.canvasCssWidth_/2-r.x),l=-Math.round(this.canvasCssHeight_/2-r.y);this.canvas.style[Ae.CSS_TRANSFORM_]="translate("+s+"px,"+l+"px)",this.scheduleUpdate()},Ae.prototype.update_=function(){this.requestAnimationFrameId_=null,this.isAdded_&&(this.isAnimated_&&this.scheduleUpdate(),this.needsResize_&&this.resizeHandler_&&(this.needsResize_=!1,this.resizeHandler_()),this.updateHandler_&&this.updateHandler_())},Ae.prototype.getTopLeft=function(){return this.topLeft_},Ae.prototype.scheduleUpdate=function(){this.isAdded_&&!this.requestAnimationFrameId_&&(this.requestAnimationFrameId_=this.requestAnimFrame_.call(Ie,this.requestUpdateFunction_))});var ze=function(t){function e(t,n,i){h(this,e);var o=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i)),a=o;i=i||{},a.init(i),a.argCheck(i);var r={map:t,animate:!1,updateHandler:function(){a._canvasUpdate()},resolutionScale:resolutionScale};o.canvasLayer=new Ae(r);return o.clickEvent=o.clickEvent.bind(o),o.mousemoveEvent=o.mousemoveEvent.bind(o),o.bindEvent(),o}return d(e,t),c(e,[{key:"clickEvent",value:function(t){var n=t.pixel;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clickEvent",this).call(this,n,t)}},{key:"mousemoveEvent",value:function(t){var n=t.pixel;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mousemoveEvent",this).call(this,n,t)}},{key:"bindEvent",value:function(t){var e=this.map;this.options.methods&&(this.options.methods.click&&(e.setDefaultCursor("default"),e.addListener("click",this.clickEvent)),this.options.methods.mousemove&&e.addListener("mousemove",this.mousemoveEvent))}},{key:"unbindEvent",value:function(t){var e=this.map;this.options.methods&&(this.options.methods.click&&e.removeListener("click",this.clickEvent),this.options.methods.mousemove&&e.removeListener("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"_canvasUpdate",value:function(t){if(this.canvasLayer){var e=this,n=e.options.animation,i=this.getContext();if(e.isEnabledTime()){if(void 0===t)return void o(i);"2d"==this.context&&(i.save(),i.globalCompositeOperation="destination-out",i.fillStyle="rgba(0, 0, 0, .1)",i.fillRect(0,0,i.canvas.width,i.canvas.height),i.restore())}else o(i);if("2d"==this.context)for(var a in e.options)i[a]=e.options[a];else i.clear(i.COLOR_BUFFER_BIT);if(!(e.options.minZoom&&s.getZoom()<e.options.minZoom||e.options.maxZoom&&s.getZoom()>e.options.maxZoom)){var r=1;"2d"!=this.context&&(r=this.canvasLayer.devicePixelRatio);var s=this.map,l=s.getProjection(),u=(r=Math.pow(2,s.zoom)*resolutionScale,l.fromLatLngToPoint(this.canvasLayer.getTopLeft())),h={transferCoordinate:function(t){var e=new google.maps.LatLng(t[1],t[0]),n=l.fromLatLngToPoint(e),i={x:(n.x-u.x)*r,y:(n.y-u.y)*r};return[i.x,i.y]}};void 0!==t&&(h.filter=function(e){var i=n.trails||10;return!!(t&&e.time>t-i&&e.time<t)});var c=e.dataSet.get(h);this.processData(c);var p=new google.maps.LatLng(0,0),d=l.fromLatLngToPoint(p),v={x:(d.x-u.x)*r,y:(d.y-u.y)*r};"m"==e.options.unit&&e.options.size?e.options._size=e.options.size/zoomUnit:e.options._size=e.options.size,this.drawContext(i,new g(c),e.options,v),e.options.updateCallback&&e.options.updateCallback(t)}}}},{key:"init",value:function(t){var e=this;e.options=t,this.initDataRange(t),this.context=e.options.context||"2d",e.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(e.options.zIndex),this.initAnimator()}},{key:"addAnimatorEvent",value:function(){this.map.addListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addListener("moveend",this.animatorMoveendEvent.bind(this))}},{key:"show",value:function(){this.map.addOverlay(this.canvasLayer)}},{key:"hide",value:function(){this.map.removeOverlay(this.canvasLayer)}},{key:"draw",value:function(){self.canvasLayer.draw()}}]),e}(ke),Re=void 0;if("undefined"!==typeof n){Re=function(t){function e(t,n,i){h(this,e);var o=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i));return o.options_=i,o.dataSet=n,o._initBaseLayer(i),o}return d(e,t),c(e,[{key:"_initBaseLayer",value:function(t){var e=this,n=this.baseLayer=new ke(null,this.dataSet,t);e.init(t),n.argCheck(t)}},{key:"clickEvent",value:function(t){if(this.baseLayer){var e=t.containerPoint;this.baseLayer.clickEvent(e,t.domEvent)}}},{key:"mousemoveEvent",value:function(t){if(this.baseLayer){var e=t.containerPoint;this.baseLayer.mousemoveEvent(e,t.domEvent)}}},{key:"getEvents",value:function(){return{click:this.clickEvent,mousemove:this.mousemoveEvent}}},{key:"init",value:function(t){var e=this.baseLayer;e.options=t,e.initDataRange(t),e.context=e.options.context||"2d",e.initAnimator()}},{key:"addAnimatorEvent",value:function(){this.map.addListener("movestart",this.animatorMovestartEvent.bind(this)),this.map.addListener("moveend",this.animatorMoveendEvent.bind(this))}}]),e}(n.Layer);var Fe=function(t){function e(){return h(this,e),v(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return d(e,t),c(e,[{key:"needToRedraw",value:function(){var t=this.layer.baseLayer;return!!t.isEnabledTime()||p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"needToRedraw",this).call(this)}},{key:"draw",value:function(){var t=this.layer.baseLayer;this.canvas&&t.isEnabledTime()&&!this._shouldClear||(this.prepareCanvas(),this._shouldClear=!1),this._update(this.gl||this.context,this._mapvFrameTime),delete this._mapvFrameTime,this.completeRender()}},{key:"drawOnInteracting",value:function(){this.draw(),this._shouldClear=!1}},{key:"onSkipDrawOnInteracting",value:function(){this._shouldClear=!0}},{key:"_canvasUpdate",value:function(t){this.setToRedraw(),this._mapvFrameTime=t}},{key:"_update",value:function(t,e){if(this.canvas){var i=this.layer.baseLayer,a=i.options.animation,r=this.getMap();if(i.isEnabledTime()){if(void 0===e)return void o(t);"2d"==i.context&&(t.save(),t.globalCompositeOperation="destination-out",t.fillStyle="rgba(0, 0, 0, .1)",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.restore())}else o(t);if("2d"==i.context)for(var s in i.options)t[s]=i.options[s];else t.clear(t.COLOR_BUFFER_BIT);var l=1,u=new n.Coordinate(0,0),h={fromColumn:"bd09mc"===i.options.coordType?"coordinates_mercator":"coordinates",transferCoordinate:function(t){u.x=t[0],u.y=t[1];var e=r.coordToContainerPoint(u)._multi(l).toArray();return e}};void 0!==e&&(h.filter=function(t){var n=a.trails||10;return!!(e&&t.time>e-n&&t.time<e)});var c=i.dataSet.get(h);i.processData(c),"m"==i.options.unit?(i.options.size&&(i.options._size=i.options.size/zoomUnit),i.options.width&&(i.options._width=i.options.width/zoomUnit),i.options.height&&(i.options._height=i.options.height/zoomUnit)):(i.options._size=i.options.size,i.options._height=i.options.height,i.options._width=i.options.width);var p=new n.Point(0,0),d=r._pointToContainerPoint(p)._multi(l);i.drawContext(t,c,i.options,d),i.options.updateCallback&&i.options.updateCallback(e)}}},{key:"createCanvas",value:function(){if(!this.canvas){var t=this.getMap(),e=t.getSize(),i=t.getDevicePixelRatio?t.getDevicePixelRatio():n.Browser.retina?2:1,o=i*e.width,a=i*e.height;this.canvas=n.Canvas.createCanvas(o,a,t.CanvasClass);var r=this.layer.baseLayer.context;if("2d"===r)this.context=this.canvas.getContext("2d"),this.layer.options["globalCompositeOperation"]&&(this.context.globalCompositeOperation=this.layer.options["globalCompositeOperation"]),"heatmap"!==this.layer.baseLayer.options.draw&&1!==i&&this.context.scale(i,i);else{var s={alpha:!0,preserveDrawingBuffer:!0,antialias:!1};this.gl=this.canvas.getContext("webgl",s)}this.onCanvasCreate(),this._bindToMapv(),this.layer.fire("canvascreate",{context:this.context,gl:this.gl})}}},{key:"_bindToMapv",value:function(){var t=this.layer.baseLayer,e=this.getMap();this.devicePixelRatio=e.getDevicePixelRatio?e.getDevicePixelRatio():n.Browser.retina?2:1,t.canvasLayer=this,t._canvasUpdate=this._canvasUpdate.bind(this),t.getContext=function(){var t=self.getRenderer();return t.gl||t.context}}}]),e}(n.renderer.CanvasRenderer);Re.registerRenderer("canvas",Fe)}var Be,Ne=Re,je=function(t,e,n){if("undefined"!==typeof document){var i=document.createElement("canvas");return i.width=t,i.height=e,i}return new n(t,e)},Ue=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments[1],i=arguments[2];h(this,e);var o=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i));return o.options=i,o.canvasLayer={canvas:null,devicePixelRatio:window.devicePixelRatio},o.layer_=null,o.initDataRange(i),o.initAnimator(),o.onEvents(),t.on("complete",(function(){this.init(t,i),this.argCheck(i)}),o),o}return d(e,t),c(e,[{key:"init",value:function(t,e){if(!t)throw new Error("not map object");this.map=t,this.context=this.options.context||"2d",this.getCanvasLayer()}},{key:"_canvasUpdate",value:function(t){this.render(this.canvasLayer.canvas,t)}},{key:"render",value:function(t,e){if(t){var n=this.map,i=t.getContext(this.context),a=this.options.animation;if(this.isEnabledTime()){if(void 0===e)return o(i),this;"2d"===this.context&&(i.save(),i.globalCompositeOperation="destination-out",i.fillStyle="rgba(0, 0, 0, .1)",i.fillRect(0,0,i.canvas.width,i.canvas.height),i.restore())}else o(i);if("2d"===this.context)for(var r in this.options)i[r]=this.options[r];else i.clear(i.COLOR_BUFFER_BIT);var s={transferCoordinate:function(t){var e=n.lngLatToContainer(new AMap.LngLat(t[0],t[1]));return[e["x"],e["y"]]}};void 0!==e&&(s.filter=function(t){var n=a.trails||10;return!!(e&&t.time>e-n&&t.time<e)});var l=this.dataSet.get(s);return this.processData(l),"m"===this.options.unit?(this.options.size&&(this.options._size=this.options.size/zoomUnit),this.options.width&&(this.options._width=this.options.width/zoomUnit),this.options.height&&(this.options._height=this.options.height/zoomUnit)):(this.options._size=this.options.size,this.options._height=this.options.height,this.options._width=this.options.width),this.drawContext(i,new g(l),this.options,{x:0,y:0}),this.options.updateCallback&&this.options.updateCallback(e),this}}},{key:"getCanvasLayer",value:function(){if(!this.canvasLayer.canvas&&!this.layer_){var t=this.canvasFunction(),e=this.map.getBounds();this.layer_=new AMap.CanvasLayer({canvas:t,bounds:this.options.bounds||e,zooms:this.options.zooms||[0,22]}),this.layer_.setMap(this.map),this.map.on("mapmove",this.canvasFunction,this),this.map.on("zoomchange",this.canvasFunction,this)}}},{key:"canvasFunction",value:function(){var t=[this.map.getSize().width,this.map.getSize().height],e=t[0],n=t[1];if(this.canvasLayer.canvas){this.canvasLayer.canvas.width=e,this.canvasLayer.canvas.height=n;var i=this.map.getBounds();this.layer_&&this.layer_.setBounds(this.options.bounds||i)}else this.canvasLayer.canvas=je(e,n);return this.render(this.canvasLayer.canvas),this.canvasLayer.canvas}},{key:"removeLayer",value:function(){this.map&&(this.unEvents(),this.map.removeLayer(this.layer_),delete this.map,delete this.layer_,delete this.canvasLayer.canvas)}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"clickEvent",value:function(t){var n=t.pixel;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clickEvent",this).call(this,n,t)}},{key:"mousemoveEvent",value:function(t){var n=t.pixel;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mousemoveEvent",this).call(this,n,t)}},{key:"addAnimatorEvent",value:function(){this.map.on("movestart",this.animatorMovestartEvent,this),this.map.on("moveend",this.animatorMoveendEvent,this)}},{key:"onEvents",value:function(){var t=this.map;this.unEvents(),this.options.methods&&(this.options.methods.click&&t.on("click",this.clickEvent,this),this.options.methods.mousemove&&t.on("mousemove",this.mousemoveEvent,this))}},{key:"unEvents",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent,this),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent,this))}}]),e}(ke),Ze=function(t,e){if("undefined"!==typeof document){var n=document.createElement("canvas");return n.width=t,n.height=e,n}},We=function(t){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments[1],i=arguments[2];h(this,e);var o=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i));return o.options=i,o.canvasLayer={canvas:null,devicePixelRatio:window.devicePixelRatio},o.layer_=null,o.previousCursor_=void 0,o.init(t,i),o.argCheck(i),o}return d(e,t),c(e,[{key:"init",value:function(t,e){if(!(t&&t instanceof ol.Map))throw new Error("not map object");this.$Map=t,this.context=this.options.context||"2d",this.getCanvasLayer(),this.initDataRange(e),this.initAnimator(),this.onEvents()}},{key:"_canvasUpdate",value:function(t){this.render(this.canvasLayer.canvas,t)}},{key:"render",value:function(t,e){var n=this.$Map,i=t.getContext(this.context),a=this.options.animation,r=this.options.hasOwnProperty("projection")?this.options.projection:"EPSG:4326",s=this.$Map.getView().getProjection().getCode();if(this.isEnabledTime()){if(void 0===e)return o(i),this;"2d"===this.context&&(i.save(),i.globalCompositeOperation="destination-out",i.fillStyle="rgba(0, 0, 0, .1)",i.fillRect(0,0,i.canvas.width,i.canvas.height),i.restore())}else o(i);if("2d"===this.context)for(var l in this.options)i[l]=this.options[l];else i.clear(i.COLOR_BUFFER_BIT);var u={};u.transferCoordinate=r===s?function(t){return n.getPixelFromCoordinate(t)}:function(t){return n.getPixelFromCoordinate(ol.proj.transform(t,r,s))},void 0!==e&&(u.filter=function(t){var n=a.trails||10;return!!(e&&t.time>e-n&&t.time<e)});var h=this.dataSet.get(u);return this.processData(h),"m"===this.options.unit?(this.options.size&&(this.options._size=this.options.size/zoomUnit),this.options.width&&(this.options._width=this.options.width/zoomUnit),this.options.height&&(this.options._height=this.options.height/zoomUnit)):(this.options._size=this.options.size,this.options._height=this.options.height,this.options._width=this.options.width),this.drawContext(i,new g(h),this.options,{x:0,y:0}),this.options.updateCallback&&this.options.updateCallback(e),this}},{key:"getCanvasLayer",value:function(){if(!this.canvasLayer.canvas&&!this.layer_){var t=this.getMapExtent();this.layer_=new ol.layer.Image({layerName:this.options.layerName,minResolution:this.options.minResolution,maxResolution:this.options.maxResolution,zIndex:this.options.zIndex,extent:t,source:new ol.source.ImageCanvas({canvasFunction:this.canvasFunction.bind(this),projection:this.$Map.getView().getProjection().getCode(),ratio:this.options.hasOwnProperty("ratio")?this.options.ratio:1})}),this.$Map.addLayer(this.layer_),this.$Map.un("precompose",this.reRender,this),this.$Map.on("precompose",this.reRender,this)}}},{key:"reRender",value:function(){if(this.layer_){var t=this.getMapExtent();this.layer_.setExtent(t)}}},{key:"canvasFunction",value:function(t,e,n,i,o){return this.canvasLayer.canvas?(this.canvasLayer.canvas.width=i[0],this.canvasLayer.canvas.height=i[1]):this.canvasLayer.canvas=Ze(i[0],i[1]),this.render(this.canvasLayer.canvas),this.canvasLayer.canvas}},{key:"getMapExtent",value:function(){var t=this.$Map.getSize();return this.$Map.getView().calculateExtent(t)}},{key:"addTo",value:function(t){this.init(t,this.options)}},{key:"removeLayer",value:function(){this.$Map&&(this.unEvents(),this.$Map.un("precompose",this.reRender,this),this.$Map.removeLayer(this.layer_),delete this.$Map,delete this.layer_,delete this.canvasLayer.canvas)}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"clickEvent",value:function(t){var n=t.pixel;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clickEvent",this).call(this,{x:n[0],y:n[1]},t)}},{key:"mousemoveEvent",value:function(t){var n=t.pixel;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mousemoveEvent",this).call(this,{x:n[0],y:n[1]},t)}},{key:"addAnimatorEvent",value:function(){this.$Map.on("movestart",this.animatorMovestartEvent,this),this.$Map.on("moveend",this.animatorMoveendEvent,this)}},{key:"onEvents",value:function(){var t=this.$Map;this.unEvents(),this.options.methods&&(this.options.methods.click&&t.on("click",this.clickEvent,this),this.options.methods.mousemove&&t.on("pointermove",this.mousemoveEvent,this))}},{key:"unEvents",value:function(){var t=this.$Map;this.options.methods&&(this.options.methods.click&&t.un("click",this.clickEvent,this),this.options.methods.pointermove&&t.un("pointermove",this.mousemoveEvent,this))}},{key:"setDefaultCursor",value:function(t,e){if(this.$Map){var n=this.$Map.getTargetElement();e?n.style.cursor!==t&&(this.previousCursor_=n.style.cursor,n.style.cursor=t):void 0!==this.previousCursor_&&(n.style.cursor=this.previousCursor_,this.previousCursor_=void 0)}}},{key:"show",value:function(){this.$Map.addLayer(this.layer_)}},{key:"hide",value:function(){this.$Map.removeLayer(this.layer_)}}]),e}(ke),He=function(t){function e(t,n,i,o){h(this,e);var a=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,i,o));if(!ke)return v(a);var r=a;return o=o||{},r.init(o),r.argCheck(o),a.canvasLayer=n,a.clickEvent=a.clickEvent.bind(a),a.mousemoveEvent=a.mousemoveEvent.bind(a),a._moveStartEvent=a.moveStartEvent.bind(a),a._moveEndEvent=a.moveEndEvent.bind(a),a._zoomStartEvent=a.zoomStartEvent.bind(a),a.bindEvent(),a}return d(e,t),c(e,[{key:"clickEvent",value:function(t){var n=this.map.containerPointToLayerPoint([0,0]),i=this.devicePixelRatio=this.canvasLayer.devicePixelRatio=window.devicePixelRatio,o=t.layerPoint;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clickEvent",this).call(this,L.point((o.x-n.x)/i,(o.y-n.y)/i),t)}},{key:"mousemoveEvent",value:function(t){var n=t.layerPoint;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mousemoveEvent",this).call(this,n,t)}},{key:"bindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.on("click",this.clickEvent),this.options.methods.mousemove&&t.on("mousemove",this.mousemoveEvent)),this.map.on("movestart",this._moveStartEvent),this.map.on("moveend",this._moveEndEvent),this.map.on("zoomstart",this._zoomStartEvent)}},{key:"destroy",value:function(){this.unbindEvent(),this.clearData(),this.animator&&this.animator.stop(),this.animator=null,this.canvasLayer=null}},{key:"unbindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent)),this.map.off("movestart",this._moveStartEvent),this.map.off("moveend",this._moveEndEvent),this.map.off("zoomstart",this._zoomStartEvent)}},{key:"getContext",value:function(){return this.canvasLayer.getCanvas().getContext(this.context)}},{key:"addData",value:function(t,e){var n=t;t&&t.get&&(n=t.get()),this.dataSet.add(n),this.update({options:e})}},{key:"update",value:function(t){var n=t||{},i=n.data;i&&i.get&&(i=i.get()),void 0!=i&&this.dataSet.set(i),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,{options:n.options})}},{key:"getData",value:function(){return this.dataSet}},{key:"removeData",value:function(t){if(this.dataSet){var e=this.dataSet.get({filter:function(e){return null==t||"function"!==typeof t||!t(e)}});this.dataSet.set(e),this.update({options:null})}}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"_canvasUpdate",value:function(t){if(this.canvasLayer){var e=this,n=e.options.animation,i=this.getContext(),o=this.map;if(e.isEnabledTime()){if(void 0===t)return void this.clear(i);"2d"===this.context&&(i.save(),i.globalCompositeOperation="destination-out",i.fillStyle="rgba(0, 0, 0, .1)",i.fillRect(0,0,i.canvas.width,i.canvas.height),i.restore())}else this.clear(i);if("2d"===this.context)for(var a in e.options)i[a]=e.options[a];else i.clear(i.COLOR_BUFFER_BIT);if(!(e.options.minZoom&&o.getZoom()<e.options.minZoom||e.options.maxZoom&&o.getZoom()>e.options.maxZoom)){var r=o.getBounds(),s=r.getEast()-r.getWest(),l=r.getNorth()-r.getSouth(),u=o.getSize(),h=s/u.x,c=l/u.y,p=this.canvasLayer.getTopLeft(),d=o.latLngToContainerPoint(p),v={transferCoordinate:function(t){var n;n="2d"===e.context?o.latLngToContainerPoint(L.latLng(t[1],t[0])):{x:(t[0]-p.lng)/h,y:(p.lat-t[1])/c};var i={x:n.x-d.x,y:n.y-d.y};return[i.x,i.y]}};void 0!==t&&(v.filter=function(e){var i=n.trails||10;return t&&e.time>t-i&&e.time<t});var f=e.dataSet.get(v);this.processData(f),e.options._size=e.options.size;var g=o.latLngToContainerPoint(L.latLng(0,0)),m={x:g.x-d.x,y:g.y-d.y};this.drawContext(i,f,e.options,m),e.options.updateCallback&&e.options.updateCallback(t)}}}},{key:"init",value:function(t){var e=this;e.options=t,this.initDataRange(t),this.context=e.options.context||"2d",e.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(e.options.zIndex),this.initAnimator()}},{key:"addAnimatorEvent",value:function(){}},{key:"moveStartEvent",value:function(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start,this._hide())}},{key:"moveEndEvent",value:function(){this.canvasLayer.draw(),this._show()}},{key:"zoomStartEvent",value:function(){this._hide()}},{key:"clear",value:function(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}},{key:"_hide",value:function(){this.canvasLayer.canvas.style.display="none"}},{key:"_show",value:function(){this.canvasLayer.canvas.style.display="block"}},{key:"draw",value:function(){this.canvasLayer.draw()}}]),e}(ke);if("undefined"!==typeof L){var Ye=L.Layer.extend({options:{attributionPrefix:null,attribution:""},initialize:function(t,e,n){n=n||{},this.dataSet=t||{},this.mapVOptions=e||{},this.render=this.render.bind(this),L.Util.setOptions(this,n),this.options.attributionPrefix&&(this.options.attribution=this.options.attributionPrefix+this.options.attribution),this.canvas=this._createCanvas(),L.stamp(this)},onAdd:function(t){this._map=t;var e=this.getPane(),n=this.container=L.DomUtil.create("div","leaflet-layer leaflet-zoom-animated",e);n.appendChild(this.canvas);var i=t.getSize();n.style.width=i.x+"px",n.style.height=i.y+"px",this.renderer=new He(t,this,this.dataSet,this.mapVOptions),this.draw(),this.fire("loaded")},onRemove:function(){L.DomUtil.remove(this.container),this.renderer.destroy()},addData:function(t,e){this.renderer.addData(t,e)},update:function(t){this.renderer.update(t)},getData:function(){return this.renderer&&(this.dataSet=this.renderer.getData()),this.dataSet},removeData:function(t){this.renderer&&this.renderer.removeData(t)},clearData:function(){this.renderer.clearData()},draw:function(){return this._reset()},setZIndex:function(t){this.canvas.style.zIndex=t},render:function(){this.renderer._canvasUpdate()},getCanvas:function(){return this.canvas},getContainer:function(){return this.container},getTopLeft:function(){var t,e=this._map;if(e){var n=e.getBounds();t=n.getNorthWest()}return t},_createCanvas:function(){var t=document.createElement("canvas");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.options.zIndex||600;var e="undefined"===typeof window?{}:window,n=this.devicePixelRatio=e.devicePixelRatio;return this.mapVOptions.context&&"2d"!==this.mapVOptions.context||t.getContext("2d").scale(n,n),t},_resize:function(){var t=this.canvas;if(t){var e=this._map,n=e.getSize();t.width=n.x,t.height=n.y,t.style.width=n.x+"px",t.style.height=n.y+"px";var i=e.getBounds(),o=e.latLngToLayerPoint(i.getNorthWest());L.DomUtil.setPosition(t,o)}},_reset:function(){this._resize(),this._render()},redraw:function(){this._resize(),this._render()},_render:function(){this.render()}});Be=function(t,e,n){return new Ye(t,e,n)}}var Xe,qe=Be,Ve=function(t){function e(t,n,i,o){h(this,e);var a=v(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,i));return ke?(a.map=t,a.scene=t.scene,a.dataSet=n,i=i||{},a.init(i),a.argCheck(i),a.initDevicePixelRatio(),a.canvasLayer=o,a.stopAniamation=!1,a.animation=i.animation,a.clickEvent=a.clickEvent.bind(a),a.mousemoveEvent=a.mousemoveEvent.bind(a),a.bindEvent(),a):v(a)}return d(e,t),c(e,[{key:"initDevicePixelRatio",value:function(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"clickEvent",value:function(t){var n=t.point;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"clickEvent",this).call(this,n,t)}},{key:"mousemoveEvent",value:function(t){var n=t.point;p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"mousemoveEvent",this).call(this,n,t)}},{key:"addAnimatorEvent",value:function(){}},{key:"animatorMovestartEvent",value:function(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start)}},{key:"animatorMoveendEvent",value:function(){this.isEnabledTime()&&this.animator}},{key:"bindEvent",value:function(){this.map,this.options.methods&&(this.options.methods.click,this.options.methods.mousemove)}},{key:"unbindEvent",value:function(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent))}},{key:"getContext",value:function(){return this.canvasLayer.canvas.getContext(this.context)}},{key:"init",value:function(t){this.options=t,this.initDataRange(t),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}},{key:"_canvasUpdate",value:function(t){this.map;var e=this.scene;if(this.canvasLayer&&!this.stopAniamation){var n=this.options.animation,i=this.getContext();if(this.isEnabledTime()){if(void 0===t)return void this.clear(i);"2d"===this.context&&(i.save(),i.globalCompositeOperation="destination-out",i.fillStyle="rgba(0, 0, 0, .1)",i.fillRect(0,0,i.canvas.width,i.canvas.height),i.restore())}else this.clear(i);if("2d"===this.context)for(var o in this.options)i[o]=this.options[o];else i.clear(i.COLOR_BUFFER_BIT);var a={transferCoordinate:function(t){var n=Cesium.Cartesian3.fromDegrees(t[0],t[1]),i=Cesium.SceneTransforms.wgs84ToWindowCoordinates(e,n);return void 0==i?[-1,-1]:[i.x,i.y]}};void 0!==t&&(a.filter=function(e){var i=n.trails||10;return!!(t&&e.time>t-i&&e.time<t)});var r=this.dataSet.get(a);this.processData(r),"m"==this.options.unit&&this.options.size,this.options._size=this.options.size;var s=Cesium.SceneTransforms.wgs84ToWindowCoordinates(e,Cesium.Cartesian3.fromDegrees(0,0));this.drawContext(i,new g(r),this.options,s),this.options.updateCallback&&this.options.updateCallback(t)}}},{key:"updateData",value:function(t,n){var i=t;i&&i.get&&(i=i.get()),void 0!=i&&this.dataSet.set(i),p(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"update",this).call(this,{options:n})}},{key:"addData",value:function(t,e){var n=t;t&&t.get&&(n=t.get()),this.dataSet.add(n),this.update({options:e})}},{key:"getData",value:function(){return this.dataSet}},{key:"removeData",value:function(t){if(this.dataSet){var e=this.dataSet.get({filter:function(e){return null==t||"function"!=typeof t||!t(e)}});this.dataSet.set(e),this.update({options:null})}}},{key:"clearData",value:function(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}},{key:"draw",value:function(){this.canvasLayer.draw()}},{key:"clear",value:function(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}}]),e}(ke);if("undefined"!==typeof Cesium){var $e=0,Ge=(Cesium,function(){function t(e,n,i,o){if(h(this,t),this.map=e,this.scene=e.scene,this.mapvBaseLayer=new Ve(e,n,i,this),this.mapVOptions=i,this.initDevicePixelRatio(),this.canvas=this._createCanvas(),this.render=this.render.bind(this),o)this.container=o;else{var a=e.container.querySelector(".cesium-viewer-cesiumWidgetContainer");this.container=a||e.container}this.addInnerContainer(),this.bindEvent(),this._reset()}return c(t,[{key:"initDevicePixelRatio",value:function(){this.devicePixelRatio=window.devicePixelRatio||1}},{key:"addInnerContainer",value:function(){this.container.appendChild(this.canvas)}},{key:"bindEvent",value:function(){var t=this;this.innerMoveStart=this.moveStartEvent.bind(this),this.innerMoveEnd=this.moveEndEvent.bind(this),this.scene.camera.moveStart.addEventListener(this.innerMoveStart,this),this.scene.camera.moveEnd.addEventListener(this.innerMoveEnd,this);var e=new Cesium.ScreenSpaceEventHandler(this.scene.canvas);e.setInputAction((function(e){t.innerMoveEnd()}),Cesium.ScreenSpaceEventType.LEFT_UP),e.setInputAction((function(e){t.innerMoveEnd()}),Cesium.ScreenSpaceEventType.MIDDLE_UP),this.handler=e}},{key:"unbindEvent",value:function(){this.scene.camera.moveStart.removeEventListener(this.innerMoveStart,this),this.scene.camera.moveEnd.removeEventListener(this.innerMoveEnd,this),this.scene.postRender.removeEventListener(this._reset,this),this.handler&&(this.handler.destroy(),this.handler=null)}},{key:"moveStartEvent",value:function(){this.mapvBaseLayer&&(this.mapvBaseLayer.animatorMovestartEvent(),this.scene.postRender.addEventListener(this._reset,this))}},{key:"moveEndEvent",value:function(){this.mapvBaseLayer&&(this.scene.postRender.removeEventListener(this._reset,this),this.mapvBaseLayer.animatorMoveendEvent(),this._reset())}},{key:"zoomStartEvent",value:function(){this._unvisiable()}},{key:"zoomEndEvent",value:function(){this._unvisiable()}},{key:"addData",value:function(t,e){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer.addData(t,e)}},{key:"updateData",value:function(t,e){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer.updateData(t,e)}},{key:"getData",value:function(){return this.mapvBaseLayer&&(this.dataSet=this.mapvBaseLayer.getData()),this.dataSet}},{key:"removeData",value:function(t){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer&&this.mapvBaseLayer.removeData(t)}},{key:"removeAllData",value:function(){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer.clearData()}},{key:"_visiable",value:function(){return this.canvas.style.display="block",this}},{key:"_unvisiable",value:function(){return this.canvas.style.display="none",this}},{key:"_createCanvas",value:function(){var t=document.createElement("canvas");t.id=this.mapVOptions.layerid||"mapv"+$e++,t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.mapVOptions.zIndex||0,t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height;var e=this.devicePixelRatio;return"2d"==this.mapVOptions.context&&t.getContext(this.mapVOptions.context).scale(e,e),t}},{key:"_reset",value:function(){this.resizeCanvas(),this.fixPosition(),this.onResize(),this.render()}},{key:"draw",value:function(){this._reset()}},{key:"show",value:function(){this._visiable()}},{key:"hide",value:function(){this._unvisiable()}},{key:"destroy",value:function(){this.remove()}},{key:"remove",value:function(){void 0!=this.mapvBaseLayer&&(this.removeAllData(),this.mapvBaseLayer.clear(this.mapvBaseLayer.getContext()),this.mapvBaseLayer=void 0,this.canvas.parentElement.removeChild(this.canvas))}},{key:"update",value:function(t){void 0!=t&&this.updateData(t.data,t.options)}},{key:"resizeCanvas",value:function(){if(void 0!=this.canvas&&null!=this.canvas){var t=this.canvas;t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height}}},{key:"fixPosition",value:function(){}},{key:"onResize",value:function(){}},{key:"render",value:function(){void 0!=this.mapvBaseLayer&&this.mapvBaseLayer._canvasUpdate()}}]),t}());Xe=function(t,e,n,i){return new Ge(t,e,n,i)}}var Je=Xe,Qe={getDataSet:function(t){var e=[],n=t.features;if(n)for(var i=0;i<n.length;i++){var o=n[i],a=o.geometry,r=o.properties,s={};for(var l in r)s[l]=r[l];s.geometry=a,e.push(s)}return new g(e)}},Ke={CSVToArray:function(t,e){e=e||",";var n=new RegExp("(\\"+e+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+e+"\\r\\n]*))","gi"),i=[[]],o=null;while(o=n.exec(t)){var a,r=o[1];r.length&&r!==e&&i.push([]),a=o[2]?o[2].replace(new RegExp('""',"g"),'"'):o[3],i[i.length-1].push(a)}return i},getDataSet:function(t,e){for(var n=this.CSVToArray(t,e||","),i=[],o=n[0],a=1;a<n.length-1;a++){for(var r=n[a],s={},l=0;l<r.length;l++){var u=r[l];"geometry"==o[l]&&(u=JSON.parse(u)),s[o[l]]=u}i.push(s)}return new g(i)}};e.version=i,e.canvasClear=o,e.canvasResolutionScale=a,e.canvasDrawSimple=b,e.canvasDrawHeatmap=A,e.canvasDrawGrid=I,e.canvasDrawHoneycomb=R,e.webglDrawSimple=Mt,e.webglDrawPoint=q,e.webglDrawLine=W,e.webglDrawPolygon=kt,e.utilCityCenter=u,e.utilCurve=Tt,e.utilForceEdgeBundling=Dt,e.utilDataRangeIntensity=_,e.utilDataRangeCategory=Ot,e.utilDataRangeChoropleth=At,e.Map=It,e.baiduMapCanvasLayer=zt,e.baiduMapAnimationLayer=Pe,e.baiduMapLayer=Oe,e.googleMapCanvasLayer=Ae,e.googleMapLayer=ze,e.MaptalksLayer=Ne,e.AMapLayer=Ue,e.OpenlayersLayer=We,e.leafletMapLayer=qe,e.cesiumMapLayer=Je,e.DataSet=g,e.geojson=Qe,e.csv=Ke,Object.defineProperty(e,"__esModule",{value:!0})}))}).call(this,n("eef6"),n("c75b"))}}]);