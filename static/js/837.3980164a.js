/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2025-03-11 22:54:54
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[837],{24024:function(e,t,l){l.d(t,{Ed:function(){return o},pL:function(){return i},vS:function(){return n}});var a=l(24380);function n(e){return(0,a.A)({url:"/table/getList",method:"get",params:e})}function o(e){return(0,a.A)({url:"/table/doEdit",method:"post",data:e})}function i(e){return(0,a.A)({url:"/table/doDelete",method:"post",data:e})}},30837:function(e,t,l){l.r(t),l.d(t,{default:function(){return b}});var a=l(34641),n=l(50670),o=l(27386);const i={class:"export-excel-container"};function u(e,t,l,u,d,r){const s=(0,a.g2)("el-input"),c=(0,a.g2)("el-form-item"),f=(0,a.g2)("el-option"),b=(0,a.g2)("el-select"),p=(0,a.g2)("el-button"),h=(0,a.g2)("el-form"),m=(0,a.g2)("vab-query-form-left-panel"),g=(0,a.g2)("vab-query-form"),k=(0,a.g2)("el-table-column"),_=(0,a.g2)("el-tag"),v=(0,a.g2)("el-table"),w=(0,a.gN)("loading");return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(g,null,{default:(0,a.k6)((()=>[(0,a.bF)(m,{span:24},{default:(0,a.k6)((()=>[(0,a.bF)(h,{inline:"","label-width":"100px",onSubmit:t[2]||(t[2]=(0,n.D$)((()=>{}),["prevent"]))},{default:(0,a.k6)((()=>[(0,a.bF)(c,{label:"文件名"},{default:(0,a.k6)((()=>[(0,a.bF)(s,{modelValue:e.filename,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filename=t),placeholder:"请输出要导出文件的名称"},null,8,["modelValue"])])),_:1}),(0,a.bF)(c,{label:"文件类型"},{default:(0,a.k6)((()=>[(0,a.bF)(b,{modelValue:e.bookType,"onUpdate:modelValue":t[1]||(t[1]=t=>e.bookType=t)},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.options,(e=>((0,a.uX)(),(0,a.Wv)(f,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,a.bF)(c,null,{default:(0,a.k6)((()=>[(0,a.bF)(p,{type:"primary",onClick:e.handleDownload},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)(" 导出 Excel ")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.bo)(((0,a.uX)(),(0,a.Wv)(v,{border:"",data:e.list},{default:(0,a.k6)((()=>[(0,a.bF)(k,{align:"center",label:"序号",width:"55"},{default:(0,a.k6)((({$index:e})=>[(0,a.eW)((0,o.v_)(e+1),1)])),_:1}),(0,a.bF)(k,{align:"center",label:"标题"},{default:(0,a.k6)((({row:e})=>[(0,a.eW)((0,o.v_)(e.title),1)])),_:1}),(0,a.bF)(k,{align:"center",label:"作者"},{default:(0,a.k6)((({row:e})=>[(0,a.bF)(_,null,{default:(0,a.k6)((()=>[(0,a.eW)((0,o.v_)(e.author),1)])),_:2},1024)])),_:1}),(0,a.bF)(k,{align:"center",label:"访问量"},{default:(0,a.k6)((({row:e})=>[(0,a.eW)((0,o.v_)(e.pageViews),1)])),_:1}),(0,a.bF)(k,{align:"center",label:"时间"},{default:(0,a.k6)((({row:e})=>[(0,a.Lk)("span",null,(0,o.v_)(e.datetime),1)])),_:1})])),_:1},8,["data"])),[[w,e.listLoading]])])}l(94473),l(55759);var d=l(24024),r=(0,a.pM)({name:"ExportExcel",data(){return{list:[],listLoading:!0,downloadLoading:!1,filename:"",autoWidth:!0,bookType:"xlsx",options:["xlsx","csv","txt"]}},created(){this.fetchData()},methods:{async fetchData(){this.listLoading=!0;const{data:{list:e}}=await(0,d.vS)();this.list=e,this.listLoading=!1},handleDownload(){this.downloadLoading=!0,Promise.all([l.e(8106),l.e(9566)]).then(l.bind(l,89566)).then((e=>{const t=["Id","Title","Author","Readings","Date"],l=["id","title","author","pageViews","datetime"],a=this.list,n=this.formatJson(l,a);e.export_json_to_excel({header:t,data:n,filename:this.filename,autoWidth:this.autoWidth,bookType:this.bookType}),this.downloadLoading=!1}))},formatJson(e,t){return t.map((t=>e.map((e=>t[e]))))}}});function s(e){e.__source="src/views/other/excel/exportExcel.vue"}var c=l(48499);"function"===typeof s&&s(r);const f=(0,c.A)(r,[["render",u]]);var b=f}}]);