/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2024-09-26 21:23:19 
 */
import{d as Te,b as _,K as e,S as t,P as U,u as o,A as M,n as Q,B as s,W as Ue,o as i,Z as Me,Q as N,a9 as $e,Y as d,ab as ze,ac as Fe,e as We,I as g,F as X,a2 as Z,X as B,R as Ne}from"./vsv-element-plus-CleF0dO9.js";import{l as Be}from"./vue-draggable-plus-NyGi0-tu.js";import{g as Ee,d as G}from"./table-rNzIqkgx.js";import{e as Le,f as Ye,h as Ae,g as He,_ as Ie}from"./index-wMoNB7-P.js";import"./vsv-icon-DrZkBOPN.js";import"./vsv-nprogress-D5kd6v05.js";const je={key:0},Ke={key:1},Pe={class:"custom-table-right-tools"},Qe={key:0},Xe={key:2},Ze=Te({name:"CustomTable",__name:"customTable",setup(Ge){const E=useRouter(),J=Le(),{getAllRoutes:O}=storeToRefs(J),ee=Ye(),{changeTabsMeta:le,addVisitedRoute:te}=ee,L=ref(),m=ref(!0),$=ref(null),C=ref(!0),x=ref(!1),w=ref("default"),f=ref(!1),Y=ref([]),D=ref(!0),A=ref(0),p=ref([]),v=ref([{label:"id",prop:"id",sortable:!0,checked:!0,minWidth:200},{label:"标题",prop:"title",sortable:!0,disableCheck:!0,checked:!0,minWidth:200},{label:"图片",prop:"title",checked:!0,minWidth:100},{label:"作者",prop:"author",sortable:!0,checked:!0,minWidth:100},{label:"评级",prop:"rate",sortable:!0,checked:!0,minWidth:200},{label:"数量",prop:"count",sortable:!0,checked:!0,minWidth:100},{label:"时间",prop:"datetime",sortable:!0,checked:!0,minWidth:160},{label:"描述",prop:"description",sortable:!0,checked:!0,minWidth:400}]),h=ref([]),u=reactive({pageNo:1,pageSize:20,title:""}),S=ref("right"),{exit:ae,enter:oe,isFullscreen:H}=useFullscreen(),ne=computed(()=>v.value.filter(n=>h.value.includes(n.label))),b=async()=>{D.value=!0;const{data:n}=await Ee(u);Y.value=n.list,A.value=n.total,D.value=!1},se=n=>{u.pageNo=1,u.pageSize=n,b()},ue=n=>{u.pageNo=n,b()},I=()=>{u.pageNo=1,b()},re=()=>{f.value=!f.value,f.value?oe():ae()},de=n=>{p.value=n},ie=()=>{m.value=!m.value},ce=()=>{$.value.showEdit()},pe=n=>{$.value.showEdit(n)},j=n=>{if(n.id)$baseConfirm("您确定要删除当前项吗",null,async()=>{const{msg:l}=await G({ids:n.id});$baseMessage(l,"success","vab-hey-message-success"),await b()});else if(p.value.length>0){const l=p.value.map(c=>c.id).join(",");$baseConfirm("您确定要删除选中项吗",null,async()=>{const{msg:c}=await G({ids:l});$baseMessage(c,"success","vab-hey-message-success"),await b()})}else $baseMessage("您未选中任何行","warning","hey")},me=async()=>{if(p.value.length>0)for(let n=0;n<p.value.length;n++){const l=Ae(O.value,"/vab/table/defaultTableDetail"),c=He({...l.at(-1),query:p.value[n]});c&&(await te(c),await le({title:"详情页",meta:{title:`${c.query.title} 详情页`}}))}else $baseMessage("请至少选择一行进行详情页跳转","warning","hey")},K=n=>{n.id?E.push({path:"/vab/table/defaultTableDetail",query:{...n,timestamp:Date.now()}}):p.value.length===1?E.push({path:"/vab/table/defaultTableDetail",query:{...p.value[0],timestamp:Date.now()}}):$baseMessage("请选择一行进行详情页跳转","warning","hey")};return watch(H,()=>{H.value?f.value=!0:f.value=!1},{immediate:!0}),onActivated(()=>{var n;(n=L.value)==null||n.doLayout()}),onBeforeMount(()=>{v.value.forEach(n=>{n.checked&&h.value.push(n.label)}),b()}),(n,l)=>{const c=s("el-input"),y=s("el-form-item"),fe=s("el-date-picker"),z=s("el-option"),be=s("el-select"),r=s("el-button"),k=s("vab-icon"),_e=s("el-form"),ve=s("vab-query-form-top-panel"),ge=s("vab-query-form-left-panel"),q=s("el-checkbox"),F=s("el-radio-button"),he=s("el-radio-group"),W=s("el-popover"),ye=s("el-checkbox-group"),ke=s("vab-query-form-right-panel"),Ve=s("vab-query-form"),R=s("el-table-column"),Ce=s("el-rate"),P=s("el-image"),xe=s("el-empty"),we=s("el-table"),De=s("vab-pagination"),Se=s("default-table-edit"),qe=Ue("loading");return i(),_("div",{class:Q(["custom-table-container auto-height-container",{"fullscreen-container":o(f)}])},[e(Ve,null,{default:t(()=>[e(ve,null,{default:t(()=>[e(_e,{inline:"",model:o(u),onSubmit:l[4]||(l[4]=Me(()=>{},["prevent"]))},{default:t(()=>[e(y,{label:"标题"},{default:t(()=>[e(c,{modelValue:o(u).title,"onUpdate:modelValue":l[0]||(l[0]=a=>o(u).title=a),clearable:"",placeholder:"请输入标题"},null,8,["modelValue"])]),_:1}),U(e(y,{label:"作者"},{default:t(()=>[e(c,{modelValue:o(u).author,"onUpdate:modelValue":l[1]||(l[1]=a=>o(u).author=a),clearable:"",placeholder:"请输入作者"},null,8,["modelValue"])]),_:1},512),[[N,!o(m)]]),U(e(y,{label:"时间"},{default:t(()=>[e(fe,{modelValue:o(u).datetime,"onUpdate:modelValue":l[2]||(l[2]=a=>o(u).datetime=a),format:"YYYY/MM/DD HH:mm:ss",placeholder:"请选择时间",type:"datetime"},null,8,["modelValue"])]),_:1},512),[[N,!o(m)]]),U(e(y,{label:"状态"},{default:t(()=>[e(be,{modelValue:o(u).status,"onUpdate:modelValue":l[3]||(l[3]=a=>o(u).status=a),placeholder:"请选择状态"},{default:t(()=>[e(z,{label:"success",value:"published"}),e(z,{label:"primary",value:"draft"}),e(z,{label:"danger",value:"deleted"})]),_:1},8,["modelValue"])]),_:1},512),[[N,!o(m)]]),e(y,null,{default:t(()=>[e(r,{icon:o($e),loading:o(D),"native-type":"submit",type:"primary",onClick:I},{default:t(()=>l[11]||(l[11]=[d("查询")])),_:1},8,["icon","loading"]),e(r,{class:"hidden-xs-only",text:"",type:"primary",onClick:ie},{default:t(()=>[o(m)?(i(),_("span",je,"展开")):(i(),_("span",Ke,"合并")),e(k,{class:Q(["vab-dropdown",{"vab-dropdown-active":o(m)}]),icon:"arrow-up-s-line"},null,8,["class"])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(ge,null,{default:t(()=>[e(r,{icon:o(ze),type:"primary",onClick:ce},{default:t(()=>l[12]||(l[12]=[d("添加")])),_:1},8,["icon"]),e(r,{icon:o(Fe),type:"danger",onClick:j},{default:t(()=>l[13]||(l[13]=[d("删除")])),_:1},8,["icon"]),e(r,{type:"primary",onClick:K},{default:t(()=>l[14]||(l[14]=[d("详情")])),_:1}),e(r,{class:"hidden-xs-only",type:"primary",onClick:me},{default:t(()=>l[15]||(l[15]=[d("后台打开详情")])),_:1})]),_:1}),e(ke,null,{default:t(()=>[We("div",Pe,[e(r,{class:"hidden-xs-only"},{default:t(()=>[e(q,{modelValue:o(x),"onUpdate:modelValue":l[5]||(l[5]=a=>g(x)?x.value=a:null),label:"斑马纹"},null,8,["modelValue"])]),_:1}),e(r,{class:"hidden-xs-only"},{default:t(()=>[e(q,{modelValue:o(C),"onUpdate:modelValue":l[6]||(l[6]=a=>g(C)?C.value=a:null),label:"边框"},null,8,["modelValue"])]),_:1}),e(r,{onClick:I},{default:t(()=>[e(k,{icon:"refresh-line"})]),_:1}),e(r,{onClick:re},{default:t(()=>[e(k,{icon:o(f)?"fullscreen-exit-fill":"fullscreen-fill"},null,8,["icon"])]),_:1}),e(W,{width:165},{reference:t(()=>[e(r,null,{default:t(()=>[e(k,{icon:"line-height"})]),_:1})]),default:t(()=>[e(he,{modelValue:o(w),"onUpdate:modelValue":l[7]||(l[7]=a=>g(w)?w.value=a:null)},{default:t(()=>[e(F,{label:"large",value:"large"},{default:t(()=>l[16]||(l[16]=[d("大")])),_:1}),e(F,{label:"default",value:"default"},{default:t(()=>l[17]||(l[17]=[d("中")])),_:1}),e(F,{label:"small",value:"small"},{default:t(()=>l[18]||(l[18]=[d("小")])),_:1})]),_:1},8,["modelValue"])]),_:1}),e(W,{"popper-class":"custom-table-checkbox"},{reference:t(()=>[e(r,null,{default:t(()=>[e(k,{icon:"settings-line"})]),_:1})]),default:t(()=>[e(o(Be),{modelValue:o(v),"onUpdate:modelValue":l[9]||(l[9]=a=>g(v)?v.value=a:null),animation:600,target:".el-checkbox-group"},{default:t(()=>[e(ye,{modelValue:o(h),"onUpdate:modelValue":l[8]||(l[8]=a=>g(h)?h.value=a:null)},{default:t(()=>[(i(!0),_(X,null,Z(o(v),a=>(i(),M(q,{key:a.label,disabled:a.disableCheck,label:a.label,value:a.label},{default:t(()=>[d(B(a.label),1)]),_:2},1032,["disabled","label","value"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])]),_:1})])]),_:1})]),_:1}),U((i(),M(we,{ref_key:"tableRef",ref:L,border:o(C),data:o(Y),size:o(w),stripe:o(x),onSelectionChange:de},{empty:t(()=>[e(xe,{class:"vab-data-empty",description:"暂无数据"})]),default:t(()=>[e(R,{type:"selection",width:"38"}),e(R,{align:"center",label:"序号",width:"55"},{default:t(({$index:a})=>[d(B(a+1),1)]),_:1}),(i(!0),_(X,null,Z(o(ne),(a,T)=>(i(),M(R,{key:T,align:"center",fixed:a.fixed,label:a.label,"min-width":a.minWidth||100,prop:a.prop,"show-overflow-tooltip":"",sortable:a.sortable},{default:t(({row:V})=>[a.label==="评级"?(i(),_("span",Qe,[e(Ce,{modelValue:V.rate,"onUpdate:modelValue":Re=>V.rate=Re,disabled:""},null,8,["modelValue","onUpdate:modelValue"])])):Ne("",!0),a.label==="图片"?(i(),M(W,{key:1,placement:"top-start"},{reference:t(()=>[e(P,{src:V.image},null,8,["src"])]),default:t(()=>[e(P,{src:V.image},null,8,["src"])]),_:2},1024)):(i(),_("span",Xe,B(V[a.prop]),1))]),_:2},1032,["fixed","label","min-width","prop","sortable"]))),128)),e(R,{align:"center",fixed:o(S),label:"操作",width:"215"},{header:t(()=>[e(q,{modelValue:o(S),"onUpdate:modelValue":l[10]||(l[10]=a=>g(S)?S.value=a:null),label:"固定操作列","true-value":"right"},null,8,["modelValue"])]),default:t(({row:a})=>[e(r,{text:"",type:"primary",onClick:T=>K(a)},{default:t(()=>l[19]||(l[19]=[d("详情")])),_:2},1032,["onClick"]),e(r,{text:"",type:"primary",onClick:T=>pe(a)},{default:t(()=>l[20]||(l[20]=[d("编辑")])),_:2},1032,["onClick"]),e(r,{text:"",type:"danger",onClick:T=>j(a)},{default:t(()=>l[21]||(l[21]=[d("删除")])),_:2},1032,["onClick"])]),_:1},8,["fixed"])]),_:1},8,["border","data","size","stripe"])),[[qe,o(D)]]),e(De,{"current-page":o(u).pageNo,"page-size":o(u).pageSize,total:o(A),onCurrentChange:ue,onSizeChange:se},null,8,["current-page","page-size","total"]),e(Se,{ref_key:"editRef",ref:$,onFetchData:b},null,512)],2)}}}),ol=Ie(Ze,[["__scopeId","data-v-cdfa0919"]]);export{ol as default};
