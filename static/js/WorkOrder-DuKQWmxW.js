/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2024-09-30 14:06:07 
 */
import{d as T,N as o,a2 as W,o as y,b as j,T as e,$ as t,u as s,ak as A,a4 as u,a5 as E,ag as F,Y as I,M as U,a3 as h}from"./vsv-element-plus-CxGOTlXz.js";import{g as Y,d as w}from"./workOrder-9tl29DMi.js";import"./index-DMdRIM5p.js";import"./vsv-icon-B5tQoIEl.js";import"./vsv-nprogress-DAXSSYSi.js";const G={class:"work-order-container auto-height-container"},ee=T({name:"WorkOrder",__name:"WorkOrder",setup(H){const m=ref(),f=ref([]),d=ref(!0),g=ref(0),_=ref([]),i=reactive({pageNo:1,pageSize:20});onActivated(()=>{var a;(a=m.value)==null||a.doLayout()});const p=async()=>{d.value=!0;const{data:a}=await Y(i);f.value=a.list,g.value=a.total,d.value=!1},C=a=>{i.pageNo=1,i.pageSize=a,p()},k=a=>{i.pageNo=a,p()},S=()=>{i.pageNo=1,p()},q=a=>{_.value=a},b=a=>{if(a.id)$baseConfirm("您确定要删除当前项吗",null,async()=>{const{msg:n}=await w({ids:a.id});$baseMessage(n,"success","hey"),await p()});else if(_.value.length>0){const n=_.value.map(c=>c.id).join(",");$baseConfirm("您确定要删除选中项吗",null,async()=>{const{msg:c}=await w({ids:n});$baseMessage(c,"success","hey"),await p()})}else $baseMessage("您未选中任何行","warning","hey")};return onBeforeMount(()=>{p()}),(a,n)=>{const c=o("el-button"),N=o("vab-query-form-left-panel"),z=o("el-input"),v=o("el-form-item"),D=o("el-form"),$=o("vab-query-form-right-panel"),M=o("vab-query-form"),r=o("el-table-column"),x=o("el-progress"),V=o("el-tag"),B=o("el-empty"),R=o("el-table"),L=o("vab-pagination"),O=W("loading");return y(),j("div",G,[e(M,null,{default:t(()=>[e(N,null,{default:t(()=>[e(c,{icon:s(A),type:"danger",onClick:b},{default:t(()=>n[2]||(n[2]=[u("删除")])),_:1},8,["icon"])]),_:1}),e($,null,{default:t(()=>[e(D,{inline:"",model:s(i),onSubmit:n[1]||(n[1]=E(()=>{},["prevent"]))},{default:t(()=>[e(v,{label:"工单标题"},{default:t(()=>[e(z,{modelValue:s(i).title,"onUpdate:modelValue":n[0]||(n[0]=l=>s(i).title=l),clearable:"",placeholder:"请输入工单标题"},null,8,["modelValue"])]),_:1}),e(v,null,{default:t(()=>[e(c,{icon:s(F),loading:s(d),"native-type":"submit",type:"primary",onClick:S},{default:t(()=>n[3]||(n[3]=[u("查询")])),_:1},8,["icon","loading"])]),_:1})]),_:1},8,["model"])]),_:1})]),_:1}),I((y(),U(R,{ref_key:"tableRef",ref:m,border:"",data:s(f),onSelectionChange:q},{empty:t(()=>[e(B,{class:"vab-data-empty",description:"暂无数据"})]),default:t(()=>[e(r,{type:"selection",width:"38"}),e(r,{align:"center",label:"序号",width:"55"},{default:t(({$index:l})=>[u(h(l+1),1)]),_:1}),e(r,{align:"center",label:"工单号","min-width":"200",prop:"uuid","show-overflow-tooltip":""}),e(r,{align:"center",label:"标题","min-width":"200",prop:"title","show-overflow-tooltip":""}),e(r,{align:"center",label:"进度","min-width":"180"},{default:t(({row:l})=>[e(x,{percentage:parseInt(l.progress),status:l.progress=="100"?"success":""},null,8,["percentage","status"])]),_:1}),e(r,{align:"center",label:"提交者",prop:"submit"}),e(r,{align:"center",label:"受理人员","min-width":"90",prop:"accept","show-overflow-tooltip":""}),e(r,{align:"center",label:"工单状态","min-width":"90"},{default:t(({row:l})=>[e(V,{effect:"dark",type:l.status=="处理中"?"warning":l.status=="已处理"?"success":"primary"},{default:t(()=>[u(h(l.status),1)]),_:2},1032,["type"])]),_:1}),e(r,{align:"center",label:"操作",width:"80"},{default:t(({row:l})=>[e(c,{text:"",type:"danger",onClick:J=>b(l)},{default:t(()=>n[4]||(n[4]=[u("删除")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[O,s(d)]]),e(L,{"current-page":s(i).pageNo,"page-size":s(i).pageSize,total:s(g),onCurrentChange:k,onSizeChange:C},null,8,["current-page","page-size","total"])])}}});export{ee as default};
