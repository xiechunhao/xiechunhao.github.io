/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2025-03-12 00:28:56
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[3257],{24024:function(e,t,a){a.d(t,{Ed:function(){return o},pL:function(){return i},vS:function(){return l}});var n=a(24380);function l(e){return(0,n.A)({url:"/table/getList",method:"get",params:e})}function o(e){return(0,n.A)({url:"/table/doEdit",method:"post",data:e})}function i(e){return(0,n.A)({url:"/table/doDelete",method:"post",data:e})}},43257:function(e,t,a){a.r(t),a.d(t,{default:function(){return g}});var n=a(34641),l=a(27386);const o={class:"merge-header-container"};function i(e,t,a,i,r,d){const u=(0,n.g2)("el-button"),s=(0,n.g2)("vab-query-form-top-panel"),c=(0,n.g2)("vab-query-form"),f=(0,n.g2)("el-table-column"),g=(0,n.g2)("el-tag"),b=(0,n.g2)("el-table"),h=(0,n.gN)("loading");return(0,n.uX)(),(0,n.CE)("div",o,[(0,n.bF)(c,null,{default:(0,n.k6)((()=>[(0,n.bF)(s,{span:24},{default:(0,n.k6)((()=>[(0,n.bF)(u,{loading:e.downloadLoading,type:"primary",onClick:e.handleDownload},{default:(0,n.k6)((()=>t[0]||(t[0]=[(0,n.eW)(" 导出 ")]))),_:1},8,["loading","onClick"])])),_:1})])),_:1}),(0,n.bo)(((0,n.uX)(),(0,n.Wv)(b,{ref:"multipleTable",border:"",data:e.list},{default:(0,n.k6)((()=>[(0,n.bF)(f,{align:"center",label:"序号",width:"55"},{default:(0,n.k6)((({$index:e})=>[(0,n.eW)((0,l.v_)(e+1),1)])),_:1}),(0,n.bF)(f,{align:"center",label:"Main Information"},{default:(0,n.k6)((()=>[(0,n.bF)(f,{label:"Title"},{default:(0,n.k6)((({row:e})=>[(0,n.eW)((0,l.v_)(e.title),1)])),_:1}),(0,n.bF)(f,{align:"center",label:"Author"},{default:(0,n.k6)((({row:e})=>[(0,n.bF)(g,null,{default:(0,n.k6)((()=>[(0,n.eW)((0,l.v_)(e.author),1)])),_:2},1024)])),_:1}),(0,n.bF)(f,{align:"center",label:"Readings"},{default:(0,n.k6)((({row:e})=>[(0,n.eW)((0,l.v_)(e.pageViews),1)])),_:1})])),_:1}),(0,n.bF)(f,{align:"center",label:"Date"},{default:(0,n.k6)((({row:e})=>[(0,n.Lk)("span",null,(0,l.v_)(e.datetime),1)])),_:1})])),_:1},8,["data"])),[[h,e.listLoading]])])}a(94473),a(55759);var r=a(24024),d=a(27849),u=(0,n.pM)({name:"ExportMergeHeaderExcel",data(){return{list:[],listLoading:!0,downloadLoading:!1}},created(){this.fetchData()},methods:{async fetchData(){this.listLoading=!0;const{data:{list:e}}=await(0,r.vS)();this.list=e,this.listLoading=!1},handleDownload(){this.downloadLoading=!0,Promise.all([a.e(8106),a.e(9566)]).then(a.bind(a,89566)).then((e=>{const t=[["Id","Main Information","","","Date"]],a=["","Title","Author","Readings",""],n=["id","title","author","pageViews","datetime"],l=this.list,o=this.formatJson(n,l),i=["A1:A2","B1:D1","E1:E2"];e.export_json_to_excel({multiHeader:t,header:a,merges:i,data:o}),this.downloadLoading=!1}))},formatJson(e,t){return t.map((t=>e.map((e=>"timestamp"===e?(0,d.pe)(t[e]):t[e]))))}}});function s(e){e.__source="src/views/other/excel/exportMergeHeaderExcel.vue"}var c=a(48499);"function"===typeof s&&s(u);const f=(0,c.A)(u,[["render",i]]);var g=f}}]);