/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2025-02-08 15:10:48 
 */
import{t as O}from"./index-CltMZZBk.js";import{d as R,b as p,K as e,e as c,U as t,B as s,u as l,Z as _,Y as i,H as U,a2 as D,o as f}from"./vsv-element-plus-D84I6Pnf.js";import{_ as M}from"./index-BL5slC2T.js";import"./vsv-icon-DZABqXig.js";import"./vsv-nprogress-0btfRK0G.js";const W={class:"web-socket-container"},q={class:"list-content"},F=R({name:"WebSocket",__name:"index",setup(I){const b=ref(),o=reactive({server:"ws://127.0.0.1:7002",serverHide:"ws://*.*.*.*",sendValue:"你好！",recordList:[]}),{status:v,data:m,send:h,close:k,open:w}=useWebSocket(o.server,{autoReconnect:!1,heartbeat:!0}),L=reactive({sendValue:[{required:!0,trigger:"blur",message:"请输入内容"}]});watchEffect(()=>{if(m.value)try{const d=JSON.parse(m.value);o.recordList.push(d)}catch{o.recordList.push({res:m.value,id:Math.ceil(Math.random()*1e3),time:Date.now()})}});const r=computed(()=>v.value==="OPEN"),B=computed(()=>r.value?"success":"danger"),C=computed(()=>[...o.recordList].reverse()),N=()=>{var d;(d=b.value)==null||d.validate(async a=>{a&&(h(o.sendValue),o.sendValue="你好")})},S=()=>{r.value?k():w()};return(d,a)=>{const H=s("el-tag"),u=s("el-form-item"),g=s("el-input"),V=s("el-button"),y=s("el-form"),x=s("el-col"),T=s("el-scrollbar"),E=s("el-row");return f(),p("div",W,[e(E,{gutter:20},{default:t(()=>[e(x,{lg:12,md:24,sm:24,xl:12,xs:24},{default:t(()=>[e(y,{ref_key:"formRef",ref:b,"label-position":"top",model:l(o),rules:l(L)},{default:t(()=>[e(u,{label:"连接状态"},{default:t(()=>[e(H,{type:l(B)},{default:t(()=>[_(i(l(v)),1)]),_:1},8,["type"])]),_:1}),e(u,{label:"服务地址"},{default:t(()=>[e(g,{modelValue:l(o).serverHide,"onUpdate:modelValue":a[0]||(a[0]=n=>l(o).serverHide=n),clearable:"",disabled:""},null,8,["modelValue"])]),_:1}),e(u,{label:"内容",prop:"sendValue"},{default:t(()=>[e(g,{modelValue:l(o).sendValue,"onUpdate:modelValue":a[1]||(a[1]=n=>l(o).sendValue=n),clearable:"",disabled:!l(r),placeholder:"需要发送到服务器的内容",rows:3,type:"textarea"},null,8,["modelValue","disabled"])]),_:1}),e(u,{label:"操作"},{default:t(()=>[e(V,{type:l(r)?"danger":"primary",onClick:S},{default:t(()=>[_(i(l(r)?"关闭连接":"开启连接"),1)]),_:1},8,["type"]),e(V,{disabled:!l(r),type:"primary",onClick:N},{default:t(()=>a[2]||(a[2]=[_("发送")])),_:1},8,["disabled"])]),_:1})]),_:1},8,["model","rules"])]),_:1}),e(x,{lg:12,md:24,sm:24,xl:12,xs:24},{default:t(()=>[e(y,{"label-position":"top"},{default:t(()=>[e(u,{label:"消息记录"},{default:t(()=>[c("div",q,[e(T,{style:{height:"calc(var(--el-container-height) - var(--el-margin) * 6)"}},{default:t(()=>[c("ul",null,[(f(!0),p(U,null,D(l(C),n=>(f(),p("li",{key:n.time},[c("div",null,i(l(O)(n.time)),1),c("div",null,i(n.res),1)]))),128))])]),_:1})])]),_:1})]),_:1})]),_:1})]),_:1}),a[3]||(a[3]=c("p",null,null,-1))])}}}),j=M(F,[["__scopeId","data-v-ecc1d2fd"]]);export{j as default};
