/*!
 *  build: Vue  Admin Plus
 *  copyright: vue-admin-beautiful.com
 *  time: 2024-12-11 15:03:04
 */
"use strict";(self["webpackChunkadmin_plus"]=self["webpackChunkadmin_plus"]||[]).push([[5314],{16709:function(e,t,a){a.d(t,{Ed:function(){return o},pL:function(){return u},vS:function(){return l}});var n=a(80085);function l(e){return(0,n.A)({url:"/table/getList",method:"get",params:e})}function o(e){return(0,n.A)({url:"/table/doEdit",method:"post",data:e})}function u(e){return(0,n.A)({url:"/table/doDelete",method:"post",data:e})}},68632:function(e,t,a){a.d(t,{A:function(){return d}});var n=a(83047),l=(a(72688),a(13919),a(34641));const o={class:"left-panel"};var u=(0,l.pM)({__name:"VabQueryFormLeftPanel",props:{span:{type:Number,default:14}},setup(e){return(t,a)=>{const u=n.uD;return(0,l.uX)(),(0,l.Wv)(u,{lg:e.span,md:24,sm:24,xl:e.span,xs:24},{default:(0,l.k6)((()=>[(0,l.Lk)("div",o,[(0,l.RG)(t.$slots,"default")])])),_:3},8,["lg","xl"])}}});function r(e){e.__source="library/components/VabQueryForm/components/VabQueryFormLeftPanel.vue"}"function"===typeof r&&r(u);const i=u;var d=i},72441:function(e,t,a){a.d(t,{A:function(){return s}});var n=a(32426),l=(a(72688),a(28962),a(34641));function o(e,t){const a=n.S2;return(0,l.uX)(),(0,l.Wv)(a,{class:"vab-query-form",gutter:0},{default:(0,l.k6)((()=>[(0,l.RG)(e.$slots,"default",{},void 0,!0)])),_:3})}function u(e){e.__source="library/components/VabQueryForm/index.vue"}var r=a(48499);const i={};"function"===typeof u&&u(i);const d=(0,r.A)(i,[["render",o],["__scopeId","data-v-172989c8"]]);var s=d},15729:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var n=a(45434),l=(a(72688),a(98564),a(51283)),o=(a(15144),a(19953)),u=(a(28504),a(96211),a(72441)),r=a(68632),i=a(24016),d=(a(56140),a(31542)),s=(a(87157),a(69394)),c=(a(79049),a(47881),a(66535),a(24451)),f=(a(91807),a(34641)),p=a(50670),b=a(27386);const m={class:"export-excel-container"};function _(e,t,a,_,h,v){const k=c.WK,x=i.xE,g=s.P9,y=s.AV,F=d.S2,w=i.US,L=r.A,V=u.A,W=l.o8,A=o.u,E=l.Up,D=n.L;return(0,f.uX)(),(0,f.CE)("div",m,[(0,f.bF)(V,null,{default:(0,f.k6)((()=>[(0,f.bF)(L,{span:24},{default:(0,f.k6)((()=>[(0,f.bF)(w,{inline:"","label-width":"100px",onSubmit:t[2]||(t[2]=(0,p.D$)((()=>{}),["prevent"]))},{default:(0,f.k6)((()=>[(0,f.bF)(x,{label:"文件名"},{default:(0,f.k6)((()=>[(0,f.bF)(k,{modelValue:e.filename,"onUpdate:modelValue":t[0]||(t[0]=t=>e.filename=t),placeholder:"请输出要导出文件的名称"},null,8,["modelValue"])])),_:1}),(0,f.bF)(x,{label:"文件类型"},{default:(0,f.k6)((()=>[(0,f.bF)(y,{modelValue:e.bookType,"onUpdate:modelValue":t[1]||(t[1]=t=>e.bookType=t)},{default:(0,f.k6)((()=>[((0,f.uX)(!0),(0,f.CE)(f.FK,null,(0,f.pI)(e.options,(e=>((0,f.uX)(),(0,f.Wv)(g,{key:e,label:e,value:e},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,f.bF)(x,null,{default:(0,f.k6)((()=>[(0,f.bF)(F,{type:"primary",onClick:e.handleDownload},{default:(0,f.k6)((()=>t[3]||(t[3]=[(0,f.eW)(" 导出 Excel ")]))),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1}),(0,f.bo)(((0,f.uX)(),(0,f.Wv)(E,{border:"",data:e.list},{default:(0,f.k6)((()=>[(0,f.bF)(W,{align:"center",label:"序号",width:"55"},{default:(0,f.k6)((({$index:e})=>[(0,f.eW)((0,b.v_)(e+1),1)])),_:1}),(0,f.bF)(W,{align:"center",label:"标题"},{default:(0,f.k6)((({row:e})=>[(0,f.eW)((0,b.v_)(e.title),1)])),_:1}),(0,f.bF)(W,{align:"center",label:"作者"},{default:(0,f.k6)((({row:e})=>[(0,f.bF)(A,null,{default:(0,f.k6)((()=>[(0,f.eW)((0,b.v_)(e.author),1)])),_:2},1024)])),_:1}),(0,f.bF)(W,{align:"center",label:"访问量"},{default:(0,f.k6)((({row:e})=>[(0,f.eW)((0,b.v_)(e.pageViews),1)])),_:1}),(0,f.bF)(W,{align:"center",label:"时间"},{default:(0,f.k6)((({row:e})=>[(0,f.Lk)("span",null,(0,b.v_)(e.datetime),1)])),_:1})])),_:1},8,["data"])),[[D,e.listLoading]])])}a(58607);var h=a(16709),v=(0,f.pM)({name:"ExportExcel",data(){return{list:[],listLoading:!0,downloadLoading:!1,filename:"",autoWidth:!0,bookType:"xlsx",options:["xlsx","csv","txt"]}},created(){this.fetchData()},methods:{async fetchData(){this.listLoading=!0;const{data:{list:e}}=await(0,h.vS)();this.list=e,this.listLoading=!1},handleDownload(){this.downloadLoading=!0,Promise.all([a.e(9914),a.e(7263)]).then(a.bind(a,77263)).then((e=>{const t=["Id","Title","Author","Readings","Date"],a=["id","title","author","pageViews","datetime"],n=this.list,l=this.formatJson(a,n);e.export_json_to_excel({header:t,data:l,filename:this.filename,autoWidth:this.autoWidth,bookType:this.bookType}),this.downloadLoading=!1}))},formatJson(e,t){return t.map((t=>e.map((e=>t[e]))))}}});function k(e){e.__source="src/views/other/excel/exportExcel.vue"}var x=a(48499);"function"===typeof k&&k(v);const g=(0,x.A)(v,[["render",_]]);var y=g}}]);