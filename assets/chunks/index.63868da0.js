import{A as T,M as E}from"./index.a511ac44.js";import{T as w}from"./TileImage.70f39159.js";import{X as B}from"./XYZ.94b2552a.js";import{bS as L,bT as y,cI as M,v as W,b5 as U,M as C,V as N,bR as R}from"./reproj.9b488601.js";import{d as I,p as $,a4 as k,o as P,c as V,_ as A}from"./framework.57763b9a.js";const S="units",D=[1,2,5],p=25.4/.28;class j extends L{constructor(e){e=e||{};const i=document.createElement("div");i.style.pointerEvents="none",super({element:i,render:e.render,target:e.target}),this.on,this.once,this.un;const n=e.className!==void 0?e.className:e.bar?"ol-scale-bar":"ol-scale-line";this.innerElement_=document.createElement("div"),this.innerElement_.className=n+"-inner",this.element.className=n+" "+y,this.element.appendChild(this.innerElement_),this.viewState_=null,this.minWidth_=e.minWidth!==void 0?e.minWidth:64,this.maxWidth_=e.maxWidth,this.renderedVisible_=!1,this.renderedWidth_=void 0,this.renderedHTML_="",this.addChangeListener(S,this.handleUnitsChanged_),this.setUnits(e.units||"metric"),this.scaleBar_=e.bar||!1,this.scaleBarSteps_=e.steps||4,this.scaleBarText_=e.text||!1,this.dpi_=e.dpi||void 0}getUnits(){return this.get(S)}handleUnitsChanged_(){this.updateElement_()}setUnits(e){this.set(S,e)}setDpi(e){this.dpi_=e}updateElement_(){const e=this.viewState_;if(!e){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const i=e.center,n=e.projection,a=this.getUnits(),d=a=="degrees"?"degrees":"m";let t=M(n,e.resolution,i,d);const c=this.minWidth_*(this.dpi_||p)/p,o=this.maxWidth_!==void 0?this.maxWidth_*(this.dpi_||p)/p:void 0;let r=c*t,s="";if(a=="degrees"){const u=U.degrees;r*=u,r<u/60?(s="″",t*=3600):r<u?(s="′",t*=60):s="°"}else a=="imperial"?r<.9144?(s="in",t/=.0254):r<1609.344?(s="ft",t/=.3048):(s="mi",t/=1609.344):a=="nautical"?(t/=1852,s="NM"):a=="metric"?r<.001?(s="μm",t*=1e6):r<1?(s="mm",t*=1e3):r<1e3?s="m":(s="km",t/=1e3):a=="us"?r<.9144?(s="in",t*=39.37):r<1609.344?(s="ft",t/=.30480061):(s="mi",t/=1609.3472):W(!1,33);let _=3*Math.floor(Math.log(c*t)/Math.log(10)),h,l,m,x,v,g;for(;;){m=Math.floor(_/3);const u=Math.pow(10,m);if(h=D[(_%3+3)%3]*u,l=Math.round(h/t),isNaN(l)){this.element.style.display="none",this.renderedVisible_=!1;return}if(o!==void 0&&l>=o){h=x,l=v,m=g;break}else if(l>=c)break;x=h,v=l,g=m,++_}const f=this.scaleBar_?this.createScaleBar(l,h,s):h.toFixed(m<0?-m:0)+" "+s;this.renderedHTML_!=f&&(this.innerElement_.innerHTML=f,this.renderedHTML_=f),this.renderedWidth_!=l&&(this.innerElement_.style.width=l+"px",this.renderedWidth_=l),this.renderedVisible_||(this.element.style.display="",this.renderedVisible_=!0)}createScaleBar(e,i,n){const a=this.getScaleForResolution(),d=a<1?Math.round(1/a).toLocaleString()+" : 1":"1 : "+Math.round(a).toLocaleString(),t=this.scaleBarSteps_,c=e/t,o=[this.createMarker("absolute")];for(let s=0;s<t;++s){const _=s%2===0?"ol-scale-singlebar-odd":"ol-scale-singlebar-even";o.push(`<div><div class="ol-scale-singlebar ${_}" style="width: ${c}px;"></div>`+this.createMarker("relative")+(s%2===0||t===2?this.createStepText(s,e,!1,i,n):"")+"</div>")}return o.push(this.createStepText(t,e,!0,i,n)),(this.scaleBarText_?`<div class="ol-scale-text" style="width: ${e}px;">`+d+"</div>":"")+o.join("")}createMarker(e){return`<div class="ol-scale-step-marker" style="position: ${e}; top: ${e==="absolute"?3:-10}px;"></div>`}createStepText(e,i,n,a,d){const c=(e===0?0:Math.round(a/this.scaleBarSteps_*e*100)/100)+(e===0?"":" "+d),o=e===0?-3:i/this.scaleBarSteps_*-1,r=e===0?0:i/this.scaleBarSteps_*2;return`<div class="ol-scale-step-text" style="margin-left: ${o}px;text-align: ${e===0?"left":"center"};min-width: ${r}px;left: ${n?i+"px":"unset"};">`+c+"</div>"}getScaleForResolution(){const e=M(this.viewState_.projection,this.viewState_.resolution,this.viewState_.center,"m"),i=this.dpi_||p,n=1e3/25.4;return e*n*i}render(e){const i=e.frameState;i?this.viewState_=i.viewState:this.viewState_=null,this.updateElement_()}}const F=j,H={id:"map"},G=I({__name:"index",setup(b){const e=new w({source:new B({attributions:T,url:E,maxZoom:20})}),i=new F({units:"metric"});let n=null;const a=()=>{n=new C({target:"map",layers:[e],view:new N({projection:"EPSG:4326",center:[0,0],zoom:5}),controls:R().extend([i])})};return $(()=>{a()}),k(()=>{n&&(n.dispose(),n=null)}),(d,t)=>(P(),V("div",H))}});const q=A(G,[["__scopeId","data-v-ad984b49"]]);export{q as default};
