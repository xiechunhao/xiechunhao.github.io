import{a as w,L as g}from"./leaflet-src.347f22be.js";import{c as x}from"./commonjsHelpers.042e6b4d.js";import{d as L,p as B,a3 as C,o as O,c as j,_ as I}from"./framework.873b9d65.js";var y={exports:{}};(function(t,e){(function(n,i){i(e,t)})(x,function(n,i){var o={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function s(){return"jsonp_"+Date.now()+"_"+Math.ceil(Math.random()*1e5)}function l(u){try{delete window[u]}catch{window[u]=void 0}}function h(u){var a=document.getElementById(u);a&&document.getElementsByTagName("head")[0].removeChild(a)}function M(u){var a=arguments.length<=1||arguments[1]===void 0?{}:arguments[1],p=u,S=a.timeout||o.timeout,v=a.jsonpCallback||o.jsonpCallback,d=void 0;return new Promise(function(T,_){var c=a.jsonpCallbackFunction||s(),f=v+"_"+c;window[c]=function(E){T({ok:!0,json:function(){return Promise.resolve(E)}}),d&&clearTimeout(d),h(f),l(c)},p+=p.indexOf("?")===-1?"?":"&";var m=document.createElement("script");m.setAttribute("src",""+p+v+"="+c),a.charset&&m.setAttribute("charset",a.charset),a.nonce&&m.setAttribute("nonce",a.nonce),a.referrerPolicy&&m.setAttribute("referrerPolicy",a.referrerPolicy),m.id=f,document.getElementsByTagName("head")[0].appendChild(m),d=setTimeout(function(){_(new Error("JSONP request to "+u+" timed out")),l(c),h(f),window[c]=function(){l(c)}},S),m.onerror=function(){_(new Error("JSONP request to "+u+" failed")),l(c),h(f),d&&clearTimeout(d)}})}i.exports=M})})(y,y.exports);var k=y.exports,D=function(t,e){return!(t[0]>e[2]||t[2]<e[0]||t[3]<e[1]||t[1]>e[3])},r=w,b=k,P=D;function U(t,e,n){for(var i="",o=n;o>0;o--){var s=0,l=1<<o-1;t&l&&s++,e&l&&(s+=2),i+=s.toString()}return i}function K(t){var e=t.split(",");return[e[1],e[0],e[3],e[2]]}var R=["Aerial","AerialWithLabels","AerialWithLabelsOnDemand","Road","RoadOnDemand","CanvasLight","CanvasDark","CanvasGray","OrdnanceSurvey"],A=["AerialWithLabelsOnDemand","RoadOnDemand"];r.TileLayer.Bing=r.TileLayer.extend({options:{bingMapsKey:null,imagerySet:"Aerial",culture:"en-US",minZoom:1,minNativeZoom:1,maxNativeZoom:19},statics:{METADATA_URL:"https://dev.virtualearth.net/REST/v1/Imagery/Metadata/{imagerySet}?key={bingMapsKey}&include=ImageryProviders&uriScheme=https&c={culture}",POINT_METADATA_URL:"https://dev.virtualearth.net/REST/v1/Imagery/Metadata/{imagerySet}/{lat},{lng}?zl={z}&key={bingMapsKey}&uriScheme=https&c={culture}"},initialize:function(t){if(typeof t=="string"&&(t={bingMapsKey:t}),t&&t.BingMapsKey&&(t.bingMapsKey=t.BingMapsKey,console.warn("use options.bingMapsKey instead of options.BingMapsKey")),!t||!t.bingMapsKey)throw new Error("Must supply options.BingMapsKey");if(t=r.setOptions(this,t),R.indexOf(t.imagerySet)<0)throw new Error("'"+t.imagerySet+"' is an invalid imagerySet, see https://github.com/digidem/leaflet-bing-layer#parameters");t&&t.style&&A.indexOf(t.imagerySet)<0&&console.warn("Dynamic styles will only work with these imagerySet choices: "+A.join(", "));var e=r.Util.template(r.TileLayer.Bing.METADATA_URL,{bingMapsKey:this.options.bingMapsKey,imagerySet:this.options.imagerySet,culture:this.options.culture});this._imageryProviders=[],this._attributions=[],this._fetch=b(e,{jsonpCallback:"jsonp"}).then(function(n){return n.json()}).then(this._metaDataOnLoad.bind(this)).catch(console.error.bind(console)),r.Browser.android||this.on("tileunload",this._onTileRemove)},createTile:function(t,e){var n=document.createElement("img");return r.DomEvent.on(n,"load",r.bind(this._tileOnLoad,this,e,n)),r.DomEvent.on(n,"error",r.bind(this._tileOnError,this,e,n)),this.options.crossOrigin&&(n.crossOrigin=""),n.alt="",this._url?n.src=this.getTileUrl(t):this._fetch.then(function(){n.src=this.getTileUrl(t)}.bind(this)).catch(function(i){console.error(i),e(i)}),n},getTileUrl:function(t){var e=U(t.x,t.y,t.z),n=r.Util.template(this._url,{quadkey:e,subdomain:this._getSubdomain(t),culture:this.options.culture});return typeof this.options.style=="string"&&(n+="&st="+this.options.style),n},onAdd:function(t){t.on("moveend",this._updateAttribution,this),r.TileLayer.prototype.onAdd.call(this,t),this._attributions.forEach(function(e){t.attributionControl.addAttribution(e)})},onRemove:function(t){t.off("moveend",this._updateAttribution,this),this._attributions.forEach(function(e){t.attributionControl.removeAttribution(e)}),r.TileLayer.prototype.onRemove.call(this,t)},getMetaData:function(t,e){if(!this._map&&(!t||!e))return Promise.reject(new Error("If layer is not attached to map, you must provide LatLng and zoom"));t=t||this._map.getCenter(),e=e||this._map.getZoom();var n=r.Util.template(r.TileLayer.Bing.POINT_METADATA_URL,{bingMapsKey:this.options.bingMapsKey,imagerySet:this.options.imagerySet,z:e,lat:t.lat,lng:t.lng});return b(n,{jsonpCallback:"jsonp"}).then(function(i){return i.json()}).catch(console.error.bind(console))},_metaDataOnLoad:function(t){if(t.statusCode!==200)throw new Error(`Bing Imagery Metadata error: 
`+JSON.stringify(t,null,"  "));var e=t.resourceSets[0].resources[0];return this._url=e.imageUrl,this._imageryProviders=e.imageryProviders||[],this.options.subdomains=e.imageUrlSubdomains,this._updateAttribution(),Promise.resolve()},_updateAttribution:function(){var t=this._map;if(!(!t||!t.attributionControl)){var e=t.getZoom(),n=K(t.getBounds().toBBoxString());this._fetch.then(function(){var i=this._getAttributions(n,e),o=this._attributions;i.forEach(function(s){o.indexOf(s)>-1||t.attributionControl.addAttribution(s)}),o.filter(function(s){i.indexOf(s)>-1||t.attributionControl.removeAttribution(s)}),this._attributions=i}.bind(this))}},_getAttributions:function(t,e){return this._imageryProviders.reduce(function(n,i){for(var o=0;o<i.coverageAreas.length;o++)if(P(t,i.coverageAreas[o].bbox)&&e>=i.coverageAreas[o].zoomMin&&e<=i.coverageAreas[o].zoomMax)return n.push(i.attribution),n;return n},[])}});r.tileLayer.bing=function(t){return new r.TileLayer.Bing(t)};r.TileLayer.Bing;const N={id:"map"},Z=L({__name:"index",setup(t){let e=null;const n=()=>{e=g.map("map",{crs:g.CRS.EPSG3857,center:[22.548857,114.064839],minZoom:1,maxZoom:18,zoom:12,attributionControl:!1});const i="Q57tupj2UBsQNQdju4xL~xBceblfTd6icjljunbuaCw~AhwA-whmGMsfIpVhslZyknWhFYq-GvWJZqBnqV8Zq1uRlI5YM_qr7_hxvdgnU7nH";g.tileLayer.bing(i).addTo(e)};return B(()=>{n()}),C(()=>{e&&(e.remove(),e=null)}),(i,o)=>(O(),j("div",N))}});const F=I(Z,[["__scopeId","data-v-13289f4c"]]);export{F as default};
