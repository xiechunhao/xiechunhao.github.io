import{B as P,c1 as p,c2 as E,c3 as O,u as C,r as I,c4 as y,c5 as N,c6 as T,a3 as S}from"./reproj.9b488601.js";const s={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class M extends P{constructor(e){super(),this.on,this.once,this.un,this.options=e,this.id=e.id,this.insertFirst=e.insertFirst!==void 0?e.insertFirst:!0,this.stopEvent=e.stopEvent!==void 0?e.stopEvent:!0,this.element=document.createElement("div"),this.element.className=e.className!==void 0?e.className:"ol-overlay-container "+p,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=e.autoPan===!0?{}:e.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(s.ELEMENT,this.handleElementChanged),this.addChangeListener(s.MAP,this.handleMapChanged),this.addChangeListener(s.OFFSET,this.handleOffsetChanged),this.addChangeListener(s.POSITION,this.handlePositionChanged),this.addChangeListener(s.POSITIONING,this.handlePositioningChanged),e.element!==void 0&&this.setElement(e.element),this.setOffset(e.offset!==void 0?e.offset:[0,0]),this.setPositioning(e.positioning||"top-left"),e.position!==void 0&&this.setPosition(e.position)}getElement(){return this.get(s.ELEMENT)}getId(){return this.id}getMap(){return this.get(s.MAP)||null}getOffset(){return this.get(s.OFFSET)}getPosition(){return this.get(s.POSITION)}getPositioning(){return this.get(s.POSITIONING)}handleElementChanged(){E(this.element);const e=this.getElement();e&&this.element.appendChild(e)}handleMapChanged(){this.mapPostrenderListenerKey&&(O(this.element),C(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const e=this.getMap();if(e){this.mapPostrenderListenerKey=I(e,y.POSTRENDER,this.render,this),this.updatePixelPosition();const n=this.stopEvent?e.getOverlayContainerStopEvent():e.getOverlayContainer();this.insertFirst?n.insertBefore(this.element,n.childNodes[0]||null):n.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(e){this.set(s.ELEMENT,e)}setMap(e){this.set(s.MAP,e)}setOffset(e){this.set(s.OFFSET,e)}setPosition(e){this.set(s.POSITION,e)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(e){const n=this.getMap();if(!n||!n.getTargetElement()||!this.get(s.POSITION))return;const i=this.getRect(n.getTargetElement(),n.getSize()),o=this.getElement(),t=this.getRect(o,[N(o),T(o)]);e=e||{};const a=e.margin===void 0?20:e.margin;if(!S(i,t)){const f=t[0]-i[0],h=i[2]-t[2],d=t[1]-i[1],l=i[3]-t[3],r=[0,0];if(f<0?r[0]=f-a:h<0&&(r[0]=Math.abs(h)+a),d<0?r[1]=d-a:l<0&&(r[1]=Math.abs(l)+a),r[0]!==0||r[1]!==0){const m=n.getView().getCenterInternal(),g=n.getPixelFromCoordinateInternal(m);if(!g)return;const u=[g[0]+r[0],g[1]+r[1]],c=e.animation||{};n.getView().animateInternal({center:n.getCoordinateFromPixelInternal(u),duration:c.duration,easing:c.easing})}}}getRect(e,n){const i=e.getBoundingClientRect(),o=i.left+window.pageXOffset,t=i.top+window.pageYOffset;return[o,t,o+n[0],t+n[1]]}setPositioning(e){this.set(s.POSITIONING,e)}setVisible(e){this.rendered.visible!==e&&(this.element.style.display=e?"":"none",this.rendered.visible=e)}updatePixelPosition(){const e=this.getMap(),n=this.getPosition();if(!e||!e.isRendered()||!n){this.setVisible(!1);return}const i=e.getPixelFromCoordinate(n),o=e.getSize();this.updateRenderedPosition(i,o)}updateRenderedPosition(e,n){const i=this.element.style,o=this.getOffset(),t=this.getPositioning();this.setVisible(!0);const a=Math.round(e[0]+o[0])+"px",f=Math.round(e[1]+o[1])+"px";let h="0%",d="0%";t=="bottom-right"||t=="center-right"||t=="top-right"?h="-100%":(t=="bottom-center"||t=="center-center"||t=="top-center")&&(h="-50%"),t=="bottom-left"||t=="bottom-center"||t=="bottom-right"?d="-100%":(t=="center-left"||t=="center-center"||t=="center-right")&&(d="-50%");const l=`translate(${h}, ${d}) translate(${a}, ${f})`;this.rendered.transform_!=l&&(this.rendered.transform_=l,i.transform=l)}getOptions(){return this.options}}const v=M;export{v as O};
