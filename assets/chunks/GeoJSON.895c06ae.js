import{b as p}from"./Vector.e7fd2c77.js";import{G as f,M as G,a as F}from"./GeometryCollection.bd3c0be4.js";import{F as O,t as d}from"./Feature.861d9f0b.js";import{x as a,b4 as u,v as P,W as b,i as h,P as j}from"./reproj.9b488601.js";import{L as w}from"./LineString.2b94a2e9.js";import{M as S}from"./MultiLineString.f00700b3.js";class N extends O{constructor(){super()}getType(){return"json"}readFeature(e,t){return this.readFeatureFromObject(c(e),this.getReadOptions(e,t))}readFeatures(e,t){return this.readFeaturesFromObject(c(e),this.getReadOptions(e,t))}readFeatureFromObject(e,t){return a()}readFeaturesFromObject(e,t){return a()}readGeometry(e,t){return this.readGeometryFromObject(c(e),this.getReadOptions(e,t))}readGeometryFromObject(e,t){return a()}readProjection(e){return this.readProjectionFromObject(c(e))}readProjectionFromObject(e){return a()}writeFeature(e,t){return JSON.stringify(this.writeFeatureObject(e,t))}writeFeatureObject(e,t){return a()}writeFeatures(e,t){return JSON.stringify(this.writeFeaturesObject(e,t))}writeFeaturesObject(e,t){return a()}writeGeometry(e,t){return JSON.stringify(this.writeGeometryObject(e,t))}writeGeometryObject(e,t){return a()}}function c(r){if(typeof r=="string"){const e=JSON.parse(r);return e||null}return r!==null?r:null}const M=N;class C extends M{constructor(e){e=e||{},super(),this.dataProjection=u(e.dataProjection?e.dataProjection:"EPSG:4326"),e.featureProjection&&(this.defaultFeatureProjection=u(e.featureProjection)),this.geometryName_=e.geometryName,this.extractGeometryName_=e.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(e,t){let o=null;e.type==="Feature"?o=e:o={type:"Feature",geometry:e,properties:null};const n=l(o.geometry,t),i=new p;return this.geometryName_?i.setGeometryName(this.geometryName_):this.extractGeometryName_&&"geometry_name"in o!==void 0&&i.setGeometryName(o.geometry_name),i.setGeometry(n),"id"in o&&i.setId(o.id),o.properties&&i.setProperties(o.properties,!0),i}readFeaturesFromObject(e,t){const o=e;let n=null;if(o.type==="FeatureCollection"){const i=e;n=[];const s=i.features;for(let m=0,g=s.length;m<g;++m)n.push(this.readFeatureFromObject(s[m],t))}else n=[this.readFeatureFromObject(e,t)];return n}readGeometryFromObject(e,t){return l(e,t)}readProjectionFromObject(e){const t=e.crs;let o;return t?t.type=="name"?o=u(t.properties.name):t.type==="EPSG"?o=u("EPSG:"+t.properties.code):P(!1,36):o=this.dataProjection,o}writeFeatureObject(e,t){t=this.adaptOptions(t);const o={type:"Feature",geometry:null,properties:null},n=e.getId();if(n!==void 0&&(o.id=n),!e.hasProperties())return o;const i=e.getProperties(),s=e.getGeometry();return s&&(o.geometry=y(s,t),delete i[e.getGeometryName()]),b(i)||(o.properties=i),o}writeFeaturesObject(e,t){t=this.adaptOptions(t);const o=[];for(let n=0,i=e.length;n<i;++n)o.push(this.writeFeatureObject(e[n],t));return{type:"FeatureCollection",features:o}}writeGeometryObject(e,t){return y(e,this.adaptOptions(t))}}function l(r,e){if(!r)return null;let t;switch(r.type){case"Point":{t=J(r);break}case"LineString":{t=L(r);break}case"Polygon":{t=R(r);break}case"MultiPoint":{t=_(r);break}case"MultiLineString":{t=x(r);break}case"MultiPolygon":{t=E(r);break}case"GeometryCollection":{t=k(r);break}default:throw new Error("Unsupported GeoJSON type: "+r.type)}return d(t,!1,e)}function k(r,e){const t=r.geometries.map(function(o){return l(o,e)});return new f(t)}function J(r){return new h(r.coordinates)}function L(r){return new w(r.coordinates)}function x(r){return new S(r.coordinates)}function _(r){return new G(r.coordinates)}function E(r){return new F(r.coordinates)}function R(r){return new j(r.coordinates)}function y(r,e){r=d(r,!0,e);const t=r.getType();let o;switch(t){case"Point":{o=W(r);break}case"LineString":{o=v(r);break}case"Polygon":{o=$(r,e);break}case"MultiPoint":{o=I(r);break}case"MultiLineString":{o=H(r);break}case"MultiPolygon":{o=U(r,e);break}case"GeometryCollection":{o=T(r,e);break}case"Circle":{o={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+t)}return o}function T(r,e){return e=Object.assign({},e),delete e.featureProjection,{type:"GeometryCollection",geometries:r.getGeometriesArray().map(function(o){return y(o,e)})}}function v(r,e){return{type:"LineString",coordinates:r.getCoordinates()}}function H(r,e){return{type:"MultiLineString",coordinates:r.getCoordinates()}}function I(r,e){return{type:"MultiPoint",coordinates:r.getCoordinates()}}function U(r,e){let t;return e&&(t=e.rightHanded),{type:"MultiPolygon",coordinates:r.getCoordinates(t)}}function W(r,e){return{type:"Point",coordinates:r.getCoordinates()}}function $(r,e){let t;return e&&(t=e.rightHanded),{type:"Polygon",coordinates:r.getCoordinates(t)}}const Q=C;export{Q as G};
