import{i as H}from"./index-p1XoTQj1.js";import{J as q,r as x,O as M,R as B,o as C,l as z,a5 as P,a7 as E,d as i,ai as Q,c as I,a as N,w as u,b as a,aF as T,F as A,aH as G,aG as J,aI as j,aJ as K,aS as W,aK as X}from"./index-BF2fBoPb.js";import{i as Y}from"./index-Cjr4ibGp.js";import{E as Z}from"./input-number-DNV7vLKM.js";import{E as ee}from"./slider-DWumXTvR.js";import{q as L,a as O,b as le,E as ae,g as te,e as oe,S as ne,c as se,i as F}from"./index-wNuulKXY.js";import"./index-DOwINDGR.js";const ie=q({name:"CanvasRender",props:L,emits:O,setup(e,{emit:d}){const s=x(""),m=x(null),n=x(null),p=()=>{const{value:c,size:t,level:w,bgColor:R,fgColor:$,margin:g,imageSettings:l}=e,y=m.value;if(!y)return;const f=y.getContext("2d");if(!f)return;if(!c){f.clearRect(0,0,y.width,y.height);return}let _=le.QrCode.encodeText(c,ae[w]).getModules();const r=_.length+g*2,v=te(l,t,g,_),V=n.value,b=v!=null&&V!=null&&V.complete&&V.naturalHeight!==0&&V.naturalWidth!==0;b&&v.excavation!=null&&(_=oe(_,v.excavation));const S=window.devicePixelRatio||1;y.height=y.width=t*S;const h=t/r*S;f.scale(h,h),f.fillStyle=R,f.fillRect(0,0,r,r),f.fillStyle=$,ne?f.fill(new Path2D(se(_,g))):_.forEach(function(U,D){U.forEach(function(k,o){k&&f.fillRect(o+g,D+g,1,1)})}),b&&f.drawImage(V,v.x+g,v.y+g,v.w,v.h),e.tag==="img"&&(s.value=y.toDataURL()),d("done")};return M([()=>e.value,()=>e.size,()=>e.level,()=>e.margin,()=>e.bgColor,()=>e.fgColor,()=>e.tag],()=>{p()}),M(()=>e.imageSettings,()=>{p()},{deep:!0}),B(()=>{p()}),{imgData:s,canvasRef:m,imageRef:n,render:p}}}),de=(e,d)=>{const s=e.__vccOpts||e;for(const[m,n]of d)s[m]=n;return s},me={class:"ele-qr-code",style:{display:"inline-flex"}},re=["src"],ue=["src"];function ge(e,d,s,m,n,p){return C(),z("div",me,[e.tag==="img"?(C(),z("img",{key:0,src:e.imgData,style:P([{width:e.size+"px",height:e.size+"px"},e.customStyle||{}])},null,12,re)):E("",!0),i("canvas",{ref:"canvasRef",style:P([{width:e.size+"px",height:e.size+"px",display:e.tag==="img"?"none":void 0},e.customStyle||{}])},null,4),e.imageSettings&&e.imageSettings.src?(C(),z("img",{key:1,ref:"imageRef",src:e.imageSettings.src,crossorigin:"anonymous",referrerpolicy:"no-referrer",style:{display:"none"},onLoad:d[0]||(d[0]=(...c)=>e.render&&e.render(...c))},null,40,ue)):E("",!0)])}const ve=de(ie,[["render",ge]]),pe=q({name:"EleQrCode",components:{EleQrCodeSvg:F,CanvasRender:ve},props:L,emits:O,setup(e,{emit:d}){return{handleDone:()=>{d("done")}}}}),fe=(e,d)=>{const s=e.__vccOpts||e;for(const[m,n]of d)s[m]=n;return s};function ce(e,d,s,m,n,p){const c=Q("EleQrCodeSvg"),t=Q("CanvasRender");return e.tag==="svg"?(C(),I(c,{key:0,value:e.value,size:e.size,level:e.level,bgColor:e.bgColor,fgColor:e.fgColor,margin:e.margin,imageSettings:e.imageSettings,customStyle:e.customStyle,onDone:e.handleDone},null,8,["value","size","level","bgColor","fgColor","margin","imageSettings","customStyle","onDone"])):(C(),I(t,{key:1,value:e.value,size:e.size,level:e.level,bgColor:e.bgColor,fgColor:e.fgColor,margin:e.margin,imageSettings:e.imageSettings,customStyle:e.customStyle,tag:e.tag,onDone:e.handleDone},null,8,["value","size","level","bgColor","fgColor","margin","imageSettings","customStyle","tag","onDone"]))}const ye=fe(pe,[["render",ce]]),_e={style:{display:"flex","flex-wrap":"wrap"}},xe={style:{margin:"0 10px 20px 10px"}},Ce={style:{margin:"0 10px 20px 10px"}},Ve={style:{display:"flex","flex-wrap":"wrap"}},he={style:{width:"120px","margin-right":"16px"}},Se={style:{width:"120px"}},we={key:0,style:{display:"flex","flex-wrap":"wrap"}},be={style:{display:"flex","align-items":"center"}},ze={style:{width:"120px"}},Ee={style:{display:"flex","align-items":"center"}},Re={style:{width:"120px"}},$e={name:"ExtensionQrCode"},qe=Object.assign($e,{setup(e){const d="https://cdn.eleadmin.com/20200610/logo-radius.png",s=x("https://eleadmin.com"),m=x("L"),n=x(120),p=x(0),c=x(!0),t=N({src:d,width:28,height:28,x:void 0,y:void 0,excavate:!1}),w=x(!0),R=g=>{g?t.src=d:t.src=void 0},$=g=>{g?(t.x=void 0,t.y=void 0):(t.x=0,t.y=0)};return(g,l)=>{const y=ye,f=F,_=G,r=J,v=j,V=K,b=ee,S=W,h=Z,U=X,D=Y,k=H;return C(),I(k,{"multi-card":!0},{default:u(()=>[a(D,{header:"基础用法"},{default:u(()=>[i("div",_e,[i("div",xe,[l[13]||(l[13]=i("div",{style:{"margin-bottom":"8px"}},"canvas 渲染",-1)),a(y,{value:s.value,size:n.value,level:m.value,margin:p.value,"image-settings":t},null,8,["value","size","level","margin","image-settings"])]),i("div",Ce,[l[14]||(l[14]=i("div",{style:{"margin-bottom":"8px"}},"svg 渲染",-1)),a(f,{value:s.value,size:n.value,level:m.value,margin:p.value,"image-settings":t},null,8,["value","size","level","margin","image-settings"])])]),a(U,{"label-width":"88px",style:{"max-width":"420px"},onSubmit:l[12]||(l[12]=T(()=>{},["prevent"]))},{default:u(()=>[a(r,{label:"二维码内容"},{default:u(()=>[a(_,{modelValue:s.value,"onUpdate:modelValue":l[0]||(l[0]=o=>s.value=o),maxlength:150},null,8,["modelValue"])]),_:1}),a(r,{label:"容错等级"},{default:u(()=>[a(V,{modelValue:m.value,"onUpdate:modelValue":l[1]||(l[1]=o=>m.value=o),class:"ele-fluid"},{default:u(()=>[a(v,{value:"L",label:"L"}),a(v,{value:"M",label:"M"}),a(v,{value:"Q",label:"Q"}),a(v,{value:"H",label:"H"})]),_:1},8,["modelValue"])]),_:1}),a(r,{label:"尺寸"},{default:u(()=>[a(b,{modelValue:n.value,"onUpdate:modelValue":l[2]||(l[2]=o=>n.value=o),min:80,max:280,step:40},null,8,["modelValue"])]),_:1}),a(r,{label:"间距"},{default:u(()=>[a(b,{modelValue:p.value,"onUpdate:modelValue":l[3]||(l[3]=o=>p.value=o),min:0,max:20},null,8,["modelValue"])]),_:1}),a(r,{label:"自定义图片"},{default:u(()=>[a(S,{modelValue:c.value,"onUpdate:modelValue":l[4]||(l[4]=o=>c.value=o),size:"small",onChange:R},null,8,["modelValue"])]),_:1}),c.value?(C(),z(A,{key:0},[a(r,{label:"图片地址"},{default:u(()=>[a(_,{modelValue:t.src,"onUpdate:modelValue":l[5]||(l[5]=o=>t.src=o),maxlength:400},null,8,["modelValue"])]),_:1}),a(r,{label:"图片宽高"},{default:u(()=>[i("div",Ve,[i("div",he,[a(h,{modelValue:t.width,"onUpdate:modelValue":l[6]||(l[6]=o=>t.width=o),size:"small",min:0,max:n.value},null,8,["modelValue","max"])]),i("div",Se,[a(h,{modelValue:t.height,"onUpdate:modelValue":l[7]||(l[7]=o=>t.height=o),size:"small",min:0,max:n.value},null,8,["modelValue","max"])])])]),_:1}),a(r,{label:"位置居中"},{default:u(()=>[i("div",null,[a(S,{modelValue:w.value,"onUpdate:modelValue":l[8]||(l[8]=o=>w.value=o),size:"small",onChange:$},null,8,["modelValue"]),w.value?E("",!0):(C(),z("div",we,[i("div",be,[l[15]||(l[15]=i("div",{style:{padding:"0 12px"}},"x",-1)),i("div",ze,[a(h,{modelValue:t.x,"onUpdate:modelValue":l[9]||(l[9]=o=>t.x=o),size:"small",min:0,max:n.value},null,8,["modelValue","max"])])]),i("div",Ee,[l[16]||(l[16]=i("div",{style:{padding:"0 12px"}},"y",-1)),i("div",Re,[a(h,{modelValue:t.y,"onUpdate:modelValue":l[10]||(l[10]=o=>t.y=o),size:"small",min:0,max:n.value},null,8,["modelValue","max"])])])]))])]),_:1}),a(r,{label:"背景擦除"},{default:u(()=>[a(S,{modelValue:t.excavate,"onUpdate:modelValue":l[11]||(l[11]=o=>t.excavate=o),size:"small"},null,8,["modelValue"])]),_:1})],64)):E("",!0)]),_:1})]),_:1})]),_:1})}}});export{qe as default};
