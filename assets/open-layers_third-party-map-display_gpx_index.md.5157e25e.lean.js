import{b as N,S as x,C as z,F as Q,a as R,V as $}from"./chunks/Vector.e7fd2c77.js";import{L as H}from"./chunks/LineString.2b94a2e9.js";import{M as J}from"./chunks/MultiLineString.f00700b3.js";import{b4 as j,i as ss,M as ns,V as as}from"./chunks/reproj.9b488601.js";import{m as F,X as os,p as f,c as U,a as G,b as g,d as S,e as t,r as y,f as e,g as h,h as C,i as L,w as D,j as w,k as V,l as m,n as ls,o as Y,O as T,q,s as ps}from"./chunks/xsd.7af4bacb.js";import{t as E}from"./chunks/Feature.861d9f0b.js";import{X as es}from"./chunks/XYZ.94b2552a.js";import{A as ts,M as rs}from"./chunks/index.a511ac44.js";import{T as cs}from"./chunks/TileImage.70f39159.js";import{V as ys}from"./chunks/Vector.ef038271.js";import{d as Ds,p as Fs,a3 as is,o as Z,c as B,_ as As,G as Cs,z as d,a as P,O as us}from"./chunks/framework.873b9d65.js";const c=[null,"http://www.topografix.com/GPX/1/0","http://www.topografix.com/GPX/1/1"],ms="http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",ds={rte:b,trk:K,wpt:W},fs=F(c,{rte:S(b),trk:S(K),wpt:S(W)}),gs=F(c,{text:t(y,"linkText"),type:t(y,"linkType")}),Es=F(c,{rte:e(bs),trk:e(Ks),wpt:e(zs)});class _s extends os{constructor(s){super(),s=s||{},this.dataProjection=j("EPSG:4326"),this.readExtensions_=s.readExtensions}handleReadExtensions_(s){s||(s=[]);for(let a=0,n=s.length;a<n;++a){const o=s[a];if(this.readExtensions_){const p=o.get("extensionsNode_")||null;this.readExtensions_(o,p)}o.set("extensionsNode_",void 0)}}readFeatureFromNode(s,a){if(!c.includes(s.namespaceURI))return null;const n=ds[s.localName];if(!n)return null;const o=n(s,[this.getReadOptions(s,a)]);return o?(this.handleReadExtensions_([o]),o):null}readFeaturesFromNode(s,a){if(!c.includes(s.namespaceURI))return[];if(s.localName=="gpx"){const n=f([],fs,s,[this.getReadOptions(s,a)]);return n?(this.handleReadExtensions_(n),n):[]}return[]}writeFeaturesNode(s,a){a=this.adaptOptions(a);const n=U("http://www.topografix.com/GPX/1/1","gpx"),o="http://www.w3.org/2000/xmlns/";return n.setAttributeNS(o,"xmlns:xsi",G),n.setAttributeNS(G,"xsi:schemaLocation",ms),n.setAttribute("version","1.1"),n.setAttribute("creator","OpenLayers"),g({node:n},Es,Vs,s,[a]),n}}const hs=F(c,{name:t(y),cmt:t(y),desc:t(y),src:t(y),link:M,number:t(h),extensions:v,type:t(y),rtept:Ys}),ws=F(c,{ele:t(C),time:t(L)}),Ts=F(c,{name:t(y),cmt:t(y),desc:t(y),src:t(y),link:M,number:t(h),type:t(y),extensions:v,trkseg:Bs}),xs=F(c,{trkpt:Zs}),Rs=F(c,{ele:t(C),time:t(L)}),Ss=F(c,{ele:t(C),time:t(L),magvar:t(C),geoidheight:t(C),name:t(y),cmt:t(y),desc:t(y),src:t(y),link:M,sym:t(y),type:t(y),fix:t(y),sat:t(h),hdop:t(C),vdop:t(C),pdop:t(C),ageofdgpsdata:t(C),dgpsid:t(h),extensions:v}),Ps=["text","type"],Ns=F(c,{text:e(D),type:e(D)}),Ls=F(c,["name","cmt","desc","src","link","number","type","rtept"]),qs=F(c,{name:e(D),cmt:e(D),desc:e(D),src:e(D),link:e(O),number:e(w),type:e(D),rtept:V(e(X))}),Is=F(c,["ele","time"]),ks=F(c,["name","cmt","desc","src","link","number","type","trkseg"]),Ms=F(c,{name:e(D),cmt:e(D),desc:e(D),src:e(D),link:e(O),number:e(w),type:e(D),trkseg:V(e(Ws))}),vs=ps("trkpt"),Os=F(c,{trkpt:e(X)}),Xs=F(c,["ele","time","magvar","geoidheight","name","cmt","desc","src","link","sym","type","fix","sat","hdop","vdop","pdop","ageofdgpsdata","dgpsid"]),Gs=F(c,{ele:e(m),time:e(ls),magvar:e(m),geoidheight:e(m),name:e(D),cmt:e(D),desc:e(D),src:e(D),link:e(O),sym:e(D),type:e(D),fix:e(D),sat:e(w),hdop:e(m),vdop:e(m),pdop:e(m),ageofdgpsdata:e(m),dgpsid:e(w)}),Us={Point:"wpt",LineString:"rte",MultiLineString:"trk"};function Vs(l,s,a){const n=l.getGeometry();if(n){const o=Us[n.getType()];if(o){const p=s[s.length-1].node;return U(p.namespaceURI,o)}}}function I(l,s,a,n){return l.push(parseFloat(a.getAttribute("lon")),parseFloat(a.getAttribute("lat"))),"ele"in n?(l.push(n.ele),delete n.ele,s.hasZ=!0):l.push(0),"time"in n?(l.push(n.time),delete n.time,s.hasM=!0):l.push(0),l}function k(l,s,a){let n="XY",o=2;if(l.hasZ&&l.hasM?(n="XYZM",o=4):l.hasZ?(n="XYZ",o=3):l.hasM&&(n="XYM",o=3),o!==4){for(let p=0,r=s.length/4;p<r;p++)s[p*o]=s[p*4],s[p*o+1]=s[p*4+1],l.hasZ&&(s[p*o+2]=s[p*4+2]),l.hasM&&(s[p*o+2]=s[p*4+3]);if(s.length=s.length/4*o,a)for(let p=0,r=a.length;p<r;p++)a[p]=a[p]/4*o}return n}function M(l,s){const a=s[s.length-1],n=l.getAttribute("href");n!==null&&(a.link=n),Y(gs,l,s)}function v(l,s){const a=s[s.length-1];a.extensionsNode_=l}function Ys(l,s){const a=f({},ws,l,s);if(a){const n=s[s.length-1],o=n.flatCoordinates,p=n.layoutOptions;I(o,p,l,a)}}function Zs(l,s){const a=f({},Rs,l,s);if(a){const n=s[s.length-1],o=n.flatCoordinates,p=n.layoutOptions;I(o,p,l,a)}}function Bs(l,s){const a=s[s.length-1];Y(xs,l,s);const n=a.flatCoordinates;a.ends.push(n.length)}function b(l,s){const a=s[0],n=f({flatCoordinates:[],layoutOptions:{}},hs,l,s);if(!n)return;const o=n.flatCoordinates;delete n.flatCoordinates;const p=n.layoutOptions;delete n.layoutOptions;const r=k(p,o),A=new H(o,r);E(A,!1,a);const i=new N(A);return i.setProperties(n,!0),i}function K(l,s){const a=s[0],n=f({flatCoordinates:[],ends:[],layoutOptions:{}},Ts,l,s);if(!n)return;const o=n.flatCoordinates;delete n.flatCoordinates;const p=n.ends;delete n.ends;const r=n.layoutOptions;delete n.layoutOptions;const A=k(r,o,p),i=new J(o,A,p);E(i,!1,a);const u=new N(i);return u.setProperties(n,!0),u}function W(l,s){const a=s[0],n=f({},Ss,l,s);if(!n)return;const o={},p=I([],o,l,n),r=k(o,p),A=new ss(p,r);E(A,!1,a);const i=new N(A);return i.setProperties(n,!0),i}function O(l,s,a){l.setAttribute("href",s);const o=a[a.length-1].properties,p=[o.linkText,o.linkType];g({node:l},Ns,T,p,a,Ps)}function X(l,s,a){const n=a[a.length-1],p=n.node.namespaceURI,r=n.properties;switch(l.setAttributeNS(null,"lat",String(s[1])),l.setAttributeNS(null,"lon",String(s[0])),n.geometryLayout){case"XYZM":s[3]!==0&&(r.time=s[3]);case"XYZ":s[2]!==0&&(r.ele=s[2]);break;case"XYM":s[2]!==0&&(r.time=s[2]);break}const i=l.nodeName=="rtept"?Is[p]:Xs[p],u=q(r,i);g({node:l,properties:r},Gs,T,u,a,i)}function bs(l,s,a){const n=a[0],o=s.getProperties(),p={node:l};p.properties=o;const r=s.getGeometry();if(r.getType()=="LineString"){const _=E(r,!0,n);p.geometryLayout=_.getLayout(),o.rtept=_.getCoordinates()}const A=a[a.length-1].node,i=Ls[A.namespaceURI],u=q(o,i);g(p,qs,T,u,a,i)}function Ks(l,s,a){const n=a[0],o=s.getProperties(),p={node:l};p.properties=o;const r=s.getGeometry();if(r.getType()=="MultiLineString"){const _=E(r,!0,n);o.trkseg=_.getLineStrings()}const A=a[a.length-1].node,i=ks[A.namespaceURI],u=q(o,i);g(p,Ms,T,u,a,i)}function Ws(l,s,a){const n={node:l};n.geometryLayout=s.getLayout(),n.properties={},g(n,Os,vs,s.getCoordinates(),a)}function zs(l,s,a){const n=a[0],o=a[a.length-1];o.properties=s.getProperties();const p=s.getGeometry();if(p.getType()=="Point"){const r=E(p,!0,n);o.geometryLayout=r.getLayout(),X(l,r.getCoordinates(),a)}}const Qs=_s,$s={id:"map",class:"map"},Hs=Ds({__name:"index",setup(l){const s=new cs({source:new es({attributions:ts,url:rs,maxZoom:20})}),a={Point:new x({image:new z({fill:new Q({color:"rgba(255,255,0,0.4)"}),radius:5,stroke:new R({color:"#ff0",width:1})})}),LineString:new x({stroke:new R({color:"#f00",width:3})}),MultiLineString:new x({stroke:new R({color:"#0f0",width:3})})},n=new ys({source:new $({url:"/gpx/fells_loop.gpx",format:new Qs}),style:function(p){const r=p.getGeometry();if(r)return a[r.getType()]}});let o=null;return Fs(()=>{o=new ns({layers:[s,n],target:"map",view:new as({center:[-7916041528716288e-9,5228379045749711e-9],zoom:12})})}),is(()=>{o&&(o.dispose(),o=null)}),(p,r)=>(Z(),B("div",$s))}});const Js=As(Hs,[["__scopeId","data-v-ed192b35"]]),js=d("h1",{id:"gpx",tabindex:"-1"},[P("GPX "),d("a",{class:"header-anchor",href:"#gpx","aria-label":'Permalink to "GPX"'},"​")],-1),sn=d("div",{class:"tip custom-block"},[d("p",{class:"custom-block-title"},"TIP"),d("p",null,[P("加载 "),d("code",null,"GPX"),P(" 数据")])],-1),nn=us("",2),Cn=JSON.parse('{"title":"GPX","description":"","frontmatter":{},"headers":[],"relativePath":"open-layers/third-party-map-display/gpx/index.md","filePath":"open-layers/third-party-map-display/gpx/index.md","lastUpdated":1687662745000}'),an={name:"open-layers/third-party-map-display/gpx/index.md"},un=Object.assign(an,{setup(l){return(s,a)=>(Z(),B("div",null,[js,sn,Cs(Js),nn]))}});export{Cn as __pageData,un as default};
