import{i as I}from"./index-p1XoTQj1.js";import{r as N,o as w,c as R,w as l,b as p,e as B,aW as z,aX as D,E,aB as J,d as g,l as b,F as C,m as M,t as A,a7 as j,aY as O,aZ as T}from"./index-BF2fBoPb.js";import{i as K}from"./index-Cjr4ibGp.js";import{i as G}from"./index-DG03PXF-.js";import"./index-CcYpqHDV.js";import"./index-B-b3I1wI.js";import"./index-BnIMXyIx.js";import"./virtual-list-B6G0p9cv.js";import"./index-BWYZqqjh.js";import{i as L}from"./index-DuliLu7F.js";import{E as X,a as Y}from"./col-DirwGu8S.js";import{E as Z}from"./upload-CY9ZjjH3.js";import"./progress-C9ZnX_fS.js";import"./isArrayLikeObject-j402kJv_.js";import"./vuedraggable.umd-DLnsjw3h.js";import"./cloneDeep-Zuu3-0H5.js";const H={__name:"excel-export",setup(V){const y=N([{key:1,username:"张小三",amount:18,province:"浙江",city:"杭州",zone:"西湖区",street:"西溪街道",address:"西溪花园30栋1单元"},{key:2,username:"李小四",amount:39,province:"江苏",city:"苏州",zone:"姑苏区",street:"丝绸路",address:"天墅之城9幢2单元"},{key:3,username:"王小五",amount:8,province:"江西",city:"南昌",zone:"青山湖区",street:"艾溪湖办事处",address:"中兴和园1幢3单元"},{key:4,username:"赵小六",amount:16,province:"福建",city:"泉州",zone:"丰泽区",street:"南洋街道",address:"南洋村6幢1单元"},{key:5,username:"孙小七",amount:12,province:"湖北",city:"武汉",zone:"武昌区",street:"武昌大道",address:"两湖花园16幢2单元"},{key:6,username:"周小八",amount:11,province:"安徽",city:"黄山",zone:"黄山区",street:"汤口镇",address:"温泉村21号"}]),v=N([{type:"selection",columnKey:"selection",width:56,align:"center"},{type:"index",columnKey:"index",width:56,align:"center"},{prop:"username",label:"用户名",align:"center",minWidth:110},{columnKey:"cityAddress",label:"地址",align:"center",children:[{prop:"province",label:"省",align:"center",minWidth:100},{prop:"city",label:"市",align:"center",minWidth:100},{prop:"zone",label:"区",align:"center",minWidth:120},{prop:"street",label:"街道",align:"center",minWidth:120},{prop:"address",label:"详细地址",align:"center",minWidth:160}]},{prop:"amount",label:"金额",align:"center",minWidth:80}]),x=N([]),F=()=>{const a=[["用户名","省","市","区","街道","详细地址","金额"]];y.value.forEach(s=>{a.push([s.username,s.province,s.city,s.zone,s.street,s.address,s.amount])});const o="Sheet1",t={SheetNames:[o],Sheets:{}},n=z.aoa_to_sheet(a);t.Sheets[o]=n,n["!cols"]=[{wch:10},{wch:10},{wch:10},{wch:10},{wch:20},{wch:40},{wch:10}],D(t,"用户数据.xlsx")},W=()=>{const a=[["用户名","地址",null,null,null,null,"金额"],[null,"省","市","区","街道","详细地址",null]];y.value.forEach(s=>{a.push([s.username,s.province,s.city,s.zone,s.street,s.address,s.amount])});const o=z.aoa_to_sheet(a);o["!merges"]=[{s:{r:0,c:1},e:{r:0,c:5}},{s:{r:0,c:1},e:{r:0,c:5}},{s:{r:0,c:0},e:{r:1,c:0}},{s:{r:0,c:6},e:{r:1,c:6}}];const t="Sheet1",n={SheetNames:[t],Sheets:{}};n.Sheets[t]=o,D(n,"用户数据.xlsx")},U=()=>{if(x.value.length===0){E.error("请至少选择一条数据");return}const a=[["用户名","省","市","区","街道","详细地址","金额"]];x.value.forEach(n=>{a.push([n.username,n.province,n.city,n.zone,n.street,n.address,n.amount])});const o="Sheet1",t={SheetNames:[o],Sheets:{}};t.Sheets[o]=z.aoa_to_sheet(a),D(t,"用户数据.xlsx")};return(a,o)=>{const t=J,n=G,s=K;return w(),R(s,{header:"导出 Excel","body-style":{padding:"18px 20px"}},{default:l(()=>[p(n,{"row-key":"key",columns:v.value,datasource:y.value,"show-overflow-tooltip":!0,pagination:!1,selections:x.value,"onUpdate:selections":o[0]||(o[0]=h=>x.value=h),tools:["export","print","size","columns","maximized"],toolbar:{theme:"default"},border:!0},{toolbar:l(()=>[p(t,{type:"primary",class:"ele-btn-icon",onClick:F},{default:l(()=>o[1]||(o[1]=[B(" 导出 ")])),_:1}),p(t,{type:"primary",class:"ele-btn-icon",onClick:W},{default:l(()=>o[2]||(o[2]=[B(" 导出带表头合并 ")])),_:1}),p(t,{type:"primary",class:"ele-btn-icon",onClick:U},{default:l(()=>o[3]||(o[3]=[B(" 导出选中 ")])),_:1})]),_:1},8,["columns","datasource","selections"])]),_:1})}}},P={style:{overflow:"auto"}},Q={style:{"text-align":"center"}},q=["colspan","rowspan"],ee={key:0},te=["colspan"],oe={style:{"max-height":"300px",padding:"16px",overflow:"auto"}},se={style:{"max-height":"300px",padding:"16px",overflow:"auto"}},ne={__name:"excel-import",setup(V){const y=N(["A","B","C","D","E","F","G"]),v=N([]),x=N([]),F=o=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(o.type))return E.error("只能选择 excel 文件"),!1;if(o.size/1024/1024>20)return E.error("大小不能超过 20MB"),!1;const t=new FileReader;return t.onload=n=>{var u;const s=new Uint8Array((u=n.target)==null?void 0:u.result),h=O(s,{type:"array"}),k=h.SheetNames,f=h.Sheets[k[0]],_=z.sheet_to_json(f,{header:1}),m=[],c=[];let d=0;_.forEach(e=>{e.length>d&&(d=e.length);const i={};for(let r=0;r<e.length;r++){const S=a(r);i[S]=e[r],i["colspan"+S]=1,i["rowspan"+S]=1}m.push(i)});for(let e=0;e<d;e++)c.push(a(e));y.value=c,v.value=m,x.value=_},t.readAsArrayBuffer(o),!1},W=o=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(o.type))return E.error("只能选择 excel 文件"),!1;if(o.size/1024/1024>20)return E.error("大小不能超过 20MB"),!1;const t=new FileReader;return t.onload=n=>{var u;const s=new Uint8Array((u=n.target)==null?void 0:u.result),h=O(s,{type:"array"}),k=h.SheetNames,f=h.Sheets[k[0]],_=z.sheet_to_json(f,{header:1});f["!merges"]&&f["!merges"].forEach(e=>{for(let i=e.s.r;i<=e.e.r;i++)for(let r=e.s.c;r<=e.e.c;r++)_[i][r]=_[e.s.r][e.s.c]});const m=[],c=[];let d=0;_.forEach(e=>{e.length>d&&(d=e.length);const i={};for(let r=0;r<e.length;r++)i[a(r)]=e[r];m.push(i)});for(let e=0;e<d;e++)c.push(a(e));y.value=c,v.value=m,x.value=_},t.readAsArrayBuffer(o),!1},U=o=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(o.type))return E.error("只能选择 excel 文件"),!1;if(o.size/1024/1024>20)return E.error("大小不能超过 20MB"),!1;const t=new FileReader;return t.onload=n=>{var u;const s=new Uint8Array((u=n.target)==null?void 0:u.result),h=O(s,{type:"array"}),k=h.SheetNames,f=h.Sheets[k[0]],_=z.sheet_to_json(f,{header:1}),m=[],c=[];let d=0;_.forEach(e=>{e.length>d&&(d=e.length);const i={};for(let r=0;r<e.length;r++)i[a(r)]=e[r];m.push(i)});for(let e=0;e<d;e++)c.push(a(e));f["!merges"]&&f["!merges"].forEach(e=>{for(let r=e.s.r;r<=e.e.r;r++)for(let S=e.s.c;S<=e.e.c;S++){const $=a(S);m[r]["colspan"+$]=0,m[r]["rowspan"+$]=0}const i=a(e.s.c);m[e.s.r]["colspan"+i]=e.e.c-e.s.c+1,m[e.s.r]["rowspan"+i]=e.e.r-e.s.r+1}),y.value=c,v.value=m,x.value=_},t.readAsArrayBuffer(o),!1},a=o=>{const t=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(o<t.length)return t[o];const n=Number.parseInt(String(o/t.length)),s=o%t.length;return t[n]+t[s]};return(o,t)=>{const n=J,s=Z,h=T,k=L,f=X,_=Y,m=K;return w(),R(m,{header:"导入 Excel"},{default:l(()=>[p(h,null,{default:l(()=>[p(s,{action:"",accept:".xls,.xlsx","show-upload-list":!1,"before-upload":F},{default:l(()=>[p(n,{type:"primary",class:"ele-btn-icon"},{default:l(()=>t[0]||(t[0]=[B("导入")])),_:1})]),_:1}),p(s,{action:"",accept:".xls,.xlsx","show-upload-list":!1,"before-upload":W},{default:l(()=>[p(n,{type:"primary",class:"ele-btn-icon"},{default:l(()=>t[1]||(t[1]=[B(" 导入拆分合并 ")])),_:1})]),_:1}),p(s,{action:"",accept:".xls,.xlsx","show-upload-list":!1,"before-upload":U},{default:l(()=>[p(n,{type:"primary",class:"ele-btn-icon"},{default:l(()=>t[2]||(t[2]=[B(" 导入保持合并 ")])),_:1})]),_:1})]),_:1}),g("div",P,[p(k,{border:!0,style:{"min-width":"max-content"}},{default:l(()=>[g("thead",null,[g("tr",null,[t[3]||(t[3]=g("th",null,null,-1)),(w(!0),b(C,null,M(y.value,c=>(w(),b("th",{key:c,style:{"text-align":"center"}},A(c),1))),128))])]),g("tbody",null,[(w(!0),b(C,null,M(v.value,(c,d)=>(w(),b("tr",{key:d},[g("td",Q,A(d+1),1),(w(!0),b(C,null,M(y.value,u=>(w(),b(C,null,[c["colspan"+u]!==0&&c["rowspan"+u]!==0?(w(),b("td",{key:u,colspan:c["colspan"+u],rowspan:c["rowspan"+u],style:{"text-align":"center"}},A(c[u]),9,q)):j("",!0)],64))),256))]))),128)),v.value.length?j("",!0):(w(),b("tr",ee,[g("td",{colspan:y.value.length+1,style:{"text-align":"center"}}," 暂无数据 ",8,te)]))])]),_:1})]),p(_,{gutter:32},{default:l(()=>[p(f,{sm:12,xs:24},{default:l(()=>[t[4]||(t[4]=g("div",{style:{margin:"16px 0"}},"二维数组格式数据:",-1)),g("pre",oe,A(JSON.stringify(x.value,null,4)),1)]),_:1}),p(f,{sm:12,xs:24},{default:l(()=>[t[5]||(t[5]=g("div",{style:{margin:"16px 0"}},"JSON格式数据:",-1)),g("pre",se,A(JSON.stringify(v.value,null,4)),1)]),_:1})]),_:1})]),_:1})}}},re={name:"ExtensionExcel"},be=Object.assign(re,{setup(V){return(y,v)=>{const x=I;return w(),R(x,null,{default:l(()=>[p(H),p(ne)]),_:1})}}});export{be as default};
