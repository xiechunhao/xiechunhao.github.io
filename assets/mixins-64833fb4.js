import{y as O,d as E,D as b,E as q,z as N,f as l,V as L,X as C,N as z,H as P,A as Y,P as V,C as X,r as J,bl as Q,U as K,a1 as Z,W as ee,bm as H,bn as te,bo as ne,a6 as _,o as oe,b4 as p}from"../js/index.dc884249.js";import{a as ae,A as se,d as re,e as ie,f as ce}from"./activity-1845c990.js";import{f as le}from"./filter-09506a2e.js";import{m as ue,u as de,a as M}from"./function-call-1366be59.js";import{p as fe,a as me,P as ge,c as ve}from"./index-c95161c5.js";import{B as R}from"./index-c65add84.js";import{u as Be}from"./use-placeholder-815df439.js";import{u as he}from"./use-expose-9032f2c9.js";import{r as ye,u as we}from"./use-route-4e332491.js";import{d as pe,B as be}from"./index-49d41786.js";import{m as Ce}from"./min-6453c3f4.js";const[$,U]=O("action-bar"),j=Symbol($),Ae={placeholder:Boolean,safeAreaInsetBottom:N};var xe=E({name:$,props:Ae,setup(t,{slots:s}){const n=b(),r=Be(n,U),{linkChildren:i}=q(j);i();const f=()=>{var g;return l("div",{ref:n,class:[U(),{"van-safe-area-bottom":t.safeAreaInsetBottom}]},[(g=s.default)==null?void 0:g.call(s)])};return()=>t.placeholder?r(f):f()}});const Pe=L(xe),[Te,Se]=O("action-bar-button"),ke=C({},ye,{type:String,text:String,icon:String,color:String,loading:Boolean,disabled:Boolean});var De=E({name:Te,props:ke,setup(t,{slots:s}){const n=we(),{parent:r,index:i}=z(j),f=P(()=>{if(r){const u=r.children[i.value-1];return!(u&&"isButton"in u)}}),g=P(()=>{if(r){const u=r.children[i.value+1];return!(u&&"isButton"in u)}});return he({isButton:!0}),()=>{const{type:u,icon:v,text:B,color:h,loading:y,disabled:w}=t;return l(R,{class:Se([u,{last:g.value,first:f.value}]),size:"large",type:u,icon:v,color:h,loading:y,disabled:w,onClick:n},{default:()=>[s.default?s.default():B]})}}});const G=L(De),[_e,m,x]=O("dialog"),Ne=C({},fe,{title:String,theme:String,width:Y,message:[String,Function],callback:Function,allowHtml:Boolean,className:V,transition:X("van-dialog-bounce"),messageAlign:String,closeOnPopstate:N,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:N,closeOnClickOverlay:Boolean}),Re=[...me,"transition","closeOnPopstate"];var W=E({name:_e,props:Ne,emits:["confirm","cancel","keydown","update:show"],setup(t,{emit:s,slots:n}){const r=b(),i=J({confirm:!1,cancel:!1}),f=a=>s("update:show",a),g=a=>{var e;f(!1),(e=t.callback)==null||e.call(t,a)},u=a=>()=>{t.show&&(s(a),t.beforeClose?(i[a]=!0,ve(t.beforeClose,{args:[a],done(){g(a),i[a]=!1},canceled(){i[a]=!1}})):g(a))},v=u("cancel"),B=u("confirm"),h=Q(a=>{var e,o;if(a.target!==((o=(e=r.value)==null?void 0:e.popupRef)==null?void 0:o.value))return;({Enter:t.showConfirmButton?B:H,Escape:t.showCancelButton?v:H})[a.key](),s("keydown",a)},["enter","esc"]),y=()=>{const a=n.title?n.title():t.title;if(a)return l("div",{class:m("header",{isolated:!t.message&&!n.default})},[a])},w=a=>{const{message:e,allowHtml:o,messageAlign:c}=t,d=m("message",{"has-title":a,[c]:c}),D=te(e)?e():e;return o&&typeof D=="string"?l("div",{class:d,innerHTML:D},null):l("div",{class:d},[D])},T=()=>{if(n.default)return l("div",{class:m("content")},[n.default()]);const{title:a,message:e,allowHtml:o}=t;if(e){const c=!!(a||n.title);return l("div",{key:o?1:0,class:m("content",{isolated:!c})},[w(c)])}},S=()=>l("div",{class:[be,m("footer")]},[t.showCancelButton&&l(R,{size:"large",text:t.cancelButtonText||x("cancel"),class:m("cancel"),style:{color:t.cancelButtonColor},loading:i.cancel,disabled:t.cancelButtonDisabled,onClick:v},null),t.showConfirmButton&&l(R,{size:"large",text:t.confirmButtonText||x("confirm"),class:[m("confirm"),{[pe]:t.showCancelButton}],style:{color:t.confirmButtonColor},loading:i.confirm,disabled:t.confirmButtonDisabled,onClick:B},null)]),A=()=>l(Pe,{class:m("footer")},{default:()=>[t.showCancelButton&&l(G,{type:"warning",text:t.cancelButtonText||x("cancel"),class:m("cancel"),color:t.cancelButtonColor,loading:i.cancel,disabled:t.cancelButtonDisabled,onClick:v},null),t.showConfirmButton&&l(G,{type:"danger",text:t.confirmButtonText||x("confirm"),class:m("confirm"),color:t.confirmButtonColor,loading:i.confirm,disabled:t.confirmButtonDisabled,onClick:B},null)]}),k=()=>n.footer?n.footer():t.theme==="round-button"?A():S();return()=>{const{width:a,title:e,theme:o,message:c,className:d}=t;return l(ge,K({ref:r,role:"dialog",class:[m([o]),d],style:{width:ee(a)},tabindex:0,"aria-labelledby":e||c,onKeydown:h,"onUpdate:show":f},Z(t,Re)),{default:()=>[y(),T(),k()]})}}});let I;const Ie={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let Oe=C({},Ie);function Ee(){({instance:I}=ue({setup(){const{state:s,toggle:n}=de();return()=>l(W,K(s,{"onUpdate:show":n}),null)}}))}function Le(t){return ne?new Promise((s,n)=>{I||Ee(),I.open(C({},Oe,t,{callback:r=>{(r==="confirm"?s:n)(r)}}))}):Promise.resolve(void 0)}const He=t=>Le(C({showCancelButton:!0},t));L(W);function F(t,s){const{loading:n=!1}=s||{loading:!1},r=b(n);return[r,async(...f)=>{r.value=!0;try{return await t(...f)}finally{r.value=!1}}]}function Ye(){let t=_("activityConfigId")||0;const s=b([]),n=J({data:{activityEndTime:0,activityReceive:0,activityStartTime:0,progressConfiguration:0,rewardDistribution:0,ruleJson:"",type:0,validDate:0,ifReceive:0,totalAmount:0},ruleList:{bangingBank:0,bangingEmail:0,bangingPhone:0,calculationWithdrawal:0,positions:[],withdrawalConditions:"",calculationType:0},userActive:[],ruleDes:{CN:"",EN:"",YN:""},activeInfo:{}});oe(()=>{g(),u(),f()});const r=P(()=>n.ruleList.positions.map(e=>(e.array=i(e),e)).sort(e=>e.array.status===2?-1:1)),i=e=>{let o={deliveryWinningsAmount:"",expirationTime:0,position:0,rechargeAmount:"",recordId:0,status:0};try{const[c]=s.value.filter(d=>d.position===e.position);return c||o}catch(c){return o}},f=async()=>{const e=await ae();try{const[o]=le(e,c=>c.activityConfigId==t);n.activeInfo=o||{}}catch(o){}},g=async()=>{try{const e=await se(t);try{n.data=e,n.ruleList=JSON.parse(e.ruleJson),e.ruleDescription&&(n.ruleDes=JSON.parse(e.ruleDescription))}catch(o){}}catch(e){}},u=async()=>{try{const e=await re(t);n.userActive=e,s.value=e}catch(e){}},v=e=>{let o=!1;switch(Number(e)){case 2057:case 2058:case 2059:o=!0;break}return o},B=e=>{let o="";switch(Number(e)){case 2057:case 2058:case 2059:o=p.global.t("qu_bang_ding");break}return o},h=b(-1),[y,w]=F(async(e,o)=>{h.value=o;let c=_("device");if(e.status===0){if(n.data.activityReceive===1&&n.data.ifReceive===0)return M(p.global.t("ti_shi_cy"));c==="android"?window.jsandroid.jumpCharge():c==="ios"?window.webkit.messageHandlers.jumpCharge.postMessage(""):(window.parent.postMessage({type:"leadRecharge2"},"*"),window.parent.postMessage({type:"leadRecharge"},"*"))}else if(e.status===2)try{await ie(e.recordId),n.userActive=n.userActive.map(d=>(d.position===e.position&&(d.status=1),d))}catch(d){A(d)}}),[T,S]=F(async()=>{try{await ce(t),n.data.ifReceive=1,M(p.global.t("can_yu_cg"))}catch(e){A(e)}}),A=e=>{He({message:e.msg,confirmButtonText:B(e.code),cancelButtonText:p.global.t("quxiao"),showConfirmButton:v(e.code)}).then(()=>{let o=_("device");o==="android"?window.jsandroid.codeJump(e.code):o==="ios"?window.webkit.messageHandlers.codeJump.postMessage(e.code):window.parent.postMessage({type:"codeJump",data:e.code},"*")}).catch(()=>{})},k=(e,o)=>Ce([100,Math.floor((e||0)*100/(o||0))]),a=P(()=>{try{return n.ruleDes[p.global.locale.value]}catch(e){return n.ruleDes.YN}});return{getIndex:h,set:n,getStatusBtn:i,getLoading:y,handleGetGold:w,receiveLoading:T,activityReceive:S,positionList:r,getProgress:k,ruleText:a}}export{He as a,Ye as s,F as u};
