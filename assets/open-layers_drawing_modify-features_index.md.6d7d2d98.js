import{A as os,M as ps}from"./chunks/index.47495de9.js";import{R as rs,V as Q,b as U,c as f,d as ss,S as cs,F as j,a as is,C as ys}from"./chunks/Vector.f72cf874.js";import{a as Fs,p as Ds,b as Cs,s as ns,c as As,C as I,d as _,E as X,e as u,f as L,g as G,h as M,i as Y,j as h,k as d,l as g,t as V,m as ds,n as hs,o as us,q,r as gs,u as fs,v as es,w as _s,I as ms,x as H,y as Es,T as $,z as Ss,A as W,P as xs,M as vs,V as ws}from"./chunks/reproj.50e0d4ab.js";import{L as Ms}from"./chunks/LineString.e8af5305.js";import{V as R}from"./chunks/Vector.0afd591d.js";import{T as Ts}from"./chunks/TileImage.36abd4f0.js";import{X as Ps}from"./chunks/XYZ.eaf43adc.js";import{d as Ls,p as bs,a3 as Bs,o as as,c as ts,_ as Is,G as Gs,z as x,a as Vs,O as qs}from"./chunks/framework.166469be.js";const Z=0,v=1,z=[0,0,0,0],m=[],b={MODIFYSTART:"modifystart",MODIFYEND:"modifyend"};class B extends es{constructor(s,n,a){super(s),this.features=n,this.mapBrowserEvent=a}}class Rs extends Fs{constructor(s){super(s),this.on,this.once,this.un,this.boundHandleFeatureChange_=this.handleFeatureChange_.bind(this),this.condition_=s.condition?s.condition:Ds,this.defaultDeleteCondition_=function(a){return Cs(a)&&ns(a)},this.deleteCondition_=s.deleteCondition?s.deleteCondition:this.defaultDeleteCondition_,this.insertVertexCondition_=s.insertVertexCondition?s.insertVertexCondition:As,this.vertexFeature_=null,this.vertexSegments_=null,this.lastPixel_=[0,0],this.ignoreNextSingleClick_=!1,this.featuresBeingModified_=null,this.rBush_=new rs,this.pixelTolerance_=s.pixelTolerance!==void 0?s.pixelTolerance:10,this.snappedToVertex_=!1,this.changingFeature_=!1,this.dragSegments_=[],this.overlay_=new R({source:new Q({useSpatialIndex:!1,wrapX:!!s.wrapX}),style:s.style?s.style:Ns(),updateWhileAnimating:!0,updateWhileInteracting:!0}),this.SEGMENT_WRITERS_={Point:this.writePointGeometry_.bind(this),LineString:this.writeLineStringGeometry_.bind(this),LinearRing:this.writeLineStringGeometry_.bind(this),Polygon:this.writePolygonGeometry_.bind(this),MultiPoint:this.writeMultiPointGeometry_.bind(this),MultiLineString:this.writeMultiLineStringGeometry_.bind(this),MultiPolygon:this.writeMultiPolygonGeometry_.bind(this),Circle:this.writeCircleGeometry_.bind(this),GeometryCollection:this.writeGeometryCollectionGeometry_.bind(this)},this.source_=null,this.hitDetection_=null;let n;if(s.features?n=s.features:s.source&&(this.source_=s.source,n=new I(this.source_.getFeatures()),this.source_.addEventListener(U.ADDFEATURE,this.handleSourceAdd_.bind(this)),this.source_.addEventListener(U.REMOVEFEATURE,this.handleSourceRemove_.bind(this))),!n)throw new Error("The modify interaction requires features, a source or a layer");s.hitDetection&&(this.hitDetection_=s.hitDetection),this.features_=n,this.features_.forEach(this.addFeature_.bind(this)),this.features_.addEventListener(_.ADD,this.handleFeatureAdd_.bind(this)),this.features_.addEventListener(_.REMOVE,this.handleFeatureRemove_.bind(this)),this.lastPointerEvent_=null,this.delta_=[0,0],this.snapToPointer_=s.snapToPointer===void 0?!this.hitDetection_:s.snapToPointer}addFeature_(s){const n=s.getGeometry();if(n){const e=this.SEGMENT_WRITERS_[n.getType()];e&&e(s,n)}const a=this.getMap();a&&a.isRendered()&&this.getActive()&&this.handlePointerAtPixel_(this.lastPixel_,a),s.addEventListener(X.CHANGE,this.boundHandleFeatureChange_)}willModifyFeatures_(s,n){if(!this.featuresBeingModified_){this.featuresBeingModified_=new I;const a=this.featuresBeingModified_.getArray();for(let e=0,t=n.length;e<t;++e){const p=n[e];for(let c=0,o=p.length;c<o;++c){const r=p[c].feature;r&&!a.includes(r)&&this.featuresBeingModified_.push(r)}}this.featuresBeingModified_.getLength()===0?this.featuresBeingModified_=null:this.dispatchEvent(new B(b.MODIFYSTART,this.featuresBeingModified_,s))}}removeFeature_(s){this.removeFeatureSegmentData_(s),this.vertexFeature_&&this.features_.getLength()===0&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),s.removeEventListener(X.CHANGE,this.boundHandleFeatureChange_)}removeFeatureSegmentData_(s){const n=this.rBush_,a=[];n.forEach(function(e){s===e.feature&&a.push(e)});for(let e=a.length-1;e>=0;--e){const t=a[e];for(let p=this.dragSegments_.length-1;p>=0;--p)this.dragSegments_[p][0]===t&&this.dragSegments_.splice(p,1);n.remove(t)}}setActive(s){this.vertexFeature_&&!s&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),super.setActive(s)}setMap(s){this.overlay_.setMap(s),super.setMap(s)}getOverlay(){return this.overlay_}handleSourceAdd_(s){s.feature&&this.features_.push(s.feature)}handleSourceRemove_(s){s.feature&&this.features_.remove(s.feature)}handleFeatureAdd_(s){this.addFeature_(s.element)}handleFeatureChange_(s){if(!this.changingFeature_){const n=s.target;this.removeFeature_(n),this.addFeature_(n)}}handleFeatureRemove_(s){this.removeFeature_(s.element)}writePointGeometry_(s,n){const a=n.getCoordinates(),e={feature:s,geometry:n,segment:[a,a]};this.rBush_.insert(n.getExtent(),e)}writeMultiPointGeometry_(s,n){const a=n.getCoordinates();for(let e=0,t=a.length;e<t;++e){const p=a[e],c={feature:s,geometry:n,depth:[e],index:e,segment:[p,p]};this.rBush_.insert(n.getExtent(),c)}}writeLineStringGeometry_(s,n){const a=n.getCoordinates();for(let e=0,t=a.length-1;e<t;++e){const p=a.slice(e,e+2),c={feature:s,geometry:n,index:e,segment:p};this.rBush_.insert(u(p),c)}}writeMultiLineStringGeometry_(s,n){const a=n.getCoordinates();for(let e=0,t=a.length;e<t;++e){const p=a[e];for(let c=0,o=p.length-1;c<o;++c){const r=p.slice(c,c+2),l={feature:s,geometry:n,depth:[e],index:c,segment:r};this.rBush_.insert(u(r),l)}}}writePolygonGeometry_(s,n){const a=n.getCoordinates();for(let e=0,t=a.length;e<t;++e){const p=a[e];for(let c=0,o=p.length-1;c<o;++c){const r=p.slice(c,c+2),l={feature:s,geometry:n,depth:[e],index:c,segment:r};this.rBush_.insert(u(r),l)}}}writeMultiPolygonGeometry_(s,n){const a=n.getCoordinates();for(let e=0,t=a.length;e<t;++e){const p=a[e];for(let c=0,o=p.length;c<o;++c){const r=p[c];for(let l=0,i=r.length-1;l<i;++l){const F=r.slice(l,l+2),y={feature:s,geometry:n,depth:[c,e],index:l,segment:F};this.rBush_.insert(u(F),y)}}}}writeCircleGeometry_(s,n){const a=n.getCenter(),e={feature:s,geometry:n,index:Z,segment:[a,a]},t={feature:s,geometry:n,index:v,segment:[a,a]},p=[e,t];e.featureSegments=p,t.featureSegments=p,this.rBush_.insert(L(a),e);let c=n;this.rBush_.insert(c.getExtent(),t)}writeGeometryCollectionGeometry_(s,n){const a=n.getGeometriesArray();for(let e=0;e<a.length;++e){const t=a[e],p=this.SEGMENT_WRITERS_[t.getType()];p(s,t)}}createOrUpdateVertexFeature_(s,n,a){let e=this.vertexFeature_;return e?e.getGeometry().setCoordinates(s):(e=new f(new G(s)),this.vertexFeature_=e,this.overlay_.getSource().addFeature(e)),e.set("features",n),e.set("geometries",a),e}handleEvent(s){if(!s.originalEvent)return!0;this.lastPointerEvent_=s;let n;return!s.map.getView().getInteracting()&&s.type==M.POINTERMOVE&&!this.handlingDownUpSequence&&this.handlePointerMove_(s),this.vertexFeature_&&this.deleteCondition_(s)&&(s.type!=M.SINGLECLICK||!this.ignoreNextSingleClick_?n=this.removePoint():n=!0),s.type==M.SINGLECLICK&&(this.ignoreNextSingleClick_=!1),super.handleEvent(s)&&!n}handleDragEvent(s){this.ignoreNextSingleClick_=!1,this.willModifyFeatures_(s,this.dragSegments_);const n=[s.coordinate[0]+this.delta_[0],s.coordinate[1]+this.delta_[1]],a=[],e=[];for(let t=0,p=this.dragSegments_.length;t<p;++t){const c=this.dragSegments_[t],o=c[0],r=o.feature;a.includes(r)||a.push(r);const l=o.geometry;e.includes(l)||e.push(l);const i=o.depth;let F;const y=o.segment,D=c[1];for(;n.length<l.getStride();)n.push(y[D][n.length]);switch(l.getType()){case"Point":F=n,y[0]=n,y[1]=n;break;case"MultiPoint":F=l.getCoordinates(),F[o.index]=n,y[0]=n,y[1]=n;break;case"LineString":F=l.getCoordinates(),F[o.index+D]=n,y[D]=n;break;case"MultiLineString":F=l.getCoordinates(),F[i[0]][o.index+D]=n,y[D]=n;break;case"Polygon":F=l.getCoordinates(),F[i[0]][o.index+D]=n,y[D]=n;break;case"MultiPolygon":F=l.getCoordinates(),F[i[1]][i[0]][o.index+D]=n,y[D]=n;break;case"Circle":if(y[0]=n,y[1]=n,o.index===Z)this.changingFeature_=!0,l.setCenter(n),this.changingFeature_=!1;else{this.changingFeature_=!0,s.map.getView().getProjection();let A=Y(h(l.getCenter()),h(n));l.setRadius(A),this.changingFeature_=!1}break}F&&this.setGeometryCoordinates_(l,F)}this.createOrUpdateVertexFeature_(n,a,e)}handleDownEvent(s){if(!this.condition_(s))return!1;const n=s.coordinate;this.handlePointerAtPixel_(s.pixel,s.map,n),this.dragSegments_.length=0,this.featuresBeingModified_=null;const a=this.vertexFeature_;if(a){s.map.getView().getProjection();const e=[],t=a.getGeometry().getCoordinates(),p=u([t]),c=this.rBush_.getInExtent(p),o={};c.sort(ks);for(let r=0,l=c.length;r<l;++r){const i=c[r],F=i.segment;let y=d(i.geometry);const D=i.depth;if(D&&(y+="-"+D.join("-")),o[y]||(o[y]=new Array(2)),i.geometry.getType()==="Circle"&&i.index===v){const A=J(n,i);g(A,t)&&!o[y][0]&&(this.dragSegments_.push([i,0]),o[y][0]=i);continue}if(g(F[0],t)&&!o[y][0]){this.dragSegments_.push([i,0]),o[y][0]=i;continue}if(g(F[1],t)&&!o[y][1]){if(o[y][0]&&o[y][0].index===0){let A=i.geometry.getCoordinates();switch(i.geometry.getType()){case"LineString":case"MultiLineString":continue;case"MultiPolygon":A=A[D[1]];case"Polygon":if(i.index!==A[D[0]].length-2)continue;break}}this.dragSegments_.push([i,1]),o[y][1]=i;continue}d(F)in this.vertexSegments_&&!o[y][0]&&!o[y][1]&&this.insertVertexCondition_(s)&&e.push(i)}e.length&&this.willModifyFeatures_(s,[e]);for(let r=e.length-1;r>=0;--r)this.insertVertex_(e[r],t)}return!!this.vertexFeature_}handleUpEvent(s){for(let n=this.dragSegments_.length-1;n>=0;--n){const a=this.dragSegments_[n][0],e=a.geometry;if(e.getType()==="Circle"){const t=e.getCenter(),p=a.featureSegments[0],c=a.featureSegments[1];p.segment[0]=t,p.segment[1]=t,c.segment[0]=t,c.segment[1]=t,this.rBush_.update(L(t),p);let o=e;this.rBush_.update(o.getExtent(),c)}else this.rBush_.update(u(a.segment),a)}return this.featuresBeingModified_&&(this.dispatchEvent(new B(b.MODIFYEND,this.featuresBeingModified_,s)),this.featuresBeingModified_=null),!1}handlePointerMove_(s){this.lastPixel_=s.pixel,this.handlePointerAtPixel_(s.pixel,s.map,s.coordinate)}handlePointerAtPixel_(s,n,a){const e=a||n.getCoordinateFromPixel(s);n.getView().getProjection();const t=function(o,r){return K(e,o)-K(e,r)};let p,c;if(this.hitDetection_){const o=typeof this.hitDetection_=="object"?r=>r===this.hitDetection_:void 0;n.forEachFeatureAtPixel(s,(r,l,i)=>{i&&(i=new G(V(i.getCoordinates())));const F=i||r.getGeometry();if(F.getType()==="Point"&&r instanceof f&&this.features_.getArray().includes(r)){c=F;const y=r.getGeometry().getFlatCoordinates().slice(0,2);p=[{feature:r,geometry:c,segment:[y,y]}]}return!0},{layerFilter:o})}if(!p){const o=ds(L(e,z)),r=n.getView().getResolution()*this.pixelTolerance_,l=hs(us(o,r,z));p=this.rBush_.getInExtent(l)}if(p&&p.length>0){const o=p.sort(t)[0],r=o.segment;let l=J(e,o);const i=n.getPixelFromCoordinate(l);let F=Y(s,i);if(c||F<=this.pixelTolerance_){const y={};if(y[d(r)]=!0,this.snapToPointer_||(this.delta_[0]=l[0]-e[0],this.delta_[1]=l[1]-e[1]),o.geometry.getType()==="Circle"&&o.index===v)this.snappedToVertex_=!0,this.createOrUpdateVertexFeature_(l,[o.feature],[o.geometry]);else{const D=n.getPixelFromCoordinate(r[0]),A=n.getPixelFromCoordinate(r[1]),E=q(i,D),N=q(i,A);F=Math.sqrt(Math.min(E,N)),this.snappedToVertex_=F<=this.pixelTolerance_,this.snappedToVertex_&&(l=E>N?r[1]:r[0]),this.createOrUpdateVertexFeature_(l,[o.feature],[o.geometry]);const P={};P[d(o.geometry)]=!0;for(let w=1,ls=p.length;w<ls;++w){const S=p[w].segment;if(g(r[0],S[0])&&g(r[1],S[1])||g(r[0],S[1])&&g(r[1],S[0])){const O=d(p[w].geometry);O in P||(P[O]=!0,y[d(S)]=!0)}else break}}this.vertexSegments_=y;return}}this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null)}insertVertex_(s,n){const a=s.segment,e=s.feature,t=s.geometry,p=s.depth,c=s.index;let o;for(;n.length<t.getStride();)n.push(0);switch(t.getType()){case"MultiLineString":o=t.getCoordinates(),o[p[0]].splice(c+1,0,n);break;case"Polygon":o=t.getCoordinates(),o[p[0]].splice(c+1,0,n);break;case"MultiPolygon":o=t.getCoordinates(),o[p[1]][p[0]].splice(c+1,0,n);break;case"LineString":o=t.getCoordinates(),o.splice(c+1,0,n);break;default:return}this.setGeometryCoordinates_(t,o);const r=this.rBush_;r.remove(s),this.updateSegmentIndices_(t,c,p,1);const l={segment:[a[0],n],feature:e,geometry:t,depth:p,index:c};r.insert(u(l.segment),l),this.dragSegments_.push([l,1]);const i={segment:[n,a[1]],feature:e,geometry:t,depth:p,index:c+1};r.insert(u(i.segment),i),this.dragSegments_.push([i,0]),this.ignoreNextSingleClick_=!0}removePoint(){if(this.lastPointerEvent_&&this.lastPointerEvent_.type!=M.POINTERDRAG){const s=this.lastPointerEvent_;this.willModifyFeatures_(s,this.dragSegments_);const n=this.removeVertex_();return this.featuresBeingModified_&&this.dispatchEvent(new B(b.MODIFYEND,this.featuresBeingModified_,s)),this.featuresBeingModified_=null,n}return!1}removeVertex_(){const s=this.dragSegments_,n={};let a=!1,e,t,p,c,o,r,l,i,F,y,D;for(o=s.length-1;o>=0;--o)p=s[o],y=p[0],D=d(y.feature),y.depth&&(D+="-"+y.depth.join("-")),D in n||(n[D]={}),p[1]===0?(n[D].right=y,n[D].index=y.index):p[1]==1&&(n[D].left=y,n[D].index=y.index+1);for(D in n){switch(F=n[D].right,l=n[D].left,r=n[D].index,i=r-1,l!==void 0?y=l:y=F,i<0&&(i=0),c=y.geometry,t=c.getCoordinates(),e=t,a=!1,c.getType()){case"MultiLineString":t[y.depth[0]].length>2&&(t[y.depth[0]].splice(r,1),a=!0);break;case"LineString":t.length>2&&(t.splice(r,1),a=!0);break;case"MultiPolygon":e=e[y.depth[1]];case"Polygon":e=e[y.depth[0]],e.length>4&&(r==e.length-1&&(r=0),e.splice(r,1),a=!0,r===0&&(e.pop(),e.push(e[0]),i=e.length-1));break}if(a){this.setGeometryCoordinates_(c,t);const A=[];if(l!==void 0&&(this.rBush_.remove(l),A.push(l.segment[0])),F!==void 0&&(this.rBush_.remove(F),A.push(F.segment[1])),l!==void 0&&F!==void 0){const E={depth:y.depth,feature:y.feature,geometry:y.geometry,index:i,segment:A};this.rBush_.insert(u(E.segment),E)}this.updateSegmentIndices_(c,r,y.depth,-1),this.vertexFeature_&&(this.overlay_.getSource().removeFeature(this.vertexFeature_),this.vertexFeature_=null),s.length=0}}return a}setGeometryCoordinates_(s,n){this.changingFeature_=!0,s.setCoordinates(n),this.changingFeature_=!1}updateSegmentIndices_(s,n,a,e){this.rBush_.forEachInExtent(s.getExtent(),function(t){t.geometry===s&&(a===void 0||t.depth===void 0||gs(t.depth,a))&&t.index>n&&(t.index+=e)})}}function ks(C,s){return C.index-s.index}function K(C,s,n){const a=s.geometry;if(a.getType()==="Circle"){let t=a;if(s.index===v){const p=q(t.getCenter(),h(C)),c=Math.sqrt(p)-t.getRadius();return c*c}}const e=h(C);return m[0]=h(s.segment[0]),m[1]=h(s.segment[1]),_s(e,m)}function J(C,s,n){const a=s.geometry;if(a.getType()==="Circle"&&s.index===v)return V(a.getClosestPoint(h(C)));const e=h(C);return m[0]=h(s.segment[0]),m[1]=h(s.segment[1]),V(fs(e,m))}function Ns(){const C=ss();return function(s,n){return C.Point}}const Os=Rs,Us={SELECT:"select"};class js extends es{constructor(s,n,a,e){super(s),this.selected=n,this.deselected=a,this.mapBrowserEvent=e}}const T={};class k extends ms{constructor(s){super(),this.on,this.once,this.un,s=s||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=s.condition?s.condition:ns,this.addCondition_=s.addCondition?s.addCondition:H,this.removeCondition_=s.removeCondition?s.removeCondition:H,this.toggleCondition_=s.toggleCondition?s.toggleCondition:Es,this.multi_=s.multi?s.multi:!1,this.filter_=s.filter?s.filter:$,this.hitTolerance_=s.hitTolerance?s.hitTolerance:0,this.style_=s.style!==void 0?s.style:Xs(),this.features_=s.features||new I;let n;if(s.layers)if(typeof s.layers=="function")n=s.layers;else{const a=s.layers;n=function(e){return a.includes(e)}}else n=$;this.layerFilter_=n,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(s,n){this.featureLayerAssociation_[d(s)]=n}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(s){return this.featureLayerAssociation_[d(s)]}setHitTolerance(s){this.hitTolerance_=s}setMap(s){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(s),s?(this.features_.addEventListener(_.ADD,this.boundAddFeature_),this.features_.addEventListener(_.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(_.ADD,this.boundAddFeature_),this.features_.removeEventListener(_.REMOVE,this.boundRemoveFeature_))}addFeature_(s){const n=s.element;if(this.style_&&this.applySelectedStyle_(n),!this.getLayer(n)){const a=this.getMap().getAllLayers().find(function(e){if(e instanceof R&&e.getSource()&&e.getSource().hasFeature(n))return e});a&&this.addFeatureLayerAssociation_(n,a)}}removeFeature_(s){this.style_&&this.restorePreviousStyle_(s.element)}getStyle(){return this.style_}applySelectedStyle_(s){const n=d(s);n in T||(T[n]=s.getStyle()),s.setStyle(this.style_)}restorePreviousStyle_(s){const n=this.getMap().getInteractions().getArray();for(let e=n.length-1;e>=0;--e){const t=n[e];if(t!==this&&t instanceof k&&t.getStyle()&&t.getFeatures().getArray().lastIndexOf(s)!==-1){s.setStyle(t.getStyle());return}}const a=d(s);s.setStyle(T[a]),delete T[a]}removeFeatureLayerAssociation_(s){delete this.featureLayerAssociation_[d(s)]}handleEvent(s){if(!this.condition_(s))return!0;const n=this.addCondition_(s),a=this.removeCondition_(s),e=this.toggleCondition_(s),t=!n&&!a&&!e,p=s.map,c=this.getFeatures(),o=[],r=[];if(t){Ss(this.featureLayerAssociation_),p.forEachFeatureAtPixel(s.pixel,(l,i)=>{if(!(!(l instanceof f)||!this.filter_(l,i)))return this.addFeatureLayerAssociation_(l,i),r.push(l),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let l=c.getLength()-1;l>=0;--l){const i=c.item(l),F=r.indexOf(i);F>-1?r.splice(F,1):(c.remove(i),o.push(i))}r.length!==0&&c.extend(r)}else{p.forEachFeatureAtPixel(s.pixel,(l,i)=>{if(!(!(l instanceof f)||!this.filter_(l,i)))return(n||e)&&!c.getArray().includes(l)?(this.addFeatureLayerAssociation_(l,i),r.push(l)):(a||e)&&c.getArray().includes(l)&&(o.push(l),this.removeFeatureLayerAssociation_(l)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let l=o.length-1;l>=0;--l)c.remove(o[l]);c.extend(r)}return(r.length>0||o.length>0)&&this.dispatchEvent(new js(Us.SELECT,r,o,s)),!0}}function Xs(){const C=ss();return W(C.Polygon,C.LineString),W(C.GeometryCollection,C.LineString),function(s){return s.getGeometry()?C[s.getGeometry().getType()]:null}}const Ys=k,Hs={id:"map"},$s=Ls({__name:"index",setup(C){const s=new f(new G([114.1947,30.5255])),n=new f(new Ms([[114.2218,30.5695],[114.2829,30.4912]])),a=new f(new xs([[[114.2757,30.5822],[114.3526,30.5879],[114.3608,30.5367],[114.3234,30.5187],[114.2826,30.553]]])),e=new Q({features:[s,n,a]}),t=new R({source:e,style:new cs({fill:new j({color:"rgba(255, 255, 255, 0.2)"}),stroke:new is({color:"#ff0000",width:2}),image:new ys({radius:7,fill:new j({color:"#ff0000"})})})});let p=null;const c=new Ts({source:new Ps({attributions:os,url:ps,maxZoom:20})}),o=()=>{p=new vs({target:"map",layers:[c],view:new ws({projection:"EPSG:4326",center:[114.2905,30.5607],zoom:12})})};class r{constructor(){this.select=null,this.modify=null}init(i){this.select=new Ys,i.addInteraction(this.select),this.modify=new Os({features:this.select.getFeatures()}),i.addInteraction(this.modify),this.setEvents()}setEvents(){if(this.select){const i=this.select.getFeatures();this.select.on("change:active",()=>{i.forEach(i.remove)})}}setActive(i){var F,y;(F=this.select)==null||F.setActive(i),(y=this.modify)==null||y.setActive(i)}}return bs(()=>{if(o(),p){p.addLayer(t);const l=new r;l.init(p),l.setActive(!0)}}),Bs(()=>{p&&(p.dispose(),p=null)}),(l,i)=>(as(),ts("div",Hs))}});const Ws=Is($s,[["__scopeId","data-v-304c4681"]]),Zs=x("h1",{id:"图形交互编辑",tabindex:"-1"},[Vs("图形交互编辑 "),x("a",{class:"header-anchor",href:"#图形交互编辑","aria-label":'Permalink to "图形交互编辑"'},"​")],-1),zs=x("div",{class:"tip custom-block"},[x("p",{class:"custom-block-title"},"TIP"),x("p",null,"修改几何图形：请用鼠标选择修改要素，选中后再修改其几何信息。")],-1),Ks=qs(`<h2 id="代码如下" tabindex="-1">代码如下: <a class="header-anchor" href="#代码如下" aria-label="Permalink to &quot;代码如下:&quot;">​</a></h2><details class="details custom-block"><summary>点我查看代码</summary><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">map</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">div</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">lang</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">setup</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">onMounted</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">onBeforeUnmount</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">vue</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Map</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">View</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Feature</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ol</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Tile</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">TileLayer</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Vector</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">VectorLayer</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ol/layer</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">XYZ</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Vector</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">VectorSource</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ol/source</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Style</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Fill</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Stroke</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Circle</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ol/style</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Select</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Modify</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;font-style:italic;">as</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ModifyInteraction</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ol/interaction</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Polygon</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Point</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">LineString</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ol/geom</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">MAPURL</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">ATTRIBUTIONS</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">from</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">../../../constants</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//绘制的几何图形要素</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> pointFeature </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Feature</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Point</span><span style="color:#A6ACCD;">([</span><span style="color:#F78C6C;">114.1947</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30.5255</span><span style="color:#A6ACCD;">]))</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> lineFeature </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Feature</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">LineString</span><span style="color:#A6ACCD;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#F78C6C;">114.2218</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30.5695</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span><span style="color:#F78C6C;">114.2829</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30.4912</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ])</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> polygonFeature </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Feature</span><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Polygon</span><span style="color:#A6ACCD;">([</span></span>
<span class="line"><span style="color:#A6ACCD;">    [</span></span>
<span class="line"><span style="color:#A6ACCD;">      [</span><span style="color:#F78C6C;">114.2757</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30.5822</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      [</span><span style="color:#F78C6C;">114.3526</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30.5879</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      [</span><span style="color:#F78C6C;">114.3608</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30.5367</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      [</span><span style="color:#F78C6C;">114.3234</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30.5187</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      [</span><span style="color:#F78C6C;">114.2826</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30.553</span><span style="color:#A6ACCD;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  ])</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//实例化一个矢量图层Vector作为绘制层</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> source </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">VectorSource</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">features</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> [pointFeature</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> lineFeature</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> polygonFeature]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> vector </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">VectorLayer</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">source</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> source</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Style</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">fill</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Fill</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">rgba(255, 255, 255, 0.2)</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">stroke</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Stroke</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">#ff0000</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">width</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">image</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Circle</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">radius</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">7</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F07178;">fill</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Fill</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#F07178;">color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">#ff0000</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#C792EA;">let</span><span style="color:#A6ACCD;"> map</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Map</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> raster </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">TileLayer</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">source</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">XYZ</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">attributions</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> ATTRIBUTIONS</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">url</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> MAPURL</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F07178;">maxZoom</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">20</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> initMap </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#A6ACCD;">map</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Map</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//初始化map</span></span>
<span class="line"><span style="color:#F07178;">    target</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">map</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//地图容器中加载的图层</span></span>
<span class="line"><span style="color:#F07178;">    layers</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">//加载瓦片图层数据</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#A6ACCD;">raster</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    ]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    view</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">View</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">      projection</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">EPSG:4326</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// 坐标系，有EPSG:4326和EPSG:3 857</span></span>
<span class="line"><span style="color:#F07178;">      center</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> [</span><span style="color:#F78C6C;">114.2905</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">30.5607</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">//地图初始显示级别</span></span>
<span class="line"><span style="color:#F07178;">      zoom</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#F78C6C;">12</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">//定义修改几何图形功能控件</span></span>
<span class="line"><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Modify</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">select</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Select</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">modify</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">ModifyInteraction</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">|</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">null</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">constructor</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">select</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">modify</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">init</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">map</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Map</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//初始化一个交互选择控件,并添加到地图容器中</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">select</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Select</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">map</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addInteraction</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">select</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//初始化一个交互编辑控件，并添加到地图容器中</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">modify</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">ModifyInteraction</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">//选中的要素</span></span>
<span class="line"><span style="color:#F07178;">      features</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">select</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFeatures</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">map</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addInteraction</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">modify</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//设置几何图形变更的处理</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#82AAFF;">setEvents</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">setEvents</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">select</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">//选中的要素</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">selectedFeatures</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">select</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getFeatures</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#676E95;font-style:italic;">//添加选中要素变更事件</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">select</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">on</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">change:active</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">()</span><span style="color:#F07178;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">selectedFeatures</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forEach</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">selectedFeatures</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">remove</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">      </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F07178;">setActive</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">active</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">boolean</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//激活选择要素控件</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">select</span><span style="color:#89DDFF;">?.</span><span style="color:#82AAFF;">setActive</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">active</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//激活修改要素控件</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">this.</span><span style="color:#A6ACCD;">modify</span><span style="color:#89DDFF;">?.</span><span style="color:#82AAFF;">setActive</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">active</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">onMounted</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#82AAFF;">initMap</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">map</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//将绘制层添加到地图容器中</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">map</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addLayer</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">vector</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">modify</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Modify</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//初始化几何图形修改控件</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">modify</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">init</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">map</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//激活几何图形修改控件;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">modify</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setActive</span><span style="color:#F07178;">(</span><span style="color:#FF9CAC;">true</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#82AAFF;">onBeforeUnmount</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">=&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">map</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">map</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">dispose</span><span style="color:#F07178;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">map</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">&lt;!-- Add &quot;scoped&quot; attribute to limit CSS to this component only --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">style</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">scoped</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">#</span><span style="color:#F78C6C;">map</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">height</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">650px</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div></details>`,2),pn=JSON.parse('{"title":"图形交互编辑","description":"","frontmatter":{},"headers":[],"relativePath":"open-layers/drawing/modify-features/index.md","filePath":"open-layers/drawing/modify-features/index.md","lastUpdated":1687683239000}'),Js={name:"open-layers/drawing/modify-features/index.md"},rn=Object.assign(Js,{setup(C){return(s,n)=>(as(),ts("div",null,[Zs,zs,Gs(Ws),Ks]))}});export{pn as __pageData,rn as default};
