import{_ as s,o as a,c as n,O as l}from"./chunks/framework.3a9101bc.js";const p="/assets/image.c2ff99be.png",A=JSON.parse('{"title":"小兔鲜儿 - 项目打包","description":"","frontmatter":{},"headers":[],"relativePath":"pro-weixin/project/tips11/index.md","filePath":"pro-weixin/project/tips11/index.md","lastUpdated":1688979879000}'),o={name:"pro-weixin/project/tips11/index.md"},e=l(`<h1 id="小兔鲜儿-项目打包" tabindex="-1">小兔鲜儿 - 项目打包 <a class="header-anchor" href="#小兔鲜儿-项目打包" aria-label="Permalink to &quot;小兔鲜儿 - 项目打包&quot;">​</a></h1><div class="tip custom-block"><p class="custom-block-title">TIP</p><p>把当前 uni-app 项目打包成微信小程序端及 H5 端，并发布上线。</p></div><h2 id="_1-打包微信小程序端" tabindex="-1">1. 打包微信小程序端 <a class="header-anchor" href="#_1-打包微信小程序端" aria-label="Permalink to &quot;1. 打包微信小程序端&quot;">​</a></h2><h3 id="_1-1-核心步骤" tabindex="-1">1.1 核心步骤 <a class="header-anchor" href="#_1-1-核心步骤" aria-label="Permalink to &quot;1.1 核心步骤&quot;">​</a></h3><ol><li>运行打包命令 <code>pnpm build:mp-weixin</code></li><li>预览和测试，微信开发者工具导入生成的 <code>/dist/build/mp-weixin</code> 目录</li><li>上传小程序代码</li><li>提交审核和发布</li></ol><h3 id="_1-2-步骤图示" tabindex="-1">1.2 步骤图示 <a class="header-anchor" href="#_1-2-步骤图示" aria-label="Permalink to &quot;1.2 步骤图示&quot;">​</a></h3><p>项目打包上线需要使用到多个工具，注意工具之间的职责。</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">VSCode</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">----</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">微信开发者工具</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">----</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">微信公众平台</span></span></code></pre></div><p>了解：开发者也可独立使用 <a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/ci.html" target="_blank" rel="noreferrer">miniprogram-ci</a> 进行小程序代码的上传等操作</p><div class="tip custom-block"><p class="custom-block-title">举一反三</p><p>把当前 uni-app 项目打包成微信小程序端及 H5 端，并发布上线。</p></div><h2 id="_2-打包为-h5-端" tabindex="-1">2. 打包为 H5 端 <a class="header-anchor" href="#_2-打包为-h5-端" aria-label="Permalink to &quot;2. 打包为 H5 端&quot;">​</a></h2><p>把当前 uni-app 项目打包成网页(H5)端，并配置路由基础路径。</p><h3 id="_2-1-核心步骤" tabindex="-1">2.1 核心步骤 <a class="header-anchor" href="#_2-1-核心步骤" aria-label="Permalink to &quot;2.1 核心步骤&quot;">​</a></h3><ol><li>运行打包命令 <code>pnpm build:h5</code></li><li>预览和测试，使用浏览器打开 <code>/dist/build/h5</code> 目录下的 <code>index.html</code> 文件</li><li>由运维部署到服务器</li></ol><h3 id="_2-2-路由基础路径" tabindex="-1">2.2 路由基础路径 <a class="header-anchor" href="#_2-2-路由基础路径" aria-label="Permalink to &quot;2.2 路由基础路径&quot;">​</a></h3><p>默认的路由基础路径为 <code>/</code> 根路径，部分网站并不是部署到根路径，需要按运维要求调整。</p><div class="language-json"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// manifest.json</span></span>
<span class="line"><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/* 网页端特有配置 */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">h5</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&quot;</span><span style="color:#FFCB6B;">router</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#676E95;font-style:italic;">// 基础路径：./ 为相对路径</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&quot;</span><span style="color:#F78C6C;">base</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">/* 小程序特有相关 */</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">mp-weixin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">// …省略</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;">vueVersion</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">3</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><h2 id="_3-打包为-app-端" tabindex="-1">3. 打包为 APP 端 <a class="header-anchor" href="#_3-打包为-app-端" aria-label="Permalink to &quot;3. 打包为 APP 端&quot;">​</a></h2><p><a href="https://uniapp.dcloud.net.cn/tutorial/run/run-app.html" target="_blank" rel="noreferrer">App 端</a> 的打包，预览、测试、发行，使用 <code>HBuilderX</code> 工具。</p><h2 id="_4-条件编译" tabindex="-1">4. 条件编译 <a class="header-anchor" href="#_4-条件编译" aria-label="Permalink to &quot;4. 条件编译&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">常见问题</p><p>Q：按照 uni-app 规范开发可保证多平台兼容，但每个平台有自己的一些特性，该如何处理？</p><p>A：通过 条件编译，让代码按条件编译到指定平台。</p></div><p><img src="`+p+`" alt="Alt text"></p><p>**网页端不支持微信平台授权登录等功能，**可通过 条件编译，实现不同端渲染不同的登录界面。</p><h3 id="_4-1-条件编译语法" tabindex="-1">4.1 条件编译语法 <a class="header-anchor" href="#_4-1-条件编译语法" aria-label="Permalink to &quot;4.1 条件编译语法&quot;">​</a></h3><p>通过特殊注释，以 <code>#ifdef</code> 或 <code>#ifndef</code> 加 平台名称 开头，以 <code>#endif</code> 结尾。</p><p>条件编译支持: vue, ts, js, scss, css, pages.json 等文件。</p><div class="language-vue"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">setup</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">lang</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">ts</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 微信平台特有API，需要条件编译</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// #ifdef MP-WEIXIN</span></span>
<span class="line"><span style="color:#A6ACCD;">wx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">login</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">wx</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">requestPayment</span><span style="color:#A6ACCD;">()</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// #endif</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">&lt;!-- 微信开发能力按钮，需要条件编译 --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">&lt;!-- #ifdef MP-WEIXIN --&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">open-type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">openSetting</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">授权管理</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">open-type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">feedback</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">问题反馈</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">open-type</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">contact</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">联系我们</span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">button</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">&lt;!-- #endif --&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">template</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/* 如果出现样式兼容，也可添加条件编译 */</span></span>
<span class="line"><span style="color:#A6ACCD;">page </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/* #ifdef H5 */</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#B2CCD6;">background-color</span><span style="color:#89DDFF;">:</span><span style="color:#A6ACCD;"> pink</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#676E95;font-style:italic;">/* #endif */</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">style</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><p>了解：<code>#ifdef H5 || MP-WEIXIN</code> 表示在 H5 平台 <strong>或</strong> 微信小程序平台存在的代码。</p><div class="tip custom-block"><p class="custom-block-title">开发技巧</p><p>可通过搜索 <code>wx.</code> 和 <code>open-type</code> 等平台关键词，快速查找需要添加编译模式的代码。</p></div>`,29),t=[e];function c(r,i,D,y,F,d){return a(),n("div",null,t)}const u=s(o,[["render",c]]);export{A as __pageData,u as default};
