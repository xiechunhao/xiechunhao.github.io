import{A as q,M as x}from"./chunks/index.47495de9.js";import{c as w,S as b,I as P,V as S}from"./chunks/Vector.f72cf874.js";import{g as I,a as L,M,aQ as V,V as T,B as k}from"./chunks/reproj.50e0d4ab.js";import{T as U}from"./chunks/TileImage.36abd4f0.js";import{X as O}from"./chunks/XYZ.eaf43adc.js";import{V as X}from"./chunks/Vector.0afd591d.js";import{F as G}from"./chunks/FullScreen.9a3e590b.js";import{O as R}from"./chunks/Overlay.aad42cba.js";import{d as Y,h as u,p as N,a3 as j,o as D,c as C,z as p,F as m,L as Z,_ as $,G as z,a as H,O as J}from"./chunks/framework.166469be.js";const Q=e=>new b({image:new P({crossOrigin:"anonymous",src:e,scale:.1})}),K=({coordinate:e,vectorSource:s,imageUrl:l,name:o="标注点"})=>{if(s===null)return;const a=new w({geometry:new I(e),name:o});a.setStyle(Q(l)),s.addFeature(a)};class W extends L{constructor(){super(),this.coordinate_=null,this.cursor_="pointer",this.feature_=null,this.previousCursor_=void 0}handleDownEvent(s){const o=s.map.forEachFeatureAtPixel(s.pixel,function(a){return a});return o&&(this.coordinate_=s.coordinate,this.feature_=o),!!o}handleDragEvent(s){if(this.coordinate_===null||this.feature_===null)return;const l=s.coordinate[0]-this.coordinate_[0],o=s.coordinate[1]-this.coordinate_[1];this.feature_.getGeometry().translate(l,o),this.coordinate_[0]=s.coordinate[0],this.coordinate_[1]=s.coordinate[1]}handleMoveEvent(s){if(this.cursor_){const o=s.map.forEachFeatureAtPixel(s.pixel,function(F){return F}),a=s.map.getTargetElement();o?a.style.cursor!=this.cursor_&&(this.previousCursor_=a.style.cursor,a.style.cursor=this.cursor_):this.previousCursor_!==void 0&&(a.style.cursor=this.previousCursor_,this.previousCursor_=void 0)}}handleUpEvent(){return this.coordinate_=null,this.feature_=null,!1}}const ss={class:"top"},ns=["src"],as=Y({__name:"index",setup(e){let s=null,l;const o=u(null),a=u(null),F=["/image/chips.png","/image/ice_cream.png"],E=new U({source:new O({attributions:q,url:x,maxZoom:20})}),i=new S,A=new X({source:i}),d=()=>{s=new M({target:"map",interactions:V().extend([new W]),layers:[E,A],view:new T({projection:"EPSG:4326",center:[0,0],zoom:5}),controls:k().extend([new G])}),l=new R({element:o.value||void 0,positioning:"center-center"}),s.addOverlay(l)},g=n=>{const t=n.target.src;n.dataTransfer.setData("src",t)},B=n=>{n.preventDefault()},v=n=>{var f;if(s===null)return;const t=(f=n.dataTransfer)==null?void 0:f.getData("src"),{layerX:r,layerY:c}=n,y=s.getCoordinateFromPixel([r,c]);K({coordinate:y,vectorSource:i,imageUrl:t}),n.stopPropagation()},h=n=>{n.getViewport().oncontextmenu=function(t){t.preventDefault();const r=n.getEventPixel(t),c=n.forEachFeatureAtPixel(r,y=>y);if(c){const y=n.getEventCoordinate(t);a.value=c,l.setPosition(y)}}},_=()=>{const n=A.getSource();n===null||a.value===null||(n.removeFeature(a.value),a.value=null,l.setPosition(void 0))};return N(()=>{const n=document.getElementById("map");n&&(n.oncontextmenu=()=>!1),d(),s&&(h(s),s.on("singleclick",()=>{l.setPosition(void 0)}))}),j(()=>{s&&(s.dispose(),s=null)}),(n,t)=>(D(),C(m,null,[p("div",ss,[(D(),C(m,null,Z(F,(r,c)=>p("img",{key:c,src:r,draggable:"true",onDragstart:g},null,40,ns)),64))]),p("div",{id:"map",onDrop:v,onDragover:B},[p("div",{class:"menu",ref_key:"menu",ref:o},[p("div",{class:"menu-item",onClick:_},"删除")],512)],32)],64))}});const ls=$(as,[["__scopeId","data-v-1166a1e6"]]),os=p("h1",{id:"拖拽添加覆盖物",tabindex:"-1"},[H("拖拽添加覆盖物 "),p("a",{class:"header-anchor",href:"#拖拽添加覆盖物","aria-label":'Permalink to "拖拽添加覆盖物"'},"​")],-1),ps=p("div",{class:"tip custom-block"},[p("p",{class:"custom-block-title"},"TIP"),p("p",null,"拖拽下方的图标到地图指定位置可以生成覆盖物。"),p("p",null,"对着地图上的覆盖物单击右键可以移除。")],-1),ts=J("",6),us=JSON.parse('{"title":"拖拽添加覆盖物","description":"","frontmatter":{},"headers":[],"relativePath":"open-layers/map-marker/drag-to-add-mulch/index.md","filePath":"open-layers/map-marker/drag-to-add-mulch/index.md"}'),es={name:"open-layers/map-marker/drag-to-add-mulch/index.md"},ms=Object.assign(es,{setup(e){return(s,l)=>(D(),C("div",null,[os,ps,z(ls),ts]))}});export{us as __pageData,ms as default};
