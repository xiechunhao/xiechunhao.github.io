var e=(e,a,l)=>new Promise(((t,u)=>{var n=e=>{try{d(l.next(e))}catch(a){u(a)}},o=e=>{try{d(l.throw(e))}catch(a){u(a)}},d=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,o);d((l=l.apply(e,a)).next())}));import{x as a,I as l,f as t,_ as u}from"./index-AUd2T663.js";import{I as n}from"./IconSelector-BbAns_gb.js";/* empty css                       *//* empty css                        */import{_ as o}from"./ButtonTable-BCd2qicg.js";/* empty css               */import{h as d,c as s,r,X as i,a_ as m,j as p,t as c,m as f,q as h,a1 as b,N as _,J as v,M as g,aU as V,aJ as k,F as y,C as w,ac as x,s as I,z as U,u as C,Z as j,k as L,_ as N,aR as E,i as M,aS as S,aN as q,G as A,aq as H,ap as T,Y as B,E as z,n as F,aj as J}from"./vendor-CC2XCvy_.js";import"./iconfont-DPUoc2h2.js";const O={class:"page-content"},P={style:{margin:"0","text-align":"right"}},R={class:"dialog-footer"},X=u(d({__name:"Menu",setup(u){const d=s((()=>a().getMenuList)),X=r(!1),Y=i({name:"",path:"",label:"",icon:"",isEnable:!0,sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1}),$=r(l.UNICODE),D=r("menu"),G=i({name:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],label:[{required:!0,message:"输入权限标识",trigger:"blur"}],authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}],authLabel:[{required:!0,message:"请输入权限权限标识",trigger:"blur"}]}),W=d.value,Z=r(!1),K=r(),Q=s((()=>{const e="menu"===D.value?"菜单":"权限";return Z.value?`编辑${e}`:`新建${e}`})),ee=()=>{},ae=()=>e(this,null,(function*(){K.value&&(yield K.value.validate((a=>e(this,null,(function*(){if(a)try{Z.value,z.success((Z.value?"编辑":"新增")+"成功"),X.value=!1}catch(e){z.error((Z.value?"编辑":"新增")+"失败")}})))))})),le=(e,a,l=!1)=>{X.value=!0,D.value=e,Z.value=!1,de.value=l,te(),a&&(Z.value=!0,F((()=>{"menu"===e?(Y.name=a.meta.title,Y.path=a.path,Y.label=a.name,Y.icon=a.meta.icon,Y.sort=a.meta.sort||1,Y.isMenu=a.meta.isMenu,Y.keepAlive=a.meta.keepAlive,Y.isHidden=a.meta.isHidden||!0,Y.isEnable=a.meta.isEnable||!0,Y.link=a.meta.link,Y.isIframe=a.meta.isIframe||!1):(Y.authName=a.title,Y.authLabel=a.auth_mark,Y.authIcon=a.icon||"",Y.authSort=a.sort||1)})))},te=()=>{var e;null==(e=K.value)||e.resetFields(),Object.assign(Y,{name:"",path:"",label:"",icon:"",sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1})},ue=()=>e(this,null,(function*(){try{yield J.confirm("确定要删除该菜单吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),z.success("删除成功")}catch(e){"cancel"!==e&&z.error("删除失败")}})),ne=()=>e(this,null,(function*(){try{yield J.confirm("确定要删除该权限吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),z.success("删除成功")}catch(e){"cancel"!==e&&z.error("删除失败")}})),oe=s((()=>!(!Z.value||"button"!==D.value)||(!(!Z.value||"menu"!==D.value)||!(Z.value||"menu"!==D.value||!de.value)))),de=r(!1);return(e,a)=>{const l=v,u=V,d=k,s=x,r=o,i=t,z=S,F=E,J=N,Z=A,te=q,de=n,se=H,re=T,ie=j,me=B,pe=m("auth");return c(),p("div",O,[f(u,{gutter:20,style:{"margin-left":"15px"}},{default:h((()=>[b((c(),_(l,{onClick:a[0]||(a[0]=e=>le("menu",null,!0))},{default:h((()=>a[19]||(a[19]=[g("添加菜单")]))),_:1})),[[pe,"add"]])])),_:1}),f(i,{data:C(W)},{default:h((()=>[f(d,{prop:"meta.title",label:"菜单名称"}),f(d,{prop:"path",label:"路由"}),f(d,{prop:"meta.authList",label:"可操作权限"},{default:h((e=>[(c(!0),p(y,null,w(e.row.meta.authList,((e,t)=>(c(),_(s,{placement:"top-start",title:"操作",width:200,trigger:"click",key:t},{reference:h((()=>[f(l,{class:"small-btn"},{default:h((()=>[g(U(e.title),1)])),_:2},1024)])),default:h((()=>[I("div",P,[f(l,{size:"small",type:"primary",onClick:a=>le("button",e)},{default:h((()=>a[20]||(a[20]=[g("编辑")]))),_:2},1032,["onClick"]),f(l,{size:"small",type:"danger",onClick:a[1]||(a[1]=e=>ne())},{default:h((()=>a[21]||(a[21]=[g("删除")]))),_:1})])])),_:2},1024)))),128))])),_:1}),f(d,{label:"编辑时间",prop:"date"},{default:h((()=>a[22]||(a[22]=[g(" 2022-3-12 12:00:00 ")]))),_:1}),f(d,{fixed:"right",label:"操作",width:"180"},{default:h((e=>[b(f(r,{type:"add",onClick:a[2]||(a[2]=e=>le("menu"))},null,512),[[pe,"add"]]),b(f(r,{type:"edit",onClick:a=>{return l=e.row,void le("menu",l,!0);var l}},null,8,["onClick"]),[[pe,"edit"]]),b(f(r,{type:"delete",onClick:ue},null,512),[[pe,"delete"]])])),_:1})])),_:1},8,["data"]),f(me,{title:C(Q),modelValue:C(X),"onUpdate:modelValue":a[18]||(a[18]=e=>M(X)?X.value=e:null),width:"700px","align-center":""},{footer:h((()=>[I("span",R,[f(l,{onClick:a[16]||(a[16]=e=>X.value=!1)},{default:h((()=>a[25]||(a[25]=[g("取 消")]))),_:1}),f(l,{type:"primary",onClick:a[17]||(a[17]=e=>ae())},{default:h((()=>a[26]||(a[26]=[g(" 确 定 ")]))),_:1})])])),default:h((()=>[f(ie,{ref_key:"formRef",ref:K,model:C(Y),rules:C(G),"label-width":"85px"},{default:h((()=>[f(J,{label:"菜单类型"},{default:h((()=>[f(F,{modelValue:C(D),"onUpdate:modelValue":a[3]||(a[3]=e=>M(D)?D.value=e:null),disabled:C(oe)},{default:h((()=>[f(z,{value:"menu",label:"menu"},{default:h((()=>a[23]||(a[23]=[g("菜单")]))),_:1}),f(z,{value:"button",label:"button"},{default:h((()=>a[24]||(a[24]=[g("权限")]))),_:1})])),_:1},8,["modelValue","disabled"])])),_:1}),"menu"===C(D)?(c(),p(y,{key:0},[f(u,{gutter:20},{default:h((()=>[f(te,{span:12},{default:h((()=>[f(J,{label:"菜单名称",prop:"name"},{default:h((()=>[f(Z,{modelValue:C(Y).name,"onUpdate:modelValue":a[4]||(a[4]=e=>C(Y).name=e),placeholder:"菜单名称"},null,8,["modelValue"])])),_:1})])),_:1}),f(te,{span:12},{default:h((()=>[f(J,{label:"路由地址",prop:"path"},{default:h((()=>[f(Z,{modelValue:C(Y).path,"onUpdate:modelValue":a[5]||(a[5]=e=>C(Y).path=e),placeholder:"路由地址"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),f(u,{gutter:20},{default:h((()=>[f(te,{span:12},{default:h((()=>[f(J,{label:"权限标识",prop:"label"},{default:h((()=>[f(Z,{modelValue:C(Y).label,"onUpdate:modelValue":a[6]||(a[6]=e=>C(Y).label=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1}),f(te,{span:12},{default:h((()=>[f(J,{label:"图标",prop:"icon"},{default:h((()=>[f(de,{iconType:C($),defaultIcon:C(Y).icon,width:"229px"},null,8,["iconType","defaultIcon"])])),_:1})])),_:1})])),_:1}),f(u,{gutter:20},{default:h((()=>[f(te,{span:12},{default:h((()=>[f(J,{label:"菜单排序",prop:"sort",style:{width:"100%"}},{default:h((()=>[f(se,{modelValue:C(Y).sort,"onUpdate:modelValue":a[7]||(a[7]=e=>C(Y).sort=e),style:{width:"100%"},onChange:ee,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1}),f(te,{span:12},{default:h((()=>[f(J,{label:"外部链接",prop:"link"},{default:h((()=>[f(Z,{modelValue:C(Y).link,"onUpdate:modelValue":a[8]||(a[8]=e=>C(Y).link=e),placeholder:"外部链接/内嵌地址(https://www.baidu.com)"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),f(u,{gutter:20},{default:h((()=>[f(te,{span:5},{default:h((()=>[f(J,{label:"是否启用",prop:"isEnable"},{default:h((()=>[f(re,{modelValue:C(Y).isEnable,"onUpdate:modelValue":a[9]||(a[9]=e=>C(Y).isEnable=e)},null,8,["modelValue"])])),_:1})])),_:1}),f(te,{span:5},{default:h((()=>[f(J,{label:"页面缓存",prop:"keepAlive"},{default:h((()=>[f(re,{modelValue:C(Y).keepAlive,"onUpdate:modelValue":a[10]||(a[10]=e=>C(Y).keepAlive=e)},null,8,["modelValue"])])),_:1})])),_:1}),f(te,{span:5},{default:h((()=>[f(J,{label:"是否显示",prop:"isHidden"},{default:h((()=>[f(re,{modelValue:C(Y).isHidden,"onUpdate:modelValue":a[11]||(a[11]=e=>C(Y).isHidden=e)},null,8,["modelValue"])])),_:1})])),_:1}),f(te,{span:5},{default:h((()=>[f(J,{label:"是否内嵌",prop:"isMenu"},{default:h((()=>[f(re,{modelValue:C(Y).isIframe,"onUpdate:modelValue":a[12]||(a[12]=e=>C(Y).isIframe=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):L("",!0),"button"===C(D)?(c(),p(y,{key:1},[f(u,{gutter:20},{default:h((()=>[f(te,{span:12},{default:h((()=>[f(J,{label:"权限名称",prop:"authName"},{default:h((()=>[f(Z,{modelValue:C(Y).authName,"onUpdate:modelValue":a[13]||(a[13]=e=>C(Y).authName=e),placeholder:"权限名称"},null,8,["modelValue"])])),_:1})])),_:1}),f(te,{span:12},{default:h((()=>[f(J,{label:"权限标识",prop:"authLabel"},{default:h((()=>[f(Z,{modelValue:C(Y).authLabel,"onUpdate:modelValue":a[14]||(a[14]=e=>C(Y).authLabel=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),f(u,{gutter:20},{default:h((()=>[f(te,{span:12},{default:h((()=>[f(J,{label:"权限排序",prop:"authSort",style:{width:"100%"}},{default:h((()=>[f(se,{modelValue:C(Y).authSort,"onUpdate:modelValue":a[15]||(a[15]=e=>C(Y).authSort=e),style:{width:"100%"},onChange:ee,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):L("",!0)])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])}}}),[["__scopeId","data-v-8b55aa05"]]);export{X as default};
