var e=(e,s,a)=>new Promise(((t,l)=>{var o=e=>{try{i(a.next(e))}catch(s){l(s)}},r=e=>{try{i(a.throw(e))}catch(s){l(s)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,r);i((a=a.apply(e,s)).next())}));import{_ as s,j as a,n as t,i as l,k as o,u as r,o as i,g as n,H as d,S as u}from"./index-jEQxvlyX.js";import{h as c,X as g,aV as h,r as p,a as v,c as f,j as m,k as y,p as x,y as w,u as b,af as k,s as _,H as B,z as T,a1 as $,x as M,l as V,m as z,B as I,ag as P,$ as C,i as L,E as j,ax as X,ai as H,aj as S,L as A,_ as F,aE as R,K as U}from"./vendor-Bhb26uf3.js";import{L as D}from"./LeftView-DKgcGt9B.js";import{a as O,A as E}from"./axios-CBzZLLX9.js";const K=["innerHTML"],q=s(c({__name:"DragVerify",props:{value:{type:Boolean,default:!1},width:{default:260},height:{default:44},text:{default:"按住滑块拖动"},successText:{default:"success"},background:{default:"#eee"},progressBarBg:{default:"#1385FF"},completedBg:{default:"#57D187"},circle:{type:Boolean,default:!1},radius:{default:"calc(var(--custom-radius) / 2 + 2px)"},handlerIcon:{default:"&#xea50;"},successIcon:{default:"&#xe621;"},handlerBg:{default:"#fff"},textSize:{default:"13px"},textColor:{default:"#333"}},emits:["handlerMove","update:value","passCallback"],setup(e,{expose:s,emit:a}){const t=a,l=e,o=g({isMoving:!1,x:0,isOk:!1}),{isOk:r}=h(o),i=p(),n=p(),d=p(),u=p();v((()=>{var e,s,a;null==(e=i.value)||e.style.setProperty("--textColor",l.textColor),null==(s=i.value)||s.style.setProperty("--width",Math.floor(l.width/2)+"px"),null==(a=i.value)||a.style.setProperty("--pwidth",-Math.floor(l.width/2)+"px")}));const c={left:"0",width:l.height+"px",height:l.height+"px",background:l.handlerBg},$={width:l.width+"px",height:l.height+"px",lineHeight:l.height+"px",background:l.background,borderRadius:l.circle?l.height/2+"px":l.radius},M={background:l.progressBarBg,height:l.height+"px",borderRadius:l.circle?l.height/2+"px 0 0 "+l.height/2+"px":l.radius},V={height:l.height+"px",width:l.width+"px",fontSize:l.textSize},z=f((()=>l.value?l.successText:l.text)),I=e=>{l.value||(o.isMoving=!0,d.value.style.transition="none",o.x=(e.pageX||e.touches[0].pageX)-parseInt(d.value.style.left.replace("px",""),10)),t("handlerMove")},P=e=>{if(o.isMoving&&!l.value){let s=(e.pageX||e.touches[0].pageX)-o.x;s>0&&s<=l.width-l.height?(d.value.style.left=s+"px",u.value.style.width=s+l.height/2+"px"):s>l.width-l.height&&(d.value.style.left=l.width-l.height+"px",u.value.style.width=l.width-l.height/2+"px",L())}},C=e=>{if(o.isMoving&&!l.value){(e.pageX||e.changedTouches[0].pageX)-o.x<l.width-l.height?(o.isOk=!0,d.value.style.left="0",d.value.style.transition="all 0.2s",u.value.style.width="0",o.isOk=!1):(d.value.style.transition="none",d.value.style.left=l.width-l.height+"px",u.value.style.width=l.width-l.height/2+"px",L()),o.isMoving=!1}},L=()=>{t("update:value",!0),o.isMoving=!1,u.value.style.background=l.completedBg,n.value.style["-webkit-text-fill-color"]="unset",n.value.style.animation="slidetounlock2 3s infinite",n.value.style.color="#fff",t("passCallback")};return s({reset:()=>{d.value.style.left="0",u.value.valueFormat.style.width="0",d.value.children[0].type=l.handlerIcon,n.value.style["-webkit-text-fill-color"]="transparent",n.value.style.animation="slidetounlock 3s infinite",n.value.style.color=l.background}}),(e,s)=>(m(),y("div",{ref_key:"dragVerify",ref:i,class:"drag_verify",style:$,onMousemove:P,onMouseup:C,onMouseleave:C,onTouchmove:P,onTouchend:C},[x("div",{class:w(["dv_progress_bar",{goFirst2:b(r)}]),ref_key:"progressBar",ref:u,style:M},null,2),x("div",{class:"dv_text custom-text",style:V,ref_key:"messageRef",ref:n},[e.$slots.textBefore?k(e.$slots,"textBefore",{key:0},void 0,!0):_("",!0),B(" "+T(z.value)+" ",1),e.$slots.textAfter?k(e.$slots,"textAfter",{key:1},void 0,!0):_("",!0)],512),x("div",{class:w(["dv_handler dv_handler_bg",{goFirst:b(r)}]),onMousedown:I,onTouchstart:I,ref_key:"handler",ref:d,style:c},[x("i",{class:"iconfont-sys",innerHTML:e.value?e.successIcon:e.handlerIcon},null,8,K)],34)],544))}}),[["__scopeId","data-v-aed95d78"]]),G={class:"login"},Z={class:"left-wrap"},J={class:"right-wrap"},N={class:"top-right-wrap"},Q={class:"iconfont-sys"},W={class:"lang-btn-item"},Y={key:0,class:"iconfont-sys"},ee={class:"lang-btn-item"},se={key:0,class:"iconfont-sys"},ae={class:"header"},te={class:"login-wrap"},le={class:"form"},oe={class:"title"},re={class:"sub-title"},ie={class:"drag-verify"},ne={class:"forget-password"},de={style:{"margin-top":"30px"}},ue={class:"footer"},ce=s(c({__name:"index",setup(s){const{t:c}=a(),h=t(),v=$(),k=p(!1),K=p(!1),ce=l.name,ge=p(),he=g({username:l.login.username,password:l.login.password,rememberPassword:!0}),pe=f((()=>({username:[{required:!0,message:c("login.placeholder[0]"),trigger:"blur"}],password:[{required:!0,message:c("login.placeholder[1]"),trigger:"blur"}]}))),ve=p(!1),{width:fe}=o(),me=r(),ye=f((()=>me.isDark)),xe=()=>{},we=()=>e(this,null,(function*(){ge.value&&(yield ge.value.validate((s=>e(this,null,(function*(){if(s){if(!k.value)return void(K.value=!0);ve.value=!0;try{const e=yield O.post("/api/login",{username:he.username,password:he.password});let{code:s,data:a}=e.data;s===E.success?(h.setUserInfo(a),h.setLoginStatus(!0),be(),v.push(d)):j.error(e.data.message)}finally{ve.value=!1}}})))))})),be=()=>{setTimeout((()=>{X({title:c("login.success.title"),type:"success",showClose:!1,duration:2500,zIndex:1e4,message:`${c("login.success.message")}, ${ce}!`})}),300)},{locale:ke}=a(),_e=e=>{ke.value=e,h.setLanguage(e)},Be=()=>{let{LIGHT:e,DARK:s}=u;i().switchTheme(r().systemThemeType===e?s:e)};return(e,s)=>{const a=H,t=S,l=P,o=A,r=F,i=q,d=R,u=M("router-link"),c=U,g=C;return m(),y("div",G,[x("div",Z,[V(D)]),x("div",J,[x("div",N,[x("div",{class:"btn theme-btn",onClick:Be},[x("i",Q,T(b(ye)?"":""),1)]),V(l,{onCommand:_e},{dropdown:z((()=>[V(t,null,{default:z((()=>[x("div",W,[V(a,{command:"zh"},{default:z((()=>[s[4]||(s[4]=x("span",{class:"menu-txt"},"简体中文",-1)),"zh"===b(ke)?(m(),y("i",Y,"")):_("",!0)])),_:1})]),x("div",ee,[V(a,{command:"en"},{default:z((()=>[s[5]||(s[5]=x("span",{class:"menu-txt"},"English",-1)),"en"===b(ke)?(m(),y("i",se,"")):_("",!0)])),_:1})])])),_:1})])),default:z((()=>[s[6]||(s[6]=x("div",{class:"btn language-btn"},[x("i",{class:"iconfont-sys"},"")],-1))])),_:1})]),x("div",ae,[s[7]||(s[7]=x("svg",{class:"icon","aria-hidden":"true"},[x("use",{"xlink:href":"#iconsys-zhaopian-copy"})],-1)),x("h1",null,T(b(ce)),1)]),x("div",te,[x("div",le,[x("h3",oe,T(e.$t("login.title")),1),x("p",re,T(e.$t("login.subTitle")),1),V(g,{ref_key:"formRef",ref:ge,model:b(he),rules:b(pe),onKeyup:I(we,["enter"]),style:{"margin-top":"25px"}},{default:z((()=>[V(r,{prop:"username"},{default:z((()=>[V(o,{placeholder:e.$t("login.placeholder[0]"),size:"large",modelValue:b(he).username,"onUpdate:modelValue":s[0]||(s[0]=e=>b(he).username=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),V(r,{prop:"password"},{default:z((()=>[V(o,{placeholder:e.$t("login.placeholder[1]"),size:"large",modelValue:b(he).password,"onUpdate:modelValue":s[1]||(s[1]=e=>b(he).password=e),modelModifiers:{trim:!0},type:"password",radius:"8px",autocomplete:"off"},null,8,["placeholder","modelValue"])])),_:1}),x("div",ie,[x("div",{class:w(["drag-verify-content",{error:!b(k)&&b(K)}])},[V(i,{ref:"dragVerify",value:b(k),"onUpdate:value":s[2]||(s[2]=e=>L(k)?k.value=e:null),width:b(fe)<500?328:438,text:e.$t("login.sliderText"),textColor:"var(--art-gray-800)",successText:e.$t("login.sliderSuccessText"),progressBarBg:b(n)("--el-color-primary"),background:"var(--art-gray-200)",handlerBg:"var(--art-main-bg-color)",onPass:xe},null,8,["value","width","text","successText","progressBarBg"])],2),x("p",{class:w(["error-text",{"show-error-text":!b(k)&&b(K)}])},T(e.$t("login.placeholder[2]")),3)]),x("div",ne,[V(d,{modelValue:b(he).rememberPassword,"onUpdate:modelValue":s[3]||(s[3]=e=>b(he).rememberPassword=e)},{default:z((()=>[B(T(e.$t("login.rememberPwd")),1)])),_:1},8,["modelValue"]),V(u,{class:"custom-text",to:"/forget-password"},{default:z((()=>[B(T(e.$t("login.forgetPwd")),1)])),_:1})]),x("div",de,[V(c,{class:"login-btn",size:"large",type:"primary",onClick:we,loading:b(ve)},{default:z((()=>[B(T(e.$t("login.btnText")),1)])),_:1},8,["loading"])]),x("div",ue,[x("p",null,[B(T(e.$t("login.noAccount"))+" ",1),V(u,{class:"custom-text",to:"/register"},{default:z((()=>[B(T(e.$t("login.register")),1)])),_:1})])])])),_:1},8,["model","rules"])])])])])}}}),[["__scopeId","data-v-3eb81946"]]);export{ce as default};
