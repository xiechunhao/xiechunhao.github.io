import{i as S}from"./index-p1XoTQj1.js";import{b4 as M,o as R,c as w,w as o,b as t,cM as H,aF as B,u as v,e as b,aH as D,aG as F,aB as $,aK as K,r as f,a as W,O,E as h,aD as T,d as U,a6 as q,a7 as A,t as L,fN as P,fo as z,V as G,dM as J,g as Q,bD as X,at as Y,aV as Z,ax as ee,j as le}from"./index-BF2fBoPb.js";import{i as j}from"./index-Cjr4ibGp.js";import{i as te}from"./index-DG03PXF-.js";import"./index-CcYpqHDV.js";import{i as oe}from"./index-B-b3I1wI.js";import"./index-BnIMXyIx.js";import"./virtual-list-B6G0p9cv.js";import"./index-BWYZqqjh.js";import"./index-DuliLu7F.js";import{E as ae,a as ne}from"./col-DirwGu8S.js";import{u as se,a as re,b as de,c as ue,p as ie,r as me}from"./index-E9Z4TjLA.js";import{E as pe}from"./tree-B2uMWqdF.js";import"./isArrayLikeObject-j402kJv_.js";import"./vuedraggable.umd-DLnsjw3h.js";const ce={__name:"role-search",emits:["search"],setup(I,{emit:C}){const E=C,[d,p]=M({roleName:"",roleCode:"",comments:""}),i=()=>{E("search",{...d})},c=()=>{p(),i()};return(m,r)=>{const x=D,V=F,g=ae,a=$,e=ne,l=K,n=j;return R(),w(n,{"body-style":{paddingBottom:"2px"}},{default:o(()=>[t(l,{"label-width":"72px",onKeyup:H(i,["enter"]),onSubmit:r[2]||(r[2]=B(()=>{},["prevent"]))},{default:o(()=>[t(e,{gutter:8},{default:o(()=>[t(g,{lg:6,md:8,sm:12,xs:24},{default:o(()=>[t(V,{label:"角色名称"},{default:o(()=>[t(x,{clearable:"",modelValue:v(d).roleName,"onUpdate:modelValue":r[0]||(r[0]=u=>v(d).roleName=u),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),t(g,{lg:6,md:8,sm:12,xs:24},{default:o(()=>[t(V,{label:"角色标识"},{default:o(()=>[t(x,{clearable:"",modelValue:v(d).roleCode,"onUpdate:modelValue":r[1]||(r[1]=u=>v(d).roleCode=u),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),t(g,{lg:12,md:8,sm:24,xs:24},{default:o(()=>[t(V,{"label-width":"16px"},{default:o(()=>[t(a,{type:"primary",onClick:i},{default:o(()=>r[3]||(r[3]=[b("查询")])),_:1}),t(a,{onClick:c},{default:o(()=>r[4]||(r[4]=[b("重置")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},fe={__name:"role-edit",props:{modelValue:Boolean,data:Object},emits:["done","update:modelValue"],setup(I,{emit:C}){const E=C,d=I,p=f(!1),i=f(!1),c=f(null),[m,r,x]=M({roleId:void 0,roleName:"",roleCode:"",comments:""}),V=W({roleName:[{required:!0,message:"请输入角色名称",type:"string",trigger:"blur"}],roleCode:[{required:!0,message:"请输入角色标识",type:"string",trigger:"blur"}]}),g=()=>{var e,l;(l=(e=c.value)==null?void 0:e.validate)==null||l.call(e,n=>{if(!n)return;i.value=!0,(p.value?se:re)(m).then(_=>{i.value=!1,h.success(_),a(!1),E("done")}).catch(_=>{i.value=!1,h.error(_.message)})})},a=e=>{E("update:modelValue",e)};return O(()=>d.modelValue,e=>{var l,n;e?d.data?(x(d.data),p.value=!0):p.value=!1:(r(),(n=(l=c.value)==null?void 0:l.clearValidate)==null||n.call(l))}),(e,l)=>{const n=D,u=F,_=K,k=$,y=T;return R(),w(y,{form:"",width:460,"model-value":I.modelValue,title:p.value?"修改角色":"添加角色","onUpdate:modelValue":a},{footer:o(()=>[t(k,{onClick:l[4]||(l[4]=s=>a(!1))},{default:o(()=>l[5]||(l[5]=[b("取消")])),_:1}),t(k,{type:"primary",loading:i.value,onClick:g},{default:o(()=>l[6]||(l[6]=[b(" 保存 ")])),_:1},8,["loading"])]),default:o(()=>[t(_,{ref_key:"formRef",ref:c,model:v(m),rules:V,"label-width":"80px",onSubmit:l[3]||(l[3]=B(()=>{},["prevent"]))},{default:o(()=>[t(u,{label:"角色名称",prop:"roleName"},{default:o(()=>[t(n,{clearable:"",maxlength:20,modelValue:v(m).roleName,"onUpdate:modelValue":l[0]||(l[0]=s=>v(m).roleName=s),placeholder:"请输入角色名称"},null,8,["modelValue"])]),_:1}),t(u,{label:"角色标识",prop:"roleCode"},{default:o(()=>[t(n,{clearable:"",maxlength:20,modelValue:v(m).roleCode,"onUpdate:modelValue":l[1]||(l[1]=s=>v(m).roleCode=s),placeholder:"请输入角色标识"},null,8,["modelValue"])]),_:1}),t(u,{label:"备注"},{default:o(()=>[t(n,{rows:4,type:"textarea",modelValue:v(m).comments,"onUpdate:modelValue":l[2]||(l[2]=s=>v(m).comments=s),placeholder:"请输入备注"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value","title"])}}},_e={style:{"vertical-align":"-2px"}},ve={components:P},ge=Object.assign(ve,{__name:"role-auth",props:{modelValue:Boolean,data:Object},emits:["update:modelValue"],setup(I,{emit:C}){const E=C,d=I,p=f(null),i=f([]),c=f(!1),m=f(!1),r=f([]),x=()=>{i.value=[],r.value=[],d.data&&(c.value=!0,de(d.data.roleId).then(a=>{c.value=!1,i.value=z({data:a,idField:"menuId",parentIdField:"parentId"}),G(()=>{const e=[];J(i.value,l=>{var n;l.menuId&&l.checked&&!((n=l.children)!=null&&n.length)&&e.push(l.menuId)}),r.value=e})}).catch(a=>{c.value=!1,h.error(a.message)}))},V=()=>{var e,l,n,u,_,k,y,s;m.value=!0;const a=(y=((n=(l=(e=p.value)==null?void 0:e.getCheckedKeys)==null?void 0:l.call(e))!=null?n:[]).concat((k=(_=(u=p.value)==null?void 0:u.getHalfCheckedKeys)==null?void 0:_.call(u))!=null?k:[]))!=null?y:[];ue((s=d.data)==null?void 0:s.roleId,a).then(N=>{m.value=!1,h.success(N),g(!1)}).catch(N=>{m.value=!1,h.error(N.message)})},g=a=>{E("update:modelValue",a)};return O(()=>d.modelValue,a=>{a&&x()}),(a,e)=>{const l=Q,n=pe,u=oe,_=$,k=T;return R(),w(k,{width:460,title:"分配权限",position:"center","model-value":I.modelValue,"body-style":{padding:"12px 0 12px 22px"},"onUpdate:modelValue":g},{footer:o(()=>[t(_,{onClick:e[0]||(e[0]=y=>g(!1))},{default:o(()=>e[1]||(e[1]=[b("取消")])),_:1}),t(_,{type:"primary",loading:m.value,onClick:V},{default:o(()=>e[2]||(e[2]=[b(" 保存 ")])),_:1},8,["loading"])]),default:o(()=>[t(u,{loading:c.value,"spinner-style":{background:"transparent"},style:{height:"560px",paddingRight:"20px",maxHeight:"calc(100vh - 192px)",minHeight:"100px",overflow:"auto"}},{default:o(()=>[t(n,{ref_key:"treeRef",ref:p,"show-checkbox":"",data:i.value,"node-key":"menuId","default-expand-all":!0,props:{label:"title"},"default-checked-keys":r.value,style:{"--ele-tree-item-height":"28px"}},{default:o(y=>[U("div",null,[y.data.icon?(R(),w(l,{key:0,size:16,style:{"margin-right":"6px","vertical-align":"-5px"}},{default:o(()=>[(R(),w(q(y.data.icon)))]),_:2},1024)):A("",!0),U("span",_e,L(y.data.title),1)])]),_:1},8,["data","default-checked-keys"])]),_:1},8,["loading"])]),_:1},8,["model-value"])}}}),ye={name:"SystemRole"},De=Object.assign(ye,{setup(I){const C=f(null),E=f([{type:"selection",columnKey:"selection",width:50,align:"center",fixed:"left"},{type:"index",columnKey:"index",width:50,align:"center",fixed:"left"},{prop:"roleName",label:"角色名称",sortable:"custom",minWidth:110},{prop:"roleCode",label:"角色标识",sortable:"custom",minWidth:110},{prop:"comments",label:"备注",sortable:"custom",minWidth:110},{prop:"createTime",label:"创建时间",sortable:"custom",minWidth:110},{columnKey:"action",label:"操作",width:200,align:"center",slot:"action",hideInPrint:!0,hideInExport:!0}]),d=f([]),p=f(null),i=f(!1),c=f(!1),m=({pages:a,where:e,orders:l})=>ie({...e,...l,...a}),r=a=>{var e,l;d.value=[],(l=(e=C.value)==null?void 0:e.reload)==null||l.call(e,{page:1,where:a})},x=a=>{p.value=a!=null?a:null,i.value=!0},V=a=>{p.value=a!=null?a:null,c.value=!0},g=a=>{const e=a==null?d.value:[a];if(!e.length){h.error("请至少选择一条数据");return}Z.confirm("确定要删除“"+e.map(l=>l.roleName).join(", ")+"”吗?","系统提示",{type:"warning",draggable:!0}).then(()=>{const l=h.loading("请求中..");me(e.map(n=>n.roleId)).then(n=>{l.close(),h.success(n),r()}).catch(n=>{l.close(),h.error(n.message)})}).catch(()=>{})};return(a,e)=>{const l=$,n=ee,u=le,_=te,k=j,y=S;return R(),w(y,null,{default:o(()=>[t(ce,{onSearch:r}),t(k,{"body-style":{paddingTop:"8px"}},{default:o(()=>[t(_,{ref_key:"tableRef",ref:C,"row-key":"roleId",columns:E.value,datasource:m,"show-overflow-tooltip":!0,selections:d.value,"onUpdate:selections":e[2]||(e[2]=s=>d.value=s),"highlight-current-row":!0,"export-config":{fileName:"角色数据"},"cache-key":"systemRoleTable"},{toolbar:o(()=>[t(l,{type:"primary",class:"ele-btn-icon",icon:v(X),onClick:e[0]||(e[0]=s=>x())},{default:o(()=>e[5]||(e[5]=[b(" 新建 ")])),_:1},8,["icon"]),t(l,{type:"danger",class:"ele-btn-icon",icon:v(Y),onClick:e[1]||(e[1]=s=>g())},{default:o(()=>e[6]||(e[6]=[b(" 删除 ")])),_:1},8,["icon"])]),action:o(({row:s})=>[t(n,{type:"primary",underline:!1,onClick:N=>x(s)},{default:o(()=>e[7]||(e[7]=[b(" 修改 ")])),_:2},1032,["onClick"]),t(u,{direction:"vertical"}),t(n,{type:"primary",underline:!1,onClick:N=>V(s)},{default:o(()=>e[8]||(e[8]=[b(" 分配权限 ")])),_:2},1032,["onClick"]),t(u,{direction:"vertical"}),t(n,{type:"danger",underline:!1,onClick:N=>g(s)},{default:o(()=>e[9]||(e[9]=[b(" 删除 ")])),_:2},1032,["onClick"])]),_:1},8,["columns","selections"])]),_:1}),t(fe,{modelValue:i.value,"onUpdate:modelValue":e[3]||(e[3]=s=>i.value=s),data:p.value,onDone:r},null,8,["modelValue","data"]),t(ge,{modelValue:c.value,"onUpdate:modelValue":e[4]||(e[4]=s=>c.value=s),data:p.value},null,8,["modelValue","data"])]),_:1})}}});export{De as default};
