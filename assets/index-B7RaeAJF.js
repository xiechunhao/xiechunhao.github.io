import{L as q,r as f,J as M,R as k,W as T,U as H,o as S,m as C,e as s,a6 as O,a8 as L,a as Q,c as B,w as d,b as t,aG as F,F as N,aI as A,aH as D,aJ as G,aK as J,aT as W,aL as j}from"./index-C4BxmZrN.js";import{i as K}from"./index-CkGVv88Q.js";import{E as X}from"./input-number-B8T5Eosy.js";import{E as Y}from"./slider-BqvnbqLi.js";import{q as Z,a as ee,b as le,E as te,g as ae,e as ne,S as oe,c as se,i as ie}from"./index-CJjyc4ww.js";import{i as de}from"./index-DSHqkOzX.js";import"./index-dVmM0e8c.js";const ue=q({name:"EleQrCode",props:Z,emits:ee,setup(a,{emit:v}){const u=f(null),c=f(null),i=M(()=>{var l;return(l=a.imageSettings)==null?void 0:l.src}),x=M(()=>{const l=[{height:`${a.size}px`,width:`${a.size}px`}];return a.customStyle!=null&&l.push(a.customStyle),l}),r=()=>{const{value:l,size:h,level:z,bgColor:R,fgColor:w,margin:e,imageSettings:U}=a;if(u.value==null)return;const y=u.value,m=y.getContext("2d");if(!m)return;if(!l){m.clearRect(0,0,y.width,y.height);return}let o=le.QrCode.encodeText(l,te[z]).getModules();const _=o.length+e*2,g=ae(U,h,e,o),p=c.value,b=g!=null&&p!=null&&p.complete&&p.naturalHeight!==0&&p.naturalWidth!==0;b&&g.excavation!=null&&(o=ne(o,g.excavation));const V=window.devicePixelRatio||1;y.height=y.width=h*V;const E=h/_*V;m.scale(E,E),m.fillStyle=R,m.fillRect(0,0,_,_),m.fillStyle=w,oe?m.fill(new Path2D(se(o,e))):o.forEach(function($,I){$.forEach(function(n,P){n&&m.fillRect(P+e,I+e,1,1)})}),b&&m.drawImage(p,g.x+e,g.y+e,g.w,g.h),v("done")};return k([()=>a.value,()=>a.level,()=>a.bgColor,()=>a.fgColor,()=>a.margin],()=>{r()}),k(()=>a.size,()=>{T(()=>{r()})}),k(()=>a.imageSettings,()=>{r()},{deep:!0}),H(()=>{r()}),{canvasRef:u,imageRef:c,imageSrc:i,canvasStyle:x,render:r}}}),me=(a,v)=>{const u=a.__vccOpts||a;for(const[c,i]of v)u[c]=i;return u},re={class:"ele-qr-code"},ce=["height","width"],ve=["src"];function ge(a,v,u,c,i,x){return S(),C("span",re,[s("canvas",{ref:"canvasRef",height:a.size,width:a.size,style:O(a.canvasStyle)},null,12,ce),a.imageSrc?(S(),C("img",{key:0,ref:"imageRef",src:a.imageSrc,style:{display:"none"},onLoad:v[0]||(v[0]=(...r)=>a.render&&a.render(...r))},null,40,ve)):L("",!0)])}const _e=me(ue,[["render",ge]]),pe={style:{display:"flex","flex-wrap":"wrap"}},fe={style:{margin:"0 10px 20px 10px"}},xe=s("div",{style:{"margin-bottom":"8px"}},"canvas 渲染",-1),he={style:{margin:"0 10px 20px 10px"}},ye=s("div",{style:{"margin-bottom":"8px"}},"svg 渲染",-1),Ve={style:{display:"flex","flex-wrap":"wrap"}},we={style:{width:"120px","margin-right":"16px"}},be={style:{width:"120px"}},Se={key:0,style:{display:"flex","flex-wrap":"wrap"}},Ee={style:{display:"flex","align-items":"center"}},Ce=s("div",{style:{padding:"0 12px"}},"x",-1),ze={style:{width:"120px"}},Re={style:{display:"flex","align-items":"center"}},Ue=s("div",{style:{padding:"0 12px"}},"y",-1),$e={style:{width:"120px"}},Ie={name:"ExtensionQrCode"},Oe=Object.assign(Ie,{setup(a){const v="https://cdn.eleadmin.com/20200610/logo-radius.png",u=f("https://eleadmin.com"),c=f("L"),i=f(120),x=f(0),r=f(!0),l=Q({src:v,width:28,height:28,x:void 0,y:void 0,excavate:!1}),h=f(!0),z=w=>{w?l.src=v:l.src=void 0},R=w=>{w?(l.x=void 0,l.y=void 0):(l.x=0,l.y=0)};return(w,e)=>{const U=_e,y=ie,m=A,o=D,_=G,g=J,p=Y,b=W,V=X,E=j,$=K,I=de;return S(),B(I,{"multi-card":!0},{default:d(()=>[t($,{header:"基础用法"},{default:d(()=>[s("div",pe,[s("div",fe,[xe,t(U,{value:u.value,size:i.value,level:c.value,margin:x.value,"image-settings":l},null,8,["value","size","level","margin","image-settings"])]),s("div",he,[ye,t(y,{value:u.value,size:i.value,level:c.value,margin:x.value,"image-settings":l},null,8,["value","size","level","margin","image-settings"])])]),t(E,{"label-width":"88px",style:{"max-width":"420px"},onSubmit:e[12]||(e[12]=F(()=>{},["prevent"]))},{default:d(()=>[t(o,{label:"二维码内容"},{default:d(()=>[t(m,{modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n),maxlength:150},null,8,["modelValue"])]),_:1}),t(o,{label:"容错等级"},{default:d(()=>[t(g,{modelValue:c.value,"onUpdate:modelValue":e[1]||(e[1]=n=>c.value=n),class:"ele-fluid"},{default:d(()=>[t(_,{value:"L",label:"L"}),t(_,{value:"M",label:"M"}),t(_,{value:"Q",label:"Q"}),t(_,{value:"H",label:"H"})]),_:1},8,["modelValue"])]),_:1}),t(o,{label:"尺寸"},{default:d(()=>[t(p,{modelValue:i.value,"onUpdate:modelValue":e[2]||(e[2]=n=>i.value=n),min:80,max:280,step:40},null,8,["modelValue"])]),_:1}),t(o,{label:"间距"},{default:d(()=>[t(p,{modelValue:x.value,"onUpdate:modelValue":e[3]||(e[3]=n=>x.value=n),min:0,max:20},null,8,["modelValue"])]),_:1}),t(o,{label:"自定义图片"},{default:d(()=>[t(b,{modelValue:r.value,"onUpdate:modelValue":e[4]||(e[4]=n=>r.value=n),size:"small",onChange:z},null,8,["modelValue"])]),_:1}),r.value?(S(),C(N,{key:0},[t(o,{label:"图片地址"},{default:d(()=>[t(m,{modelValue:l.src,"onUpdate:modelValue":e[5]||(e[5]=n=>l.src=n),maxlength:400},null,8,["modelValue"])]),_:1}),t(o,{label:"图片宽高"},{default:d(()=>[s("div",Ve,[s("div",we,[t(V,{modelValue:l.width,"onUpdate:modelValue":e[6]||(e[6]=n=>l.width=n),size:"small",min:0,max:i.value},null,8,["modelValue","max"])]),s("div",be,[t(V,{modelValue:l.height,"onUpdate:modelValue":e[7]||(e[7]=n=>l.height=n),size:"small",min:0,max:i.value},null,8,["modelValue","max"])])])]),_:1}),t(o,{label:"位置居中"},{default:d(()=>[s("div",null,[t(b,{modelValue:h.value,"onUpdate:modelValue":e[8]||(e[8]=n=>h.value=n),size:"small",onChange:R},null,8,["modelValue"]),h.value?L("",!0):(S(),C("div",Se,[s("div",Ee,[Ce,s("div",ze,[t(V,{modelValue:l.x,"onUpdate:modelValue":e[9]||(e[9]=n=>l.x=n),size:"small",min:0,max:i.value},null,8,["modelValue","max"])])]),s("div",Re,[Ue,s("div",$e,[t(V,{modelValue:l.y,"onUpdate:modelValue":e[10]||(e[10]=n=>l.y=n),size:"small",min:0,max:i.value},null,8,["modelValue","max"])])])]))])]),_:1}),t(o,{label:"背景擦除"},{default:d(()=>[t(b,{modelValue:l.excavate,"onUpdate:modelValue":e[11]||(e[11]=n=>l.excavate=n),size:"small"},null,8,["modelValue"])]),_:1})],64)):L("",!0)]),_:1})]),_:1})]),_:1})}}});export{Oe as default};
