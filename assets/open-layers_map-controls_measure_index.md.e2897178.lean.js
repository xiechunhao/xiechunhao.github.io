import{b_ as _,b$ as S,M as L,V as P,P as h,c0 as x}from"./chunks/reproj.9b488601.js";import{A as V,M as G}from"./chunks/index.a511ac44.js";import{X as N}from"./chunks/XYZ.94b2552a.js";import{O as w}from"./chunks/Overlay.99996f63.js";import{D as O}from"./chunks/Draw.15ac7265.js";import{S as v,F as A,a as E,C as b,V as H}from"./chunks/Vector.e7fd2c77.js";import{V as I}from"./chunks/Vector.ef038271.js";import{T as j}from"./chunks/TileImage.70f39159.js";import{L as q}from"./chunks/LineString.2b94a2e9.js";import{d as U,a2 as z,p as K,a3 as R,D as m,o as i,c as d,z as F,a as M,G as g,B as Z,F as X,L as $,A as Y,_ as J,O as Q}from"./chunks/framework.873b9d65.js";import"./chunks/Circle.fe3ab237.js";import"./chunks/GeometryCollection.bd3c0be4.js";import"./chunks/MultiLineString.f00700b3.js";function W({helpTooltipElement:n,map:l}){n&&n.parentNode&&n.parentNode.removeChild(n);const a=document.createElement("div");a.className="tooltip hidden";const s=new w({element:a,offset:[15,0],positioning:"center-left"});return l.addOverlay(s),[a,s]}function T({measureTooltipElement:n,map:l}){n&&n.parentNode&&n.parentNode.removeChild(n);const a=document.createElement("div");a.className="tooltip tooltip-measure";const s=new w({element:a,offset:[0,-15],positioning:"bottom-center"});return l.addOverlay(s),[a,s]}function ss({checked:n,line:l,map:a}){let s;if(n){const c=a.getView().getProjection();s=_(l,{projection:c,radius:6378137})}else s=Math.round(l.getLength()*100)/100;let p;return s>100?p=Math.round(s/1e3*100)/100+" km":p=Math.round(s*100)/100+" m",p}function ns({checked:n,polygon:l,map:a}){let s;if(n){const c=a.getView().getProjection(),f=l.clone().transform(c,"EPSG:4326");s=Math.abs(S(f,{projection:c,radius:6378137}))}else s=l.getArea();let p;return s>1e4?p=Math.round(s/1e6*100)/100+" km<sup>2</sup>":p=Math.round(s*100)/100+" m<sup>2</sup>",p}function as({source:n,type:l}){return new O({source:n,type:l,style:new v({fill:new A({color:"rgba(255, 255, 255, 0.2)"}),stroke:new E({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new b({radius:5,stroke:new E({color:"rgba(0, 0, 0, 0.7)"}),fill:new A({color:"rgba(255, 255, 255, 0.2)"})})})})}function ls(n){return new I({source:n,style:new v({fill:new A({color:"rgba(255, 255, 255, 0.2)"}),stroke:new E({color:"#ffcc33",width:2}),image:new b({radius:7,fill:new A({color:"#ffcc33"})})})})}const os={id:"map"},ps={id:"menu"},ts="单击继续绘制多边形",es="单击继续绘制直线",cs=U({__name:"index",setup(n){const l=new j({source:new N({attributions:V,url:G,maxZoom:20})}),a=new H,s=z({checked:!1,typeSelect:"length",options:[{label:"长度",value:"length"},{label:"面积",value:"area"}],map:null,sketch:null,helpTooltipElement:null,helpTooltip:null,measureTooltipElement:null,measureTooltip:null,draw:null}),p=()=>{s.map=new L({target:"map",layers:[l],view:new P({projection:"EPSG:4326",center:[0,0],zoom:5})})},c=()=>{if(s.map===null)return;const e=ls(a);s.map.addLayer(e)},f=e=>{if(e.dragging)return;let o="单击开始绘图";if(s.sketch){const r=s.sketch.getGeometry();r instanceof h?o=ts:r instanceof q&&(o=es)}s.helpTooltipElement===null||s.helpTooltip===null||(s.helpTooltipElement.innerHTML=o,s.helpTooltip.setPosition(e.coordinate),s.helpTooltipElement.classList.remove("hidden"))},B=()=>{if(s.map===null)return;const e=s.typeSelect==="area"?"Polygon":"LineString";s.draw=as({source:a,type:e}),s.map.addInteraction(s.draw),[s.measureTooltipElement,s.measureTooltip]=T({measureTooltipElement:s.measureTooltipElement,map:s.map}),[s.helpTooltipElement,s.helpTooltip]=W({helpTooltipElement:s.helpTooltipElement,map:s.map});let o;s.draw.on("drawstart",function(r){s.sketch=r.feature;let D;const C=s.sketch.getGeometry();C&&(o=C.on("change",function(t){if(s.map===null)return;const y=t.target;let u="";y instanceof h?(u=ns({checked:s.checked,polygon:y,map:s.map}),D=y.getInteriorPoint().getCoordinates()):y instanceof q&&(u=ss({checked:s.checked,line:y,map:s.map}),D=y.getLastCoordinate()),s.measureTooltipElement&&(s.measureTooltipElement.innerHTML=u),s.measureTooltip&&s.measureTooltip.setPosition(D)}))}),s.draw.on("drawend",function(){s.measureTooltipElement!==null&&s.measureTooltip!==null&&s.map!==null&&(s.measureTooltipElement.className="tooltip tooltip-static",s.measureTooltip.setOffset([0,-7]),s.sketch=null,s.measureTooltipElement=null,[s.measureTooltipElement,s.measureTooltip]=T({measureTooltipElement:s.measureTooltipElement,map:s.map}),x(o))})},k=()=>{s.map===null||s.draw===null||(s.map.removeInteraction(s.draw),B())};return K(()=>{p(),c(),s.map&&(s.map.on("pointermove",f),s.map.getViewport().addEventListener("mouseout",()=>{s.helpTooltipElement&&s.helpTooltipElement.classList.add("hidden")})),B()}),R(()=>{s.map&&(s.map.dispose(),s.map=null)}),(e,o)=>{const r=m("el-option"),D=m("el-select"),C=m("el-checkbox");return i(),d("div",os,[F("div",ps,[M(" 几何体类型 "),g(D,{modelValue:s.typeSelect,"onUpdate:modelValue":o[0]||(o[0]=t=>s.typeSelect=t),placeholder:"Select",size:"small",onChange:k,class:"select"},{default:Z(()=>[(i(!0),d(X,null,$(s.options,t=>(i(),Y(r,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),g(C,{modelValue:s.checked,"onUpdate:modelValue":o[1]||(o[1]=t=>s.checked=t),label:"使用测地线的措施",size:"large"},null,8,["modelValue"])])])}}});const rs=J(cs,[["__scopeId","data-v-73d4629a"]]),ys=F("h1",{id:"测量",tabindex:"-1"},[M("测量 "),F("a",{class:"header-anchor",href:"#测量","aria-label":'Permalink to "测量"'},"​")],-1),Fs=F("div",{class:"tip custom-block"},[F("p",{class:"custom-block-title"},"TIP"),F("p",null,"单击开始绘图。左下角可以选择几何体的类型和是否使用测地线的措施。")],-1),Ds=Q("",4),vs=JSON.parse('{"title":"测量","description":"","frontmatter":{},"headers":[],"relativePath":"open-layers/map-controls/measure/index.md","filePath":"open-layers/map-controls/measure/index.md","lastUpdated":1687662745000}'),Cs={name:"open-layers/map-controls/measure/index.md"},bs=Object.assign(Cs,{setup(n){return(l,a)=>(i(),d("div",null,[ys,Fs,g(rs),Ds]))}});export{vs as __pageData,bs as default};
