import{i as se}from"./index-p1XoTQj1.js";import{b4 as H,o as g,c as V,w as t,b as e,cM as re,aF as J,u as o,e as b,aH as P,aG as G,aB as K,aK as L,r as C,fo as Q,E as O,a6 as Z,fN as R,g as W,a as ue,O as pe,fO as $,Q as B,a7 as F,d as j,t as A,aN as me,q as ce,j as X,i as fe,aS as _e,aD as ye,bD as be,dZ as ge,fP as Ve,aV as ve,k as he,ax as xe}from"./index-BF2fBoPb.js";import{i as Y}from"./index-Cjr4ibGp.js";import{i as Te}from"./index-DG03PXF-.js";import"./index-CcYpqHDV.js";import"./index-B-b3I1wI.js";import"./index-BnIMXyIx.js";import"./virtual-list-B6G0p9cv.js";import"./index-BWYZqqjh.js";import"./index-DuliLu7F.js";import{E as ee,a as le}from"./col-DirwGu8S.js";import{E as ke}from"./input-number-DNV7vLKM.js";import"./tree-B2uMWqdF.js";import{E as Ie}from"./tree-select-u-xVs2-A.js";import{l as te,u as Ee,a as Ce,r as Ne}from"./index-B7rDDQJg.js";import"./index-BFNslPul.js";import{i as Ue}from"./index-ee9OCFOz.js";import"./isArrayLikeObject-j402kJv_.js";import"./vuedraggable.umd-DLnsjw3h.js";import"./index-DOwINDGR.js";const we={__name:"menu-search",emits:["search"],setup(v,{emit:f}){const k=f,[i,_]=H({title:"",path:"",authority:""}),m=()=>{k("search",{...i})},I=()=>{_(),m()};return(l,u)=>{const M=P,N=G,U=ee,w=K,d=le,a=L,h=Y;return g(),V(h,{"body-style":{paddingBottom:"2px"}},{default:t(()=>[e(a,{"label-width":"72px",onKeyup:re(m,["enter"]),onSubmit:u[3]||(u[3]=J(()=>{},["prevent"]))},{default:t(()=>[e(d,{gutter:8},{default:t(()=>[e(U,{lg:6,md:12,sm:12,xs:24},{default:t(()=>[e(N,{label:"菜单名称"},{default:t(()=>[e(M,{clearable:"",modelValue:o(i).title,"onUpdate:modelValue":u[0]||(u[0]=x=>o(i).title=x),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),e(U,{lg:6,md:12,sm:12,xs:24},{default:t(()=>[e(N,{label:"菜单地址"},{default:t(()=>[e(M,{clearable:"",modelValue:o(i).path,"onUpdate:modelValue":u[1]||(u[1]=x=>o(i).path=x),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),e(U,{lg:6,md:12,sm:12,xs:24},{default:t(()=>[e(N,{label:"权限标识"},{default:t(()=>[e(M,{clearable:"",modelValue:o(i).authority,"onUpdate:modelValue":u[2]||(u[2]=x=>o(i).authority=x),modelModifiers:{trim:!0},placeholder:"请输入"},null,8,["modelValue"])]),_:1})]),_:1}),e(U,{lg:6,md:12,sm:12,xs:24},{default:t(()=>[e(N,{"label-width":"16px"},{default:t(()=>[e(w,{type:"primary",onClick:m},{default:t(()=>u[4]||(u[4]=[b("查询")])),_:1}),e(w,{onClick:I},{default:t(()=>u[5]||(u[5]=[b("重置")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})}}},Me={__name:"menu-select",props:{modelValue:[Number,String],placeholder:{type:String,default:"请选择上级菜单"}},emits:["update:modelValue"],setup(v,{emit:f}){const k=f,i=C([]),_=m=>{k("update:modelValue",m||0)};return te().then(m=>{i.value=Q({data:m,idField:"menuId",parentIdField:"parentId"})}).catch(m=>{O.error(m.message)}),(m,I)=>{const l=Ie;return g(),V(l,{clearable:"",filterable:"",data:i.value,"check-strictly":"","default-expand-all":"","node-key":"menuId",props:{label:"title"},placeholder:v.placeholder,"model-value":v.modelValue||void 0,class:"ele-fluid","onUpdate:modelValue":_},null,8,["data","placeholder","model-value"])}}},Oe={components:R,data(){const v=Object.keys(R);return{iconData:[{title:"线框风格",icons:v.filter(f=>!f.endsWith("Filled"))},{title:"实底风格",icons:v.filter(f=>f.endsWith("Filled"))}]}}},Se=Object.assign(Oe,{__name:"icon-select",props:{modelValue:String,disabled:Boolean,placeholder:{type:String,default:"请选择菜单图标"}},emits:["update:modelValue"],setup(v,{emit:f}){const k=f,i=_=>{k("update:modelValue",_)};return(_,m)=>{const I=W,l=Ue;return g(),V(l,{clearable:"",filterable:"popper",data:_.iconData,"model-value":v.modelValue,placeholder:v.placeholder,disabled:v.disabled,"popper-width":420,"popper-height":294,"grid-style":{gridTemplateColumns:"repeat(6, 1fr)"},"item-style":{height:"52px"},"onUpdate:modelValue":i},{icon:t(({icon:u})=>[e(I,null,{default:t(()=>[(g(),V(Z(u)))]),_:2},1024)]),_:1},8,["data","model-value","placeholder","disabled"])}}}),$e={__name:"menu-edit",props:{modelValue:Boolean,data:Object,parentId:Number},emits:["done","update:modelValue"],setup(v,{emit:f}){const k=f,i=v,_=C(!1),m=C(!1),I=C(null),[l,u,M]=H({menuId:void 0,parentId:void 0,title:"",menuType:0,openType:0,icon:"",path:"",component:"",authority:"",sortNumber:void 0,hide:0,meta:""}),N=ue({title:[{required:!0,type:"string",message:"请输入菜单名称",trigger:"blur"}],sortNumber:[{required:!0,type:"number",message:"请输入排序号",trigger:"blur"}],meta:[{type:"string",validator:(r,n,s)=>{if(n){const T="请输入正确的JSON格式";try{const y=JSON.parse(n);if(y==null||typeof y!="object")return s(T)}catch(y){return s(T)}}s()},trigger:"blur"}]}),U=()=>{var r,n;(n=(r=I.value)==null?void 0:r.validate)==null||n.call(r,s=>{if(!s)return;m.value=!0,(_.value?Ee:Ce)({...l,menuType:l.menuType===2?1:0,parentId:l.parentId||0}).then(y=>{m.value=!1,O.success(y),w(!1),k("done")}).catch(y=>{m.value=!1,O.error(y.message)})})},w=r=>{k("update:modelValue",r)},d=()=>{l.menuType===0?(l.authority="",l.openType=0,l.component=""):l.menuType===1?l.openType===2&&(l.authority=""):(l.openType=0,l.icon="",l.path="",l.component="",l.hide=0)},a=()=>{l.openType===2&&(l.component="",l.authority="")},h=r=>{l.hide=r?0:1},x=r=>{var n;return!!((n=r.children)!=null&&n.length)&&!r.component};return pe(()=>i.modelValue,r=>{var n,s;if(r)if(i.data){const T=$(i.data.path),y=$(i.data.component),E=i.data.menuType===1?2:x(i.data)?0:1;M({...i.data,menuType:E,openType:T?2:y?1:0,parentId:i.data.parentId===0?void 0:i.data.parentId}),_.value=!0}else l.parentId=i.parentId,_.value=!1;else u(),(s=(n=I.value)==null?void 0:n.clearValidate)==null||s.call(n)}),(r,n)=>{const s=G,T=P,y=ee,E=me,c=ce,S=le,oe=X,D=W,z=fe,ae=ke,ne=_e,de=L,q=K,ie=ye;return g(),V(ie,{form:"",width:740,"model-value":v.modelValue,title:_.value?"修改菜单":"新建菜单","onUpdate:modelValue":w},{footer:t(()=>[e(q,{onClick:n[11]||(n[11]=p=>w(!1))},{default:t(()=>n[12]||(n[12]=[b("取消")])),_:1}),e(q,{type:"primary",loading:m.value,onClick:U},{default:t(()=>n[13]||(n[13]=[b(" 保存 ")])),_:1},8,["loading"])]),default:t(()=>[e(de,{ref_key:"formRef",ref:I,model:o(l),rules:N,"label-width":"92px",onSubmit:n[10]||(n[10]=J(()=>{},["prevent"]))},{default:t(()=>[e(S,{gutter:16},{default:t(()=>[e(y,{sm:12,xs:24},{default:t(()=>[e(s,{label:"上级菜单",prop:"parentId"},{default:t(()=>[e(Me,{modelValue:o(l).parentId,"onUpdate:modelValue":n[0]||(n[0]=p=>o(l).parentId=p)},null,8,["modelValue"])]),_:1}),e(s,{label:"菜单名称",prop:"title"},{default:t(()=>[e(T,{clearable:"",maxlength:20,modelValue:o(l).title,"onUpdate:modelValue":n[1]||(n[1]=p=>o(l).title=p),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1})]),_:1}),e(y,{sm:12,xs:24},{default:t(()=>[e(s,{label:"菜单类型",prop:"menuType"},{default:t(()=>[e(c,{modelValue:o(l).menuType,"onUpdate:modelValue":n[2]||(n[2]=p=>o(l).menuType=p),onChange:d},{default:t(()=>[e(E,{value:0,label:"目录"}),e(E,{value:1,label:"菜单"}),e(E,{value:2,label:"按钮"})]),_:1},8,["modelValue"])]),_:1}),e(s,{label:"打开方式"},{default:t(()=>[e(c,{modelValue:o(l).openType,"onUpdate:modelValue":n[3]||(n[3]=p=>o(l).openType=p),disabled:o(l).menuType===0||o(l).menuType===2,onChange:a},{default:t(()=>[e(E,{value:0,label:"组件"}),e(E,{value:1,label:"内链"}),e(E,{value:2,label:"外链"})]),_:1},8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),e(oe,{style:{margin:"8px 0 22px 0",opacity:"0.6"}}),e(S,{gutter:16},{default:t(()=>[e(y,{sm:12,xs:24},{default:t(()=>[e(s,{label:"菜单图标",prop:"icon"},{default:t(()=>[e(Se,{modelValue:o(l).icon,"onUpdate:modelValue":n[4]||(n[4]=p=>o(l).icon=p),disabled:o(l).menuType===2},null,8,["modelValue","disabled"])]),_:1}),e(s,{prop:"path"},{label:t(()=>[o(l).openType===2?(g(),V(z,{key:0,content:"需要以`http://`、`https://`、`//`开头"},{default:t(()=>[e(D,{size:15,style:{"align-self":"center","margin-right":"4px",cursor:"help"}},{default:t(()=>[e(o(B),{style:{opacity:"0.6"}})]),_:1})]),_:1})):F("",!0),j("span",null,A(o(l).openType===2?"外链地址":"路由地址"),1)]),default:t(()=>[e(T,{clearable:"",maxlength:100,modelValue:o(l).path,"onUpdate:modelValue":n[5]||(n[5]=p=>o(l).path=p),disabled:o(l).menuType===2,placeholder:o(l).openType===2?"请输入外链地址":"请输入路由地址"},null,8,["modelValue","disabled","placeholder"])]),_:1}),e(s,{prop:"component"},{label:t(()=>[o(l).openType===1?(g(),V(z,{key:0,content:"需要以`http://`、`https://`、`//`开头"},{default:t(()=>[e(D,{size:15,style:{"align-self":"center","margin-right":"4px",cursor:"help"}},{default:t(()=>[e(o(B),{style:{opacity:"0.6"}})]),_:1})]),_:1})):F("",!0),j("span",null,A(o(l).openType===1?"内链地址":"组件路径"),1)]),default:t(()=>[e(T,{clearable:"",maxlength:100,modelValue:o(l).component,"onUpdate:modelValue":n[6]||(n[6]=p=>o(l).component=p),disabled:o(l).menuType===0||o(l).menuType===2||o(l).openType===2,placeholder:o(l).openType===1?"请输入内链地址":"请输入组件路径"},null,8,["modelValue","disabled","placeholder"])]),_:1})]),_:1}),e(y,{sm:12,xs:24},{default:t(()=>[e(s,{label:"权限标识",prop:"authority"},{default:t(()=>[e(T,{clearable:"",modelValue:o(l).authority,"onUpdate:modelValue":n[7]||(n[7]=p=>o(l).authority=p),placeholder:"请输入权限标识",disabled:o(l).menuType===0||o(l).menuType===1&&o(l).openType===2},null,8,["modelValue","disabled"])]),_:1}),e(s,{label:"排序号",prop:"sortNumber"},{default:t(()=>[e(ae,{min:0,max:99999,modelValue:o(l).sortNumber,"onUpdate:modelValue":n[8]||(n[8]=p=>o(l).sortNumber=p),placeholder:"请输入排序号","controls-position":"right",class:"ele-fluid"},null,8,["modelValue"])]),_:1}),e(s,{label:"是否展示"},{default:t(()=>[e(ne,{"inline-prompt":"","active-text":"是","inactive-text":"否","model-value":o(l).hide===0,disabled:o(l).menuType===2,onChange:h},null,8,["model-value","disabled"]),e(z,{content:"选择不展示只注册路由不展示在侧边栏, 比如添加页面应该选择不展示","popper-style":{maxWidth:"240px"}},{default:t(()=>[e(D,{size:15,style:{"margin-left":"16px",cursor:"help"}},{default:t(()=>[e(o(B),{style:{opacity:"0.6"}})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e(s,{label:"路由元数据",prop:"meta"},{default:t(()=>[e(T,{rows:4,type:"textarea",maxlength:200,modelValue:o(l).meta,"onUpdate:modelValue":n[9]||(n[9]=p=>o(l).meta=p),placeholder:"请输入JSON格式的路由元数据"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["model-value","title"])}}},Fe={name:"SystemMenu",components:R},tl=Object.assign(Fe,{setup(v){const f=C(null),k=C([{type:"index",columnKey:"index",width:50,align:"center",fixed:"left"},{prop:"title",label:"菜单名称",slot:"title",minWidth:160},{prop:"path",label:"路由地址",minWidth:110},{prop:"sortNumber",label:"排序",width:100,align:"center"},{prop:"hide",label:"可见",width:100,align:"center",formatter:d=>["是","否"][d.hide]},{prop:"menuType",label:"类型",width:100,align:"center",slot:"menuType"},{columnKey:"action",label:"操作",width:180,align:"center",slot:"action",hideInPrint:!0,hideInExport:!0}]),i=C(null),_=C(!1),m=C(),I=async({where:d})=>{const a=await te({...d});return Q({data:a,idField:"menuId",parentIdField:"parentId"})},l=d=>{var a,h;(h=(a=f.value)==null?void 0:a.reload)==null||h.call(a,{where:d})},u=(d,a)=>{i.value=d!=null?d:null,m.value=a,_.value=!0},M=d=>{var a;if((a=d.children)!=null&&a.length){O.error("请先删除子节点");return}ve.confirm("确定要删除“"+d.title+"”吗?","系统提示",{type:"warning",draggable:!0}).then(()=>{const h=O.loading("请求中..");Ne(d.menuId).then(x=>{h.close(),O.success(x),l()}).catch(x=>{h.close(),O.error(x.message)})}).catch(()=>{})},N=()=>{var d,a;(a=(d=f.value)==null?void 0:d.toggleRowExpansionAll)==null||a.call(d,!0)},U=()=>{var d,a;(a=(d=f.value)==null?void 0:d.toggleRowExpansionAll)==null||a.call(d,!1)},w=d=>{var a;return!!((a=d.children)!=null&&a.length)&&!d.component};return(d,a)=>{const h=K,x=W,r=he,n=xe,s=X,T=Te,y=Y,E=se;return g(),V(E,null,{default:t(()=>[e(we,{onSearch:l}),e(y,{"body-style":{paddingTop:"8px"}},{default:t(()=>[e(T,{sticky:"",ref_key:"tableRef",ref:f,"row-key":"menuId",columns:k.value,datasource:I,"show-overflow-tooltip":!0,"highlight-current-row":!0,"export-config":{fileName:"菜单数据"},"default-expand-all":!1,pagination:!1,"cache-key":"systemMenuTable"},{toolbar:t(()=>[e(h,{type:"primary",class:"ele-btn-icon",icon:o(be),onClick:a[0]||(a[0]=c=>u())},{default:t(()=>a[2]||(a[2]=[b(" 新建 ")])),_:1},8,["icon"]),e(h,{class:"ele-btn-icon",icon:o(ge),onClick:N},{default:t(()=>a[3]||(a[3]=[b(" 展开全部 ")])),_:1},8,["icon"]),e(h,{class:"ele-btn-icon",icon:o(Ve),onClick:U},{default:t(()=>a[4]||(a[4]=[b(" 折叠全部 ")])),_:1},8,["icon"])]),title:t(({row:c})=>[c.icon?(g(),V(x,{key:0,size:15,style:{"margin-right":"8px","vertical-align":"-2px"}},{default:t(()=>[(g(),V(Z(c.icon)))]),_:2},1024)):F("",!0),j("span",null,A(c.title),1)]),menuType:t(({row:c})=>[o($)(c.path)?(g(),V(r,{key:0,size:"small",type:"danger","disable-transitions":!0},{default:t(()=>a[5]||(a[5]=[b(" 外链 ")])),_:1})):o($)(c.component)?(g(),V(r,{key:1,size:"small",type:"warning","disable-transitions":!0},{default:t(()=>a[6]||(a[6]=[b(" 内链 ")])),_:1})):w(c)?(g(),V(r,{key:2,size:"small","disable-transitions":!0},{default:t(()=>a[7]||(a[7]=[b(" 目录 ")])),_:1})):c.menuType===0?(g(),V(r,{key:3,size:"small",type:"success","disable-transitions":!0},{default:t(()=>a[8]||(a[8]=[b(" 菜单 ")])),_:1})):c.menuType===1?(g(),V(r,{key:4,size:"small",type:"info","disable-transitions":!0},{default:t(()=>a[9]||(a[9]=[b(" 按钮 ")])),_:1})):F("",!0)]),action:t(({row:c})=>[e(n,{type:"primary",underline:!1,onClick:S=>u(null,c.menuId)},{default:t(()=>a[10]||(a[10]=[b(" 添加 ")])),_:2},1032,["onClick"]),e(s,{direction:"vertical"}),e(n,{type:"primary",underline:!1,onClick:S=>u(c)},{default:t(()=>a[11]||(a[11]=[b(" 修改 ")])),_:2},1032,["onClick"]),e(s,{direction:"vertical"}),e(n,{type:"danger",underline:!1,onClick:S=>M(c)},{default:t(()=>a[12]||(a[12]=[b(" 删除 ")])),_:2},1032,["onClick"])]),_:1},8,["columns"])]),_:1}),e($e,{modelValue:_.value,"onUpdate:modelValue":a[1]||(a[1]=c=>_.value=c),data:i.value,"parent-id":m.value,onDone:l},null,8,["modelValue","data","parent-id"])]),_:1})}}});export{tl as default};
