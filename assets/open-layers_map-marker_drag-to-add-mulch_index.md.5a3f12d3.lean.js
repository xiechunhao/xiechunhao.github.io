import{A as q,M as x}from"../js/index/index.47495de9.js";import{e as w,f as b,S,A as P,E as I,T as k,X as M,V as L,a as T,M as V,H as U,c as O,i as X,k as N,O as R}from"../js/ol@7.4.0@ol/ol@7.4.0@ol.2a99620d.js";import{D as Y,n as G,v as j,o as D,c as C,a as p,F as u,S as Z,j as $,N as z,a0 as H}from"../js/@vue_runtime-core@3.3.4@@vue/@vue_runtime-core@3.3.4@@vue.35efc880.js";import{k as m}from"../js/@vue_reactivity@3.3.4@@vue/@vue_reactivity@3.3.4@@vue.e6fc7fe8.js";import{_ as J}from"./app.f296b152.js";import"../js/earcut@2.2.4@earcut/earcut@2.2.4@earcut.e6a9c857.js";import"../js/rbush@3.0.1@rbush/rbush@3.0.1@rbush.75a05972.js";import"../js/quickselect@2.0.0@quickselect/quickselect@2.0.0@quickselect.f3892974.js";import"../js/@vue_shared@3.3.4@@vue/@vue_shared@3.3.4@@vue.5a5848fd.js";import"../js/@docsearch_css@3.5.1@@docsearch/@docsearch_css@3.5.1@@docsearch.4ed993c7.js";import"../js/body-scroll-lock@4.0.0-beta.0@body-scroll-lock/body-scroll-lock@4.0.0-beta.0@body-scroll-lock.e1f8a6eb.js";import"../js/geotiff@2.0.7@geotiff/geotiff@2.0.7@geotiff.101896b7.js";import"../js/@vue_runtime-dom@3.3.4@@vue/@vue_runtime-dom@3.3.4@@vue.5dd85bb5.js";import"../js/@vueuse_core@10.2.0@@vueuse/@vueuse_core@10.2.0@@vueuse.8a5d8129.js";import"../js/@vueuse_shared@10.2.0@@vueuse/@vueuse_shared@10.2.0@@vueuse.9afec68c.js";import"../js/es/element-plus@2.3.7@element-plus.9cf0a975.js";import"../js/lodash-es@4.17.21@lodash-es/lodash-es@4.17.21@lodash-es.36eb724a.js";import"../js/@vueuse_core@9.13.0@@vueuse/@vueuse_core@9.13.0@@vueuse.604f33c6.js";import"../js/@vueuse_shared@9.13.0@@vueuse/@vueuse_shared@9.13.0@@vueuse.740d90d5.js";import"../js/@element-plus_icons-vue@2.1.0@@element-plus/@element-plus_icons-vue@2.1.0@@element-plus.1b5ed4e9.js";import"../js/@sxzz_popperjs-es@2.11.7@@sxzz/@sxzz_popperjs-es@2.11.7@@sxzz.c75af06c.js";import"../js/@ctrl_tinycolor@3.6.0@@ctrl/@ctrl_tinycolor@3.6.0@@ctrl.f8748455.js";import"../js/dayjs@1.11.8@dayjs/dayjs@1.11.8@dayjs.ab63237d.js";import"../js/async-validator@4.2.5@async-validator/async-validator@4.2.5@async-validator.dee29e8b.js";import"../js/memoize-one@6.0.0@memoize-one/memoize-one@6.0.0@memoize-one.297ddbcb.js";import"../js/escape-html@1.0.3@escape-html/escape-html@1.0.3@escape-html.3a386d15.js";import"../js/normalize-wheel-es@1.2.0@normalize-wheel-es/normalize-wheel-es@1.2.0@normalize-wheel-es.ed76fb12.js";import"../js/@floating-ui_dom@1.4.2@@floating-ui/@floating-ui_dom@1.4.2@@floating-ui.4bb7de12.js";import"../js/@floating-ui_core@1.3.1@@floating-ui/@floating-ui_core@1.3.1@@floating-ui.a8b4680c.js";const K=e=>new S({image:new P({crossOrigin:"anonymous",src:e,scale:.1})}),Q=({coordinate:e,vectorSource:s,imageUrl:l,name:o="标注点"})=>{if(s===null)return;const a=new w({geometry:new b(e),name:o});a.setStyle(K(l)),s.addFeature(a)};class W extends I{constructor(){super(),this.coordinate_=null,this.cursor_="pointer",this.feature_=null,this.previousCursor_=void 0}handleDownEvent(s){const o=s.map.forEachFeatureAtPixel(s.pixel,function(a){return a});return o&&(this.coordinate_=s.coordinate,this.feature_=o),!!o}handleDragEvent(s){if(this.coordinate_===null||this.feature_===null)return;const l=s.coordinate[0]-this.coordinate_[0],o=s.coordinate[1]-this.coordinate_[1];this.feature_.getGeometry().translate(l,o),this.coordinate_[0]=s.coordinate[0],this.coordinate_[1]=s.coordinate[1]}handleMoveEvent(s){if(this.cursor_){const o=s.map.forEachFeatureAtPixel(s.pixel,function(F){return F}),a=s.map.getTargetElement();o?a.style.cursor!=this.cursor_&&(this.previousCursor_=a.style.cursor,a.style.cursor=this.cursor_):this.previousCursor_!==void 0&&(a.style.cursor=this.previousCursor_,this.previousCursor_=void 0)}}handleUpEvent(){return this.coordinate_=null,this.feature_=null,!1}}const ss={class:"top"},ns=["src"],as=Y({__name:"index",setup(e){let s=null,l;const o=m(null),a=m(null),F=["/image/chips.png","/image/ice_cream.png"],E=new k({source:new M({attributions:q,url:x,maxZoom:20})}),i=new L,A=new T({source:i}),d=()=>{s=new V({target:"map",interactions:U().extend([new W]),layers:[E,A],view:new O({projection:"EPSG:4326",center:[0,0],zoom:5}),controls:X().extend([new N])}),l=new R({element:o.value||void 0,positioning:"center-center"}),s.addOverlay(l)},g=n=>{const t=n.target.src;n.dataTransfer.setData("src",t)},B=n=>{n.preventDefault()},v=n=>{var f;if(s===null)return;const t=(f=n.dataTransfer)==null?void 0:f.getData("src"),{layerX:r,layerY:c}=n,y=s.getCoordinateFromPixel([r,c]);Q({coordinate:y,vectorSource:i,imageUrl:t}),n.stopPropagation()},h=n=>{n.getViewport().oncontextmenu=function(t){t.preventDefault();const r=n.getEventPixel(t),c=n.forEachFeatureAtPixel(r,y=>y);if(c){const y=n.getEventCoordinate(t);a.value=c,l.setPosition(y)}}},_=()=>{const n=A.getSource();n===null||a.value===null||(n.removeFeature(a.value),a.value=null,l.setPosition(void 0))};return G(()=>{const n=document.getElementById("map");n&&(n.oncontextmenu=()=>!1),d(),s&&(h(s),s.on("singleclick",()=>{l.setPosition(void 0)}))}),j(()=>{s&&(s.dispose(),s=null)}),(n,t)=>(D(),C(u,null,[p("div",ss,[(D(),C(u,null,Z(F,(r,c)=>p("img",{key:c,src:r,draggable:"true",onDragstart:g},null,40,ns)),64))]),p("div",{id:"map",onDrop:v,onDragover:B},[p("div",{class:"menu",ref_key:"menu",ref:o},[p("div",{class:"menu-item",onClick:_},"删除")],512)],32)],64))}});const ls=J(as,[["__scopeId","data-v-1166a1e6"]]),os=p("h1",{id:"拖拽添加覆盖物",tabindex:"-1"},[z("拖拽添加覆盖物 "),p("a",{class:"header-anchor",href:"#拖拽添加覆盖物","aria-label":'Permalink to "拖拽添加覆盖物"'},"​")],-1),ps=p("div",{class:"tip custom-block"},[p("p",{class:"custom-block-title"},"TIP"),p("p",null,"拖拽下方的图标到地图指定位置可以生成覆盖物。"),p("p",null,"对着地图上的覆盖物单击右键可以移除。")],-1),ts=H("",6),Vs=JSON.parse('{"title":"拖拽添加覆盖物","description":"","frontmatter":{},"headers":[],"relativePath":"open-layers/map-marker/drag-to-add-mulch/index.md","filePath":"open-layers/map-marker/drag-to-add-mulch/index.md","lastUpdated":1687683239000}'),es={name:"open-layers/map-marker/drag-to-add-mulch/index.md"},Us=Object.assign(es,{setup(e){return(s,l)=>(D(),C("div",null,[os,ps,$(ls),ts]))}});export{Vs as __pageData,Us as default};
