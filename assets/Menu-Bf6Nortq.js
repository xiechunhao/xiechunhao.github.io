var e=(e,l,a)=>new Promise(((t,u)=>{var n=e=>{try{d(a.next(e))}catch(l){u(l)}},o=e=>{try{d(a.throw(e))}catch(l){u(l)}},d=e=>e.done?t(e.value):Promise.resolve(e.value).then(n,o);d((a=a.apply(e,l)).next())}));import{z as l,I as a,B as t,m as u,_ as n}from"./index-D_qZw2oD.js";import{I as o}from"./IconSelector-DG5Q2Ei4.js";/* empty css                       *//* empty css                        */import{_ as d}from"./ButtonTable-53-Y9OGI.js";/* empty css               */import{d as r,j as s,r as i,Z as m,N as p,c,o as f,b as h,w as b,H as _,L as v,I as g,M as V,aR as y,aK as k,x as w,u as I,F as x,A as U,ad as C,e as j,$ as L,a as N,a0 as A,b2 as H,m as M,b3 as E,aO as S,C as T,ar as q,aq as B,_ as z,P as O,g as P,aj as $}from"./vendor-Dakx4FZ3.js";import"./iconfont-DPUoc2h2.js";const F={class:"page-content"},R={style:{margin:"0","text-align":"right"}},D={class:"dialog-footer"},K=n(r({__name:"Menu",setup(n){const r=s((()=>l().getMenuList)),K=i(!1),Z=m({name:"",path:"",label:"",icon:"",isEnable:!0,sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1}),G=i(a.UNICODE),J=i("menu"),Q=m({name:[{required:!0,message:"请输入菜单名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],path:[{required:!0,message:"请输入路由地址",trigger:"blur"}],label:[{required:!0,message:"输入权限标识",trigger:"blur"}],authName:[{required:!0,message:"请输入权限名称",trigger:"blur"}],authLabel:[{required:!0,message:"请输入权限权限标识",trigger:"blur"}]}),W=r.value,X=i(!1),Y=i(),ee=s((()=>{const e="menu"===J.value?"菜单":"权限";return X.value?`编辑${e}`:`新建${e}`})),le=()=>{},ae=()=>e(this,null,(function*(){Y.value&&(yield Y.value.validate((l=>e(this,null,(function*(){if(l)try{X.value,O.success((X.value?"编辑":"新增")+"成功"),K.value=!1}catch(e){O.error((X.value?"编辑":"新增")+"失败")}})))))})),te=(e,l,a=!1)=>{K.value=!0,J.value=e,X.value=!1,re.value=a,ue(),l&&(X.value=!0,P((()=>{"menu"===e?(Z.name=t(l.meta.title),Z.path=l.path,Z.label=l.name,Z.icon=l.meta.icon,Z.sort=l.meta.sort||1,Z.isMenu=l.meta.isMenu,Z.keepAlive=l.meta.keepAlive,Z.isHidden=l.meta.isHidden||!0,Z.isEnable=l.meta.isEnable||!0,Z.link=l.meta.link,Z.isIframe=l.meta.isIframe||!1):(Z.authName=l.title,Z.authLabel=l.auth_mark,Z.authIcon=l.icon||"",Z.authSort=l.sort||1)})))},ue=()=>{var e;null==(e=Y.value)||e.resetFields(),Object.assign(Z,{name:"",path:"",label:"",icon:"",sort:1,isMenu:!0,keepAlive:!0,isHidden:!0,link:"",isIframe:!1,authName:"",authLabel:"",authIcon:"",authSort:1})},ne=()=>e(this,null,(function*(){try{yield $.confirm("确定要删除该菜单吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),O.success("删除成功")}catch(e){"cancel"!==e&&O.error("删除失败")}})),oe=()=>e(this,null,(function*(){try{yield $.confirm("确定要删除该权限吗？删除后无法恢复","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),O.success("删除成功")}catch(e){"cancel"!==e&&O.error("删除失败")}})),de=s((()=>!(!X.value||"button"!==J.value)||(!(!X.value||"menu"!==J.value)||!(X.value||"menu"!==J.value||!re.value)))),re=i(!1);return(e,l)=>{const a=g,n=y,r=k,s=C,i=d,m=u,O=E,P=H,$=A,X=T,ue=S,re=o,se=q,ie=B,me=L,pe=z,ce=p("auth"),fe=p("ripple");return f(),c("div",F,[h(n,{gutter:20,style:{"margin-left":"15px"}},{default:b((()=>[_((f(),v(a,{onClick:l[0]||(l[0]=e=>te("menu",null,!0))},{default:b((()=>l[19]||(l[19]=[V("添加菜单")]))),_:1})),[[ce,"add"],[fe]])])),_:1}),h(m,{data:I(W)},{default:b((()=>[h(r,{label:"菜单名称"},{default:b((e=>{var l;return[V(w(I(t)(null==(l=e.row.meta)?void 0:l.title)),1)]})),_:1}),h(r,{prop:"path",label:"路由"}),h(r,{prop:"meta.authList",label:"可操作权限"},{default:b((e=>[(f(!0),c(x,null,U(e.row.meta.authList,((e,t)=>(f(),v(s,{placement:"top-start",title:"操作",width:200,trigger:"click",key:t},{reference:b((()=>[h(a,{class:"small-btn"},{default:b((()=>[V(w(e.title),1)])),_:2},1024)])),default:b((()=>[j("div",R,[h(a,{size:"small",type:"primary",onClick:l=>te("button",e)},{default:b((()=>l[20]||(l[20]=[V("编辑")]))),_:2},1032,["onClick"]),h(a,{size:"small",type:"danger",onClick:l[1]||(l[1]=e=>oe())},{default:b((()=>l[21]||(l[21]=[V("删除")]))),_:1})])])),_:2},1024)))),128))])),_:1}),h(r,{label:"编辑时间",prop:"date"},{default:b((()=>l[22]||(l[22]=[V(" 2022-3-12 12:00:00 ")]))),_:1}),h(r,{fixed:"right",label:"操作",width:"180"},{default:b((e=>[_(h(i,{type:"add",onClick:l[2]||(l[2]=e=>te("menu"))},null,512),[[ce,"add"]]),_(h(i,{type:"edit",onClick:l=>{return a=e.row,void te("menu",a,!0);var a}},null,8,["onClick"]),[[ce,"edit"]]),_(h(i,{type:"delete",onClick:ne},null,512),[[ce,"delete"]])])),_:1})])),_:1},8,["data"]),h(pe,{title:I(ee),modelValue:I(K),"onUpdate:modelValue":l[18]||(l[18]=e=>M(K)?K.value=e:null),width:"700px","align-center":""},{footer:b((()=>[j("span",D,[h(a,{onClick:l[16]||(l[16]=e=>K.value=!1)},{default:b((()=>l[25]||(l[25]=[V("取 消")]))),_:1}),h(a,{type:"primary",onClick:l[17]||(l[17]=e=>ae())},{default:b((()=>l[26]||(l[26]=[V(" 确 定 ")]))),_:1})])])),default:b((()=>[h(me,{ref_key:"formRef",ref:Y,model:I(Z),rules:I(Q),"label-width":"85px"},{default:b((()=>[h($,{label:"菜单类型"},{default:b((()=>[h(P,{modelValue:I(J),"onUpdate:modelValue":l[3]||(l[3]=e=>M(J)?J.value=e:null),disabled:I(de)},{default:b((()=>[h(O,{value:"menu",label:"menu"},{default:b((()=>l[23]||(l[23]=[V("菜单")]))),_:1}),h(O,{value:"button",label:"button"},{default:b((()=>l[24]||(l[24]=[V("权限")]))),_:1})])),_:1},8,["modelValue","disabled"])])),_:1}),"menu"===I(J)?(f(),c(x,{key:0},[h(n,{gutter:20},{default:b((()=>[h(ue,{span:12},{default:b((()=>[h($,{label:"菜单名称",prop:"name"},{default:b((()=>[h(X,{modelValue:I(Z).name,"onUpdate:modelValue":l[4]||(l[4]=e=>I(Z).name=e),placeholder:"菜单名称"},null,8,["modelValue"])])),_:1})])),_:1}),h(ue,{span:12},{default:b((()=>[h($,{label:"路由地址",prop:"path"},{default:b((()=>[h(X,{modelValue:I(Z).path,"onUpdate:modelValue":l[5]||(l[5]=e=>I(Z).path=e),placeholder:"路由地址"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),h(n,{gutter:20},{default:b((()=>[h(ue,{span:12},{default:b((()=>[h($,{label:"权限标识",prop:"label"},{default:b((()=>[h(X,{modelValue:I(Z).label,"onUpdate:modelValue":l[6]||(l[6]=e=>I(Z).label=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1}),h(ue,{span:12},{default:b((()=>[h($,{label:"图标",prop:"icon"},{default:b((()=>[h(re,{iconType:I(G),defaultIcon:I(Z).icon,width:"229px"},null,8,["iconType","defaultIcon"])])),_:1})])),_:1})])),_:1}),h(n,{gutter:20},{default:b((()=>[h(ue,{span:12},{default:b((()=>[h($,{label:"菜单排序",prop:"sort",style:{width:"100%"}},{default:b((()=>[h(se,{modelValue:I(Z).sort,"onUpdate:modelValue":l[7]||(l[7]=e=>I(Z).sort=e),style:{width:"100%"},onChange:le,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1}),h(ue,{span:12},{default:b((()=>[h($,{label:"外部链接",prop:"link"},{default:b((()=>[h(X,{modelValue:I(Z).link,"onUpdate:modelValue":l[8]||(l[8]=e=>I(Z).link=e),placeholder:"外部链接/内嵌地址(https://www.baidu.com)"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),h(n,{gutter:20},{default:b((()=>[h(ue,{span:5},{default:b((()=>[h($,{label:"是否启用",prop:"isEnable"},{default:b((()=>[h(ie,{modelValue:I(Z).isEnable,"onUpdate:modelValue":l[9]||(l[9]=e=>I(Z).isEnable=e)},null,8,["modelValue"])])),_:1})])),_:1}),h(ue,{span:5},{default:b((()=>[h($,{label:"页面缓存",prop:"keepAlive"},{default:b((()=>[h(ie,{modelValue:I(Z).keepAlive,"onUpdate:modelValue":l[10]||(l[10]=e=>I(Z).keepAlive=e)},null,8,["modelValue"])])),_:1})])),_:1}),h(ue,{span:5},{default:b((()=>[h($,{label:"是否显示",prop:"isHidden"},{default:b((()=>[h(ie,{modelValue:I(Z).isHidden,"onUpdate:modelValue":l[11]||(l[11]=e=>I(Z).isHidden=e)},null,8,["modelValue"])])),_:1})])),_:1}),h(ue,{span:5},{default:b((()=>[h($,{label:"是否内嵌",prop:"isMenu"},{default:b((()=>[h(ie,{modelValue:I(Z).isIframe,"onUpdate:modelValue":l[12]||(l[12]=e=>I(Z).isIframe=e)},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):N("",!0),"button"===I(J)?(f(),c(x,{key:1},[h(n,{gutter:20},{default:b((()=>[h(ue,{span:12},{default:b((()=>[h($,{label:"权限名称",prop:"authName"},{default:b((()=>[h(X,{modelValue:I(Z).authName,"onUpdate:modelValue":l[13]||(l[13]=e=>I(Z).authName=e),placeholder:"权限名称"},null,8,["modelValue"])])),_:1})])),_:1}),h(ue,{span:12},{default:b((()=>[h($,{label:"权限标识",prop:"authLabel"},{default:b((()=>[h(X,{modelValue:I(Z).authLabel,"onUpdate:modelValue":l[14]||(l[14]=e=>I(Z).authLabel=e),placeholder:"权限标识"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),h(n,{gutter:20},{default:b((()=>[h(ue,{span:12},{default:b((()=>[h($,{label:"权限排序",prop:"authSort",style:{width:"100%"}},{default:b((()=>[h(se,{modelValue:I(Z).authSort,"onUpdate:modelValue":l[15]||(l[15]=e=>I(Z).authSort=e),style:{width:"100%"},onChange:le,min:1,"controls-position":"right"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1})],64)):N("",!0)])),_:1},8,["model","rules"])])),_:1},8,["title","modelValue"])])}}}),[["__scopeId","data-v-d04977c9"]]);export{K as default};
