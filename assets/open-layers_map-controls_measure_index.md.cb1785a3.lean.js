import{O as w,o as _,p as S,D as L,S as v,F as A,b as E,C as b,a as P,T as x,X as V,V as G,M as N,c as H,P as h,L as q,u as O}from"../js/ol@7.4.0@ol/ol@7.4.0@ol.2a99620d.js";import{A as I,M as j}from"../js/index/index.47495de9.js";import{D as U,n as z,v as K,V as m,o as i,c as d,a as F,N as M,j as g,J as R,F as Z,S as X,I as Y,a0 as $}from"../js/@vue_runtime-core@3.3.4@@vue/@vue_runtime-core@3.3.4@@vue.35efc880.js";import{h as J}from"../js/@vue_reactivity@3.3.4@@vue/@vue_reactivity@3.3.4@@vue.e6fc7fe8.js";import{_ as Q}from"./app.f296b152.js";import"../js/earcut@2.2.4@earcut/earcut@2.2.4@earcut.e6a9c857.js";import"../js/rbush@3.0.1@rbush/rbush@3.0.1@rbush.75a05972.js";import"../js/quickselect@2.0.0@quickselect/quickselect@2.0.0@quickselect.f3892974.js";import"../js/@vue_shared@3.3.4@@vue/@vue_shared@3.3.4@@vue.5a5848fd.js";import"../js/@docsearch_css@3.5.1@@docsearch/@docsearch_css@3.5.1@@docsearch.4ed993c7.js";import"../js/body-scroll-lock@4.0.0-beta.0@body-scroll-lock/body-scroll-lock@4.0.0-beta.0@body-scroll-lock.e1f8a6eb.js";import"../js/geotiff@2.0.7@geotiff/geotiff@2.0.7@geotiff.101896b7.js";import"../js/@vue_runtime-dom@3.3.4@@vue/@vue_runtime-dom@3.3.4@@vue.5dd85bb5.js";import"../js/@vueuse_core@10.2.0@@vueuse/@vueuse_core@10.2.0@@vueuse.8a5d8129.js";import"../js/@vueuse_shared@10.2.0@@vueuse/@vueuse_shared@10.2.0@@vueuse.9afec68c.js";import"../js/es/element-plus@2.3.7@element-plus.9cf0a975.js";import"../js/lodash-es@4.17.21@lodash-es/lodash-es@4.17.21@lodash-es.36eb724a.js";import"../js/@vueuse_core@9.13.0@@vueuse/@vueuse_core@9.13.0@@vueuse.604f33c6.js";import"../js/@vueuse_shared@9.13.0@@vueuse/@vueuse_shared@9.13.0@@vueuse.740d90d5.js";import"../js/@element-plus_icons-vue@2.1.0@@element-plus/@element-plus_icons-vue@2.1.0@@element-plus.1b5ed4e9.js";import"../js/@sxzz_popperjs-es@2.11.7@@sxzz/@sxzz_popperjs-es@2.11.7@@sxzz.c75af06c.js";import"../js/@ctrl_tinycolor@3.6.0@@ctrl/@ctrl_tinycolor@3.6.0@@ctrl.f8748455.js";import"../js/dayjs@1.11.8@dayjs/dayjs@1.11.8@dayjs.ab63237d.js";import"../js/async-validator@4.2.5@async-validator/async-validator@4.2.5@async-validator.dee29e8b.js";import"../js/memoize-one@6.0.0@memoize-one/memoize-one@6.0.0@memoize-one.297ddbcb.js";import"../js/escape-html@1.0.3@escape-html/escape-html@1.0.3@escape-html.3a386d15.js";import"../js/normalize-wheel-es@1.2.0@normalize-wheel-es/normalize-wheel-es@1.2.0@normalize-wheel-es.ed76fb12.js";import"../js/@floating-ui_dom@1.4.2@@floating-ui/@floating-ui_dom@1.4.2@@floating-ui.4bb7de12.js";import"../js/@floating-ui_core@1.3.1@@floating-ui/@floating-ui_core@1.3.1@@floating-ui.a8b4680c.js";function W({helpTooltipElement:n,map:l}){n&&n.parentNode&&n.parentNode.removeChild(n);const a=document.createElement("div");a.className="tooltip hidden";const s=new w({element:a,offset:[15,0],positioning:"center-left"});return l.addOverlay(s),[a,s]}function T({measureTooltipElement:n,map:l}){n&&n.parentNode&&n.parentNode.removeChild(n);const a=document.createElement("div");a.className="tooltip tooltip-measure";const s=new w({element:a,offset:[0,-15],positioning:"bottom-center"});return l.addOverlay(s),[a,s]}function ss({checked:n,line:l,map:a}){let s;if(n){const c=a.getView().getProjection();s=_(l,{projection:c,radius:6378137})}else s=Math.round(l.getLength()*100)/100;let p;return s>100?p=Math.round(s/1e3*100)/100+" km":p=Math.round(s*100)/100+" m",p}function ns({checked:n,polygon:l,map:a}){let s;if(n){const c=a.getView().getProjection(),f=l.clone().transform(c,"EPSG:4326");s=Math.abs(S(f,{projection:c,radius:6378137}))}else s=l.getArea();let p;return s>1e4?p=Math.round(s/1e6*100)/100+" km<sup>2</sup>":p=Math.round(s*100)/100+" m<sup>2</sup>",p}function as({source:n,type:l}){return new L({source:n,type:l,style:new v({fill:new A({color:"rgba(255, 255, 255, 0.2)"}),stroke:new E({color:"rgba(0, 0, 0, 0.5)",lineDash:[10,10],width:2}),image:new b({radius:5,stroke:new E({color:"rgba(0, 0, 0, 0.7)"}),fill:new A({color:"rgba(255, 255, 255, 0.2)"})})})})}function ls(n){return new P({source:n,style:new v({fill:new A({color:"rgba(255, 255, 255, 0.2)"}),stroke:new E({color:"#ffcc33",width:2}),image:new b({radius:7,fill:new A({color:"#ffcc33"})})})})}const os={id:"map"},ps={id:"menu"},ts="单击继续绘制多边形",es="单击继续绘制直线",cs=U({__name:"index",setup(n){const l=new x({source:new V({attributions:I,url:j,maxZoom:20})}),a=new G,s=J({checked:!1,typeSelect:"length",options:[{label:"长度",value:"length"},{label:"面积",value:"area"}],map:null,sketch:null,helpTooltipElement:null,helpTooltip:null,measureTooltipElement:null,measureTooltip:null,draw:null}),p=()=>{s.map=new N({target:"map",layers:[l],view:new H({projection:"EPSG:4326",center:[0,0],zoom:5})})},c=()=>{if(s.map===null)return;const e=ls(a);s.map.addLayer(e)},f=e=>{if(e.dragging)return;let o="单击开始绘图";if(s.sketch){const r=s.sketch.getGeometry();r instanceof h?o=ts:r instanceof q&&(o=es)}s.helpTooltipElement===null||s.helpTooltip===null||(s.helpTooltipElement.innerHTML=o,s.helpTooltip.setPosition(e.coordinate),s.helpTooltipElement.classList.remove("hidden"))},B=()=>{if(s.map===null)return;const e=s.typeSelect==="area"?"Polygon":"LineString";s.draw=as({source:a,type:e}),s.map.addInteraction(s.draw),[s.measureTooltipElement,s.measureTooltip]=T({measureTooltipElement:s.measureTooltipElement,map:s.map}),[s.helpTooltipElement,s.helpTooltip]=W({helpTooltipElement:s.helpTooltipElement,map:s.map});let o;s.draw.on("drawstart",function(r){s.sketch=r.feature;let D;const C=s.sketch.getGeometry();C&&(o=C.on("change",function(t){if(s.map===null)return;const y=t.target;let u="";y instanceof h?(u=ns({checked:s.checked,polygon:y,map:s.map}),D=y.getInteriorPoint().getCoordinates()):y instanceof q&&(u=ss({checked:s.checked,line:y,map:s.map}),D=y.getLastCoordinate()),s.measureTooltipElement&&(s.measureTooltipElement.innerHTML=u),s.measureTooltip&&s.measureTooltip.setPosition(D)}))}),s.draw.on("drawend",function(){s.measureTooltipElement!==null&&s.measureTooltip!==null&&s.map!==null&&(s.measureTooltipElement.className="tooltip tooltip-static",s.measureTooltip.setOffset([0,-7]),s.sketch=null,s.measureTooltipElement=null,[s.measureTooltipElement,s.measureTooltip]=T({measureTooltipElement:s.measureTooltipElement,map:s.map}),O(o))})},k=()=>{s.map===null||s.draw===null||(s.map.removeInteraction(s.draw),B())};return z(()=>{p(),c(),s.map&&(s.map.on("pointermove",f),s.map.getViewport().addEventListener("mouseout",()=>{s.helpTooltipElement&&s.helpTooltipElement.classList.add("hidden")})),B()}),K(()=>{s.map&&(s.map.dispose(),s.map=null)}),(e,o)=>{const r=m("el-option"),D=m("el-select"),C=m("el-checkbox");return i(),d("div",os,[F("div",ps,[M(" 几何体类型 "),g(D,{modelValue:s.typeSelect,"onUpdate:modelValue":o[0]||(o[0]=t=>s.typeSelect=t),placeholder:"Select",size:"small",onChange:k,class:"select"},{default:R(()=>[(i(!0),d(Z,null,X(s.options,t=>(i(),Y(r,{key:t.value,label:t.label,value:t.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),g(C,{modelValue:s.checked,"onUpdate:modelValue":o[1]||(o[1]=t=>s.checked=t),label:"使用测地线的措施",size:"large"},null,8,["modelValue"])])])}}});const rs=Q(cs,[["__scopeId","data-v-73d4629a"]]),ys=F("h1",{id:"测量",tabindex:"-1"},[M("测量 "),F("a",{class:"header-anchor",href:"#测量","aria-label":'Permalink to "测量"'},"​")],-1),Fs=F("div",{class:"tip custom-block"},[F("p",{class:"custom-block-title"},"TIP"),F("p",null,"单击开始绘图。左下角可以选择几何体的类型和是否使用测地线的措施。")],-1),Ds=$("",4),Us=JSON.parse('{"title":"测量","description":"","frontmatter":{},"headers":[],"relativePath":"open-layers/map-controls/measure/index.md","filePath":"open-layers/map-controls/measure/index.md","lastUpdated":1687683239000}'),Cs={name:"open-layers/map-controls/measure/index.md"},zs=Object.assign(Cs,{setup(n){return(l,a)=>(i(),d("div",null,[ys,Fs,g(rs),Ds]))}});export{Us as __pageData,zs as default};
