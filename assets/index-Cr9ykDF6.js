var e=(e,s,a)=>new Promise(((t,l)=>{var o=e=>{try{i(a.next(e))}catch(s){l(s)}},r=e=>{try{i(a.throw(e))}catch(s){l(s)}},i=e=>e.done?t(e.value):Promise.resolve(e.value).then(o,r);i((a=a.apply(e,s)).next())}));import{_ as s,j as a,n as t,i as l,k as o,u as r,g as i,H as n,S as d,o as u}from"./index-AUd2T663.js";import{h as c,X as g,aV as h,r as p,o as v,c as f,j as m,s as y,y as x,u as w,af as b,k,M as _,z as B,t as M,m as T,q as $,ah as V,ai as z,ag as I,_ as P,G as C,i as L,aE as X,B as j,J as H,H as S,Z as A,a4 as F,E as R,ax as U}from"./vendor-CC2XCvy_.js";import{L as D}from"./LeftView-DsMLAUBG.js";import{a as O,A as q}from"./index-CDaEv5A8.js";const E=["innerHTML"],G=s(c({__name:"DragVerify",props:{value:{type:Boolean,default:!1},width:{default:260},height:{default:44},text:{default:"按住滑块拖动"},successText:{default:"success"},background:{default:"#eee"},progressBarBg:{default:"#1385FF"},completedBg:{default:"#57D187"},circle:{type:Boolean,default:!1},radius:{default:"calc(var(--custom-radius) / 2 + 2px)"},handlerIcon:{default:"&#xea50;"},successIcon:{default:"&#xe621;"},handlerBg:{default:"#fff"},textSize:{default:"13px"},textColor:{default:"#333"}},emits:["handlerMove","update:value","passCallback"],setup(e,{expose:s,emit:a}){const t=a,l=e,o=g({isMoving:!1,x:0,isOk:!1}),{isOk:r}=h(o),i=p(),n=p(),d=p(),u=p();v((()=>{var e,s,a;null==(e=i.value)||e.style.setProperty("--textColor",l.textColor),null==(s=i.value)||s.style.setProperty("--width",Math.floor(l.width/2)+"px"),null==(a=i.value)||a.style.setProperty("--pwidth",-Math.floor(l.width/2)+"px")}));const c={left:"0",width:l.height+"px",height:l.height+"px",background:l.handlerBg},T={width:l.width+"px",height:l.height+"px",lineHeight:l.height+"px",background:l.background,borderRadius:l.circle?l.height/2+"px":l.radius},$={background:l.progressBarBg,height:l.height+"px",borderRadius:l.circle?l.height/2+"px 0 0 "+l.height/2+"px":l.radius},V={height:l.height+"px",width:l.width+"px",fontSize:l.textSize},z=f((()=>l.value?l.successText:l.text)),I=e=>{l.value||(o.isMoving=!0,d.value.style.transition="none",o.x=(e.pageX||e.touches[0].pageX)-parseInt(d.value.style.left.replace("px",""),10)),t("handlerMove")},P=e=>{if(o.isMoving&&!l.value){let s=(e.pageX||e.touches[0].pageX)-o.x;s>0&&s<=l.width-l.height?(d.value.style.left=s+"px",u.value.style.width=s+l.height/2+"px"):s>l.width-l.height&&(d.value.style.left=l.width-l.height+"px",u.value.style.width=l.width-l.height/2+"px",L())}},C=e=>{if(o.isMoving&&!l.value){(e.pageX||e.changedTouches[0].pageX)-o.x<l.width-l.height?(o.isOk=!0,d.value.style.left="0",d.value.style.transition="all 0.2s",u.value.style.width="0",o.isOk=!1):(d.value.style.transition="none",d.value.style.left=l.width-l.height+"px",u.value.style.width=l.width-l.height/2+"px",L()),o.isMoving=!1}},L=()=>{t("update:value",!0),o.isMoving=!1,u.value.style.background=l.completedBg,n.value.style["-webkit-text-fill-color"]="unset",n.value.style.animation="slidetounlock2 3s infinite",n.value.style.color="#fff",t("passCallback")};return s({reset:()=>{d.value.style.left="0",u.value.valueFormat.style.width="0",d.value.children[0].type=l.handlerIcon,n.value.style["-webkit-text-fill-color"]="transparent",n.value.style.animation="slidetounlock 3s infinite",n.value.style.color=l.background}}),(e,s)=>(M(),m("div",{ref_key:"dragVerify",ref:i,class:"drag_verify",style:T,onMousemove:P,onMouseup:C,onMouseleave:C,onTouchmove:P,onTouchend:C},[y("div",{class:x(["dv_progress_bar",{goFirst2:w(r)}]),ref_key:"progressBar",ref:u,style:$},null,2),y("div",{class:"dv_text custom-text",style:V,ref_key:"messageRef",ref:n},[e.$slots.textBefore?b(e.$slots,"textBefore",{key:0},void 0,!0):k("",!0),_(" "+B(z.value)+" ",1),e.$slots.textAfter?b(e.$slots,"textAfter",{key:1},void 0,!0):k("",!0)],512),y("div",{class:x(["dv_handler dv_handler_bg",{goFirst:w(r)}]),onMousedown:I,onTouchstart:I,ref_key:"handler",ref:d,style:c},[y("i",{class:"iconfont-sys",innerHTML:e.value?e.successIcon:e.handlerIcon},null,8,E)],34)],544))}}),[["__scopeId","data-v-aed95d78"]]),K={class:"login"},Z={class:"left-wrap"},J={class:"right-wrap"},N={class:"top-right-wrap"},Q={class:"iconfont-sys"},W={class:"lang-btn-item"},Y={key:0,class:"iconfont-sys"},ee={class:"lang-btn-item"},se={key:0,class:"iconfont-sys"},ae={class:"header"},te={class:"login-wrap"},le={class:"form"},oe={class:"title"},re={class:"sub-title"},ie={class:"drag-verify"},ne={class:"forget-password"},de={style:{"margin-top":"30px"}},ue={class:"footer"},ce=s(c({__name:"index",setup(s){const{t:c}=a(),h=t(),v=F(),b=p(!1),E=p(!1),ce=l.name,ge=p(),he=g({username:l.login.username,password:l.login.password,rememberPassword:!0}),pe=f((()=>({username:[{required:!0,message:c("login.placeholder[0]"),trigger:"blur"}],password:[{required:!0,message:c("login.placeholder[1]"),trigger:"blur"}]}))),ve=p(!1),{width:fe}=o(),me=r(),ye=f((()=>me.isDark)),xe=()=>{},we=()=>e(this,null,(function*(){ge.value&&(yield ge.value.validate((s=>e(this,null,(function*(){if(s){if(!b.value)return void(E.value=!0);ve.value=!0;try{const e=yield O.post("/api/login",{username:he.username,password:he.password});let{code:s,data:a}=e.data;s===q.success?(h.setUserInfo(a),h.setLoginStatus(!0),be(),v.push(n)):R.error(e.data.message)}finally{ve.value=!1}}})))))})),be=()=>{setTimeout((()=>{U({title:c("login.success.title"),type:"success",showClose:!1,duration:2500,zIndex:1e4,message:`${c("login.success.message")}, ${ce}!`})}),300)},{locale:ke}=a(),_e=e=>{ke.value=e,h.setLanguage(e)},Be=()=>{let{LIGHT:e,DARK:s}=d;u().switchTheme(r().systemThemeType===e?s:e)};return(e,s)=>{const a=z,t=V,l=I,o=C,r=P,n=G,d=X,u=j("router-link"),c=H,g=A;return M(),m("div",K,[y("div",Z,[T(D)]),y("div",J,[y("div",N,[y("div",{class:"btn theme-btn",onClick:Be},[y("i",Q,B(w(ye)?"":""),1)]),T(l,{onCommand:_e},{dropdown:$((()=>[T(t,null,{default:$((()=>[y("div",W,[T(a,{command:"zh"},{default:$((()=>[s[4]||(s[4]=y("span",{class:"menu-txt"},"简体中文",-1)),"zh"===w(ke)?(M(),m("i",Y,"")):k("",!0)])),_:1})]),y("div",ee,[T(a,{command:"en"},{default:$((()=>[s[5]||(s[5]=y("span",{class:"menu-txt"},"English",-1)),"en"===w(ke)?(M(),m("i",se,"")):k("",!0)])),_:1})])])),_:1})])),default:$((()=>[s[6]||(s[6]=y("div",{class:"btn language-btn"},[y("i",{class:"iconfont-sys"},"")],-1))])),_:1})]),y("div",ae,[s[7]||(s[7]=y("svg",{class:"icon","aria-hidden":"true"},[y("use",{"xlink:href":"#iconsys-zhaopian-copy"})],-1)),y("h1",null,B(w(ce)),1)]),y("div",te,[y("div",le,[y("h3",oe,B(e.$t("login.title")),1),y("p",re,B(e.$t("login.subTitle")),1),T(g,{ref_key:"formRef",ref:ge,model:w(he),rules:w(pe),onKeyup:S(we,["enter"]),style:{"margin-top":"25px"}},{default:$((()=>[T(r,{prop:"username"},{default:$((()=>[T(o,{placeholder:e.$t("login.placeholder[0]"),size:"large",modelValue:w(he).username,"onUpdate:modelValue":s[0]||(s[0]=e=>w(he).username=e),modelModifiers:{trim:!0}},null,8,["placeholder","modelValue"])])),_:1}),T(r,{prop:"password"},{default:$((()=>[T(o,{placeholder:e.$t("login.placeholder[1]"),size:"large",modelValue:w(he).password,"onUpdate:modelValue":s[1]||(s[1]=e=>w(he).password=e),modelModifiers:{trim:!0},type:"password",radius:"8px",autocomplete:"off"},null,8,["placeholder","modelValue"])])),_:1}),y("div",ie,[y("div",{class:x(["drag-verify-content",{error:!w(b)&&w(E)}])},[T(n,{ref:"dragVerify",value:w(b),"onUpdate:value":s[2]||(s[2]=e=>L(b)?b.value=e:null),width:w(fe)<500?328:438,text:e.$t("login.sliderText"),textColor:"var(--art-gray-800)",successText:e.$t("login.sliderSuccessText"),progressBarBg:w(i)("--el-color-primary"),background:"var(--art-gray-200)",handlerBg:"var(--art-main-bg-color)",onPass:xe},null,8,["value","width","text","successText","progressBarBg"])],2),y("p",{class:x(["error-text",{"show-error-text":!w(b)&&w(E)}])},B(e.$t("login.placeholder[2]")),3)]),y("div",ne,[T(d,{modelValue:w(he).rememberPassword,"onUpdate:modelValue":s[3]||(s[3]=e=>w(he).rememberPassword=e)},{default:$((()=>[_(B(e.$t("login.rememberPwd")),1)])),_:1},8,["modelValue"]),T(u,{class:"custom-text",to:"/forget-password"},{default:$((()=>[_(B(e.$t("login.forgetPwd")),1)])),_:1})]),y("div",de,[T(c,{class:"login-btn",size:"large",type:"primary",onClick:we,loading:w(ve)},{default:$((()=>[_(B(e.$t("login.btnText")),1)])),_:1},8,["loading"])]),y("div",ue,[y("p",null,[_(B(e.$t("login.noAccount"))+" ",1),T(u,{class:"custom-text",to:"/register"},{default:$((()=>[_(B(e.$t("login.register")),1)])),_:1})])])])),_:1},8,["model","rules"])])])])])}}}),[["__scopeId","data-v-3eb81946"]]);export{ce as default};
