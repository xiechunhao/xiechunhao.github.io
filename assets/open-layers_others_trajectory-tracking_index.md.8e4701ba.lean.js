import{g as R}from"./chunks/render.17812929.js";import{v as X,e as $}from"./chunks/index.34f4d0e1.js";import{A as Y,M as z}from"./chunks/index.a511ac44.js";import{b as i,S as d,a as W,I as J,T as h,F as q,V as H}from"./chunks/Vector.e7fd2c77.js";import{L as K}from"./chunks/LineString.2b94a2e9.js";import{F as Q,t as S}from"./chunks/Feature.861d9f0b.js";import{x as D,b4 as ss,j as ns,a7 as as,v as ls,i as v,M as os,V as ps,bR as es}from"./chunks/reproj.9b488601.js";import{V as ts}from"./chunks/Vector.ef038271.js";import{T as rs}from"./chunks/TileImage.70f39159.js";import{X as cs}from"./chunks/XYZ.94b2552a.js";import{F as Fs}from"./chunks/FullScreen.fe51dd7f.js";import{d as ys,a3 as Ds,p as is,a4 as Cs,D as M,o as L,c as k,z as C,a as w,G as _,B as As,b as V,t as us,_ as ds,O as ms}from"./chunks/framework.57763b9a.js";class fs extends Q{constructor(){super()}getType(){return"text"}readFeature(s,n){return this.readFeatureFromText(E(s),this.adaptOptions(n))}readFeatureFromText(s,n){return D()}readFeatures(s,n){return this.readFeaturesFromText(E(s),this.adaptOptions(n))}readFeaturesFromText(s,n){return D()}readGeometry(s,n){return this.readGeometryFromText(E(s),this.adaptOptions(n))}readGeometryFromText(s,n){return D()}readProjection(s){return this.readProjectionFromText(E(s))}readProjectionFromText(s){return this.dataProjection}writeFeature(s,n){return this.writeFeatureText(s,this.adaptOptions(n))}writeFeatureText(s,n){return D()}writeFeatures(s,n){return this.writeFeaturesText(s,this.adaptOptions(n))}writeFeaturesText(s,n){return D()}writeGeometry(s,n){return this.writeGeometryText(s,this.adaptOptions(n))}writeGeometryText(s,n){return D()}}function E(l){return typeof l=="string"?l:""}const gs=fs;function G(l,s,n,a,o,p){o!==void 0?(o=o,p=p!==void 0?p:0):(o=[],p=0);let e=s;for(;e<n;){const t=l[e++];o[p++]=l[e++],o[p++]=t;for(let c=2;c<a;++c)o[p++]=l[e++]}return o.length=p,o}class Es extends gs{constructor(s){super(),s=s||{},this.dataProjection=ss("EPSG:4326"),this.factor_=s.factor?s.factor:1e5,this.geometryLayout_=s.geometryLayout?s.geometryLayout:"XY"}readFeatureFromText(s,n){const a=this.readGeometryFromText(s,n);return new i(a)}readFeaturesFromText(s,n){return[this.readFeatureFromText(s,n)]}readGeometryFromText(s,n){const a=ns(this.geometryLayout_),o=hs(s,a,this.factor_);G(o,0,o.length,a,o);const p=as(o,0,o.length,a),e=new K(p,this.geometryLayout_);return S(e,!1,this.adaptOptions(n))}writeFeatureText(s,n){const a=s.getGeometry();return a?this.writeGeometryText(a,n):(ls(!1,40),"")}writeFeaturesText(s,n){return this.writeFeatureText(s[0],n)}writeGeometryText(s,n){s=S(s,!0,this.adaptOptions(n));const a=s.getFlatCoordinates(),o=s.getStride();return G(a,0,a.length,o,a),xs(a,o,this.factor_)}}function xs(l,s,n){n=n||1e5;let a;const o=new Array(s);for(a=0;a<s;++a)o[a]=0;for(let p=0,e=l.length;p<e;)for(a=0;a<s;++a,++p){const t=l[p],c=t-o[a];o[a]=t,l[p]=c}return qs(l,n)}function hs(l,s,n){n=n||1e5;let a;const o=new Array(s);for(a=0;a<s;++a)o[a]=0;const p=ws(l,n);for(let e=0,t=p.length;e<t;)for(a=0;a<s;++a,++e)o[a]+=p[e],p[e]=o[a];return p}function qs(l,s){s=s||1e5;for(let n=0,a=l.length;n<a;++n)l[n]=Math.round(l[n]*s);return _s(l)}function ws(l,s){s=s||1e5;const n=Bs(l);for(let a=0,o=n.length;a<o;++a)n[a]/=s;return n}function _s(l){for(let s=0,n=l.length;s<n;++s){const a=l[s];l[s]=a<0?~(a<<1):a<<1}return Ps(l)}function Bs(l){const s=Ts(l);for(let n=0,a=s.length;n<a;++n){const o=s[n];s[n]=o&1?~(o>>1):o>>1}return s}function Ps(l){let s="";for(let n=0,a=l.length;n<a;++n)s+=Ss(l[n]);return s}function Ts(l){const s=[];let n=0,a=0;for(let o=0,p=l.length;o<p;++o){const e=l.charCodeAt(o)-63;n|=(e&31)<<a,e<32?(s.push(n),n=0,a=0):a+=5}return s}function Ss(l){let s,n="";for(;l>=32;)s=(32|l&31)+63,n+=String.fromCharCode(s),l>>=5;return s=l+63,n+=String.fromCharCode(s),n}const vs=Es,Ms={id:"map"},Vs={class:"setting"},Gs=ys({__name:"index",setup(l){const s=Ds({speed:100,isPlay:!1});let n,a,o,p,e,t,c=0,m=[],x=0;const b=()=>{n=new os({target:"map",layers:[new rs({source:new cs({attributions:Y,url:z,maxZoom:20})})],view:new ps({projection:"EPSG:3857",center:[-563952395e-2,-350127452e-2],zoom:9,minZoom:2,maxZoom:19}),controls:es().extend([new Fs])})},j=()=>{s.isPlay?U():I()};function B(A){const F=Number(s.speed),y=A.frameState.time,u=y-a;c=(c+F*u/1e6)%2,a=y;const r=o.getCoordinateAt(c>1?2-c:c);p.setCoordinates(r);const f=R(A);m.length&&(x=Math.atan2(0,1)-Math.atan2(r[1]-m[1],r[0]-m[0])),f.setStyle(new d({text:new h({text:"->",rotation:x,font:"normal 20px 微软雅黑",fill:new q({color:"red"})})})),f.drawGeometry(p),m=r,n==null||n.render()}function I(){s.isPlay=!0,a=Date.now(),e.on("postrender",B),t.setGeometry(void 0)}function U(){s.isPlay=!1,t.setGeometry(p),e.un("postrender",B),t.setStyle(new d({text:new h({text:"->",rotation:x,font:"normal 20px 微软雅黑",fill:new q({color:"red"})})})),n==null||n.render()}return is(()=>{b(),fetch("/json/route.json").then(A=>{A.json().then(F=>{var T;const y=F.routes[0].geometry;o=new vs({factor:1e6}).readGeometry(y,{dataProjection:"EPSG:4326",featureProjection:"EPSG:3857"});const u=new i({type:"route",geometry:o}),r=new i({type:"icon",geometry:new v(o.getFirstCoordinate())}),f=new i({type:"icon",geometry:new v(o.getLastCoordinate())}),P=(T=r==null?void 0:r.getGeometry())==null?void 0:T.clone();if(P){p=P;const N=new i({type:"geoMarker",geometry:p});t=new i({geometry:p,type:"text"});let g=p.getFirstCoordinate();const Z={route:new d({stroke:new W({width:6,color:[237,212,0,.8]})}),icon:new d({image:new J({anchor:[.5,1],src:"/image/icon.png"})}),text:new d({text:new h({text:"->",rotation:Math.atan2(g[0]-g[1],g[1]-g[0]),font:"normal 20px 微软雅黑",fill:new q({color:"red"})})})};e=new ts({source:new H({features:[u,N,r,f,t]}),style:function(O){return Z[O.get("type")]}}),n==null||n.addLayer(e)}})})}),Cs(()=>{n&&(n.dispose(),n=null)}),(A,F)=>{const y=M("el-slider"),u=M("el-button");return L(),k("div",Ms,[C("div",Vs,[w(" 滑动控制速度: "),_(y,{modelValue:s.speed,"onUpdate:modelValue":F[0]||(F[0]=r=>s.speed=r),class:"slider",min:10,max:999},null,8,["modelValue"]),_(u,{type:"primary",icon:s.isPlay?V($):V(X),onClick:j},{default:As(()=>[w(us(s.isPlay?"关闭":"开启"),1)]),_:1},8,["icon"])])])}}});const Ls=ds(Gs,[["__scopeId","data-v-d74cc5b9"]]),ks=C("h1",{id:"轨迹跟踪",tabindex:"-1"},[w("轨迹跟踪 "),C("a",{class:"header-anchor",href:"#轨迹跟踪","aria-label":'Permalink to "轨迹跟踪"'},"​")],-1),bs=C("div",{class:"tip custom-block"},[C("p",{class:"custom-block-title"},"TIP"),C("p",null,"滑动滑块可改变箭头运动速度，点击按钮可控制开启或关闭。")],-1),js=ms("",2),Ks=JSON.parse('{"title":"轨迹跟踪","description":"","frontmatter":{},"headers":[],"relativePath":"open-layers/others/trajectory-tracking/index.md","filePath":"open-layers/others/trajectory-tracking/index.md","lastUpdated":1687662745000}'),Is={name:"open-layers/others/trajectory-tracking/index.md"},Qs=Object.assign(Is,{setup(l){return(s,n)=>(L(),k("div",null,[ks,bs,_(Ls),js]))}});export{Ks as __pageData,Qs as default};
