import{K as C,dR as L,L as E,b0 as P,M as B,r as R,J as V,R as j,aj as _,o as m,c as k,e as o,m as b,a6 as f,a2 as p,a8 as g,b as N,w as T,a5 as A,e3 as F,W as I}from"./index-C4BxmZrN.js";const h="ele-printer-container",w="ele-printer-iframe",y="ele-printing";function v(){const e=document.getElementById(h);if(e)return e;const t=document.createElement("div");return t.id=h,document.body.appendChild(t),t}function M(e){const t=document.querySelector("html");if(t){t.classList.add(y);const r=document.createElement("style");r.setAttribute("type","text/css"),r.setAttribute("media","print"),r.innerHTML=O(e),document.body.appendChild(r);const n=document.title;e.title!=null&&e.title!==""&&(document.title=e.title),window.print(e.options),t.classList.remove(y),document.body.removeChild(r),e.title!=null&&(document.title=n)}}function q(e){var t;const r=$(),n=r.contentWindow;if(!n)return;n.focus();const i=r.contentDocument||n.document;if(!i)return;const c=v();Array.from(c.querySelectorAll('input[type="text"], input[type="number"]')).forEach(l=>{l.setAttribute("value",l.value)}),i.open();const a=e.options?`JSON.parse('${JSON.stringify(e.options)}')`:"",d=`
  <style type="text/css" media="print">
    ${O(e)}
  </style>
  <script>
    const $html = document.querySelector('html');
    if($html && $html.classList && $html.classList.add) {
      $html.classList.add('${y}');
    }
    window.onload = function() {
      if(${e.title==null?0:1}) {
        document.title = '${e.title}';
      }
      window.print(${a});
      window.parent.postMessage('elePrintDone_${e.printId}', '*');
    };
  <\/script>
  `,s=(((t=document.querySelector("html"))==null?void 0:t.outerHTML)||"").replace(/<script/g,'<textarea style="display:none;" ').replace(/<\/script>/g,"</textarea>").replace(/<\/html>/,d+"</html>");return i.write("<!DOCTYPE html>"+s),i.close(),n}function $(){S();const e=document.createElement("iframe");return e.id=w,e.style.width="0px",e.style.height="0px",e.style.position="fixed",e.style.visibility="hidden",document.body.appendChild(e),e.focus(),e}function S(){const e=document.getElementById(w);e&&e.parentNode&&e.parentNode.removeChild(e)}function O(e){const t=["@page {"];if(e.margin!=null&&e.margin!==""){const r=typeof e.margin=="number"?e.margin+"px":e.margin;t.push(`margin: ${r};`)}return e.direction!=null&&e.direction!==""&&t.push(`size: ${e.direction};`),e.orientation!=null&&e.orientation!==""&&t.push(`page-orientation: ${e.orientation};`),t.push("}"),t.join(" ")}function D(e,t){return e==null?t:Object.assign({},e,t)}function H(e){const t=L(8),r=n=>{n.data===`elePrintDone_${t}`&&(S(),e&&e())};return window.addEventListener("message",r),C(()=>{window.removeEventListener("message",r)}),{printId:t}}function Y(e){const t=$();t.onload=()=>{const n=t.getAttribute("src");n&&(t.focus(),t.contentWindow&&t.contentWindow.print(e.options),e.done&&e.done(),URL.revokeObjectURL(n))};const r=n=>{const i=new window.Blob([n],{type:"application/pdf"});if(window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(i,"print.pdf");return}t.setAttribute("src",window.URL.createObjectURL(i))};if(e.arraybuffer){r(e.arraybuffer);return}if(e.url){const n=new window.XMLHttpRequest;n.open("GET",e.url,!0),n.responseType="arraybuffer",n.onload=()=>{if([200,201].indexOf(n.status)!==-1){r(n.response);return}e.error&&e.error(n.status,n.statusText)},n.send()}}const U={modelValue:Boolean,headerStyle:Object,bodyStyle:Object,footerStyle:Object,title:String,margin:[String,Number],direction:String,orientation:String,target:String,static:Boolean,options:Object},W={"update:modelValue":e=>!0,done:()=>!0},x=E({name:"ElePrinter",components:{ReceiverView:P},props:U,emits:W,setup(e,{emit:t}){const{printId:r}=H(()=>{u(!1),d()}),n=B(v()),i=R(!1),c=V(()=>e.static),a=s=>{i.value=!0,I(()=>{const l={printId:r,title:e.title,margin:e.margin,direction:e.direction,orientation:e.orientation,options:D(e.options,s)};e.target==="_iframe"?(q(l),i.value=!1):(M(l),i.value=!1,u(!1),d())})},d=()=>{t("done")},u=s=>{t("update:modelValue",s)};return j(()=>e.modelValue,s=>{s&&a()},{immediate:!0}),{container:n,visible:i,isStatic:c,print:a}}}),z=(e,t)=>{const r=e.__vccOpts||e;for(const[n,i]of t)r[n]=i;return r},J={key:0},G={key:1};function K(e,t,r,n,i,c){const a=_("ReceiverView");return m(),k(F,{to:e.container,disabled:e.isStatic&&!e.visible},[o("table",{class:A(["ele-printer",{"is-open":e.visible},{"is-static":e.isStatic}])},[e.$slots.header?(m(),b("thead",J,[o("tr",null,[o("td",null,[o("div",{class:"ele-printer-header",style:f(e.headerStyle)},[p(e.$slots,"header")],4)])])])):g("",!0),o("tbody",null,[o("tr",null,[o("td",null,[N(a,{class:"ele-printer-body",style:f(e.bodyStyle)},{default:T(()=>[p(e.$slots,"default")]),_:3},8,["style"])])])]),e.$slots.footer?(m(),b("tfoot",G,[o("tr",null,[o("td",null,[o("div",{class:"ele-printer-footer",style:f(e.footerStyle)},[p(e.$slots,"footer")],4)])])])):g("",!0)],2)],8,["to","disabled"])}const Q=z(x,[["render",K]]);export{Q as i,Y as p};
