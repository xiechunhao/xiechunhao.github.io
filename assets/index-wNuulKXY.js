import{J as T,r as R,O as z,o as v,l as B,a5 as D,d as O,a7 as F}from"./index-BF2fBoPb.js";var U=Object.defineProperty,k=(n,l,a)=>l in n?U(n,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[l]=a,M=(n,l,a)=>k(n,typeof l!="symbol"?l+"":l,a),S;(n=>{const l=class d{constructor(t,s,e,o){if(M(this,"size"),M(this,"mask"),M(this,"modules",[]),M(this,"isFunction",[]),this.version=t,this.errorCorrectionLevel=s,t<d.MIN_VERSION||t>d.MAX_VERSION)throw"Version value out of range";if(o<-1||o>7)throw"Mask value out of range";this.size=t*4+17;let i=[];for(let r=0;r<this.size;r++)i.push(!1);for(let r=0;r<this.size;r++)this.modules.push(i.slice()),this.isFunction.push(i.slice());this.drawFunctionPatterns();const h=this.addEccAndInterleave(e);if(this.drawCodewords(h),o==-1){let r=1e9;for(let m=0;m<8;m++){this.applyMask(m),this.drawFormatBits(m);const c=this.getPenaltyScore();c<r&&(o=m,r=c),this.applyMask(m)}}u(0<=o&&o<=7),this.mask=o,this.applyMask(o),this.drawFormatBits(o),this.isFunction=[]}static encodeText(t,s){const e=n.QrSegment.makeSegments(t);return d.encodeSegments(e,s)}static encodeBinary(t,s){const e=n.QrSegment.makeBytes(t);return d.encodeSegments([e],s)}static encodeSegments(t,s,e=1,o=40,i=-1,h=!0){if(!(d.MIN_VERSION<=e&&e<=o&&o<=d.MAX_VERSION)||i<-1||i>7)throw"Invalid value";let r,m;for(r=e;;r++){const C=d.getNumDataCodewords(r,s)*8,N=p.getTotalBits(t,r);if(N<=C){m=N;break}if(r>=o)throw"Data too long"}for(const C of[d.Ecc.MEDIUM,d.Ecc.QUARTILE,d.Ecc.HIGH])h&&m<=d.getNumDataCodewords(r,C)*8&&(s=C);let c=[];for(const C of t){f(C.mode.modeBits,4,c),f(C.numChars,C.mode.numCharCountBits(r),c);for(const N of C.getData())c.push(N)}u(c.length==m);const I=d.getNumDataCodewords(r,s)*8;u(c.length<=I),f(0,Math.min(4,I-c.length),c),f(0,(8-c.length%8)%8,c),u(c.length%8==0);for(let C=236;c.length<I;C^=253)f(C,8,c);let P=[];for(;P.length*8<c.length;)P.push(0);return c.forEach((C,N)=>P[N>>>3]|=C<<7-(N&7)),new d(r,s,P,i)}getModule(t,s){return 0<=t&&t<this.size&&0<=s&&s<this.size&&this.modules[s][t]}getModules(){return this.modules}drawFunctionPatterns(){for(let e=0;e<this.size;e++)this.setFunctionModule(6,e,e%2==0),this.setFunctionModule(e,6,e%2==0);this.drawFinderPattern(3,3),this.drawFinderPattern(this.size-4,3),this.drawFinderPattern(3,this.size-4);const t=this.getAlignmentPatternPositions(),s=t.length;for(let e=0;e<s;e++)for(let o=0;o<s;o++)e==0&&o==0||e==0&&o==s-1||e==s-1&&o==0||this.drawAlignmentPattern(t[e],t[o]);this.drawFormatBits(0),this.drawVersion()}drawFormatBits(t){const s=this.errorCorrectionLevel.formatBits<<3|t;let e=s;for(let i=0;i<10;i++)e=e<<1^(e>>>9)*1335;const o=(s<<10|e)^21522;u(o>>>15==0);for(let i=0;i<=5;i++)this.setFunctionModule(8,i,g(o,i));this.setFunctionModule(8,7,g(o,6)),this.setFunctionModule(8,8,g(o,7)),this.setFunctionModule(7,8,g(o,8));for(let i=9;i<15;i++)this.setFunctionModule(14-i,8,g(o,i));for(let i=0;i<8;i++)this.setFunctionModule(this.size-1-i,8,g(o,i));for(let i=8;i<15;i++)this.setFunctionModule(8,this.size-15+i,g(o,i));this.setFunctionModule(8,this.size-8,!0)}drawVersion(){if(this.version<7)return;let t=this.version;for(let e=0;e<12;e++)t=t<<1^(t>>>11)*7973;const s=this.version<<12|t;u(s>>>18==0);for(let e=0;e<18;e++){const o=g(s,e),i=this.size-11+e%3,h=Math.floor(e/3);this.setFunctionModule(i,h,o),this.setFunctionModule(h,i,o)}}drawFinderPattern(t,s){for(let e=-4;e<=4;e++)for(let o=-4;o<=4;o++){const i=Math.max(Math.abs(o),Math.abs(e)),h=t+o,r=s+e;0<=h&&h<this.size&&0<=r&&r<this.size&&this.setFunctionModule(h,r,i!=2&&i!=4)}}drawAlignmentPattern(t,s){for(let e=-2;e<=2;e++)for(let o=-2;o<=2;o++)this.setFunctionModule(t+o,s+e,Math.max(Math.abs(o),Math.abs(e))!=1)}setFunctionModule(t,s,e){this.modules[s][t]=e,this.isFunction[s][t]=!0}addEccAndInterleave(t){const s=this.version,e=this.errorCorrectionLevel;if(t.length!=d.getNumDataCodewords(s,e))throw"Invalid argument";const o=d.NUM_ERROR_CORRECTION_BLOCKS[e.ordinal][s],i=d.ECC_CODEWORDS_PER_BLOCK[e.ordinal][s],h=Math.floor(d.getNumRawDataModules(s)/8),r=o-h%o,m=Math.floor(h/o);let c=[];const I=d.reedSolomonComputeDivisor(i);for(let C=0,N=0;C<o;C++){let y=t.slice(N,N+m-i+(C<r?0:1));N+=y.length;const L=d.reedSolomonComputeRemainder(y,I);C<r&&y.push(0),c.push(y.concat(L))}let P=[];for(let C=0;C<c[0].length;C++)c.forEach((N,y)=>{(C!=m-i||y>=r)&&P.push(N[C])});return u(P.length==h),P}drawCodewords(t){if(t.length!=Math.floor(d.getNumRawDataModules(this.version)/8))throw"Invalid argument";let s=0;for(let e=this.size-1;e>=1;e-=2){e==6&&(e=5);for(let o=0;o<this.size;o++)for(let i=0;i<2;i++){const h=e-i,m=(e+1&2)==0?this.size-1-o:o;!this.isFunction[m][h]&&s<t.length*8&&(this.modules[m][h]=g(t[s>>>3],7-(s&7)),s++)}}u(s==t.length*8)}applyMask(t){if(t<0||t>7)throw"Mask value out of range";for(let s=0;s<this.size;s++)for(let e=0;e<this.size;e++){let o;switch(t){case 0:o=(e+s)%2==0;break;case 1:o=s%2==0;break;case 2:o=e%3==0;break;case 3:o=(e+s)%3==0;break;case 4:o=(Math.floor(e/3)+Math.floor(s/2))%2==0;break;case 5:o=e*s%2+e*s%3==0;break;case 6:o=(e*s%2+e*s%3)%2==0;break;case 7:o=((e+s)%2+e*s%3)%2==0;break;default:throw"Unreachable"}!this.isFunction[s][e]&&o&&(this.modules[s][e]=!this.modules[s][e])}}getPenaltyScore(){let t=0;for(let i=0;i<this.size;i++){let h=!1,r=0,m=[0,0,0,0,0,0,0];for(let c=0;c<this.size;c++)this.modules[i][c]==h?(r++,r==5?t+=d.PENALTY_N1:r>5&&t++):(this.finderPenaltyAddHistory(r,m),h||(t+=this.finderPenaltyCountPatterns(m)*d.PENALTY_N3),h=this.modules[i][c],r=1);t+=this.finderPenaltyTerminateAndCount(h,r,m)*d.PENALTY_N3}for(let i=0;i<this.size;i++){let h=!1,r=0,m=[0,0,0,0,0,0,0];for(let c=0;c<this.size;c++)this.modules[c][i]==h?(r++,r==5?t+=d.PENALTY_N1:r>5&&t++):(this.finderPenaltyAddHistory(r,m),h||(t+=this.finderPenaltyCountPatterns(m)*d.PENALTY_N3),h=this.modules[c][i],r=1);t+=this.finderPenaltyTerminateAndCount(h,r,m)*d.PENALTY_N3}for(let i=0;i<this.size-1;i++)for(let h=0;h<this.size-1;h++){const r=this.modules[i][h];r==this.modules[i][h+1]&&r==this.modules[i+1][h]&&r==this.modules[i+1][h+1]&&(t+=d.PENALTY_N2)}let s=0;for(const i of this.modules)s=i.reduce((h,r)=>h+(r?1:0),s);const e=this.size*this.size,o=Math.ceil(Math.abs(s*20-e*10)/e)-1;return u(0<=o&&o<=9),t+=o*d.PENALTY_N4,u(0<=t&&t<=2568888),t}getAlignmentPatternPositions(){if(this.version==1)return[];{const t=Math.floor(this.version/7)+2,s=this.version==32?26:Math.ceil((this.version*4+4)/(t*2-2))*2;let e=[6];for(let o=this.size-7;e.length<t;o-=s)e.splice(1,0,o);return e}}static getNumRawDataModules(t){if(t<d.MIN_VERSION||t>d.MAX_VERSION)throw"Version number out of range";let s=(16*t+128)*t+64;if(t>=2){const e=Math.floor(t/7)+2;s-=(25*e-10)*e-55,t>=7&&(s-=36)}return u(208<=s&&s<=29648),s}static getNumDataCodewords(t,s){return Math.floor(d.getNumRawDataModules(t)/8)-d.ECC_CODEWORDS_PER_BLOCK[s.ordinal][t]*d.NUM_ERROR_CORRECTION_BLOCKS[s.ordinal][t]}static reedSolomonComputeDivisor(t){if(t<1||t>255)throw"Degree out of range";let s=[];for(let o=0;o<t-1;o++)s.push(0);s.push(1);let e=1;for(let o=0;o<t;o++){for(let i=0;i<s.length;i++)s[i]=d.reedSolomonMultiply(s[i],e),i+1<s.length&&(s[i]^=s[i+1]);e=d.reedSolomonMultiply(e,2)}return s}static reedSolomonComputeRemainder(t,s){let e=s.map(o=>0);for(const o of t){const i=o^e.shift();e.push(0),s.forEach((h,r)=>e[r]^=d.reedSolomonMultiply(h,i))}return e}static reedSolomonMultiply(t,s){if(t>>>8||s>>>8)throw"Byte out of range";let e=0;for(let o=7;o>=0;o--)e=e<<1^(e>>>7)*285,e^=(s>>>o&1)*t;return u(e>>>8==0),e}finderPenaltyCountPatterns(t){const s=t[1];u(s<=this.size*3);const e=s>0&&t[2]==s&&t[3]==s*3&&t[4]==s&&t[5]==s;return(e&&t[0]>=s*4&&t[6]>=s?1:0)+(e&&t[6]>=s*4&&t[0]>=s?1:0)}finderPenaltyTerminateAndCount(t,s,e){return t&&(this.finderPenaltyAddHistory(s,e),s=0),s+=this.size,this.finderPenaltyAddHistory(s,e),this.finderPenaltyCountPatterns(e)}finderPenaltyAddHistory(t,s){s[0]==0&&(t+=this.size),s.pop(),s.unshift(t)}};M(l,"MIN_VERSION",1),M(l,"MAX_VERSION",40),M(l,"PENALTY_N1",3),M(l,"PENALTY_N2",3),M(l,"PENALTY_N3",40),M(l,"PENALTY_N4",10),M(l,"ECC_CODEWORDS_PER_BLOCK",[[-1,7,10,15,20,26,18,20,24,30,18,20,24,26,30,22,24,28,30,28,28,28,28,30,30,26,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,10,16,26,18,24,16,18,22,22,26,30,22,22,24,24,28,28,26,26,26,26,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28],[-1,13,22,18,26,18,24,18,22,20,24,28,26,24,20,30,24,28,28,26,30,28,30,30,30,30,28,30,30,30,30,30,30,30,30,30,30,30,30,30,30],[-1,17,28,22,16,22,28,26,26,24,28,24,28,22,24,24,30,28,28,26,28,30,24,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30]]),M(l,"NUM_ERROR_CORRECTION_BLOCKS",[[-1,1,1,1,1,1,2,2,2,2,4,4,4,4,4,6,6,6,6,7,8,8,9,9,10,12,12,12,13,14,15,16,17,18,19,19,20,21,22,24,25],[-1,1,1,1,2,2,4,4,4,5,5,5,8,9,9,10,10,11,13,14,16,17,17,18,20,21,23,25,26,28,29,31,33,35,37,38,40,43,45,47,49],[-1,1,1,2,2,4,4,6,6,8,8,8,10,12,16,12,17,16,18,21,20,23,23,25,27,29,34,34,35,38,40,43,45,48,51,53,56,59,62,65,68],[-1,1,1,2,4,4,4,5,6,8,8,11,11,16,16,18,16,19,21,25,25,25,34,30,32,35,37,40,42,45,48,51,54,57,60,63,66,70,74,77,81]]);let a=l;n.QrCode=a;function f(A,t,s){if(t<0||t>31||A>>>t)throw"Value out of range";for(let e=t-1;e>=0;e--)s.push(A>>>e&1)}function g(A,t){return(A>>>t&1)!=0}function u(A){if(!A)throw"Assertion error"}const w=class E{constructor(t,s,e){if(this.mode=t,this.numChars=s,this.bitData=e,s<0)throw"Invalid argument";this.bitData=e.slice()}static makeBytes(t){let s=[];for(const e of t)f(e,8,s);return new E(E.Mode.BYTE,t.length,s)}static makeNumeric(t){if(!E.isNumeric(t))throw"String contains non-numeric characters";let s=[];for(let e=0;e<t.length;){const o=Math.min(t.length-e,3);f(Number.parseInt(t.substr(e,o),10),o*3+1,s),e+=o}return new E(E.Mode.NUMERIC,t.length,s)}static makeAlphanumeric(t){if(!E.isAlphanumeric(t))throw"String contains unencodable characters in alphanumeric mode";let s=[],e;for(e=0;e+2<=t.length;e+=2){let o=E.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e))*45;o+=E.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e+1)),f(o,11,s)}return e<t.length&&f(E.ALPHANUMERIC_CHARSET.indexOf(t.charAt(e)),6,s),new E(E.Mode.ALPHANUMERIC,t.length,s)}static makeSegments(t){return t==""?[]:E.isNumeric(t)?[E.makeNumeric(t)]:E.isAlphanumeric(t)?[E.makeAlphanumeric(t)]:[E.makeBytes(E.toUtf8ByteArray(t))]}static makeEci(t){let s=[];if(t<0)throw"ECI assignment value out of range";if(t<128)f(t,8,s);else if(t<16384)f(2,2,s),f(t,14,s);else if(t<1e6)f(6,3,s),f(t,21,s);else throw"ECI assignment value out of range";return new E(E.Mode.ECI,0,s)}static isNumeric(t){return E.NUMERIC_REGEX.test(t)}static isAlphanumeric(t){return E.ALPHANUMERIC_REGEX.test(t)}getData(){return this.bitData.slice()}static getTotalBits(t,s){let e=0;for(const o of t){const i=o.mode.numCharCountBits(s);if(o.numChars>=1<<i)return 1/0;e+=4+i+o.bitData.length}return e}static toUtf8ByteArray(t){t=encodeURI(t);let s=[];for(let e=0;e<t.length;e++)t.charAt(e)!="%"?s.push(t.charCodeAt(e)):(s.push(Number.parseInt(t.substr(e+1,2),16)),e+=2);return s}};M(w,"NUMERIC_REGEX",/^[0-9]*$/),M(w,"ALPHANUMERIC_REGEX",/^[A-Z0-9 $%*+.\/:-]*$/),M(w,"ALPHANUMERIC_CHARSET","0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:");let p=w;n.QrSegment=p})(S||(S={}));(n=>{(l=>{const a=class{constructor(u,w){this.ordinal=u,this.formatBits=w}};M(a,"LOW",new a(0,1)),M(a,"MEDIUM",new a(1,0)),M(a,"QUARTILE",new a(2,3)),M(a,"HIGH",new a(3,2));let f=a;l.Ecc=f})(n.QrCode||(n.QrCode={}))})(S||(S={}));(n=>{(l=>{const a=class{constructor(u,w){this.modeBits=u,this.numBitsCharCount=w}numCharCountBits(u){return this.numBitsCharCount[Math.floor((u+7)/17)]}};M(a,"NUMERIC",new a(1,[10,12,14])),M(a,"ALPHANUMERIC",new a(2,[9,11,13])),M(a,"BYTE",new a(4,[8,16,16])),M(a,"KANJI",new a(8,[8,10,12])),M(a,"ECI",new a(7,[0,0,0]));let f=a;l.Mode=f})(n.QrSegment||(n.QrSegment={}))})(S||(S={}));const b=S,Q={L:b.QrCode.Ecc.LOW,M:b.QrCode.Ecc.MEDIUM,Q:b.QrCode.Ecc.QUARTILE,H:b.QrCode.Ecc.HIGH},$=.1,ot=function(){try{new Path2D().addPath(new Path2D)}catch(n){return!1}return!0}();function H(n,l,a,f){if(n==null||!n.src)return null;const g=f.length+a*2,u=Math.floor(l*$),w=g/l,p=(n.width||u)*w,A=(n.height||u)*w,t=n.x==null?f.length/2-p/2:n.x*w,s=n.y==null?f.length/2-A/2:n.y*w;let e=null;if(n.excavate){const o=Math.floor(t),i=Math.floor(s),h=Math.ceil(p+t-o),r=Math.ceil(A+s-i);e={x:o,y:i,w:h,h:r}}return{x:t,y:s,h:A,w:p,excavation:e}}function Y(n,l){return n.slice().map((a,f)=>f<l.y||f>=l.y+l.h?a:a.map((g,u)=>u<l.x||u>=l.x+l.w?g:!1))}function X(n,l=0){const a=[];return n.forEach(function(f,g){let u=null;f.forEach(function(w,p){if(!w&&u!==null){a.push(`M${u+l} ${g+l}h${p-u}v1H${u+l}z`),u=null;return}if(p===f.length-1){if(!w)return;u===null?a.push(`M${p+l},${g+l} h1v1H${p+l}z`):a.push(`M${u+l},${g+l} h${p+1-u}v1H${u+l}z`);return}w&&u===null&&(u=p)})}),a.join("")}const _={value:String,size:{type:Number,default:128},level:{type:String,default:"L"},bgColor:{type:String,default:"#FFFFFF"},fgColor:{type:String,default:"#000000"},margin:{type:Number,default:0},imageSettings:Object,customStyle:Object,tag:String},G={done:()=>!0},W=T({name:"EleQrCodeSvg",props:_,emits:G,setup(n,{emit:l}){const a=R(""),f=R(""),g=R(""),u=R(0),w=R(0),p=R(0),A=R(0),t=()=>{const{value:s,size:e,level:o,margin:i,imageSettings:h}=n;if(!s){a.value="";return}let r=b.QrCode.encodeText(s,Q[o]).getModules();const m=r.length+i*2,c=H(h,e,i,r);h!=null&&c!=null&&(c.excavation!=null&&(r=Y(r,c.excavation)),u.value=c.h,w.value=c.w,p.value=c.x+i,A.value=c.y+i),a.value=`0 0 ${m} ${m}`,f.value=`M0,0 h${m}v${m}H0z`,g.value=X(r,i),l("done")};return z([()=>n.value,()=>n.size,()=>n.level,()=>n.margin],()=>{t()},{immediate:!0}),z(()=>n.imageSettings,()=>{t()},{deep:!0}),{viewBox:a,path:f,fgPath:g,imageHeight:u,imageWidth:w,imageX:p,imageY:A,render:t}}}),K=(n,l)=>{const a=n.__vccOpts||n;for(const[f,g]of l)a[f]=g;return a},V={class:"ele-qr-code",style:{display:"inline-flex"}},j=["height","width","viewBox"],J=["fill","d"],Z=["fill","d"],q=["xlink:href","height","width","x","y"];function x(n,l,a,f,g,u){return v(),B("div",V,[n.viewBox?(v(),B("svg",{key:0,shapeRendering:"crispEdges",height:n.size,width:n.size,viewBox:n.viewBox,style:D(n.customStyle)},[O("path",{fill:n.bgColor,d:n.path},null,8,J),O("path",{fill:n.fgColor,d:n.fgPath},null,8,Z),n.imageSettings&&n.imageSettings.src?(v(),B("image",{key:0,"xlink:href":n.imageSettings.src,height:n.imageHeight,width:n.imageWidth,x:n.imageX,y:n.imageY,preserveAspectRatio:"none"},null,8,q)):F("",!0)],12,j)):F("",!0)])}const it=K(W,[["render",x]]);export{Q as E,ot as S,G as a,b,X as c,Y as e,H as g,it as i,_ as q};
