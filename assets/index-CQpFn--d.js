import{r as N,o as g,c as R,w as l,b as p,d as z,aX as B,aY as D,E,aC as J,e as w,m as b,F as C,n as M,t as A,a8 as j,aZ as O,a_ as I}from"./index-C4BxmZrN.js";import{i as K}from"./index-CkGVv88Q.js";import{i as T}from"./index-BCHJo1Hi.js";import"./index-DPWieFbN.js";import"./index-BY7TmcLY.js";import"./index-Cw5RFCD5.js";import"./virtual-list-CYzSvSUd.js";import"./index-CuklncWx.js";import{i as G}from"./index-CL6ZmOyB.js";import{E as L,a as X}from"./col-DljvzS69.js";import{E as Y}from"./upload-D6XcBL05.js";import"./progress-Bytq2m9M.js";import{i as Z}from"./index-DSHqkOzX.js";import"./isArrayLikeObject-XYcYxEsS.js";import"./vuedraggable.umd-BuphSp9t.js";import"./cloneDeep-hApPH6eT.js";const H={__name:"excel-export",setup(V){const y=N([{key:1,username:"张小三",amount:18,province:"浙江",city:"杭州",zone:"西湖区",street:"西溪街道",address:"西溪花园30栋1单元"},{key:2,username:"李小四",amount:39,province:"江苏",city:"苏州",zone:"姑苏区",street:"丝绸路",address:"天墅之城9幢2单元"},{key:3,username:"王小五",amount:8,province:"江西",city:"南昌",zone:"青山湖区",street:"艾溪湖办事处",address:"中兴和园1幢3单元"},{key:4,username:"赵小六",amount:16,province:"福建",city:"泉州",zone:"丰泽区",street:"南洋街道",address:"南洋村6幢1单元"},{key:5,username:"孙小七",amount:12,province:"湖北",city:"武汉",zone:"武昌区",street:"武昌大道",address:"两湖花园16幢2单元"},{key:6,username:"周小八",amount:11,province:"安徽",city:"黄山",zone:"黄山区",street:"汤口镇",address:"温泉村21号"}]),v=N([{type:"selection",columnKey:"selection",width:56,align:"center"},{type:"index",columnKey:"index",width:56,align:"center"},{prop:"username",label:"用户名",align:"center",minWidth:110},{columnKey:"cityAddress",label:"地址",align:"center",children:[{prop:"province",label:"省",align:"center",minWidth:100},{prop:"city",label:"市",align:"center",minWidth:100},{prop:"zone",label:"区",align:"center",minWidth:120},{prop:"street",label:"街道",align:"center",minWidth:120},{prop:"address",label:"详细地址",align:"center",minWidth:160}]},{prop:"amount",label:"金额",align:"center",minWidth:80}]),x=N([]),F=()=>{const a=[["用户名","省","市","区","街道","详细地址","金额"]];y.value.forEach(s=>{a.push([s.username,s.province,s.city,s.zone,s.street,s.address,s.amount])});const t="Sheet1",o={SheetNames:[t],Sheets:{}},n=B.aoa_to_sheet(a);o.Sheets[t]=n,n["!cols"]=[{wch:10},{wch:10},{wch:10},{wch:10},{wch:20},{wch:40},{wch:10}],D(o,"用户数据.xlsx")},W=()=>{const a=[["用户名","地址",null,null,null,null,"金额"],[null,"省","市","区","街道","详细地址",null]];y.value.forEach(s=>{a.push([s.username,s.province,s.city,s.zone,s.street,s.address,s.amount])});const t=B.aoa_to_sheet(a);t["!merges"]=[{s:{r:0,c:1},e:{r:0,c:5}},{s:{r:0,c:1},e:{r:0,c:5}},{s:{r:0,c:0},e:{r:1,c:0}},{s:{r:0,c:6},e:{r:1,c:6}}];const o="Sheet1",n={SheetNames:[o],Sheets:{}};n.Sheets[o]=t,D(n,"用户数据.xlsx")},U=()=>{if(x.value.length===0){E.error("请至少选择一条数据");return}const a=[["用户名","省","市","区","街道","详细地址","金额"]];x.value.forEach(n=>{a.push([n.username,n.province,n.city,n.zone,n.street,n.address,n.amount])});const t="Sheet1",o={SheetNames:[t],Sheets:{}};o.Sheets[t]=B.aoa_to_sheet(a),D(o,"用户数据.xlsx")};return(a,t)=>{const o=J,n=T,s=K;return g(),R(s,{header:"导出 Excel","body-style":{padding:"18px 20px"}},{default:l(()=>[p(n,{"row-key":"key",columns:v.value,datasource:y.value,"show-overflow-tooltip":!0,pagination:!1,selections:x.value,"onUpdate:selections":t[0]||(t[0]=d=>x.value=d),tools:["export","print","size","columns","maximized"],toolbar:{theme:"default"},border:!0},{toolbar:l(()=>[p(o,{type:"primary",class:"ele-btn-icon",onClick:F},{default:l(()=>[z(" 导出 ")]),_:1}),p(o,{type:"primary",class:"ele-btn-icon",onClick:W},{default:l(()=>[z(" 导出带表头合并 ")]),_:1}),p(o,{type:"primary",class:"ele-btn-icon",onClick:U},{default:l(()=>[z(" 导出选中 ")]),_:1})]),_:1},8,["columns","datasource","selections"])]),_:1})}}},P={style:{overflow:"auto"}},Q=w("th",null,null,-1),q={style:{"text-align":"center"}},ee=["colspan","rowspan"],te={key:0},oe=["colspan"],se=w("div",{style:{margin:"16px 0"}},"二维数组格式数据:",-1),ne={style:{"max-height":"300px",padding:"16px",overflow:"auto"}},re=w("div",{style:{margin:"16px 0"}},"JSON格式数据:",-1),ae={style:{"max-height":"300px",padding:"16px",overflow:"auto"}},le={__name:"excel-import",setup(V){const y=N(["A","B","C","D","E","F","G"]),v=N([]),x=N([]),F=t=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return E.error("只能选择 excel 文件"),!1;if(t.size/1024/1024>20)return E.error("大小不能超过 20MB"),!1;const o=new FileReader;return o.onload=n=>{var u;const s=new Uint8Array((u=n.target)==null?void 0:u.result),d=O(s,{type:"array"}),k=d.SheetNames,_=d.Sheets[k[0]],f=B.sheet_to_json(_,{header:1}),h=[],c=[];let m=0;f.forEach(e=>{e.length>m&&(m=e.length);const i={};for(let r=0;r<e.length;r++){const S=a(r);i[S]=e[r],i["colspan"+S]=1,i["rowspan"+S]=1}h.push(i)});for(let e=0;e<m;e++)c.push(a(e));y.value=c,v.value=h,x.value=f},o.readAsArrayBuffer(t),!1},W=t=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return E.error("只能选择 excel 文件"),!1;if(t.size/1024/1024>20)return E.error("大小不能超过 20MB"),!1;const o=new FileReader;return o.onload=n=>{var u;const s=new Uint8Array((u=n.target)==null?void 0:u.result),d=O(s,{type:"array"}),k=d.SheetNames,_=d.Sheets[k[0]],f=B.sheet_to_json(_,{header:1});_["!merges"]&&_["!merges"].forEach(e=>{for(let i=e.s.r;i<=e.e.r;i++)for(let r=e.s.c;r<=e.e.c;r++)f[i][r]=f[e.s.r][e.s.c]});const h=[],c=[];let m=0;f.forEach(e=>{e.length>m&&(m=e.length);const i={};for(let r=0;r<e.length;r++)i[a(r)]=e[r];h.push(i)});for(let e=0;e<m;e++)c.push(a(e));y.value=c,v.value=h,x.value=f},o.readAsArrayBuffer(t),!1},U=t=>{if(!["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"].includes(t.type))return E.error("只能选择 excel 文件"),!1;if(t.size/1024/1024>20)return E.error("大小不能超过 20MB"),!1;const o=new FileReader;return o.onload=n=>{var u;const s=new Uint8Array((u=n.target)==null?void 0:u.result),d=O(s,{type:"array"}),k=d.SheetNames,_=d.Sheets[k[0]],f=B.sheet_to_json(_,{header:1}),h=[],c=[];let m=0;f.forEach(e=>{e.length>m&&(m=e.length);const i={};for(let r=0;r<e.length;r++)i[a(r)]=e[r];h.push(i)});for(let e=0;e<m;e++)c.push(a(e));_["!merges"]&&_["!merges"].forEach(e=>{for(let r=e.s.r;r<=e.e.r;r++)for(let S=e.s.c;S<=e.e.c;S++){const $=a(S);h[r]["colspan"+$]=0,h[r]["rowspan"+$]=0}const i=a(e.s.c);h[e.s.r]["colspan"+i]=e.e.c-e.s.c+1,h[e.s.r]["rowspan"+i]=e.e.r-e.s.r+1}),y.value=c,v.value=h,x.value=f},o.readAsArrayBuffer(t),!1},a=t=>{const o=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];if(t<o.length)return o[t];const n=Number.parseInt(String(t/o.length)),s=t%o.length;return o[n]+o[s]};return(t,o)=>{const n=J,s=Y,d=I,k=G,_=L,f=X,h=K;return g(),R(h,{header:"导入 Excel"},{default:l(()=>[p(d,null,{default:l(()=>[p(s,{action:"",accept:".xls,.xlsx","show-upload-list":!1,"before-upload":F},{default:l(()=>[p(n,{type:"primary",class:"ele-btn-icon"},{default:l(()=>[z("导入")]),_:1})]),_:1}),p(s,{action:"",accept:".xls,.xlsx","show-upload-list":!1,"before-upload":W},{default:l(()=>[p(n,{type:"primary",class:"ele-btn-icon"},{default:l(()=>[z(" 导入拆分合并 ")]),_:1})]),_:1}),p(s,{action:"",accept:".xls,.xlsx","show-upload-list":!1,"before-upload":U},{default:l(()=>[p(n,{type:"primary",class:"ele-btn-icon"},{default:l(()=>[z(" 导入保持合并 ")]),_:1})]),_:1})]),_:1}),w("div",P,[p(k,{border:!0,style:{"min-width":"max-content"}},{default:l(()=>[w("thead",null,[w("tr",null,[Q,(g(!0),b(C,null,M(y.value,c=>(g(),b("th",{key:c,style:{"text-align":"center"}},A(c),1))),128))])]),w("tbody",null,[(g(!0),b(C,null,M(v.value,(c,m)=>(g(),b("tr",{key:m},[w("td",q,A(m+1),1),(g(!0),b(C,null,M(y.value,u=>(g(),b(C,null,[c["colspan"+u]!==0&&c["rowspan"+u]!==0?(g(),b("td",{key:u,colspan:c["colspan"+u],rowspan:c["rowspan"+u],style:{"text-align":"center"}},A(c[u]),9,ee)):j("",!0)],64))),256))]))),128)),v.value.length?j("",!0):(g(),b("tr",te,[w("td",{colspan:y.value.length+1,style:{"text-align":"center"}}," 暂无数据 ",8,oe)]))])]),_:1})]),p(f,{gutter:32},{default:l(()=>[p(_,{sm:12,xs:24},{default:l(()=>[se,w("pre",ne,A(JSON.stringify(x.value,null,4)),1)]),_:1}),p(_,{sm:12,xs:24},{default:l(()=>[re,w("pre",ae,A(JSON.stringify(v.value,null,4)),1)]),_:1})]),_:1})]),_:1})}}},ce={name:"ExtensionExcel"},Ee=Object.assign(ce,{setup(V){return(y,v)=>{const x=Z;return g(),R(x,null,{default:l(()=>[p(H),p(le)]),_:1})}}});export{Ee as default};
